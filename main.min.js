!function(){function __firefox(){HTMLElement.prototype.__defineGetter__("runtimeStyle",__element_style),window.constructor.prototype.__defineGetter__("event",__window_event),Event.prototype.__defineGetter__("srcElement",__event_srcElement)}function __element_style(){return this.style}function __window_event(){return __window_event_constructor()}function __event_srcElement(){return this.target}function __window_event_constructor(){if(document.all)return window.event;for(var e=__window_event_constructor.caller;null!=e;){var r=e.arguments[0];if(r)if(-1!=r.constructor.toString().indexOf("Event"))return r;e=e.caller}return null}window.addEventListener&&(isFirefox=0<navigator.userAgent.indexOf("Firefox"))&&__firefox();var jfgrid={};function z(e){var r,t={times:1,num:0};if(r=e,Math.floor(r)===r)return t.num=e,t;var i=e+"",a=i.indexOf("."),n=i.substr(a+1).length,o=Math.pow(10,n),l=parseInt(e*o+.5,10);return t.times=o,t.num=l,t}function A(e,r,t){var i=z(e),a=z(r),n=i.num,o=a.num,l=i.times,d=a.times,f=d<l?l:d;switch(t){case"add":return(l===d?n+o:d<l?n+o*(l/d):n*(d/l)+o)/f;case"subtract":return(l===d?n-o:d<l?n-o*(l/d):n*(d/l)-o)/f;case"multiply":return n*o/(l*d);case"divide":return A(n/o,d/l,"multiply")}}jfgrid.floatTool={add:function(e,r){return A(e,r,"add")},subtract:function(e,r){return A(e,r,"subtract")},multiply:function(e,r){return A(e,r,"multiply")},divide:function(e,r){return A(e,r,"divide")}},jfgrid.isJsonString=function(e){try{if("object"==typeof JSON.parse(e))return!0}catch(e){}return!1},jfgrid.isRealNum=function(e){return""!==e&&null!=e&&!isNaN(e)};var defaultSetting={container:"jfgrid",column:60,row:84,allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,data:[{name:"Sheet1",color:"",status:"1",order:"0",data:[],config:{},index:0},{name:"Sheet2",color:"",status:"0",order:"1",data:[],config:{},index:1},{name:"Sheet3",color:"",status:"0",order:"2",data:[],config:{},index:2}],title:"Luckysheet Demo",userInfo:'<i style="font-size:16px;color:#ff6a00;" class="fa fa-taxi" aria-hidden="true"></i> rabbit',userMenuItem:[{url:"www.baidu.com",icon:'<i class="fa fa-folder" aria-hidden="true"></i>',name:"我的表格"},{url:"www.baidu.com",icon:'<i class="fa fa-sign-out" aria-hidden="true"></i>',name:"退出登陆"}],myFolderUrl:"www.baidu.com",config:{},fullscreenmode:!0,devicePixelRatio:window.devicePixelRatio,allowEdit:!0,loadUrl:"",loadSheetUrl:"",gridKey:"",updateUrl:"",updateImageUrl:"",allowUpdate:!1,functionButton:"",showConfigWindowResize:!0,enableAddRow:!0,enableAddCol:!0,enablePage:!1,autoFormatw:!1,accuracy:void 0,pageInfo:{queryExps:"",reportId:"",fields:"",mobile:"",frezon:"",currentPage:"",totalPage:10,pageUrl:""},editMode:!1,chartConfigChange:null,beforeCreateDom:null,fireMousedown:null},gridHTML='<div class="jfgrid"><canvas id="jfgridTableContentF" style="display:none;" class="jfgridTableContent"></canvas><div class="jfgrid-work-area jfgrid-noselected-text"><div class="jfgrid-share-logo" title="${logotitle}"></div><div id ="jfgrid_info_detail" class="jfgrid_info_detail"><div data-tips="返回" id="jfgrid_info_detail_title" class="jfgrid_info_detail_title"><i style="margin-left: -2px;" class="fa fa-chevron-left" aria-hidden="true"></i></div><div><input data-tips="表格重命名" id="jfgrid_info_detail_input" class="jfgrid_info_detail_input jfgrid-mousedown-cancel" value="无标题的电子表格" tabindex="0" dir="ltr" aria-label="重命名" style="visibility: visible; width: 149px;" data-tooltip="重命名"></div><div id="jfgrid_info_detail_update" class="jfgrid_info_detail_update"> 新打开 </div><div id="jfgrid_info_detail_save" class="jfgrid_info_detail_save"> 待更新 </div><div class="jfgrid_info_detail_user"> ${functionButton} <span id="jfgrid_info_detail_user"></span> </div></div><div id="jfgrid-wa-editor" class="jfgrid-wa-editor"> ${menu} </div><div id="jfgrid-wa-calculate" class="jfgrid-wa-calculate"><div class="jfgrid-wa-calculate-size" id="jfgrid-wa-calculate-size"></div><div class="jfgrid-wa-calculate-help"><div class="jfgrid-wa-calculate-help-box"><div spellcheck="false" aria-hidden="false" id="jfgrid-helpbox"><div id="jfgrid-helpbox-cell" class="jfgrid-helpbox-cell-input jfgrid-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list"></div></div></div><div class="jfgrid-wa-calculate-help-tool"><i class="fa fa-caret-down" aria-hidden="true" style="margin-top: 7px;"></i></div></div><div id="jfgrid-wa-functionbox-cancel" class="jfgrid-wa-functionbox"><span><i class="fa fa-remove" aria-hidden="true"></i></span></div><div id="jfgrid-wa-functionbox-confirm" class="jfgrid-wa-functionbox"><span><i class="fa fa-check" aria-hidden="true"></i></span></div><div id="jfgrid-wa-functionbox-fx" class="jfgrid-wa-functionbox"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAQAAAD9CzEMAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAHdElNRQfdBg4KFCeL2MAqAAACOUlEQVRYw+3Wy2+MURjH8U9Hp0VLVTTRUupWqfs9xEpE3ULSsLK0qVg0rJAgiD/A2kpCQkJC0rhEJMJampBSFYle0BYNMUNKTY+F0bi10zFjIZnvuzrPe57fc3mfnPeQI0eO/5+8tHaPVW22cn1aNYlnO5nlzmgzIAiazcm2/FoPBEHMY+2uKcqufKlGQcIt29RYYl6azU3JLh8E99VkuzHfKHZekHDw38hT5Zmg17L0XSMj2jVXGTq9+lcBZilAp1j6AfKHfVtmh1IDauWjQoPPIp64IpF+qD+xSKfw23PV6GxV0KdFHJWKJLwQR0SbgezkT1SFSivcE3SrM9U005WlIzF8Bf1eokAUMQ89T9oLjdWfPOwixssT1/9niZFMUakJ+Kg3uV7olKtOm4kx6jU6qzqTRq33VnBHIahy0z0dgmPy7NGjx23ThnIeSQUTlKA7OZrjNNvtHNaoc8hFm+33MpMK9giCU4PJFGKrz7o8dVnF8M6pK4iYDLoGh/MT2jw32TuHU+WeOkC+KQi/CPXqwA2PUueXigIz8UnnT9b5ZmF68sNnFKBEFbq9/sFW7bioLxYpzjzAamV4pAtElahwQtQRb1WaZ4rtxqVUGZLv/7IDyfVGl1zXbpOJmgTnXXBXZfrCk9RabKmTYoIWc5P2o2La1RslYr8OPe5a9zeZ7/TGMx0Sgvf2Dt4hamyxMnmCFVllgxl/15oGcUHwRYt9mdyBhrrdlFtgtkIvNGvN3vmfI0eO/5Ov+PeiZHME+tcAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTYtMDktMTdUMTU6MTk6MDcrMDg6MDARPBuqAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDEzLTA2LTE0VDEwOjIwOjM5KzA4OjAw59f0jAAAAE10RVh0c29mdHdhcmUASW1hZ2VNYWdpY2sgNy4wLjEtNiBRMTYgeDg2XzY0IDIwMTYtMDktMTcgaHR0cDovL3d3dy5pbWFnZW1hZ2ljay5vcmfd2aVOAAAAGHRFWHRUaHVtYjo6RG9jdW1lbnQ6OlBhZ2VzADGn/7svAAAAF3RFWHRUaHVtYjo6SW1hZ2U6OkhlaWdodAA3Nkv1+ekAAAAWdEVYdFRodW1iOjpJbWFnZTo6V2lkdGgANzazWjlkAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADEzNzExNzY0MzntxStTAAAAEHRFWHRUaHVtYjo6U2l6ZQA5OTdClByG1AAAAF90RVh0VGh1bWI6OlVSSQBmaWxlOi8vL2hvbWUvd3d3cm9vdC9zaXRlL3d3dy5lYXN5aWNvbi5uZXQvY2RuLWltZy5lYXN5aWNvbi5jbi9zcmMvMTExNTkvMTExNTkzNy5wbmeOkn0GAAAAAElFTkSuQmCC" alt="" style="vertical-align:middle"/></div><div id="jfgrid-functionbox-container" class="jfgrid-mousedown-cancel"><div class="jfgrid-mousedown-cancel" dir="ltr"><div spellcheck="false" aria-hidden="false" id="jfgrid-functionbox"><div id="jfgrid-functionbox-cell" class="jfgrid-functionbox-cell-input jfgrid-mousedown-cancel" tabindex="0" contenteditable="true" dir="ltr" aria-autocomplete="list" aria-label="D4"></div></div></div></div></div></div><div class="jfgrid-grid-container jfgrid-scrollbars-enabled"><div class="jfgrid-grid-window"><div class="jfgrid-help-sub"></div><div class="jfgrid-grid-window-1" id="jfgrid-grid-window-1"><canvas id="jfgridTableContent" class="jfgridTableContent"></canvas><table class="jfgrid-grid-window-2" cellspacing="0" cellpadding="0" dir="ltr" tabindex="-1" ><tbody><tr><td valign="top" class="jfgrid-paneswrapper"><div class="jfgrid-left-top" id="jfgrid-left-top"> </div></td><td valign="top" class="jfgrid-paneswrapper"><div id="jfgrid-cols-h-c" class="jfgrid-cols-h-c"><div class="jfgrid-cols-change-size" id="jfgrid-cols-change-size"></div><div class="jfgrid-cols-menu-btn jfgrid-mousedown-cancel" id="jfgrid-cols-menu-btn"><i class="fa fa-caret-down jfgrid-mousedown-cancel" aria-hidden="true"></i></div><div class="jfgrid-cols-h-hover" id="jfgrid-cols-h-hover"></div><div id="jfgrid-cols-h-selected"></div><div class="jfgrid-grdusedrange"></div><div class="jfgrid-grdblkflowpush"></div>  ${columnHeader}</div></td></tr><tr><td valign="top" class="jfgrid-paneswrapper"><div class="jfgrid-rows-h" id="jfgrid-rows-h"><div class="jfgrid-rows-change-size" id="jfgrid-rows-change-size"></div><div class="jfgrid-rows-h-hover" id="jfgrid-rows-h-hover"></div><div id="jfgrid-rows-h-selected"></div><div class="jfgrid-grdusedrange"></div><div class="jfgrid-grdblkflowpush"></div> ${rowHeader}</div></td><td valign="top" class="jfgrid-paneswrapper"><div class="jfgrid-cell-loading" id="jfgrid-cell-loading"><div class="jfgrid-cell-loading-inner"><i class="fa fa-circle-o-notch fa-spin"></i><span></span></div></div><div class="jfgrid-cell-freezen"></div><div class="jfgrid-scrollbars jfgrid-scrollbar-ltr jfgrid-scrollbar-x" id="jfgrid-scrollbar-x"><div></div></div><div class="jfgrid-scrollbars jfgrid-scrollbar-ltr jfgrid-scrollbar-y" id="jfgrid-scrollbar-y"><div></div></div><div class="jfgrid-cell-main " id="jfgrid-cell-main"><div id="jfgrid-formula-functionrange"></div><div id="jfgrid-formula-functionrange-select" class="jfgrid-selection-copy jfgrid-formula-functionrange-select"><div class="jfgrid-selection-copy-top jfgrid-copy"></div><div class="jfgrid-selection-copy-right jfgrid-copy"></div><div class="jfgrid-selection-copy-bottom jfgrid-copy"></div><div class="jfgrid-selection-copy-left jfgrid-copy"></div><div class="jfgrid-selection-copy-hc"></div></div><div class="jfgrid-row-count-show jfgrid-count-show" id="jfgrid-row-count-show"></div><div class="jfgrid-column-count-show jfgrid-count-show" id="jfgrid-column-count-show"></div><div class="jfgrid-change-size-line" id="jfgrid-change-size-line"></div><div class="jfgrid-cell-selected-focus" id="jfgrid-cell-selected-focus"></div><div id="jfgrid-selection-copy"></div><div id="jfgrid-chart-rangeShow"></div><div class="jfgrid-cell-selected-extend" id="jfgrid-cell-selected-extend"></div><div class="jfgrid-cell-selected-move" id="jfgrid-cell-selected-move"></div><div id="jfgrid-cell-selected-boxs"><div id="jfgrid-cell-selected" class="jfgrid-cell-selected"><div class="jfgrid-cs-inner-border"></div><div class="jfgrid-cs-fillhandle"></div><div class="jfgrid-cs-inner-border"></div><div class="jfgrid-cs-draghandle-top jfgrid-cs-draghandle"></div><div class="jfgrid-cs-draghandle-bottom jfgrid-cs-draghandle"></div><div class="jfgrid-cs-draghandle-left jfgrid-cs-draghandle"></div><div class="jfgrid-cs-draghandle-right jfgrid-cs-draghandle"></div><div class="jfgrid-cs-touchhandle jfgrid-cs-touchhandle-lt"><div class="jfgrid-cs-touchhandle-btn"></div></div><div class="jfgrid-cs-touchhandle jfgrid-cs-touchhandle-rb"><div class="jfgrid-cs-touchhandle-btn"></div></div></div></div><div id="jfgrid-postil-showBoxs"></div><div id="jfgrid-multipleRange-show"></div><div id="jfgrid-dynamicArray-hightShow"></div><div class="jfgrid-cell-copy"></div><div class="jfgrid-grdblkflowpush"></div>  ${flow}</div></td></tr></tbody></table></div><div class="jfgrid-sheet-area jfgrid-noselected-text" id="jfgrid-sheet-area"><div id="jfgrid-sheets-add" class="btn btn-default jfgrid-sheets-add"><i class="fa fa-plus"></i></div><div id="jfgrid-sheets-m" class="btn btn-default jfgrid-sheets-m"><i class="fa fa-bars"></i></div><div class="jfgrid-sheet-container" id="jfgrid-sheet-container"><div class="docs-sheet-fade docs-sheet-fade-left" style="display: none;"><div class="docs-sheet-fade3"></div><div class="docs-sheet-fade2"></div><div class="docs-sheet-fade1"></div></div><div class="docs-sheet-fade docs-sheet-fade-right" style="display: none;"><div class="docs-sheet-fade1"></div><div class="docs-sheet-fade2"></div><div class="docs-sheet-fade3"></div></div><div class="jfgrid-sheet-container-c" id="jfgrid-sheet-container-c"></div></div><div id="jfgrid-sheets-leftscroll" class="btn btn-default jfgrid-sheets-scroll"><i class="fa fa-caret-left"></i></div><div id="jfgrid-sheets-rightscroll" class="btn btn-default jfgrid-sheets-scroll"><i class="fa fa-caret-right"></i></div></div></div><div class="jfgrid-stat-area"><div class="jfgrid-sta-c"><div class="jfgrid-sta-content" id="jfgrid-sta-content"></div><div class="jfgrid-bottom-content" id="jfgrid-bottom-content-show"></div></div></div></div><div id="jfgird-copy-content" contenteditable="true"></div><input id="jfgird-copy-btn" type="button" data-clipboard-target="jfgird-copy-content"><div id="testdpidiv" style="height: 1in; left: -100%; position: absolute; top: -100%; width: 1in;"></div></div>',columeHeader_word=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],columeHeader_word_index={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25},flow='<div id="jfgrid-cell-flow_${index}" class="jfgrid-cell-flow jfgridsheetchange" style="width:${width}px;"><div class="jfgrid-cell-flow-clip"><div class="jfgrid-grdblkpush"></div>${flow}</div></div>',colsmenuHTML="",rightclickHTML='<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-mousedown-cancel" id="jfgrid-rightclick-menu"><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel jfgrid-copy-btn" id="jfgrid-copy-btn" data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">复制</div></div><div class="jfgrid-cols-menuitem jfgrid-cols-submenu jfgrid-mousedown-cancel" id="jfgridcopyfor"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">复制为<span class="jfgrid-submenu-arrow" style="user-select: none;">►</span></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgrid-copy-paste"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">粘贴</div></div>            <div id="jfgrid-cols-rows-add"><div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div>    <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">向<span class="jfgrid-cols-rows-shift-left">左</span>增加<input type="text" class="jfgrid-mousedown-cancel" placeholder="数字" value="1" style="width:40px;height:18px;margin-left:5px;"/><span class="jfgrid-cols-rows-shift-word jfgrid-mousedown-cancel">列</span><button id="jfgrid-add-lefttop" class="btn btn-primary jfgrid-copy-btn jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div>     <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">向<span class="jfgrid-cols-rows-shift-right">右</span>增加<input type="text" class="jfgrid-mousedown-cancel" placeholder="数字" value="1" style="width:40px;height:18px;margin-left:5px;"/><span class="jfgrid-cols-rows-shift-word jfgrid-mousedown-cancel">列</span><button id="jfgrid-add-rightbottom" class="btn btn-primary jfgrid-copy-btn jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgrid-del-selected"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">删除选中<span class="jfgrid-cols-rows-shift-word jfgrid-mousedown-cancel">列</span></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"><span class="jfgrid-cols-rows-shift-word jfgrid-mousedown-cancel">列</span><span class="jfgrid-cols-rows-shift-size jfgrid-mousedown-cancel">宽</span><input type="number" class="jfgrid-mousedown-cancel rcsize" min="0" max="255" placeholder="数字" value="" style="width:40px;height:18px;margin-left:5px;">px<button id="jfgrid-rows-cols-changesize" class="btn btn-primary jfgrid-copy-btn jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div></div>       <div id="jfgrid-cols-rows-shift"> <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div><div id="jfgridorderbyasc" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">A-Z顺序排列</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgridorderbydesc"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">Z-A降序排列</div></div></div>                <div id="jfgrid-cols-rows-data"><div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div><div id="jfgrid-delete-text" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">清除内容</div></div><div id="jfgridmatrix" class="jfgrid-cols-menuitem jfgrid-cols-submenu jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">矩阵操作选区<span class="jfgrid-submenu-arrow" style="user-select: none;">►</span></div></div><div id="jfgridorderby" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">排序选区</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgridfilter"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">筛选选区</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgriddatavisual"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">图表生成</div></div></div>      </div> <div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-rightgclick-menu-sub jfgrid-mousedown-cancel" id="jfgridcopyfor_sub"><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">Json<button id="jfgrid-copy-json-head" data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" class="btn btn-primary jfgrid-copy-btn jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">首行为标题</button><button id="jfgrid-copy-json-nohead" class="btn btn-primary jfgrid-copy-btn jfgrid-mousedown-cancel" data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">无标题</button></div></div><div data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" class="jfgrid-cols-menuitem jfgrid-copy-btn jfgrid-mousedown-cancel" id="jfgrid-copy-array1"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">一维数组</div></div><div id="jfgrid-copy-array2" data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" class="jfgrid-cols-menuitem jfgrid-copy-btn jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">二维数组</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"><div class="jfgrid-mousedown-cancel">多维数组</div><div><input type="number" min="1" class="jfgrid-mousedown-cancel"placeholder="行" style="width:40px;height:18px;" id="jfgrid-copy-arraymore-row"/>×<input type="number" min="1" class="jfgrid-mousedown-cancel" placeholder="列" style="width:40px;height:18px;" id="jfgrid-copy-arraymore-col"/><button id="jfgrid-copy-arraymore-confirm" data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" class="btn btn-primary jfgrid-copy-btn jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div></div><div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div><div id="jfgrid-copy-diagonal" data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" class="jfgrid-cols-menuitem jfgrid-copy-btn jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">对角线</div></div><div data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" id="jfgrid-copy-antidiagonal" class="jfgrid-cols-menuitem jfgrid-copy-btn jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">反对角线</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">对角偏移<input type="number" class="jfgrid-mousedown-cancel" placeholder="偏移量" id="jfgrid-copy-diagonaloffset-value" value="1" style="width:40px;height:18px;margin-left:5px;"/>列<button id="jfgrid-copy-diagonaloffset" class="btn btn-primary jfgrid-copy-btn jfgrid-mousedown-cancel" data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确认</button></div></div><div id="jfgrid-copy-boolvalue" data-clipboard-action="copy" data-clipboard-target="#jfgird-copy-content" class="jfgrid-cols-menuitem jfgrid-copy-btn jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">布尔值</div></div></div><div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-rightgclick-menu-sub jfgrid-mousedown-cancel" id="jfgridmatrix_sub"><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">翻转<button class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="jfgrid-matrix-turn-up">上下</button><button class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="jfgrid-matrix-turn-left">左右</button></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">翻转<button class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="jfgrid-matrix-turn-cw">顺时针</button><button class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="jfgrid-matrix-turn-anticw">逆时针</button></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" id="jfgrid-matrix-turn-trans">转置</div></div><div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"><div class="jfgrid-mousedown-cancel">矩阵计算</div><div  class="jfgrid-mousedown-cancel"><select class="jfgrid-mousedown-cancel" style="height:24px;" id="jfgrid-matrix-cal-type"><option value="plus">加</option><option value="minus">减</option><option value="multiply">乘</option><option value="divided">除</option><option value="power">次方</option><option value="root">次方根</option><option value="log">log</option></select><input type="number" id="jfgrid-matrix-cal-value" class="jfgrid-mousedown-cancel" placeholder="数值" value="2" style="width:40px;height:18px;margin-left:5px;"/><button id="jfgrid-matrix-cal-confirm" class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;">确定</button></div></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">删除两端0值<button class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="jfgrid-matrix-delezero-row">按行</button><button class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="jfgrid-matrix-delezero-column">按列</button></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">删除重复值<button class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="jfgrid-matrix-delerpt-row">按行</button><button class="btn btn-primary jfgrid-mousedown-cancel" style="margin-left:5px;padding:2px 3px;line-height:12px;font-size:12px;" id="jfgrid-matrix-delerpt-column">按列</button></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">生成新矩阵</div></div></div>',pivottableconfigHTML='<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-mousedown-cancel" id="jfgrid-pivotTable-config-option"> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <div class="jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">排序</span> <select class="jfgrid-mousedown-cancel" style="height:24px;" id="jfgrid-pivotTable-config-option-order"> <option selected="selected" value="default">无排序</option> <option value="asc">升序</option> <option value="desc">降序</option> </select> </div> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <div class="jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">排序依据</span> <select class="jfgrid-mousedown-cancel" style="height:24px;" id="jfgrid-pivotTable-config-option-orderby"> </select> </div> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <div class="jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">显示总计</span> <select class="jfgrid-mousedown-cancel" style="height:24px;" id="jfgrid-pivotTable-config-option-stastic"> <option  value="0">否</option> <option value="1" selected="selected">是</option> </select> </div> </div> </div> </div>',pivottablesumHTML='<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-mousedown-cancel" id="jfgrid-pivotTable-config-option-sumtype"> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="SUM"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">求和</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="COUNT"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">数值计数</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="COUNTA"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">计数</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="COUNTUNIQUE"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">去重计数</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="AVERAGE"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">平均值</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="MAX"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">最大值</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="MIN"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">最小值</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="MEDIAN"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">中位数</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="PRODUCT"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">乘积</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="STDEV"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">标准差</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="STDEVP"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">整体标准差</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="VAR"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">方差</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" sumtype="VARP"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> <span class="jfgrid-mousedown-cancel">整体方差</span> <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;"><i class="fa fa-check jfgrid-mousedown-cancel" aria-hidden="true"></i></span> </div> </div> </div>',sheetHTML='<div style="${style}" id="jfgrid-sheets-item${index}" data-index="${index}" class="jfgrid-sheets-item ${active}"><span class="jfgrid-sheets-item-name" spellcheck ="false" contenteditable="false">${name}</span> <span class="jfgrid-sheets-item-menu jfgrid-mousedown-cancel"><i class="fa fa-sort-desc jfgrid-mousedown-cancel"></i></span>${colorset}</div>',columnHeaderHTML='<div class="jfgrid-cols-h-cells jfgridsheetchange"  id="jfgrid-cols-h-cells_${index}" style="width:${width}px;"> <div class="jfgrid-cols-h-cells-c"> <div class="jfgrid-grdblkpush"></div>${column}</div></div>',sheetselectlistHTML='<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-mousedown-cancel" id="jfgrid-sheet-list">${item}</div>',sheetselectlistitemHTML='<div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"  id="jfgrid-sheet-btn${index}" data-index="${index}"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="${style}" ><span class="icon jfgrid-mousedown-cancel">${icon}</span>${name}</div></div>',inputHTML='<div dir="ltr"><div class="jfgrid-input-box-index" id="jfgrid-input-box-index"></div><div id="jfgrid-input-box" spellcheck="false" aria-hidden="false" class="jfgrid-input-box"><div class="jfgrid-cell-input editable" tabindex="0" role="combobox" contenteditable="true" id="jfgrid-rich-text-editor" dir="ltr" g_editable="true" aria-autocomplete="list"></div></div></div>',modelHTML='<div id="${id}" style="${style}" class="jfgrid-modal-dialog ${addclass}" tabindex="0" role="dialog" aria-labelledby=":41e" dir="ltr"> <div class="jfgrid-modal-dialog-title jfgrid-modal-dialog-title-draggable"> <span class="jfgrid-modal-dialog-title-text" role="heading">${title}</span>\t <span class="jfgrid-modal-dialog-title-close" role="button" tabindex="0" aria-label="关闭"><i class="fa fa-times" aria-hidden="true"></i></span> </div> <div class="jfgrid-modal-dialog-content">${content}</div> <div class="jfgrid-modal-dialog-buttons">\t ${botton} </div></div>',maskHTML='<div class="jfgrid-modal-dialog-mask" id="jfgrid-modal-dialog-mask"></div>',filtermenuHTML='<div class="jfgrid-cols-menu jfgrid-mousedown-cancel jfgrid-filter-menu" id="jfgrid-${menuid}-menu"><div id="jfgrid-${menuid}-orderby-asc" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">以A-Z升序排列</div></div><div id="jfgrid-${menuid}-orderby-desc" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"><div style="width:205px;" class="jfgrid-mousedown-cancel">以Z-A降序排列</div></div></div> <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div><div id="jfgrid-${menuid}-orderby-color" class="jfgrid-cols-menuitem jfgrid-cols-submenu jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="position: relative;">按颜色筛选<span class="jfgrid-submenu-arrow" style="user-select: none;right: 0;">►</span></div></div><div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgrid-${menuid}-bycondition" style="padding-top:0px;padding-bottom:0px;"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> 按条件过滤</div></div> <div class="jfgrid-${menuid}-bycondition" style="display:none;"><div class="jfgrid-flat-menu-button jfgrid-mousedown-cancel" id="jfgrid-${menuid}-selected"><span class="jfgrid-mousedown-cancel" data-value="null" data-type="0">无</span><div class="jfgrid-mousedown-cancel"><i class="fa fa-sort" aria-hidden="true"></i></div></div><div class="jfgrid-${menuid}-selected-input"><input type="text" placeholder="输入筛选值" class="jfgrid-mousedown-cancel" /></div><div class="jfgrid-${menuid}-selected-input jfgrid-${menuid}-selected-input2"><span>从</span><input type="text" placeholder="范围开始" class="jfgrid-mousedown-cancel" /><span>到</span><input type="text" placeholder="范围结束" class="jfgrid-mousedown-cancel" /></div></div> <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgrid-${menuid}-byvalue" style="padding-top:0px;padding-bottom:0px;"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"><i class="fa fa-caret-right" aria-hidden="true"></i> 按值过滤</div></div> <div class="jfgrid-${menuid}-byvalue"><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel jfgrid-mousedown-${menuid}-byvalue-btn"><span id="jfgrid-${menuid}-byvalue-btn-all" class="jfgrid-mousedown-cancel">全选</span> - <span id="jfgrid-${menuid}-byvalue-btn-clear" class="jfgrid-mousedown-cancel">清除</span> - <span id="jfgrid-${menuid}-byvalue-btn-contra" class="jfgrid-mousedown-cancel">反选</span> <div><i class="fa fa-${menuid} jfgrid-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="padding-left:3px; padding-right:3px;"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"><input type="text" placeholder="按照值进行筛选" class="jfgrid-mousedown-cancel" id="jfgrid-${menuid}-byvalue-input" /><div class="jfgrid-${menuid}-byvalue-input-icon jfgrid-mousedown-cancel"><i class="fa fa-search jfgrid-mousedown-cancel" aria-hidden="true"></i></div></div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div id="jfgrid-${menuid}-byvalue-select" class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"></div></div></div> <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"><div class="btn btn-primary jfgrid-mousedown-cancel" id="jfgrid-${menuid}-confirm">确 认</div> <div class="btn btn-default jfgrid-mousedown-cancel" id="jfgrid-${menuid}-cancel">取 消</div> <div class="btn btn-danger jfgrid-mousedown-cancel" id="jfgrid-${menuid}-initial">清除筛选</div></div></div> </div>',filtersubmenuHTML='<div style="z-index:1004;overflow-y:auto;" class="jfgrid-filter-submenu jfgrid-cols-menu jfgrid-mousedown-cancel" id="jfgrid-${menuid}-submenu"><div data-value="null" data-type="0" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">无</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="cellnull"  data-type="0"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">单元格为空</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="cellnonull"  data-type="0"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">单元格有数据</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="textinclude"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">文本包含</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="textnotinclude"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">文本不包含</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="textstart"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">文本开头为</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="textend"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">文本结尾为</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="textequal"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">文本等于</div></div>  <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div>  <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="dateequal"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">日期等于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="datelessthan"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">日期早于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="datemorethan"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">日期晚于</div></div> <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="morethan"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">大于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="moreequalthan"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">大于等于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="lessthan"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">小于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="lessequalthan"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">小于等于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="equal"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">等于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="noequal"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">不等于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="include"  data-type="2"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">介于</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-value="noinclude" data-type="2"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">不在其中</div></div> </div>',sheetconfigHTML=' <div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-mousedown-cancel" id="jfgrid-rightclick-sheet-menu"> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgridsheetconfigdelete"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">删除</div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgridsheetconfigcopy"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">复制</div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgridsheetconfigrename"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">重命名</div> </div> <div class="jfgrid-cols-menuitem jfgrid-cols-submenu jfgrid-mousedown-cancel" id="jfgridsheetconfigcolor"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel"> 更改颜色 <span class="jfgrid-submenu-arrow" style="user-select: none;">►</span> </div> </div> <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgridsheetconfighide"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">隐藏</div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgridsheetconfigshow"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">取消隐藏</div> </div> <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div> <div id="jfgridsheetconfigmoveleft" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">向左移</div> </div> <div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" id="jfgridsheetconfigmoveright"> <div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">向右移</div> </div> </div> <div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-rightgclick-menu-sub jfgrid-mousedown-cancel" id="jfgridsheetconfigcolor_sub"><div id="jfgridsheetconfigcolorreset" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">重置颜色</div></div> <div class="jfgrid-mousedown-cancel"> <div class="jfgrid-mousedown-cancel"> <input type="text" id="jfgridsheetconfigcolorur" /> </div> </div> </div>',jfgridPivotTableHTML='<div id="jfgrid-modal-dialog-slider-pivot" class="jfgrid-modal-dialog-slider jfgrid-modal-dialog-slider-pivot"> <div class="jfgrid-modal-dialog-slider-title"> <span>数据透视表</span> <span id="jfgrid-modal-dialog-slider-close" title="关闭"><i class="fa fa-times" aria-hidden="true"></i></span> </div> <div class="jfgrid-modal-dialog-slider-content"> <div class="jfgrid-modal-dialog-slider-range"> <div id="jfgrid-dialog-pivotTable-range"></div> <div id="jfgrid-dialog-pivotTable-range-seleted">编辑范围</div> </div> <div class="jfgrid-modal-dialog-slider-list-title"> 选择需要添加到数据透视表的字段 <span title="清除所有已选字段" id="jfgrid-dialog-pivotTable-clearitem">清除</span></div> <div id="jfgrid-modal-dialog-pivotTable-list" class="jfgrid-modal-dialog-slider-list jfgrid-scrollbars"> </div> <div class="jfgrid-modal-dialog-slider-config-c"> <div class="jfgrid-modal-dialog-slider-config jfgrid-modal-dialog-config-filter"> <div> <span><i class="fa fa-filter jfgrid-mousedown-cancel" aria-hidden="true"></i> 筛选</span> </div> <div id="jfgrid-modal-dialog-config-filter" class="jfgrid-modal-dialog-slider-config-list jfgrid-scrollbars"> </div> </div> <div class="jfgrid-modal-dialog-slider-config jfgrid-modal-dialog-config-row"> <div> <span><i class="fa fa-list-alt" aria-hidden="true"></i> 行</span> </div> <div id="jfgrid-modal-dialog-config-row" class="jfgrid-modal-dialog-slider-config-list jfgrid-scrollbars"> </div> </div> <div class="jfgrid-modal-dialog-slider-config jfgrid-modal-dialog-config-column"> <div> <span><i class="fa fa-indent" aria-hidden="true"></i> 列</span> </div> <div id="jfgrid-modal-dialog-config-column" class="jfgrid-modal-dialog-slider-config-list jfgrid-scrollbars"> </div> </div> <div class="jfgrid-modal-dialog-slider-config jfgrid-modal-dialog-config-value"> <div> <span><i class="fa fa-cube" aria-hidden="true"></i> 数值</span> <span style="float: right;margin-right: 10px;display:none;" id="jfgridpivottablevaluecolrowshow"><label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="统计字段显示为列" for="jfgridpivottablevaluecolrow">列</label> <input type="radio" checked="checked" value="1" name="jfgridpivottablevaluecolrow" id="jfgridpivottablevaluecolrow" /> <label style="padding:0px 5px;margin:0px;font-size:12px;height:15px;line-height:15px;" title="统计字段显示为行" for="jfgridpivottablevaluecolrow1">行</label> <input type="radio" value="0" name="jfgridpivottablevaluecolrow" id="jfgridpivottablevaluecolrow1" /></span></div> <div id="jfgrid-modal-dialog-config-value" class="jfgrid-modal-dialog-slider-config-list jfgrid-scrollbars"> </div> </div> </div> </div> </div>',jfgridAlternateformatHtml='<div id="jfgrid-modal-dialog-slider-alternateformat" class="jfgrid-modal-dialog-slider jfgrid-modal-dialog-slider-alternateformat" style="display: block;"><div class="jfgrid-modal-dialog-slider-title"><span>交替颜色</span><span class="jfgrid-model-close-btn" title="关闭"><i class="fa fa-times" aria-hidden="true"></i></span></div><div class="jfgrid-modal-dialog-slider-content"><div class="textTitle">应用范围</div><div id="jfgrid-alternateformat-range"><input class="formulaInputFocus" placeholder="请选择应用范围"/><i class="fa fa-table" aria-hidden="true"></i></div><div id="jfgrid-alternateformat-checkbox"><div class="cf"><input type="checkbox" id="jfgrid-alternateformat-rowHeader"/><label for="jfgrid-alternateformat-rowHeader">页眉</label></div><div class="cf"><input type="checkbox" id="jfgrid-alternateformat-rowFooter"/><label for="jfgrid-alternateformat-rowFooter">页脚</label></div></div><div class="textTitle">格式样式</div><div id="jfgrid-alternateformat-modelList" class="cf"></div><div class="textTitle">自定义</div><div id="jfgrid-alternateformat-modelCustom" class="cf"></div><div id="jfgrid-alternateformat-modelToning"><div class="toningbox header"><div class="toningShow"> 页眉 </div><div class="jfgrid-color-menu-button-indicator" title="点击选择文本颜色" style="border-bottom-color: #000;margin-right: 10px;"> <div class="jfgrid-icon jfgrid-inline-block"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="jfgrid-color-menu-button-indicator" title="点击选择单元格颜色" style="border-bottom-color: #fff;"> <div class="jfgrid-icon jfgrid-inline-block"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctOne"><div class="toningShow"> 颜色1 </div><div class="jfgrid-color-menu-button-indicator" title="点击选择文本颜色" style="border-bottom-color: #000;margin-right: 10px;"> <div class="jfgrid-icon jfgrid-inline-block"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="jfgrid-color-menu-button-indicator" title="点击选择单元格颜色" style="border-bottom-color: #fff;"> <div class="jfgrid-icon jfgrid-inline-block"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox ctTwo"><div class="toningShow"> 颜色2 </div><div class="jfgrid-color-menu-button-indicator" title="点击选择文本颜色" style="border-bottom-color: #000;margin-right: 10px;"> <div class="jfgrid-icon jfgrid-inline-block"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="jfgrid-color-menu-button-indicator" title="点击选择单元格颜色" style="border-bottom-color: #fff;"> <div class="jfgrid-icon jfgrid-inline-block"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-cell-color" style="user-select: none;"> </div> </div> </div></div><div class="toningbox footer"><div class="toningShow"> 页脚 </div><div class="jfgrid-color-menu-button-indicator" title="点击选择文本颜色" style="border-bottom-color: #000;margin-right: 10px;"> <div class="jfgrid-icon jfgrid-inline-block"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-text-color" style="user-select: none;"> </div> </div> </div><div class="jfgrid-color-menu-button-indicator" title="点击选择单元格颜色" style="border-bottom-color: #fff;"> <div class="jfgrid-icon jfgrid-inline-block"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-cell-color" style="user-select: none;"> </div> </div> </div></div></div><button id="jfgrid-alternateformat-remove" class="btn btn-default" style="margin: 10px;">移除交替颜色</button></div></div>',jfgridchartpointconfigHTML='<div class="jfgrid-chart-point-config"> <div class="jfgrid-chart-point-config-set"> <div class="jfgrid-chart-point-config-left"> <div class="jfgrid-chart-point-config-left-top"> <div class="jfgrid-chart-point-searchcondition"> <div class="jfgrid-datavisual-content-row" style="margin-bottom: 0px;margin-top: 0px;height: 30px;"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">选择维度</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <select data-tips="维度选择" name="jfgridpointconfigsearchdim" id="jfgridpointconfigsearchdim"> </select> </div> </div> <div class="jfgrid-datavisual-content-row" style="margin-bottom: 0px;margin-top: 3px;height: 30px;"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;">排序</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <label data-tips="无排序" for="jfgridpointconfigsearchorderno">无排序</label> <input type="radio" checked="checked" value="0" name="jfgridpointconfigsearchorder" id="jfgridpointconfigsearchorderno"> <label data-tips="升序" for="jfgridpointconfigsearchorderasc">升序</label> <input type="radio" value="1" name="jfgridpointconfigsearchorder" id="jfgridpointconfigsearchorderasc"> <label data-tips="降序" for="jfgridpointconfigsearchorderdesc">降序</label> <input type="radio" value="2" name="jfgridpointconfigsearchorder" id="jfgridpointconfigsearchorderdesc"> </div> </div> <div class="jfgrid-datavisual-content-row" style="margin-bottom: 0px;margin-top: 5px;height: 30px;"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:90%;text-align: left;"> <select data-width="70" data-tips="按照什么方式查询" name="jfgridpointconfigsearchtype" id="jfgridpointconfigsearchtype"> <option value="0" selected="selected">按照名称</option> <option value="1">按排序前%</option> </select> <input data-tips="查询关于点的关键字" id="jfgridpointconfigsearchcontent" type="text" class="jfgrid-datavisual-config-input-no" style="width:40%;" placeholder="查询内容" /> <button id="jfgridpointconfigsearchcomfirm" class="btn btn-primary jfgrid-model-conform-btn">查询</button> </div> </div> </div> </div> <div class="jfgrid-chart-point-config-left-mid"> <span id="jfgrid-chart-point-btn-all" class="jfgrid-mousedown-cancel">全选</span> - <span id="jfgrid-chart-point-btn-clear" class="jfgrid-mousedown-cancel">清除</span> - <span id="jfgrid-chart-point-btn-contra" class="jfgrid-mousedown-cancel">反选</span><span style="text-decoration:none;color:#8D8D8D;float:right;margin-right:40px;cursor:default;" class="jfgrid-mousedown-cancel">可以直接框选数据点</span> </div> <div class="jfgrid-chart-point-config-left-bottom"> <div class="jfgrid-chart-point-searchitem-c jfgrid-noselected-text">  </div> </div> </div> <div class="jfgrid-chart-point-config-right"> <div class="jfgrid-chart-point-itemconfig"> <div class="jfgrid-datavisual-content-row" style="font-size: 16px;font-weight: bold;"> 数据点设置 </div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">图形颜色</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <input data-tips="颜色" class="jfgrid-datavisual-config-colorOpacity" id="scattersingleitemstylecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="color" /> </div> </div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">图形大小</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleallsymbolsizeslider" data-tips="点大小设置" name="scattersingleallsymbolsize" id="scattersingleallsymbolsize" data-width="50" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize"> <option value="4" selected="selected">4px</option> <option value="6">6px</option> <option value="8">8px</option> <option value="10">10px</option> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="diy">自定义</option> </select> </div> </div> <div class="jfgrid-datavisual-content-row" style="display:none;"> <div data-tips="滑动修改点大小" id="scattersingleallsymbolsizeslider" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" class="jfgrid-datavisual-config-slider" style="width:70%;" data-min="1" data-max="50" data-step="1"></div> <input data-tips="自定义点大小" data-sliderid="scattersingleallsymbolsizeslider" id="scattersingleallsymbolsizesliderdiy" type="text" class="jfgrid-datavisual-config-input" data-bigclass="scattersingle" data-attr="all" data-func="symbolsize" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleallsymbolsizesliderdiy">px</label> </div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">图形形状</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <select data-tips="点类型设置" data-width="70" name="scattersingleallsymboltype" id="scattersingleallsymboltype" data-bigclass="scattersingle" data-attr="all" data-func="symboltype"> <option value="emptyCircle" selected="selected">空心圆</option> <option value="circle">圆形</option> <option value="emptyRectangle">空心矩形</option> <option value="rect">矩形</option> <option value="roundRect">圆角矩形</option> <option value="emptyTriangle">空心三角</option> <option value="triangle">三角形</option> <option value="emptyDiamond">空心菱形</option> <option value="diamond">菱形</option> <option value="droplet">水滴</option> <option value="pin">标注</option> <option value="arrow">箭头</option> <option value="heart">心形</option> <option value="star">星星</option> </select> </div> </div> <div class="jfgrid-datavisual-content-rowsplit-sub"></div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">边框粗细</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersingleitemstyleborderwidthslider" data-tips="点边框粗细" name="scattersingleitemstyleborderwidth" id="scattersingleitemstyleborderwidth" data-width="50" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth"><option value="0" selected="selected">无</option> <option value="1">1px</option> <option value="2">2px</option> <option value="3">3px</option> <option value="4">4px</option> <option value="5">5px</option> <option value="6">6px</option> <option value="7">7px</option> <option value="8">8px</option> <option value="diy">自定义</option> </select> </div> </div> <div class="jfgrid-datavisual-content-row" style="display:none;"> <div data-tips="滑动修改边框粗细" id="scattersingleitemstyleborderwidthslider" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" class="jfgrid-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="自定义边框粗细" data-sliderid="scattersingleitemstyleborderwidthslider" id="scattersingleitemstyleborderwidthsliderdiy" type="text" class="jfgrid-datavisual-config-input" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderwidth" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersingleitemstyleborderwidthsliderdiy">%</label> </div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">边框样式</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <select data-tips="点边框类型设置" data-width="50" name="scattersingleitemstyleborderlinetype" id="scattersingleitemstyleborderlinetype" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinetype"> <option value="solid" selected="selected">实线</option> <option value="dashed">虚线</option> <option value="dotted">点线</option> </select> </div> </div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">边框颜色</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <input data-tips="点边框颜色" class="jfgrid-datavisual-config-colorOpacity" id="scattersingleitemstyleborderlinecolor" type="text" data-bigclass="scattersingle" data-attr="itemstyle" data-func="borderlinecolor" /> </div> </div> <div class="jfgrid-datavisual-content-rowsplit-sub"></div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;"><i class="fa fa-th-large" aria-hidden="true"></i> 文字标签</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <label data-tips="显示数据点的标签" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow">显示</label> <input type="radio" checked="checked" value="1" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> <label data-tips="隐藏数据点的标签" data-bigclass="scattersingle" data-attr="label" data-func="labelshow" for="scattersinglelabellabelshow1">隐藏</label> <input type="radio" value="0" name="scattersinglelabellabelshow" id="scattersinglelabellabelshow1" data-bigclass="scattersingle" data-attr="label" data-func="labelshow"> </div> </div> <div class="jfgrid-datavisual-content-row" style="height:auto;line-height: initial;margin-left:auto;" showfor="scattersinglelabellabelshow1" hidefor="scattersinglelabellabelshow"> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:40%;">数值比例</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:50%;"> <select data-tips="刻度数值放大比例" name="scattersinglelabelformatratio" id="scattersinglelabelformatratio" data-bigclass="scattersingle" data-attr="label" data-func="formatratio"> <option value="0.01">乘以100</option> <option value="0.1">乘以10</option> <option value="1" selected="selected">默认</option> <option value="10">除以10</option> <option value="100">除以100</option> <option value="1000">除以1000</option> <option value="10000">除以1万</option> <option value="100000">除以10万</option> <option value="1000000">除以一百万</option> <option value="10000000">除以一千万</option> <option value="100000000">除以一亿</option> <option value="1000000000">除以十亿</option> </select> </div> </div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:40%;white-space: nowrap;">小数位数</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:50%;"> <select data-tips="数值小数点位数" name="scattersinglelabelfloatlen" id="scattersinglelabelfloatlen" data-bigclass="scattersingle" data-attr="label" data-func="floatlen"> <option value="auto" selected="selected">自动显示</option> <option value="0">整数</option> <option value="1">1位小数</option> <option value="2">2位小数</option> <option value="3">3位小数</option> <option value="4">4位小数</option> <option value="5">5位小数</option> <option value="6">6位小数</option> <option value="7">7位小数</option> <option value="8">8位小数</option> </select> </div> </div> <div class="jfgrid-datavisual-content-row"> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:20%;">标签格式</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:70%;"> <select data-sliderdiy="scattersinglelabelcontentformatslider" data-tips="标签显示格式" name="scattersinglelabelcontentformat" id="scattersinglelabelcontentformat" data-bigclass="scattersingle" data-attr="label" data-func="contentformat"> <option value="default" selected="selected">默认</option> <option value="1">仅数据名</option> <option value="2">数据名+2维数值</option> <option value="5">数据名+全部数值</option> <option value="diy">自定义</option> </select> </div> </div> <div style="display:none;"> <div class="jfgrid-datavisual-content-row" id="scattersinglelabelcontentformatslider"> <div style="text-align:center; width:60px; display:inline-block;">数据名称</div> <label data-tips="是否显示数据名" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow" for="scattersinglelabeldatalabelshow" style="font-weight:bold;"><i class="fa fa-eye" aria-hidden="true"></i></label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelshow" id="scattersinglelabeldatalabelshow" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelshow"> <input data-tips="显示在数据名前部文字" placeholder="前缀" id="scattersinglelabeldatalabelprefix" type="text" class="jfgrid-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelprefix" /> <input data-tips="显示在数据名尾部文字" placeholder="后缀" id="scattersinglelabeldatalabelsuffix" type="text" class="jfgrid-datavisual-config-input" style="width:60px;height:19px;" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelsuffix" /> <label data-tips="是否在数据名后换行" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline" for="scattersinglelabeldatalabelline" style="font-weight:bold;">换行</label> <input type="checkbox" checked="checked" name="scattersinglelabeldatalabelline" id="scattersinglelabeldatalabelline" data-bigclass="scattersingle" data-attr="label" data-func="scattersingledatalabelline"> </div> </div> <div class="jfgrid-datavisual-content-row" > <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-title jfgrid-datavisual-content-column-2x" style="width:10%;white-space:nowrap;">标签位置</div> <div class="jfgrid-datavisual-content-column jfgrid-datavisual-content-column-right jfgrid-datavisual-content-column-2x" style="width:80%;"> <select data-sliderdiy="scattersinglelabellabelplaceslider" data-tips="标签距离图形位置" data-width="70" name="scattersinglelabellabelplace" id="scattersinglelabellabelplace" data-bigclass="scattersingle" data-attr="label" data-func="labelplace"> <option value="top" selected="selected">顶端</option> <option value="left">左侧</option> <option value="right">右侧</option> <option value="bottom">底部</option> <option value="inside">内部居中</option> <option value="diy">自定义</option> <option value="insideLeft">内部左侧</option> <option value="insideRight">内部右侧</option> <option value="insideTop">内部顶端</option> <option value="insideBottom">内部底端</option> <option value="insideTopLeft">内部左上</option> <option value="insideBottomLeft">内部左下</option> <option value="insideTopRight">内部右上</option> <option value="insideBottomRight">内部右下</option> </select> </div> </div> <div class="jfgrid-datavisual-content-row" style="display:none;height:65px;"> <div data-tips="滑动修改点文本水平位置" id="scattersinglelabellabelplaceslider" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="jfgrid-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="自定义点文本水平位置" data-sliderid="scattersinglelabellabelplaceslider" id="scattersinglelabellabelplacesliderdiy" type="text" class="jfgrid-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplacesliderdiy">px</label> <br /> <div data-tips="滑动修改点文本垂直位置" id="scattersinglelabellabelplaceslider1" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" class="jfgrid-datavisual-config-slider" style="width:70%;" data-min="-100" data-max="100" data-step="1"></div> <input data-tips="自定义点文本垂直位置" data-sliderid="scattersinglelabellabelplaceslider1" id="scattersinglelabellabelplaceslider1diy" type="text" class="jfgrid-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelplacediy" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelplaceslider1diy">px</label> </div> <div class="jfgrid-datavisual-content-row"> <label data-tips="加粗" data-bigclass="scattersingle" data-attr="label" data-func="labelbold" for="scattersinglelabellabelbold" style="font-weight:bold;"><i class="fa fa-bold" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelbold" id="scattersinglelabellabelbold" data-bigclass="scattersingle" data-attr="label" data-func="labelbold"> <label data-tips="斜体" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic" for="scattersinglelabellabelitalic" class="jfgrid-datavisual-content-column-italic"><i class="fa fa-italic" aria-hidden="true"></i></label> <input type="checkbox" name="scattersinglelabellabelitalic" id="scattersinglelabellabelitalic" data-bigclass="scattersingle" data-attr="label" data-func="labelitalic"> <select data-sliderdiy="scattersinglelabellabelfontsizeslider" data-width="50" data-tips="字体大小" name="scattersinglelabellabelfontsize" id="scattersinglelabellabelfontsize" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize"> <option value="12">12px</option> <option value="14">14px</option> <option value="16">16px</option> <option value="18">18px</option> <option value="20">20px</option> <option value="22">22px</option> <option value="24">24px</option> <option value="30">30px</option> <option value="36">36px</option> <option value="diy">自定义</option> </select> <input data-tips="字体颜色" class="jfgrid-datavisual-config-color" id="scattersinglelinelabelcolor" type="text" data-bigclass="scattersingle" data-attr="label" data-func="labelcolor" /> </div> <div class="jfgrid-datavisual-content-row" style="display:none;"> <div data-tips="滑动修改字体大小" id="scattersinglelabellabelfontsizeslider" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" class="jfgrid-datavisual-config-slider" style="width:70%;" data-min="12" data-max="100" data-step="1"></div> <input data-tips="自定义字体大小" data-sliderid="scattersinglelabellabelfontsizeslider" id="scattersinglelabellabelfontsizesliderdiy" type="text" class="jfgrid-datavisual-config-input" data-bigclass="scattersingle" data-attr="label" data-func="labelfontsize" placeholder="请输入" style="width:10%;margin-left:10px;text-align:center;margin-right: 2px;" /><label for="scattersinglelabellabelfontsizesliderdiy">px</label> </div> </div> </div> </div> </div> <div class="jfgrid-chart-point-config-chart"> <div id="jfgrid-chart-point-config-chart-c" class="jfgrid-chart-point-config-chart-c"> </div> </div> </div>',jfgridToolHTML='<div id="jfgrid-tooltip-up" class="jfk-tooltip" role="tooltip" aria-hidden="true" style="left: 505px; top: 410px;"><div class="jfk-tooltip-contentId">组合图表</div><div class="jfk-tooltip-arrow jfk-tooltip-arrowup" style="left: 35.5px;"><div class="jfk-tooltip-arrowimplbefore"></div><div class="jfk-tooltip-arrowimplafter"></div></div></div>',menuToolBar='<div class="jfgrid-toolbar-left-theme"> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="撤销 (Ctrl+Z)" id="jfgrid-icon-undo" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-undo" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="重做 (Ctrl+Y)" id="jfgrid-icon-redo" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-redo" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="格式刷" id="jfgrid-icon-paintformat" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-paintformat" style="user-select: none;"> </div> </div> </div> </div> </div> \x3c!--<div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-zoom-combobox jfgrid-toolbar-combo-button jfgrid-inline-block" data-tips="缩放" id="jfgrid-icon-zoom" style="user-select: none;"> <div class="jfgrid-toolbar-combo-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-combo-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div aria-posinset="4" aria-setsize="7" class="jfgrid-inline-block jfgrid-toolbar-combo-button-caption" style="user-select: none;"> <input aria-label="缩放比例" class="jfgrid-toolbar-combo-button-input jfgrid-toolbar-textinput jfgrid-mousedown-cancel" role="combobox" style="user-select: none;" tabindex="-1" type="text" value="100%"/> </div> <div class="jfgrid-toolbar-combo-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> --\x3e <div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="货币格式" id="jfgrid-icon-currency" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> ¥ </div> </div> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="百分比格式" id="jfgrid-icon-percent" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> % </div> </div> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="减少小数位数" id="jfgrid-icon-fmt-decimal-decrease" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block toolbar-decimal-icon" style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-decimal-decrease" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="增加小数位数" id="jfgrid-icon-fmt-decimal-increase" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block toolbar-decimal-icon" style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-decimal-increase" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="更多格式" id="jfgrid-icon-fmt-other" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> 123 </div> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-select jfgrid-toolbar-menu-button jfgrid-inline-block" data-tooltip="字体样式" id="jfgrid-icon-font-family" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> 微软雅黑 </div> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-zoom-combobox jfgrid-toolbar-combo-button jfgrid-inline-block" data-tips="字号大小" id="jfgrid-icon-font-size" style="user-select: none;"> <div class="jfgrid-toolbar-combo-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-combo-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div aria-posinset="4" aria-setsize="7" class="jfgrid-inline-block jfgrid-toolbar-combo-button-caption" style="user-select: none;"> <input aria-label="字号大小" class="jfgrid-toolbar-combo-button-input jfgrid-toolbar-textinput jfgrid-mousedown-cancel" role="combobox" style="user-select: none;" tabindex="-1" type="text" value="10"/> </div> <div class="jfgrid-toolbar-combo-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="粗体 (Ctrl+B)" id="jfgrid-icon-bold" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-bold" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="斜体 (Ctrl+I)" id="jfgrid-icon-italic" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-italic" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="删除线 (Alt+Shift+5)" id="jfgrid-icon-strikethrough" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-strikethrough" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="文本颜色" id="jfgrid-icon-text-color" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-color-menu-button-indicator" style="border-bottom-color: rgb(0, 0, 0); user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-text-color" style="user-select: none;"> </div> </div> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="颜色选择..." id="jfgrid-icon-text-color-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="单元格颜色" id="jfgrid-icon-cell-color" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-color-menu-button-indicator" style="border-bottom-color: rgb(255, 255, 255); user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-cell-color" style="user-select: none;"> </div> </div> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="颜色选择..." id="jfgrid-icon-cell-color-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="边框" id="jfgrid-icon-border-all" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-all" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="边框类型..." id="jfgrid-icon-border-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="合并单元格" id="jfgrid-icon-merge-button" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-merge" style="user-select: none;"> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="选择合并类型..." id="jfgrid-icon-merge-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="水平对齐" id="jfgrid-icon-align" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-align-left" style="user-select: none;"> </div> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="对齐方式..." id="jfgrid-icon-align-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="垂直对齐" id="jfgrid-icon-valign" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-valign-bottom" style="user-select: none;"> </div> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="对齐方式..." id="jfgrid-icon-valign-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="文本换行" id="jfgrid-icon-textwrap" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-textwrap-overflow" style="user-select: none;"> </div> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="换行方式..." id="jfgrid-icon-textwrap-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="文本旋转" id="jfgrid-icon-rotation" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-none" style="user-select: none;"> </div> </div> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="旋转方式..." id="jfgrid-icon-rotation-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="冻结首行" id="jfgrid-freezen-btn-horizontal" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> <i class="fa fa-list-alt"> </i> 冻结首行 </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="更多选项..." id="jfgrid-icon-freezen-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div> <div class="jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="排序和筛选" id="jfgrid-icon-autofilter" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-autofilter" style="user-select: none;"> </div> </div> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;margin-left: 0px;margin-right: 4px;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="查找替换" id="jfgrid-icon-seachmore" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;font-size: 14px;"> <i class="fa fa-search" aria-hidden="true"></i> </div> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block" style="user-select: none;margin-left: 0px;margin-right: 4px;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-left jfgrid-toolbar-button jfgrid-inline-block" data-tips="自动求和" id="jfgrid-icon-function" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-icon jfgrid-inline-block " style="user-select: none;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-function" style="user-select: none;"> </div> </div> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> 求和 </div> </div> </div> </div> <div class="jfgrid-toolbar-button-split-right jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="更多函数..." id="jfgrid-icon-function-menu" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div><div class="jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="条件格式" id="jfgrid-icon-conditionformat" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> 条件格式 </div> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgrid-toolbar-menu-button jfgrid-inline-block" data-tips="批注" id="jfgrid-icon-postil" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;"> 批注 </div> <div class="jfgrid-toolbar-menu-button-dropdown jfgrid-inline-block " style="user-select: none;"> </div> </div> </div> </div> <div class="jfgridfulltoolbar" id="jfgrid-pivot-btn-title"> <i aria-hidden="true" class="fa fa-cube"> </i> 数据透视表 </div> <div class="jfgridfulltoolbar" id="jfgrid-chart-btn-title"> <i class="fa fa-pie-chart"> </i> 图表 </div> <div class="jfgridfulltoolbar" id="jfgrid-chart-btn-screenshot"> <i class="fa fa-object-group"> </i> 截图 </div> <div class="jfgridfulltoolbar" id="jfgrid-splitColumn-btn-title"> <i class="fa fa-gg"> </i> 分列 </div>',jfgridlodingHTML='<div id="jfgridloadingdata" style="width:100%;text-align:center;position:absolute;top:0px;height:100%;font-size: 16px;z-index:1000000000;background:#fff;"><div style="position:relative;top:45%;width:100%;"> <div class="jfgridLoaderGif"></div>  <span>正在准备！请稍后</span></div></div>';jfgrid.jfcolor=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"];var keycode={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,PAUSE:19,CAPSLOCK:20,ESC:27,SPACE:33,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,WIN:91,WIN_R:92,MENU:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLLLOCK:145},visibledatarow=[],visibledatacolumn=[],rowsplit=[],rowsplitlen=2e4,colsplit=[],colsplitlen=12e3,ch_width=0,rh_height=0,iscopyself=!0,toolbarHeight=35,infobarHeight=30,calculatebarHeight=30,rowHeaderWidth=46,columeHeaderHeight=20,cellMainSrollBarSize=12,sheetBarHeight=27,statisticBarHeight=23,copyType="normal",copysetting=[],jfgridTableContentHW=[0,0],defaultcollen=73,defaultrowlen=19;jfgrid.defaultcollen=defaultcollen,jfgrid.defaultrowlen=defaultrowlen;var jfgird_select_status=!1,jfgird_select_save=[{row:[0,0],column:[0,0]}],jfgrid_selection_range=[],jfgrid_copy_save={},jfgrid_paste_iscut=!1,jfgird_filter_save={row:[],column:[]},jfgrid_conditionformat_save=[],clearjfundo=!0,sourcechange=!0,config={},filterchage=!0,jfgridCellUpdate=[],jfgridRightHeadClickIs="column",jfgird_sheet_move_status=!1,jfgird_sheet_move_data=[],jfgird_scroll_status=!1,jfgridisrefreshdetail=!0,jfgridisrefreshtheme=!0,jfgridcurrentisPivotTable=!1,jfgridautoadjust=null,jfgridautoadjustmousedown=2,jfgridautoscrollp=[0,0],devicePixelRatio=1,jfgriddefaultstyle=null,jfgrid_shiftkeydown=!1;jfgrid.flowdata=null,jfgrid.currentSheetIndex=0,jfgrid.jfgrid_shiftpositon=null;var jfcountfuncTimeout=null,jfautoscrollTimeout=null;jfgrid.jfredo=[],jfgrid.jfundo=[],jfgrid.modelHTML=modelHTML;var jfgrid_CFiconsImg=new Image;jfgrid_CFiconsImg.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZoAAAGACAYAAACUS6SeAAAACXBIWXMAAC4jAAAuIwF4pT92AAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAHBbSURBVHja7J13mFxV+cc/M7OzLbvpjZBKQhISUgAhgAlVkADSRcDyky4iYAAhAmpQQtMIiqigYkV6FRHphgBBKSGBkB5IIb1sdrO72dmZ+f3xniGTzZR755a5s/t+nmefTGbuPec7Z8497ynveU9on5m3YJMuwNnAt4B9gA3A48CPgY0UyPxJUzN/MLMShxwDXAMcAmwGbgD+UlBKhzVn/+yqqwrVFwIuBL7tZnkyYwaK98yaNb/QW6uBk4DLgfHAduDfwI+ApYUmOnHiKC+0AowAfgh8EYgAvwF+AMTd1OlQ40nAtcB+QIMpzx8Cy70oT8U6YZvXn2x+tN8A44ByYE/gMmA18B9g7wB9v58AzwNfADoBA4A/m4c5KPwWuCdDef4X6KVVtF1yGPAx8IDpAFUBPYGvAguBucCRAdJ7CvAecA7QA+gKfB94DKgMiMargaeAQ0159gK+BrwNqLUoIUNzFPAw0C3L5+XmAXoZ6B+A7/ZNM3rJxDTgl2Y0UUwmAxdl+WwI8HOtou2OzwFP5+hERIAxwDPAhADoHQvcbxrvTB3PZ4HaImscDmSbmukO/F6rXWkYmgnAP4wxyUd/U/m6FPF7lQO35bnmMuCvQLSIOs/J8/npQIVW03bDPjaejWrgn8boFJPpRks2jgReKfLo+yygLMfnhwCDtPoF29CMMUam2ka6Y8wDVV2k73Uw0NvCdV9F1kOqiqQzX+WvQqfP2gsDkWlcO79nD/McFWuGoAJZk8nHAcBM8x2LwRAL1+ytVTC4hmawqeiFNHaHInPQkSJ8rxob156ILBp2LYLOkAu/kRJ8egEvFWgw+iPT0cXocJTnGSmkMxJ4zfxbDJ1WjKYSQEPTC3jBYW/qJODX+L8WMhuos3H9JDP876NVQnGZLsbIDHOQxt5mVqGTz9rrgTdtjtpmmhGOouQ1NF2MkRnmQh4XATf7/L02GyO3zcY944FZZhSnKG5QDfwLd9ZZJiBOBOU+f4evAAtsjt5eIVhec0oADU21qdDjXMxnKnCJz99tJuIpt97GPcOA14HRWjUUh5QDTyAL0W5xFPAn/J2OXoV4k75j455aZMr9ZK0GSiZDE0XWVQ7zIK+7kI2efvKO+S6f2LinnzFSB2v1UAokAvwNONaDtM82z5KfbDBG7lUb91Qi+2z+T6uDkm5oQsAfkSknrx6+P5kK6ycLkTWYj2zc0x14EYkqoCh2CCGbcL/sYR6XIDve/WQbsu/rKZvP/B+BKVotOjbpHiW/RNx9vZ5OeByZv32vwDQmG51DsOdJYne/TCdk09xXgUcdfN9DkE2urwGbXCjDLsDvEG+5rcCTSASENVqdA8HtwAU+5HOjGWn8psD7RxmDNRZ7TgZ2p+1CyMbjzkZzoR3izyGOSf8DVrrUFv0S2cvWgqyl3Qgs0SrsnaH5IfAdn/LsgrgTH2rzR031FC/ysXzKzSjsBex5sQGci2wa7ZXWIzzZ5vRDW6oR76NJ5v9VprE4wxie/2qVLirXIaFQ/OIu03l52OZ93wTuxd/NytOQdZv/2bzvGMRzNeWY1Aqch2y2djLqvK9Nx/prSKidc8wzprhI2PxoN/qcby/Tg7CzN+BbPhuZ9JHNWTbvmW4qcvr362xGH/sXqCOCrJ9NylKezwB9tUoXjfPM7+4nEdPg2pmOHoXE1itGRIyLbV7/VdNODGvTOXY6xf8rMs/e1AAPoc5Anhia64uU9zDsxSD6VhHL6ds2e2DX5RjNPYd9t/GQeThOymO8r9cqXTSKVfblyNRuZ4vXX4D/LtLpowarcdGGmPYhksXAPkhh671T8zzPVfi/HaNDGJo9LF77EWAlhvetNvK342s/oojlZGe387UWRnN2A4/ebNHQnqpVumhYfY5WIfu18vFzZO3ACt2QfWBW2KeIZVSB9ZhjV5A7MnQVst5rZ3PoNy0akckUL3xWuzU0b1h8OI5FNkLm4zc2jI2dDZUbi1hOG2xce6iFawYg61TdLVx7iemFWaGzVumi8YbFenQcsMLCtS8jrsxWz3tpKIHnCGCLxeusRK7ugkytWYl1dpIZIVmJUhLFXhgrxYKhud3Cw3GUMTZWuQ5ZuM/HEzbSfLqI5fSkjWuten+Nwto5GVNt5P2KVumike8EwTrEYeNDG2k+jkQZz8cyrHtxPlHEMnoLObfKTYPUC2ubYi/Cusfc+9jb6K1YMDTP5xhO1plh5GKb6SYRL7an8/Ss7Cye/gg5LMpvmhCPGatML9JvuQR/3GqVzLyU47dvBE6jMK/A35B9zS/1rH3X/GvV0DxVpDK6zsa1P8H61KHbsxdnaHV239CALGSex65TRNsQd793Ckw7bob+r2X5MU8E1tqsABOQHdfNPpbRbJvTDffZNExuPRyTsTfFp7jPDchO+LVtjMyZyFSYk9HS3VmesSuw546bRDaT3oi/02hbsrQF2XgT2SIQ91FjI/AldC+N66Rv2PwjcpLeoUjI/FkuVMTUD/d7Y1i24GyD4Xrg66bn3gfrIcwxUxDftZnfJxTmUn2jGdJf6sNvmBp16sMRDP6CuKEfjBzP/KbNDlWu+rsNcQqJIGGSbkKmo+wSM52hn5jnyM5xzIcj0+J2PNe2m05nzKbOvyPrML/24XdrQQKIvqVV2FtDkyrsVz1oCN0Ox7EDawuqIIt/PynAyHyALNyudtAwdMXbaAstZkrmHa3KgSJms/dudSRyHfamn6zMOnxq4/pTTaNvx8hsAk5w0ID/BnGaucnD3yuJzOg8o1XXG9r7oVoRJFyL3T0Os5BgnKtdqLxeOTHETfovazVWfOAi4BGbo5+V5jlyOkqYDvzCw+92HTKbo6ihsU3Kz/58m/c9jbhyb3FBQwvZ16mccpk+HIpP/BCJJmAnztl84PNY23tnhSke1fefYW/vn6KG5jO6IN50dsNU/AGZimpyUUtqnWqei2neSuHBFBXFKiHECcFuiKo3kVBJK13UkkQ2XLo5Q3A/cI3+zGpoCuVeYGIBw/ML8cbLpQ44GncW7H+Hu/P0ipKNb2Mv/BLIOscXsLa52y6tZobgPy6k9SIy9ZzUn1kNTaF80ca1CeByxDXVy0q3AZmSW+UgjaeRSAH6cCh+MNnm9X9CHAYaPdTUiERBn+sgjbdMGi36EwfT0Fhp4BIB+F5Wp75akLDgfp1YuBw4nsLOpXkDeyFJFMUp221ce5sZIbT6oKvOjJoKmSFYgkxlN+rPG1xDk8+luIlgbBq0Emaj3jT6D/msbR7i7tlo857j9eFoN6x04VnzAysRBJLIQv1Un0fahcwQrEK2LOjG5oAbmnxeH48he1yKzfQ8lWkdEjn6pSLpewtxVGix+HAcj/2D15Tg8mCekf/7uOs84kTnm3lmBL4G3FkkfXZmCOrMtUu1+vlPmc3r/4UsRl+Y5Ue/MiDfa7UZNfyT3Q9XW4as4RR7J/1LyE7k+5Aw722JmYf8Apyt6yjBYw4Su+8nGT7bioSxCQIJJAzVv9j9wL4G4HTEu7OYzEPWkv6BRDloS9xcc4mbxnvWrPmB+IEmThxVEhW+EGeAi82PNtf0aFYju4UPCtiQ9H/AOGT9ZRUyrfcY4tsflHAtTyIhzi/NUJ79kHAfi1HaIzchMdBmI7H7NpsRxEFmRBMU1iMenFORM6l2GM2HB8DIpD/rQ0x5vmnKcxMyA7M3sJ/RrJTIiAZkHva3WDsGoNisQTzKLg+wxjpjWH6t1bFDUY1sgEyav4TpfScCqLUJWey/LcDl2YRELnikBH77k5EDEsebkeG/KF50en8MzfxJU/WRd4MZM7QMFKschhy/nD6tW4XExTsL2U1/BR3wfKHUVFCxp6Y8nJK6po3BrgK+gawfTQIW6IimKI9kM4rSjvgcsh+qS5bPI8AYZOPjUbgYTXjixFFWGvAIsmbY3fzb9nWuz3Yga7h3k8VrzmEDPhwYbUYBb2L9VNFUg/4dY8hHmbZvCTKd/jNkbcxrRpL97K+eSJifw9XQKIrihH2AZ3MYmXSqEWeWI/HOA60PEl7mc0APYzScHAdebXrs1yBrjlchO/Cd0h/4K3BE2nv1yHTTneR3q+6OBJ8dl6Hhv96MJCfhvdPN2eSOF3cYMJBguLa7a2hGvVb8eHLtYvruqquCo0Wn8YLIQGTxvJeNe3oYw3SIB41gZyRK+TCPvu9Y4DkkUsA/HKTTAwlKO7jN+7XAz5HF/kvzGJvpGYxMOoMR54xvelwHBlu4ZkB7NDRhff4VxXN6Ie7s/Qvszb9s00BZ4bseGpkUEeTQw04O0rg+TwN9CRIMN9dIYYKFfD7nR8fewjWh9vgAhB1WgM3m73qUFF8CPkRCcSR9+ms1eZ6kxR84uhgj46RR39uMCjq5qOsMn75/byQieqGcbuGac5GTTbMZGysLvT20qgbP0HzJDDVTi4A3aSP3GX9GFhsjPuYZMXn+RYs/UFQjrqtjXEhrAuJEUO6StmE+lsP3HdxrdRR4DvBwlvKxEkm6m1bXYBma/mTe8zHDg+F9KfJQB81b2ZVyJObeIS6meRQSIdmNToyf+3VGOrjXztrUaYgXWUUBhqYC8UxTAmBouiCLk/2z9JAecrHHVapcgr1z2N3ieiRqg1J8IsDfkKCPbnM27kQb93OjipN1h6dsXn8iMs1Ynfae1dNydVTjEWU2H57780wDHImc7X2JawpnVgantKzv6TkTWcD1y+g+CNyi1TkQhJCoGV/2uDOzFvixgzQeBg70qUycbIb7MbKTfqCNe44xHeITkb02dgzNp1qFizuiuQsJVJmPb2H/VL72xuv4d3rf28D56GFoQeF2JBCq19zosEP3K5wdHmYHJxHdNxrDYfdY6FQsti42DI1Th4Awspb2JSRWoRuUIxs5601Z/AUY2l4NzVSblfpOZD7ZbWqR8A2fIHPMXnlxJUwet5k8C+F+vD9y+VO8P9FQsc51wNU+5neXGT0XOso4GtnJPx8JTPk8Mv39G2QH+/eQTZfFrl+LjOH42OZ9hyAef1an7pxMnU0GFiLBO59Gotmf5fB7p6ZgLwJqjCH8OhL9e3IpPRhWps5OQjY82SFqKuwhuBcpuRqYiQSi82P6YyCyw/lYJOJzIQ/brchu8G94NB1xGnqEQFA4r4DnxCkRZMf8RmSqtpDRwkU5Pu9sjE91AMp3ObJz/kUkFI1VDjDPoJeG5qtmpBFuMxL5i2k3nnbQkcg0BVuDxMo7gBKJjZZvRDMBeIDCvNN6Il43XVzSer1PRqYt43G2T+jCAhsBK+m+hRIUirWXrNw0Op1dTrcaibc2IUBlvBIJQ/NRAd/FK0OzN7JhNJylw/2AMZB2yTeLVF2Ejo0nhmYvdvfesMu+Zujnhjvm2UUsJyd5t5iRh5vxqm435aoEhz0sXrcKCf2Sj59j7QTWVAPpZiesCvH2mhTAcl6DTKPN8SDtQgzNVezuTt3WIDyNhOSxyiVkD76ZzomzZs0vD8ohbIUYmi7IoVxu7Is50WKh5WPPIpaT07zrkLUUNw6Gewbv134U+7xh4ZoNyJn1VmJZvWw6OHGL+Te49D1SI6QvBLisNyDrS28HwNAcYOGaLsiU3xAL156ETJmFLP5WnUrh4QhnEf847uxmTnENcra4E1YXsZzcyHsp4o3iZGH1Q1OOcZSgkc+9vM50uj60kebjwGUWrlsGvOfCdyhDXOWPd7ls6jwo783GGL7uYprdC7hnq8XremFt8+73sD4D9DbWPeoCZ2juxRuPsd/hbL73gSKWk1t5v2V6qYW4Im9Czm+vQwkiL5F9zrwRmT79bwHp/ibPCDaJBMh06t6e8nA6tYTKvM6MEP9TREPzQ6xPcbo9qju7VH6otoZmKvB/HuVVaXpo/Qu8fzrezMvmYw7uLro9jf2pr1bEjXUJSpC5wTw/a9sYmdQGXiejpbszvB9HTuL8h0PdISTK8lds3vc84tJbTBrMCOzfLqRVyNTZm/i3Zy69Tn2plNqDdEPzVdxZS8lFP2Nsqgss3MOQmGp+nNewAlmQPQz39xHcanqqVvku3niuKe7zF8Q1/jAzihmKHGDmlMuMwdkCbEPW6j6P83A0IVMXv2nzvv+Y0Y9fvfnO5rvOR6ahlwLvINNHM3FnDbdQ9+b7kdM7/aDFzGyUlMdpah/NocB9+HMWwoGIO+A5BfQC6pENcVdT+lyGnLORb+PVPVl6s0pwiSGHdblJ0oyE3XYE+Tn2Y+S9ifP1Rrsd4ieREFde4mTD5q+RdZhpHupLmtHTC6X2QKQMzSP4GwzzLMTdN/8I6rBm2ilxZI71NbI7XrwCXK7ttuIRl5vRsh3eMZ2jeh91nuaDkXFqaEDCAvVCTvz0gmvN6KnkCJthc78i5D0dCT7YkalD5pcz7e5fisyZt6Ao7lNlGkY7zAO+yK4OKVY2czvtLZ7uU5m40au9zCNjcCvw01KtbGG8jTJrZWTT0VlF5iCkV+LOvhtFycQEoKuN6z9C9q5savO+lViAOxxqHe5TmfzZhTRS01vPuKjLj7iJnhua85EFNj/3ZsRNnv+nzzsgXkM3ID75683rp7VYFA+xEyx2CRJBeUOBowCnbUvYpzL5lUvptJjZCDf2+PwT/73aXKcMCTXxlD53RWc6JRS7SCl5rG4c/QTZV5dt0/LLFkYcTj2kluB9nMMluOuq3Ygcq5JrDRYL5XYm7WD6vEyfN5eYMUPLQCklliFhUXKFmlllPs91FsxU05B+PsvnryOL2E54AjjDw7JIIjvy3R411CHR319DTiC2a/j89Ozz1tDMnzRVHzlF8Rcrh3j5sVfsXNMIDs6i8RjybwqsQ/YMnYl4h40w7y9FTvF8GDnfyQkPIftUDvGgDLYi3ndPelTGaxEvvVexvtdnFeJl127WaHVEoyj+86DpQWdbe3gfd6N952rQPocccfBlJGrHKmRT9XRkvdAKCfOdHvRIZxyZhrrNGLVo2mchcjs1VJM5uvJyxJPrYazHKyuUJcbYvEb+Y1NyeaKWrqEZ9dqtgRCiIyufuOqqYOnpmFOOc4AfAT/J0sP200lmE+LheGVQCidL2Pst5D6kzRMNEyeOcivJecg02jNkjorfYurFFW52MoJyhEDpjGhmVhY3//a7cVQpDjchi89XIgvdjUjssB8Ci7V42iX/RaYpT0M2dY4HtgP/An6A/aOqS2dEU8A9XZAd7d9CjkjdYIbaP0aOhu3YtF+DGEJO9fy2/u6uUI1ETE6avwQyRZTQonHEPsZYH2PK91dIWJigHK3RiETJLoWDC7+JbEAdbUa+T5myXG83IbuG5mTgj+waqmFPI+ZiYDZwgY89sj2Rk0ArkXnaKvOXel1ptKa/rmxzTRVyBvd7wJ3I/pXt+rzuxm/bTF2kfvcTkc1/urnUOocjYZ/Sp1CqkMC2ZyF7zK5AQhAp1jkN2dyY3tu7ARiFxFbc4VZGqSm1Yk9NuTi115Y7TR1M0Q85+fN4YCI215DsGJqjkIWzbDHRypGFupcR7xAvF7MipuE7H/cCgR4E/N00mBfizt6iEOLZc4Xpae1AFgSnYf9skqh5YHoCnwKLfOylTSb7/PgQJDDj17Wds8SBpm51yVG3xyBz+UfhfZTersjR4HYX2TtlaQuWIlGmH0GiTPvFOPP8VmQxQM8iUY/9iNE2wjyrDUgAUjunn1aZ9uJMk0YYcSZ4xDxnfpxHdVgbI5POIKPjTDsJWt1xOwHZvW4l8GZ/86N28bAgrjYjJy+iTfcCHjOF7dTI3IdEqh5rHuIa02i/bvRboQb4mTGAc5C9D/ONsbkO66fxOeGcPJ+fTu5z05Wd0zr/tPhsVJtrx3ioJ2Ke1QtN47hX2t8QMwOQ7S9bWzAUOdtmKd7ufWnLLXnq4FHI4XQ9PNTQ34xCFyDTys+b5/S7Fu/vaTqgtwD7me8TZed04DvAHj6UZb4D1U7B5hHSVgzNGGNk7JwhM8ZU4GqPHg6vPWQipnF32jh/M8dI8l5knSsX5UhI8KsyNE69ERfUe32oeIMs9MJ6qR3JW4bP2yynHuY56u+Rpq/gzd6UVKP5EOJp5TVVFvM50MwoeFGePUzaR7R5vxa4A1krytcxvhnYN8fnQ43B8ZoBFmZXbJVhPkMz2FT0QhqRQ5EjkN3uce9jGlk/pjic9B7yGZEQcoZFrgOTTgUOzpPOuRYqhlNCLtSljkxvMxItpIHrj0xHe2HIvT62OYwcVOg1lTbamX2AWbgfqPN6Mm98TXEpcrZUrufkIAv5HBSQOl1utyJko5fpTTux/ieZxtTNKa4ePhbmjx0aRCsN+C/JfubMEItpDEIJKl2MkRnmII29zaxCJ5e1DfXh++9rsR47YQty0qad0eVMZHrKLawcZXAhEiE6m1GMWUijWyk+BOEcD8cLDh+OFBfh7hHRW30sHyfHGFhdAAwBvyDzdGCTxTRqUYJINbJHwo11lgmIR6SbBxT6FRH4Uh/yOANxkLFKHyQszOEu5W+1Q/41xGkhmsVg5qN7ezE01aZCj3Mxn6mIa5wbzMe/0/2cjMRetHn9DHY/otpqQL1qlKBRjgSDdHMN5CjgT7g3Hb3Ip7I414c8PkEceN61cU9n0xH4kgv52/GyPZPMpxpbMTRd8McByFNDE0XWVQ7zIK+7yO/NYIUY8DufysdJ5NRbsO+K+FNjlFNY3c+jhiZYRJD9HF4shJ9tniU3eMyn8vBrF/M6JBjlf2zcU4V4iH3NYd52t0OcbO6psmlooASnz8Jteu9/RNZVvHr4/mR6ZU6ZhvinB9nQLEWm3pps3ncLO0/Ts7oPoUbb9sAQQhZ9vXTtvQR3vI8eR6aPvGaLj+W/DdlC8A8b95QBfyH7WqkVfoz9vYPHsatH76b2amjSN2z+EtmZ7PV0wuOm1/Geg3TqETfCVMTZHcYo1JmGvRHx5jrZhUrrhOcQn/MnbI46ppvfZpbF62td+F0OMRX4NRsVPt8Q/3dI5ICtSBj2nwBr2rmhuR3ZSOw1NyJ7q37jII2EeUamI8c0p/ah1LEzFE4lEoLECZsd3LsvEnVkLPacIexGPUmtldZQ2JryRuTsHrvehUcD/0aiU/s1ooki3qw9gTfMSNApnZGtFieZ+vOPdOOb+jF+SG43WzfpYgr2UPKfdZGLFjM9kYkfuWBkwJ1QNM+bwn/aprG5EXEtt4KTqbNzkfDrvdKM68kOe7rVpqJNSpueuMT08k/EflSEUuE6dl9n85K7TKfgYYedqcty/I5PFtHQnGdGh34G//0JslH2/QLuXcjO6CiDbdw30bQTj/hgaL6C7Ozvl9bGnWmjrcnWUX2CnbNVVYiH3anGgP43bH7MG31+IHshi3Be7A24HplacwO3Trd7yRS43fSO99jQTEeiF/Rq0zN5Eti/wDQjyDrfpCy/+zNA33ZoZM7D/6O4I8BfcWc6ui01pvE5xoW0Cpk6G10EIwOynODEcWk54slmtxM9AevbKQo1NNcgZwb1S3uvkzFwBzuog/dnqYM9U8972DTMxWAYEqrCTaYi4dfdws1jVF9F5o4bPGoU7HIMO9eCMo06n8O+e3sI2QF9Up5ORrHqnJcU6zuVA4+aDoKbsw7P457rbyGG5iKKd4zJN3G2Z2mFKbuPCpgJsEIhLs4HI+u/2fJ9jsLc8O8i93pkL+AHYazvfv8IcS3Oh52T1I50sXJcnaMgnUwruMlMY2zcds8uZI0m3znuvcwUgJ355pvJHxEBvN+RXgysPkersLb29nNkethqD3e8S9+juxmBu+mWXYih2aeIv2UFzjdBf4qsI8/1QF8hI5qryb1Bv5DOpdVtKyeHkcUgKw/HsViba/2NDWPjVkM+BXENdhsvjguYZYyNm1FYC5k6O9TCNQOQ9TQrPahL2NU1OxedaX9YeY42IJ5GKyxc+zLiymw1QrcbI+XeJt8DXC6bQgzNpiL/nm7kvx6ZUnrXZW3dPHre+yFLGr0tPu9WO/a9w4iXTL6H4yjsue5dh4Txz8cTLhT6Fab3ZwerD2+jR5X4ddPguGVsCjE0Vr2/Rpk/K70bq7THc1byPXR1iCPEhzbSfJzsC/XpLMOZF2dqRPYq7m7UdmJonijib/km7nhipQzWUbi7HaMQQ7PW4nXDkDiPVgyNVf4RRuZib87xcEzG/kFmScSL7ekc12zE+eLpZUhkVDvUYX0+vdHDyjzbjBK3upBWIWs004v0EC/B+hEJpcRLOcq0ETkTpRBvu9+QfS0t9ax9F2fhZAYaI2N3usrq81HI6OARZCG5GHzf5fTqgC8iWweKZWhuxr+QQ+ksBS5Pzdldj3jNpJ+SuA3ZA/JOgRnEzdD/tSyjpBNtWNlsFvUX2AsTU4csgltdpHM6tRdBDgSbgUwnXofENLsI2czZz7zvtAIUskZzH+5551llg+m4tNfTOG8A/q9NvW5E3EdfdjhaujvLM3YF9jYntmUIspPebjTj/2F902ghI5qkMc434e802mbTCXSbejOL8aILaRViaB5Fjhvx+3k/Dlid7tXxR8RN7VDkZL1ZOD8LvhGJI/R7Y1i24M7GvQvMg2fXyBxnHpBzLN7jZI0mjIT4ONmHH7RQ9+YbkUV/P4IepkbHS2jf/AVx705tiHvTYYcqffS+DXG2iCCOJTfh7ATO4abhs3vMxCzzPFsdmRY6ao8BPzAdoj7YC2VzpBkNRm3csx3nRz53ZvcNsFvTOpNuhOMp1L35DvO8f9+H5yDV9i+B3d0HW3A/JEUdsoPfLQ4yFciOkalH9qTMtjkCcDJ19nWfjIwTQ5NqwLribVSIFtM7fYeOQczFaZL0Hv515J5Gs0NPJEK7XSPzimlAttto8JyGoIkjXlxWOcN0RO0YmU3IXjcnhjuMxC87wuP65eSolOvM836Jx8/7yellWYqHVV2PPf/6BmNk3iigYXZiaM7zsUycxDpLGq1Pe6QtbtJ/GSVI/ABZm7HDv81IJjXSt7qfw89YZ99GNiXaOVr8E2R3/lsO8z7NByPjZEST3rl80CNtqfbkxbYWuNSws/em0fRSZhU4AnCyRrOfj2VS5UIP5GwPeuGpSn2/tuuB4xSb1z+NbMRN73wFzdDcaEYydsLofwB8HljgQv6n+/Q9dzi8P46sJb7ggbZrMz3vpWhorM5xNpqRzEwHIwAnazRVPpbJHBfSSM2pznNR1604C/qoeEc/G9c+ikx/txTQs64HWj3+LqmI2XYjWs9CYpOtdknHCJ9+u/tcSKPFdDbecvl5z7ifsRQNjZWGsNH0vv7j0Ag4MTQrfSwTt85lr0MWMd1YsP8d7q0nKO5jdc3jfsRDMlOUAiuGxg+PscsRT067I7RjXR5thXz67e52KZ1UZ9yNzuX9uZ73UjQ0v87zeZOx1C/luMbK5rbN2Ntc15YXfSqPjTiLvNqWDeYBXOUgjaeRxcYkSlCxcujZH5AplmwbnK0cK+3HtJndEzL/gKynNLmsww+Pyg+Aj11Mb7MxNssdpPFPZF0m6ZahsdJwJHwYNv4xxzD9FPLPPf6N3HsPms0D5sQZ4Kd4u+ET0wCcj/uBOpebyldIb/QN7IVOUYrD9DwN1m+QUO+5fkcr0y7/8+G71Nn83hd6VD+9jmaQwJu9MKkQY4Xsb3sL2SeWMy6fXUOTL0ZTE95vxkuaxvUbSCiXTUbXn5AF+OctNtCnGGPyH2Og4ubBuxeJYup0V/Ji0+Bu9qgc3jaVwytvsXnYP9pgnjFQjSi5WOnCs+aUTchRDq9m6KxdieytytexvN70sLOxDH+OILHSwCeQKbYbPBxpP4Q3mz1TMxdnWmzfCh2NfcGm0V5iRpN5n3e7YbjvJ/d+i8dw7hFh1dj81fw56R38xfx5xdPIPoXhyL6FSmR9qFva667m39TrSsQrLv11F/N5Ajnk6gfY21dQKG8ha13PWpgmWWWMTB1KPh4Evpejo/c+7jpl5PrNjjT1c7QZGb9pY4S8EdnXdoVpBEchHl9LTFvwM9wJsZSPBxC35mwRp1tMx/QhH2YYjkcOEjyMXffxhMwznY1OWZ6xpUhkiEdwP5p8W+aa5/1f5PfMTdUdSwMLu4bmX8gi74VZpluu7LBNx8ysznCNuOMVZl3HYc1upvgScirffWRe/I2ZxukCnK3r7MpVVwXr950xw83U5iCnwP4kw2dbzUjbTxaZv0JoQryNbi3irxNHNmlmOlOlHjmW4iWftGzBvmNCoFoyxMPw76aDm+l5fxuZVbL8vBdysNDFSNjrS4CRxqI9ZR6cjZ59fXcbT8UeTyI7wr9qfn//fvf2y03I0b9XImfJNJppkR9iP4itIiP8CWZ09Q1gr7R26n0tHls8i5xDdZYZKY5GplqfMbMptiNbF2JoUmeJJNv0KIo1YvAH7w3dMchRq4cg6zo34O20nl3qEI+/Xwf8IQmZEfe3kWjEG5Bw+z8OoEF8BOvnxLvCxImjaMf4Prpqx+XZgMSodOUUZLuG5mTE4yt9CmVPZPf3xchC2AXaI7PNT4xhSdEJ+DMSWdfdxdTUFFD7Ndy/bTN1kaqfJ5oer6vOKu284VZKnKDUTzuG5ihkITrbonA5sgD2sumVr/JB/56mMU5fVK80hjD9db5F+Bpkb82diNtzg4+/wTfbGJl0piEB9K7A2z0pIeBck88+iEPHayZ/u2eoRJFF4Z5mOmMR/rk6Tyb7/PgQ5IC8r2vzo42jEkxDM8E0wFY2aPVH5vgm4Z0HUgj4pZkecWvT6UHIAthGMyp7yofyL0c8VHJxGRJT6lxkIc6LsrzPGLx0YzEZmc67xOLwucYYpgvYdRFxPXJu0G0+GJx8xz+cbvTt0EdfUfzDSiM9xhgZO6HoxxhjU+2R7suREzy9iGzQE3HNPMyH8j8Ya+dzfxVZZ/Aifto5bYxM247IvcgZKPkM5gvIZrK2niq9kU1y9/pQnoPyfF6FnMehKEqADM1gYzAKeTgPRfzbIy5rDgFXe1wuEWQPgNfYCe9/IhKmvavLGr5lobx/bQx7Nk41RjMX52L/7JNC6oYbnStFUXwyNL1ML7W/g/RPMo2Um8HmhjrUZJUDgT08zmM29qYXJyFuxn1c1GDlnPjUVOXlWT4fYjGNQfrIKYoamhRdjJEZ5kIeFwE3u6i5t4/l82OP099sjLGdHb/jkfDmg13SYNXxIYSstWTalGs1OGGtPnKKooYGZF3laWCci/lMxb2jQ/3cC3GWD3nMRDz61tu4ZxgS5220C/nbjTI9g92nLq3GNqvWR05R1NBEkXUVLxbC70KCTDplCf6ccZHqxfvBO6bMP7FxTz9jpA52mPct2PcO/KnpPKSwem6PGhpF6eCGJoRsxjzJo7wiSITloxymk0A25fmBn1GIFyJrMB/ZuKe7GZEc4yDfpWbkZvdsjlvYedCR1am/Gn3kFKXjkb6P5pfkjszsBuWIm+6RWDt8LBs3mxHApAAbmsmmPIcAFTbui9rMpxMSg+iryJG7hfAccmzCEzZHHdNNHZpl8fpaF+rPIcjG29dcGtl2QQLFnogEtHwSidSwRpsHRXHX0PyQ3O6rbtIFcdM9lMJPpGtEjhz+MuIyu8O8V4ccWrYdWRM6zaHWQsJyh9g9DIrXlJvR4gsUvkn2eTOafdqmsbkR6yd8Opk6OxfZ9Nkr7bc5md3PU7FDNbJHLNVhqTL15gxjeP6rTYSiuGNozsOfw4nS6YUcOXAohceeiiE7+TPxfReMDFhfe0jnWxQnTHgnZArsHgdpvIQcdvZPm0bheI8NzXR2P4+8sxl9HIVE6bVLBFmPnJSlfj4DjAXWajOhKM4II6fkFYNhuBQZtA3fwz136kKmzr5VxN/z2y6k8Soy7edFvLdC1miOyWBk0kfHz2HfDT8E/Irc65G9ivhsKEq7MzRWNyV+BMy3cJ2dEN1Huvx9pgC3u5heIYZmRBF/z5EupTPTGJt6l/UVskYz1cLo+GXsbeK92WKH4FRtIhTFHUPzhoXrViHn02+2cO1vbBgbN48mvQKJzusmhegr5pknbobAn2WMjZuBUQuZOjvEwjUDkHW/7hauvcSC8UrRWZsIRXHH0OQbAWxA5sHthP2/DmsuyE+49D2+A9zhQfkUskbzdBF/zyddTu914DgXjU0hhsaq99co8+d0hJTOK9pEKIo7huZ5sq9p1Jlerd2DzJKm8X86T89/ugvf4RLENTtkU58VCpk6+xHwcRF+yyYkTL/bzDaj2a0upFXIGs30Ij0bS5AjBRRFcUjKvfl682C1dR89Bdm1XghxJBLAc+zu2bMB+BLOPXouBO62aWTqTONlZS2nEEOzATm/ZwbiJuvXUZazKXzaLoIcFzAe8ebbhriJN6S9vhXZpOkkWkIhazT3IVNj03x8LjaYDtYGbSIUxT1DAxIV4H7E5bgrMkfvdL2h0RiU3yP7Erbg3oa48xBXXrtGZjLW5vJTxrYQ1iMnOV6ARFq2c5LpZcB3beb3CYW7VIeR83dO9qG+FerefKPpAF3qg8ZUHVmizYOiuG9oAFpwtgEu24P7ZZfT/Bqym9uOkalH9nu8ifWYa9sd6twBrLB4bcgYYLtG5gNkHWV1gRq/7pORcWJoUga4K95Gr2hB9l+9o02DonhnaEqB/YE/YO8Aq+3GyLxhs8HzK9ZZxIzOzrd53yxkL8gWhyNDv3AS6yxptNbiTTy+uEn/ZW0WFMVdSvG0weuQkCtWaTRGZlYBPWs/DE0VEv/NrpF5Glmk3+Iw//18/O2cHkXdYkajr3mg7TJk6lhRFDU0tgJpNiJrQzPbvN/J4v3bPP4uXdgZY8wOf0CmeJpc0FDl4283x4U0Uut+81zUdSuy/0tRFDU0toxEI+I1l2kvhNWNeNs9/i73AhNt3jMd8baLu6RhpY+/3QyX0qlDgqq6sWD/O7KHuFEUpYMamrkWrmk2Pf4XsnxudW3Ka0PzRRvXJoDLgRuwvg/ICi/69LttxHqUZytsQKYOVzlI42lkH1ZSmwJFCY6hsfJAJjzWfFeez1uQGFX/znGNlbNwNgMfevxdrE59tSD7XO7yQMNP8X4tKo6sQbkdqHM5sv5WyLk0byDrPXFtBhQlWIYmn6tuE95vcnsAme7IRIMxMs/lSeNhcoe/aQb+z4cG2EoInpRb9kMeaVhsGtzNHqX/thl5eBWaZx5ytEGjzXuOx98TVBWlw2LXvfl+cu9jeAzZO+I1FyFuqJcAo02D8Qqyc32BxR72Gch+nHMRl+lOyHrF86aX78eGvelGR68sn68zjajX+zqeRnbfDwd6ItEMqpCTLFOvu5p/U68rEe+99NddzOcJY8x/AHzqQzm+hThUPEt+j8RVxsjU6eOvKME0NP8yo4kLs0xjXOm6wplZI7g8aP4KJQH8xfxZ03FYc/bPnypo0/pqTr47ddBYW2OzDPgiT11q3+AdVlB5NOKOV1ixeAn4ChKypluGz2PIZt0LcLauo3jMxRdfHBgt99xzj/4gRTA0ABcjJxpegpx/sgF4CgkmuVGL1CZPXfo/Tr57HHIq6KlAD9Mz/w5PXaqnO9rjSTOy/aqpp57Xz1JpFLXxVkrF0NQg0zhHIsEX+yLOAT2R6Z8DTI/4FdNDbyjSd2qrcwgypQMyXbI8cDqfurStzkmm0fROZ67RWWlTB/za/BWDPZCp3QPwbo9SEzKdei+FxwwsFZ19kaC/JyKH25UhzjG5PEIbzAg2E0l2j0QeQyKuP4Ksm6oXYhEMzTDgWmTBONselt7mb4LpSW5HFu1vw8Jax/xJU934Lp7rdIlS0VlcZswoRdWnIFOxtT7k9SXgKiRW3VPtVOcYxP2+d5v3y8m9FtetAJ0HA2eZTt2ZqKOIq+TyOqtEdkx/iMxrd7KRbidzz4emcfQyVL7qVILAvsiaYa2PedYi3oj7tkOd5WZ00dvn3/EE3NtYrOQxNEORhdNrsRdXLFNlucakNcwD/apTCQo/ACqKkG+Fybu96TzJPDfF4EJkmk7x0NDsjxzhO97FfMYjQS33dzFN1emuTsUZRxUx7yPboc4Di6gzQqG+m0pG2q7RDEM2O/byIK8+Ju1Dcb7OoDrd1ak4p6edi+NlYbb0q6KuTyVNtVGSYQgloKo+Rpd1zXT7tIlIq+UgG7280llR1srofqsZ0WctvWrqiYQTxBNhNjTUsnBdXz78dE92tJZ5odPW1F6nUIgxkQj7lpWxRzhMp1CIeDJJXTLJikSCD1pbmR+P2wlb0kWrtDeGpgp41KNGMb2iPYYsvBUaeVh1uqtT8ZGWqggrxnRl3dBaEpHdz+3bQhWfjuhMOJ6kz9J6Bs7bSnmT/1FyOlc1ccK+7/P5oUuIRjLnf8TwBcTiEV5fOox/fjCObU1VvuvsFApxXHk5R0ajRNt+GArRExgaiXBkNMrmZJJnW1qYFYupW5nPpE+dTQPG+ZDnWJyd/6463dWp+MSGwZ14++T+rBneOaORSScRCbFmeGfePrk/GwZ38lXngYOWc9NJj3PE8IVZjUyKaCTOEcMXctNJj3PgoOW+6hwdiXBjdTXHZjIyGegeCvG1igqmVFXRORTSClkEQzMUmOJjvlMobDFbdbqrU/GJT8Z1Y8HE3sTL7IUXjJeFWTCxN5+M6+aLzi+NncP5E2dSUdZq676KslbOnziTk8bO8ccYlpXxnaoqagswGCMiEa6tqqKbGhvfDc1UsNQpcIuoydMuqtNdnYoPrN6nCyvGdHWUxooxXVm9j7fLBl8YOZ8Tx7xPoc1vCDhhzPt8YeR8N+RkXfjZOxLhm5WVjs446RkOc1lVVS4XUJ1dc9nQ1CKbB/3mLOwt+KlOd3UqPrC9WznL93NnNLJ8v25s71buic7+3TZz6n7uxG49db93GNDNcTDwjPOFFaEQ51VWFhQ7qy17hsOcWpHV03ub1l53Dc3x2Ns86BadTN5WUZ3u6lR8YNkB3UmG3ZmiSYZDLDuguyc6v7z/25SF3TlKqiyc4Iz93/ZE59HRKN1dnPI6IhqldzisFdUHQ3N0EfM/2qNrVadSdBq6l7O1r7ueWFv7VtHQ3d1RzYBumxnZd42raY7su8aNUc1ujdWR0Wjg01Qyl/PYIuY/1qNrVadSdDYMqimJdA8c7I23mNvpDotEPPEW26+sTCurD4ZmaBHzH+rRtapTKTp1fSpLIt29e6/zRKfb6Q6NRDzR2S0Uood6oHluaDoXMf/OHl2rOpWi01xbVhLp9q71Zt3b7XR7e2gMdJ3Ge0OjKIoHxMq96YHHKtxNt1N5iyc6O1U4OtV9t8WtMg8NTYa0m7UGu2toiunGt82ja1WnUnQicW+2YkRa3U23Je6NQWxpdTTy2s3jwctAPK3J3cp0h9Zgdw3N0iLmv9Sja1WnUnQqtreWRLqbt3vjje92uhsTCc9+q01J3Z/ptaGZW8T853p0repUik7N5h0lke6KzT080el2usvj3oxp6pNJNnhoxBQxNC8VMf+XPLpWdSpFp8dKb04D7rHK3XTnrBroic73Vw1wNb2F8TjbPRh5zGlt1XgzPhiaZ5Ez6f2m0eRtFdXprk7Fa0OzqtH1EP/lTXHXDdjcVQPY2lTtappbm6p532UD1grMisVcTTMJvOpymkpmQ1OPnCHuNw+YvC2PcFWnqzoVjwklkgx6f4uraQ56fwuhhLv979ZEmGfmunuixTNzx9GacN+p9d+xGPUujmr+29rKKp0288XQANwK+GnWY8BtBdynOt3VqXhM3yX1dPvUnTPpun3aRN+l3vQlZi0Zzodr+rmS1odr+jFr6d5Ok8kYIHZ7Mslfd+xwZaprUzLJQzuyrnepB6cHhmYJcIeP+d4JLC7gPtXprk7FB0a+tp5OW5ztVem0pYWRr633LHh9Evjda4ezaquzSNOrtnbjd68dTjLpeM9L1uHQ+62tPObQ2NQnk/yqqSnXmo8u23hgaEBOafTDa2kuzk+uVJ3u6VQ8piyWYOwLa+i6rrA9gF3XNTP2hTWUxbyd4mmKlfPzF77IwnV9C7p/4bq+/PyFL9IUK/e8TF+IxfhTczOFmO9PEwlub2riU50yK4qhaQJOBzZ4mN8Gk4eT1UzV6a5OxQ9j05Jg3xfXsNc7mylrSVi+Z693NrPvi2ss3+OU7S0V3PnSsTzyzoE0tlgzGI0t5TzyzoHc+dKxbG+p8K1MZ7e2cmNjI/+z6DXWnEzyj5YWbm5sZL0aGX/rf5v/LwGOQ7yX+ric1zrkvJQlLqSlOt3VqTinGcgZ7TKUhD0/qqPvknrW7VXDpv7V1PesIB7d2d+LxBLUbtxBj1WN9FnWQMTaKKbZTZ2JZIgXF4xi1tK9OXjIUsYPWMGQHhupjO5cdmyORVm+qSdzVg5k9vKhNMeibuu0tEayMZHg983NPB0Os19ZGaMjEXqGQnQxscu2JhKsTCT4MB7n7dZWmqw7EmzXKu2doQF4F5gIPIZ7Yefnmp63m42i6lQjEyTmAAdbuTASS9Bv4Tb6LZS2NFYZIV4WItKaJNocLzRv13U2x6K8umgkry4aCUBtZTMVZTF2tEapb670Wucb2DjIb30iwb9bWvi3O79lE7BQq7R7hHP0xCcAt+PMeypm0pjgUaOoOpWgcG+hN0ab41Q2tBZqZOzmXbDO+uZKNjbUFmpk7OZ9D7C5SL/lfeh0tC+GJjXMvRYYDfzeZsE3AX8w916Lt5FQVWdbrrpKa7b//Am4vwj53m/ybm86NwKnAVt91vkOMFWrs7tYCa+6GLgQmAKcCBwJjAeGAF3NNVuB5WZo/ArwDNDghsBRoWlWL10MXDg/Oc2WzlGhaZZ1znenzItanopnJIFvAP8Fvmt+Ty9ZjrjQ3409V9xg69y1k/QfYIx5Vo5G9tZUA7k8DroChfhWrzYjmVutdAJnzZofmIo3ceKodmFo2lbS9L9ElveLhjEcD1Kc3fl2SNc5wlTwY035zQKuBpZp+11SJIBfmr8eQJe2F8Sj4fDy/bqNbexafmhrNDwyGQ7tmQzJdaEkdaFEcnVZLLGgemvszSHvbX4/EsvoHlUHbPJSZ2U0Fj51/Dtj9+y69dDKaGxkWTixZziU7AKQSIbqWhPh1c2x6II1dV3ffOy9A95vjkW90AmwCsg6RL+npiYMHGgM0ThgEJDaDLQF+AR4H3j5rqam9z6IxzPF2on50JGzrNN0AtqVW5wVQzPMTNecDWSL+93b/E0ALkY8Nh5AdqsXey3hOGTaqRm4FHguYL/B54Dn0yodwKnAJOAY7C2gKsFhU3oj+9rXhnQz9e9CIFcQsPHACXW9K1kzvHYF8Dvg7kl/W77FD533fPXPtnTu3Xsdh+298DOdF9//f1v8KNx7amqs6pwAnAlwWVXVTp0NDVt8qge2dQKf6TRGqOQJ7TPzlmyfVSIbAaeQ4RAii7Qgu9Z/RI51hfmTsk+JjnrtViffr4cZFaSOON5mpgoKWmTMpbPAdZHPAS+wc8qsLRsLNjYzZmhT78cIOn/9DAHfBm7K8TvnYyvwA+DXuXq6OevnzMrA6OSwZifPkX86czxDFqbOfNNZClNn2ZwBhgJvmpGMk22+5cA1Jq1hRfh+J6UZGczrEwM0knkhTyXsaa4Zr016SVIDPAH8ykFjg7n3LuBxk6bqVJ0lRSZDsz/wusuN23hk3WF/H79b1Bi5tlxOYYuFfhsZNTalzWDTwTrZxTRPNmkOVp2qs5QNzTBkDaOPB3n1MWn7NbK5FBiZ4f0DgHNKxMiosSlNepnfa18P0t7XpN1LdarOUjQ0VcCjHn+RXsgO+SqPv1dPZF0oG9PJ7SIZJCOjxqa0iJg67mWHahgynVKmOlVnqRmaaYjbndeMxftowz/O05gPAr5TQkZGjU3pcC3iMeg1E8k8Naw6VWdgDc1QxLvML6Z4aPn3RVwJ83E90L2EjIwam+DT39Qrv7je5Kk6VWdJGJqpyOK5X0TxLszDnRaHlt2AG0rMyKixCTZXIzvX/aLa5Kk6VWfgDU0tshnTb84iy3GtDjgF2XlrlW/jrSeHF0ZGjU0wqQTOLUK+52JvzVN1dkydRTc0x5N9x7+XdMJGGHALVCCRje3ec3MJGhk1NsFjMrvu2fKLziZv1ak6A21oji5i/m7mfRmwd4EjqwNL0MiosQkWXyiR50h1dkydRTc0Y4uYv1t590FCNRRCqICRUC729tHIpBub54G9tL0vGsU09ONUp+oMuqEZWsT83cr7JofD1yNwLzTNz3w2Mil6IRGgleKwdxHzHq46VWfQDU3nIubvRt7jgfNcSOc23NkIVcyh9LHa3pd0XfYjb9XZMXUW3dCUOne69D1GuWSwikkcpSM+S2HVqTqD/nBsK2L+TvP+MnC4i3puxLkH3vNFLM8Xtb0v2brsV96qs2PqLLqhWVrE/J3kXYlMd7lJX5xvhLoa2FCEstxACYamaEcsL2Ley1Sn6gy6oZlbxPyd5H0l3px3frUxOE6M57E4P8LWrpE5EjkOVim9uuxn3qqzY+osuqF5qYj5F5r3HsD3PdJUg0yhOWEO4hTgh7FJGZkPta0vKi8XMe9XVKfqDLqheRbYXoS8G03ehXAL3p44dx6wTwkYGzUyweEfQFMR8m0GnlGdqjPohqYeeLAIeT9g8rbL54BveKytDHf2pHhpbNTIBIttwMNFyPchoE51qs6gGxpMoxrzMd8YhS3kh4Bf4M9RzCfhjkebF8ZGjUwwuQVo9TG/1gI7RKqzY+osuqFZAtzhY753AosLuO8s4FAfdf7UJaPmprFRIxNcFgJ3+ZjfXcAC1ak6S8XQgJx66YcXw1wKP2Fzms/lcyBwpktpuWFs1MgEnxuA+T7kMx9n5ympzo6ps+iGpgk4HW/3gGwweTQWcO9eFCe2z624F6zSibFRI1MaNAIn+/AcnVzgc6Q6O7bOohsakCm044B1HuS1zqS9pMD77y1SGQ0G7nMxvUKMzXo1MiXFEuSsEC8anQ0m7SWqU3WWqqEBeBeYiLvTaHNNmu86SGNCEcvpEJfTs2Ns1gNHqZEpOd4BPg984GKaH5g031GdqrPUDU3KMk9Azmlx4o0WM2lMcMES/7eI5TTbgzStGBs1MqXNYlP3Z+DMK6kV+LlJa7HqVJ2lRq6w+M3AtcDvkRha5wDVFtNtAv6OuDC7VUAXAn82lj3kU/kkgdfx7kzwlLF5EejR5rN1yAl6rhqZiy++ODCV75577ukIxqYRCWt0DzAVOBvrZ703IfvNbvWhoVGdHVNn0Q1NunW+EJiCHA52JHIGzBB2HvC1FQkuNwcJi/AM0OCy1mXApHbYEM0BDjIjv6ONcXsOuA74WAcF7Wp0cz7wXeAEM1Idl+U5eh8JbfIs/kfoVZ0dU2fRDU3bHn76XyLL+0Vj/pMbaswPmm4Qu5iP69oYxH+OOqVXQzF0zjr1/Ew6Uz2eo5FoDZ/pnPjEHxqKVKS2ytODDkZ7IxWJ40HVqTo7CqF9Zt6S75phyBTa2Vg/q2W7GfrdhoW1mfmTpmb/8KqrrH4Xz3UyY4ZjnbNOPd+RzolP/MHaWlcWrTamzjwvzw4ydaYoHZ5cI5pKZIPkFKDcZrqdgAuQmGR3Aj9C1ny8IBA6Z516vi86Z516fl6dEyeOKvnyVBSl/ZDN62wo8Kbp0ZY7SL8ccSR40/SQ3UZ1dkydiqKUuKHZH/G0Gu9iPuOBWSZtt1CdHVOnoiglbmiGIR5PfTzIq49J240erursmDoVRSlxQ1MFPAr08jC/XsBjWPcnz4Tq7Jg6FUVpB4ZmGuLf7TVjcRaFWXV2TJ2KopS4oRmKeBn5xRQKm0pRnR1Tp6Io7cDQTAWiPuYbNXnaRXV2TJ2KopS4oalFNuX5zVkmb6uozo6pU1GUdmBojsf6zm836WTytorq7Jg6FUVpB4bm6CLmf7RH16rO9qNTUZR2YGjGFjH/sR5dqzrbj05FUdqBoRlaxPyHenSt6mw/OhVFaQeGpnMR8+/s0bWqs/3oVBSlHRgaRVEURfHU0BTzJLdtHl2rOtuPTkVR2oGhWVrE/Jd6dK3qbD86FUVpB4ZmbhHzn+vRtaqz/ehUFKUdGJqXipj/Sx5dqzrbj05FUdqBoXkWOevdbxpN3lZRnR1Tp6Io7cDQ1AMPFiHvB0zeVlGdHVOnoijtwNAA3ArEfMw3BtxWwH2qs2PqVBSlHRiaJcAdPuZ7J7C4gPtUZ8fUqShKOzA0IKcf+uENNBfnJ0Kqzo6nU1GUdmBomoDTgQ0e5rfB5NHoIA3V2TF1KorSDgwNyFTKccA6D/JaZ9Je4kJaqrNj6lQUpR0YGoB3gYm4O50y16T5rotpqs6OqVNRlHZgaFI93AnA7TjzSoqZNCZ41KNVnR1Tp6IoJURon5m35Ltmb+Aa4Byg2mK6TcDfEVdWS15G8ydNzfzBzEprOT51qTOdJ99tzRvqsObM7191laXbZ516viOdE5/4gzWdM2ZkfPviiy+2Wjc8/93vuecefQKVgp4j38jyHCn2KLNwzWLgQmAKcCJwJDAeGAJ0NddsBZYDc4BXgGeABl+/iRiKC3nqUns6T77bV53GUFw469Tzbemc+MQfGnyuG6XxuyveYLWDZ7UjpqihaVecfHdJyJz4xB9KpUQbkAgCD+rj0mEZCnwPmAz0BdYD/7YzY1EghwJTgdHARuBfyF6srS6lvwdwHXAS0AP4ELgBeEF/cv8NzTDgWnJPofQyfwcBFyFTKPcj8/R+bdBTnRbQ6SrFJieYTkZN2nv9gfNNHf4G8KgH+U5Cgq9Gzf/3Ms/DhcBpwFsO0z8GeDhtdI5J/1/A4cDr+tP7Y2gqgRuB7wLl5r1VSEDE2cBCYLN5vzswAjgYON5UxAtMJbwT+BHg1Zi6ves8AdjTR52KDUa9dmug9GRd6yyM4aYxztYhqjIdoI/MaMBNbkwzMun0A140z+9rBaZ9LPCk0d+WiOkInqS123tDMwx4DBhr/j8LuNkMlxNZ7nkD+CPiyfZFMySdiCwoH4ds2HPbAymfzu7AZaaHAvAf4K4A6gxKeSpKOt8nvyNIOXC9Gd24ybgcn9WYkcfxwEyb6X4BeCKLkUmxj/707pLJvXl/0xCOReZCv2aGsf/K0SimkzDXHmbu3WrSmmXSdot8Oochi9TTkIXsI83rOeazoOgMSnkqweeL5ndvMqPfv5hRuVcca6Pxdpu6PJ93Ms/FUTbSPBJ4yoLx3KRVzVtDMwx4DugDLAIOMEPjQkiaew8w00J9TNrDXBoh5NP5B2BAhnsHmM+CorOQ8lzksk4l+HwbmWb9PDIN2w34OvBfZGrVC/aweF0vD/J+0cI11cA/LBq6wxGvSCuu+s9rdfPO0FQhi3q9zJTMJGCZC3ksM73xJSbtx/IMW/NhRedgk2c2DkPcdIuhM4TsUdnHvM5HCBiFeN6ETRqTXNSpBJ9LgV9lmYHYA++OXggV8Tv/FGixaGyeMqO9XM/7sxaNzFZkel3xyNBMQ+ZF65A1gPUu5rPeVIStyLTPNAdpWdFppZc/tAg6RyELp4uA+UholiE50hgCvI0stH5g/kaZtCabtJ3qVILNd0zDl6vRP6Edfu/FwHlmJG/F2DxpnrO2TLJhZFqBr+JtgNkObWiGIhvzUhV7qYt5VCOLd8uQhXlMXoVM+VjVWWEhrYocIzAvdIaQRcgRadeNRxYzh2ZJYya7rsPsY0ZJITOi+Y5DnUqwuRz4pYWRRXU7/f73I1OGVoxNpTE2x6e9N9EYmU4W7o8jDg16zLiHhmYq4ko4i8LXENrSHXgE2Gb+/o3sHp9l8irED/P7HujMVsHd1jkMcRdtS39TLkPbGJlXybzQu0+aUXGqUwkuVyCu7Famr95qx+XwW+Bii8amwnTmvoSsZT3Lrvt/8hmZR7TaeWdoaoGzzf9vtviDWjEyLwBnIH7pIcSD5QkgFVztbJO3VbzQmY2kyQPgLJd0xnPcMyDN2Aw1r/vneTDa6rRbnkpw+S5y8qkVIxNH9py0Z36H7COz4qVZbkb9z1p8HuKIN+fDWu28NTTHm6HlajPqcMvIZHK9PRBYaf6qkRhaVjnB3OOWznz82+js1GY4XqjOZYhrdT5j8wqZveVSvMeuzg//LrA8Fe/oCQwke3T0XEyxYWSSprf/Ugco0/uQNZu4RWPT2aKR+QYaXskXQ3O0ef2MxR5DoUYmvRKk5kGPtJH2US7qtEIiTefRLuk8A4kGkMvY5DIyq4Azc+g8Uqt0UdkfeBNZTP4EWMPOdTQrXAn83Eb9vIBdXfXbO38GzrVobKwYmW8i0cYVHwxNarf6bB+MzErkMKw3zf/H2UjfLZ12eLNN3k51LgWOyGNschmZI8gcDaCQ8lTcZTQSEuXgtPd6Ix5j+bzGAK4GrMakTxmZ+zpgOf/VjEKcGJu4GR39Tautf4YmtQi9oM1nZWSONVSokakHvowcirXIvLeXDa3ZdBaKlTWeRW3ydkNnIcYmZWSW5tG5l1bponET2b2/voPsg8lmbL6H7Bux2khegIQn8ppkQMv674gbciHGJlV+f9Eq66+hSc1lpkI+9EHcBOuQEPF/IfeimhUjsw3Z95Hyjtli/u1sQ2tbnblYa+EaK/uEvNJpx9iszGNkCtWpuEu+UCjfBu7OYGyuQaJyW20kz/fJyIBM/VmhGPtOHkIcYOycBJtAoj//Saur/4amLY8CJ5veWTkS5uJ5oIsDI3M8/obdnpun8m8E3g9A+Sddvk4JNpcAv04zNlOxvqs/Nd3zZx/1Wg3F8mKRynMJsN3m85bQalgcQ7PNvO6C7DqfmOG6g5G4Wl1cMjLd0j63SrrOfMTIva/kWos9Ia90plyYB1hIbwCyp2Yvl3Uq7vKyxeu+hewNuY6drv5WjMy5+D/dcyv5j6NoYaeLvZ+MN+1PVxv3RBDniXO1uvpvaFJTMiPIvYM23dg4Hcnsbf61E0stXacV7jOjsfTpqVXmPauLqHu3ydsNnanNmANspJkyNkPz6FymVbpoXA80Wrz2ImC6DSPzf8giuN8sRDYyZhs1NCFrJR/4rGucaX96FHBvythcoFXWX0Mz17w+BJlOWm3B2DidLjvU/DvXhtZ0nVb5GzDINPojzGs7niZu6xxG9h3/VozNK1mMTSE6FXeZj+yhanQxzdQ+j/uL+L2eMKOHe5H1wphpI+4z7z/qs56xpv3p6SCNkPk+F2m19c/QpDZ7ncjOoHKNeYyNEyOT2iRqZ7oB08imdFrdCNcJ8fi5xfx9B2txj9rqfMklnY/kMTIryb/P5mGXylNxn1fNb+GGsYmb0XcQ9nksQTaGDkTWbVNHOS/yWce+yHqQG8cShJApzG9rtfXH0DxrhsZ7IpGL/2MayUIeFisL/8eaBrMR2dRolWfMPSmd+egPvAP8Ajlj/DTz+h2LI4p0nc+6oHMv0wPMZWRSB7TlMjb7s+t6TaHlqXjDfxAPy+0O0oibDt8DAflOIeTMl5+ZGYGfI5GS/TxGYLTpSFkxMklgh8Xv9SvsbapVCjQ09ewMwXBdWq/c7jSAVe+y682/D5i8rVKf9uBdZ+H635N5nWSE+QyfdUZy3LPKGJilpveYz9hEXNCpeMdMY2waCjQyZyPuu0FgD2M8XwCuMgZwCnK65evYW2sslFE2jcwUJLCmlfYrhETIvkKrrbeGBsS7JIZ4nH0tbRrAqrGxamS+avKIUdhhTZl0ZhvN5Br1fDHPA+KFziXI4momI3MEuzocLCH7PpuF7IwO4FSn4h2vmWfCjrFpNUYmKFGEOyGx9CZl+fwQYwC83L+1j8mjt8XrrzQzFy/YNDZ3mnsVDw3NEiSQH0i4jCE2jI1VIzPEDFMxP+riAvRm05kpr3wM8llnEpm++yjtuneR0/8yebUtRY6fndPGyJxm0trLBZ2K98ZmssWRZixgRgYkivSYPNcMQyIbeMEAY2T62DAyd6b9/2XTflmdxpyB7HVSPDI0IKc0zkX80p9P60HkMjapHf/5jExv0zPqavKY5kBzNp3prLSQzuoi6JyPzDUPN9MBnwOW50hjGbImsy8y5TfKpOGmTsVbZplnZJsFI/NowLSfbfG6r3iQdwiZ0u9r8fqr0zp36byKvWnMu9CYgZ4amibgdGRH/TAkKOS+aT/W8ey62z517PEbefLYFwn6uLe5/3SceeXk0pniY9ObzPXwLy+SzqQZfXyEtR3/SeQo50XIruYxJq1hLulUvOd18/xkCku0wzTojwVQt9VTW4d4kPcX2Om2n49ryB2Q1M7IMoIcXKh4ZGhSUz7HAetM5XkDWQcAWRAchoSnOdZ8ni+S8tdMGnuZNI8jc/Rhu+TSmeK8LCObley+M7iYOu3wNdNoDXFZp+KPsZmA7EupM9M5LyDrH48FVPMmi9dt8SDvYy1eNxVrAUlnmefFSqzEL2h19dbQgKwbTDRTMrWIO2O6F83T5gFpzJHmZHPPX00ac02a77qoPZfOsGmA90OmlV41f9PMe0sCpNPKb+SHTsV7UmtsXZEjho8F/hdgvcWMdWZlQ+Z12HOCecOisemiVdVdynL0xCcgR8ROMb2uScAKJDLAG2b6J9Xj6Y6sOxxiGsWB5v0YMm/6I/LHTCp0xJBP5wvsdN/ujuwRCqLOTOV5qNE5wCedipLOrchR5pU5rvEq1tlHeT6/Aeux4tKZDRxjjGjXLNdohA2XCe0zM+9vtTcyB3oO2c/baEsTsqP5Nix6Q82flCUG5sxKq9/FF50clqV9v+qqYOmcMUNrt1I4O5+7U81IulOWevkN0p0YDnPY/9n5HPVAYqi1dQZIkH9NxgrjgKfY3fs0DpxEapO2PkeejmjSWYyc4TDFjAaORHa4D0nrEWxFFtfnIJs9n6GwzWpOUJ2K4j6pWGffQ6ad+iKOQM+bjo9XYWg2Ia7/M8wz0oJMH9+GO6fsvo8451yBeNX2Mc/mT7EXckqxYWgms/Ps8fORXb9nmh+5GtkA9QQyBfVgEfWqTkXxn1SsM79ZbEYXXtGARNGerj+xt6Smzj5FQk2AnKrXD9jMznNOUryKrDO86rYQi1NnRddpceqs+Dp1yK+UItanoP1BnyNXDU3b/Rwhcu/xmGkaSMfRgrMamMzGpmg6Lc0973xIiqdTHwxFUQJGuMD7DkPmMV9DPDiCiupUFEUpUUOTYiKyKPg6slAYVFSnoihKiRqaFIciC96z2XkIVxBRnYqiKCVqaFJMAP4J/Bdx3Q0F9HurTkVRlBI1NCkOBP6BhNc4KcANpOpUFEUpUUOT4gBk9+07wCkBbiBVp6IoSokamhT7IRsU30PC2tcEtDxUp6IoSokamhTjkLhI64BLA1wuqlNRFMUHQxP3MN9qJAKxG6hOd3UqiqL4Zmi8DOIYY9ezvZ2gOt3VqSiK4iplPuc3F7gdOSNmfYDLRXUqiqKUmKF5Azmk6J/kjvlVbFSnoihKiRma55BT+v4T8HJQnYqiKCVkaBLA48jxru8F+LurTkVRlBIzNC3A3/D21D3VqSiK0gENzXbg98jpkSsD/F1Vp6IoSokZmi3A3cixxBsD/B1Vp6IoSokZmrXAz4HfAvUB/m6qU1EUJeCGZivQJe3/y4CfAn8CmgP0HVSnoihKgMkVGeAyZI2gHnGpHWF63UFrFFWnoihKiY5o/mH+go7qVBRFKdERjaIoiqKooVEURVHU0CiKoihqaBRFURRFDY2iKIqihkZRFEVRdiWU/E8Fo0LTPgX2MO+tnZ+ctofvSg7Lsp1kZmX6/3bRmfY6WDqfunRXnSffHRydiqIoRRrRXGAa7tXA+QHWqzoVRVFKcUTjwEg9D4SAY5BzU7we0ahOHdEEkilXrPUzu0OQI7yHAzOBKXf8ou+qYuls2B5mwIAYx03eSjwO8Xgo9VE34FFgLHLc+LkTJ47a4YXObdsijB7dxJFHb6OxMUzS3rmzruls2RGiulOCE760lepOCVp2hNws6oJ1Fhsn0ZvPAI42r78MPBTQ76g6lfZEGXAHMMH8/xRgA/DtYgmKhGFHc4jWVohEIB7/7KOngEnm9dmmE3V2AMtUdXqME2eAi7O8DhqqU2lP7JVmZFKGp6iNTUV5gk2byti4sYyqqs8G4kPTGsUUpwWwPFVngA1NH+DwtP8fZt4LGqpTaW/0zvBe16I2ImXQ3BxmyeJKQjtblJ4ZLo0HsDxVZ4ANzalABJgPLDCvTw3g91OdSqnRBTgPuBQYk+HzUIC0HgGcQhKqq+OsXFHBpo0RKisTIEeRt6XVSzGhUB6dmfFdZ97yDL5O3wzNmebfR4CHzesvB/D7qU6llKgBbgamAz8BbkMW/NNJBkTrr4FXgCeAuRUVyZ5btkRYtqySikr/JaYW/8Ph3DqzjAwCV54B1umboRmITO2AeEA8Yl4fDgwI0HdTnUqpMQlZ1O+LeBhNBs4NoM7jgEvS/j8GmBEOw7o1UVpjoVyjC08oiyTZVh8mFttlZJNRZ6mUZ0c3NNciUztzgA/N33vmvakB+m5tdX5QAjo/CLBOxXsOyfDeoQHUeUSG9yaEw5BIiNeZ34amsirBmk/LWbMmSk1NPDXCyaizVMqzIxuak4Bvmdc/Ar5o/m40733LXFNsMumkBHQSUJ2Ku0SyvF9u49piEsvw3g6QqatQEVaRysqguSnM4oVVhMPJlIasOkulPDuiobkQmdYJA38GnjY97qmIf/efzGePmGuLRTadlIBOAqhTcdfA7Ad8BTgggxHJtLhRrDWZPoj77OAMn8UtvuebzmSSwTU1cZYvq2Dt2ijV1Ymi6QyF5C9ZmuVZFENTARwPvAzca3pczyD7PA5B1hEON68vNp+Vm2tfNvdW+PA9rOhMEVSdbSmmTsUbJpvf9PfIsd4nBlTnocBi4DHz7wmloLO8InnCtvoIixdWEo0W32ciVHrl6d2I01T+84D+QNS838181jdtOB8DbjXTOnF2XT+4FnHLO8VMAU0FjjR/LUjcr1ZgS1paq4A/As/aeEid6sToCaJOfNapeDNiCZtRSCbX0+lAP/O6CvEqeyZgvdcw8CBQm9ZGPAp0B5qCrDOZ5NFoWbL7+g3RpuYdIVJrRr5WgDLYvj3M9u0hunZN0LIjUirl6bmheRhxq8zGZuBxxAtigXlvFPCltGtOMu/NB34I/B24ygwVuyOeVZk4Lu0HyEchOke30Zk+LA2Szmx4qVNxl1rgeuBgYDnwY/Nvih5IjKp0RiBurOt81noVEu5oBXA5u+7R6Mfu3o6VwEjESSXQOiPh5MhkkvcS8RChUBKfth19pjMSSV5eXx9p+eTjCgYMaAlaeRbV0PwWuNr8f7lp2NaZXtla4CPT4NUi88rDgYva/IIh4G4zxbPI/F2ILGbvY3ryIWSe8sfAEHPfvTa02tH5OaPzwjw1bUERddrBC52Ku0xBNlnWABOR3fqnszM4aqcs91X6rPNaM5JOsTc7Y+xBZoeE1Ggt8DqTEPHZIWE3nRXlyaM/Xl7JmLFNRKPJ8lgsFITyLLqhuQbxcLjONFiXmQdklRkRPG96XnvmSesIdnXTWw0sND2RF41Vv8nkkUQ2pv3AhlYrOkemTU3YIc5O12IvdTrFTZ2Ku1ycNpKNINOeg9JGNdmaPr8XE65r8/+jzEhrblody1b3VKcFndHy5NimpvDchoYwvXu3xrMYmnhHejhS88k3INGD64GDgHeRRfQPjZHYs4C09wReMmkcArxj0q43ed1g8yGzorOfw/LwWqdbuKFTcZd+ed4Lym9TleG9/gEsz5LVmUzSPxIRF+ukPpGfGZoUjyObhBYAvUzDvR9wCzCtgLSnmV7255CzE3qZEc4Ek1ehuK0zhV86neK2TsWf5ysoZNqf0aI63dcZCukDkO1B+Mj0lucA1ciZKFWIZ9R0G+nebO6pBh5A5qffRxZKP3JBdyad1QXoTO+V/N3onOODTie9Jy90Kt6QLBFNqrP96wxcj2srspN+PbIAd5l5/wbgLgtp/grxvsHcO8ykdaxJ2y3a6vyOTZ3pXG7SWG/S9ENnIXipU1EUxdeh/Xp2hkH5Ttp1cyyk+V5a2pea1zeaNN3GiU4CoJOA6VQURfHN0AD8BdlQNAA40Ly3j4U0U9ccaO5tMml5RaE6CYBOAqhTURTFN0PTAMw2rw8y/46ykOaoNvfMNml5RaE6CYBOAqhTURTFN0MD8LH5d2CGBnwJslP9NPO6raEZ2CYNL7GiMxupe5YXQacd/NSpKIrim6HZbv6NIJ5Og4CNyCL/aOQ0uCfM68vMZ4PMtZG0nrzXWNGZjUibNPzSaRc/dSqKovhmaIaaf9eYxvs2xOvpV+zq095i3tsbuN30vteYz/by4XtY1ZmJlM5hPuu0i586FUVRXKMsx2flyNGyAP9FAmZ+HwmzcQayZtDHfL7OXPMcO6Ml9zb/TkSiGMc8+g6F6mxIuweThp86U9QgwTCDolNRFMU3Q/N50wjWAW8gmwW/j+zl6JLlnjrgl8gu/TfM/7sYY/OKR99BdSqKopSooUkdzvM8srj+ADvdhj9FwqCkFqaHAMcgsZ1+YEYSZ5l7v2zS8qphVJ1KUAlleY2F93HpekUpCUPTF3GprUQW2K8G/sbu0UcjwNeAn5kG9C12TvecwM7Q+V414KpTCRrpoUiyRetNtPnN8z2jTsObRPO8V2bhvvJsn6fF94rabG981Zknn/aos6hkcwYYhITcB1kTqDQ96PHI+fbZzrj+s7nmFXPPYeazkSZNt1GdSlCoy/DehrTX29oYlZTRSPfKzHQA2uY2/88UEWKrDZ2ZjFlDG52ZSH8/li3dROKziMV1DhtGT3Xm+d3ao87ijmhmhd/d7c2Jif3T96G0IscJ3zor/K6Vg1FXT0zs/wVk/WFaWmGMmhV+95MMeTnRn1Fnhgc6o04go07gE5fLuVR0lhyzZs13dP/EiaPckvIAcEHa7/MWsLRNw/I0cDI7p7+eZedx3CDHaqxjp1PIduDJNvksM2lPSKtPD9jQ+ZAZKadYC/yvjXF8AZm6TfEBu54G+whyoF86fw2FksQTIRKJEKFQciGE5rLrqaIvBkFnm/8vRM64ae86AzmiWWJ6Uq8Ch84Kv3uzRSMjD3/43cSs8LvTgUNNGpvZdVOnW+yiE4kabeeU8AQS7Vl1Kk6ZbozCemAWcKUxAulch6yzrTdG5Zo2n8811yw0HYzfAfe3uaYVOc1zlknnSVOfrHIBsq9ss8nvKHYPdf8Vo3OzyWdym88/AM5BNiBvRE7XvSUUgkQilH4Gy5dMo7sZ+HebBrloOjPk1RF0FndEk8VQLEbOOP+MjRsX1SBrA0ea6Zwh7PSWqkMWsueYaZ5/9uw5vGFW+N3/mesd8+TmBzO9vYvOUChEMpm0pdMMc/PqPKX7Wa7pNNjSGQ6HGxKJhHs6n3wy62emHAmHwyQSiULKMy+nnHKKqxW5kPrp8rO0CnHUyMVHiCt7rg7FfebPK3aQO1IGZpT1RQsjuAcAGraHGTAgxtlf3UQ8DmknStabv4RpHLd7pXPbtgijRzdx5NHbaGwM09IS2k1nDlzT2bIjRHWnBCd8aSvVnRI0NYVtl6cXOp2O/G1yCLKfcjgwE5hSZuEBHgZcC6Gzy8urO0WjnYhGKwmHo4RCMiBKJhO9E4lY71iseUIstv3ilpbG7Rs3LnoAuK1nz+F+9byHAddWVFSe06NH7+q+ffegS5daKisriETCvPnmgow6IfkAssHTV53ZyvOQQ0YSjyd6Nzfv6F1XVz9h/fp1F69fv6axtTX2oOnl+Knz+2Vl0bN69uxd3bt3b7p160KnTtU0NcVYtmwd9fXbfSnPjz7aeeROeXk54XCY1tZWamtr2bhx0bBIJPL9aLT8rJ49U797Z6qrqygrk/rZ2pro3djY1LuubtuEtWvXXLxx4/rGLVuWPhiPx29Zu7b7kvr6esrKykgkErS07Nzfu88++xBAyoA70qbOTjHTM98ulqBIGHY0h2hthUgE4jtXHJ9i596xs82U4dkBLFPV6XH9LMthYCqBaaFQeEpVVbfyysquhMORLD3gCOFwhLKySqqqupJIxDs1N2+9oKlpyzc2blx0J/Cjnj2HN2e8+bDm3LJTn2fvgVcC02pqaq8cOHCv6MCB/ams3NVBI5lMEgqFcupMJhN3ImsnnurMV56RSJiysggVFVG6dKlh4MA9iMX2rV6x4tPzPv54ydfr67fd4UhnfiqBH1dVVX934MDB0UGD+lNdvetZbS0tccLhEOGwg/J0yIcfflgJTKuu7nTlgAGDo4MGDaCyspxQKLzbyYbl5WHKy2vp0qWWAQP2oLm5pfqTT1aet3Llx1+fPXv2HcCPxo0b10xpsFfaQ5x6sM8upqGpKE+waVMZGzeWMXhwC7FYBCQKxqQ2l54WwPJUnT7Uz7IsRmYo8GhFRe34Tp16EQ7bc24IhyNUV/egsrJL+fbtG67ZsaP+2I0bF33Zg9HN0HA4/NigQUPHDR8+jKqqCsc6zfTHEg8qScHlGY2WMXToQAYO7BddtGjpNR9/vGRyLBY7zQud4XD48X79BowdOXI4NTWdAlme77///tBQKPTYnnsOHDdy5AiqqysJh/Mf8RMKQSgUprq6khEjhjJgwJ7RBQsWXrN69Yovvv/++2eMGTOmFNa9emd4r2sxBYXLoHlbmCWLKxmy12cjwp4ZLo0HsDxVpw/1M5zByOwPvF5T03t8be0ethvFXRueMmpr96Cmpvd4YJZJ2y32j0ajb4wf/7lx48aNtm1kcukEXNXpVnlGo2WMHj2C/fc/aExlZeUbbuuMRqNvjho1Zuz48WNsGxm/ynPevHn7R6PRN0ePHjduzJjR1NRUWzIyu2sMU1NTzZgxoxk9ety4aDT6xrx58/YPwIPaBTgPOeRuTCZ7GaBG5QjgFJJQXR1n5YoKNm2MUFmZgMwxBlu9FBMK5dGZGd915i3PYOssqH6G2xiZYcBztbV79KmsdK+TVFnZldraPfoAz5k8nDIsGo3+e7/9Duo9cGA/T3TiTvBKT8pzjz16cdBBh/SqrKx83i2d0Wj0hX33HddryJBBlJWVBbI8Fy5cOCwajT6/777jew0e3J+KinLn0z4V5Qwe3J999x3fKxqNPr9w4cJiBi2tQTzIpgM/Qda6hre5Jijn0f8acax4AphbUZHsuWVLhGXLKqmo9F9iytMtQ59jF51ZRgaBK8+A6iy4fobTjEwV8GhNTe9eFRW1riusqKilpqZ3L+Axk1ehVIXD4cf23Xe/nv369fJUJxKPrGCdXpZn9+5dOOCAg3qUlZU94VRnOBx+bMSIUd3799+DSCQcyPJcuHBhFfDoyJH79thzzz6uGUOAsrIy9tyzLyNH7tsDeMzkVQwmIWstfYFuiBvsuQFscI4DLkn7/xhgRjgM69ZEaY2Fco0uPKEskmRbfZhYbJeRTUadpVKeAdRZcP1Mb1WmVVTUjnOz552ph1tRUTsW2XhYKNMGDRo6duDAPQKv0+vy7NWrO3vvPXLfcDj848KnG0I37rnnwLEDB/YnEokEsjzLy8sBpvXvP2jcgAH9XDUyO41NhAED+tG//6CxwDSTp98ckuG9QwPY4ByR4b0J4bBEBojH8d3QVFYlWPNpOWvWRKmpiadGOBl1lkp5BlBnwfUzbEYzQ0Oh8JROnXp5rrRTp96EQuEpBU6hDa2pqb1y+PBhhDyuySmdBU75+Faew4btRW1t5+8WqrOysmrKiBF7U14eDWx5zps3b2hVVdWVw4cP91RneXmU4cOHU1VVfeW8efO8nELLZtHLbVxbTDKFTNkBMnUVKsIqUlkZNDeFWbywinA4mdKQVWeplGeRcL1+pkY0U6uqukWdLFRbJRyOUFXVLcrOc2vs9L6nDhy4V5mThX8/dPpZnpFImOHD9ymLRCLX2f+O4esHDBhUVlVVGfTf/bqBA/cqq6mp9lxnTU01AwcOKQuFQtd59ADvh+wUPyDDQ5ppfrtYazJ9EPfZwRk+i1t8zzedySSDa2riLF9Wwdq1UaqrE0XTKd6Nu/1wpVCentXP8MaNi2ohdLaXUzyZplIgdJbkbZna8vKKcwYO3NN3nYAtnX6X5x579Ka8vOIrdnVGImVfGTx4oGdTZm6U55NPPlkbiZSdNXjwQMJh77vK4XAIKZOyrzz55JNuL65NBp4Bfg/8AziRYHIoEs3iMfPvCaWgs7wiecK2+giLF1YSjRbfZyJUeuXpWf0MA8eXl1d3yrYZ06vebXl5dSfgeBu3Hd+zZ+/qysrywOv0vzxD9OvXv9quzl69eldXVlYEvjx79epT7ccodqdBrKBXrz52yzPVI4ySParudOSMoSpgD8RrJ2hTY2HgwbTOQBnwKM4cTnzRmUzyaLQsWbV+Q5TmHSHCYf9FRcpg+/Yw27eHqChPBK08i1Y/w8DR0Wgn37+xyfNoG7cc3afPHiWhsxjl2atXb9s6e/fu7flalxvl2bdvX397oiEwedrRWWse1BeQYJhD2nzeg10j7wKMoDhurFchkaN/y+7z7v2AAW1tLzuPuQi0zkg4OTKZhEQ8RCiU9F1nJJIsb2wM88nHFYTDySCVZ1HrZxkwtqyswvcaZPIca+OWsZ0715aEzmKUZ21tp3Zbnl27dvFdp8nTjs4pyCa2GuSo7a7A6eyM0p2t91Hp81e7FjmiIsXebQxqeY7ecOB1JiHis0PCbjorypNHf7y8kjFjm4hGk+VpQUaLWZ5FrZ9hYGgk4r8rp8lzqI1bhlZXV5SEzmKUp9m8aLM8q30f0RRSnlVV/s8ymDzt6LzYPMSpRuQUdj2cLltB+72Y0NbJ4ag2BjXbInRcdVrTGS1Pjm1qCtPQECYaTQZFZ1HrZxjoHC7CZKbJs7ONWzqHw2GSyaTtv0Qi6bvOUijPaLRwr7iUgZJgpdb/jOOBLZ2pKMz+jrxsl2e/PO8FZUd/Jqvdn+BRsjqTSfpHIuJinUwGRmdR62fJHAUKMHv2AoIV6ik4JBIJ3/KqqalizJjCTpKOx+M888yijvKzhAOoaQe7nz/fojrd1xkKaf1Mz2ibn41Um4Zxm41bVGcOWlpitnXGYoXH5LM7kkn9tbbGbetsbfW/PE2e2xwmkwxg45JUnR1SZ1HrZxhYGo/731EweS61cYvqzEF9faNtnY2NjSR9HNsnk0kaG+3rbGpq8r08TZ5LURTFFUMzt7XV/2gH8fgOkCilVlGdOdi8eYttndu21fuu0+RpS+fWrXW+6zR5ztUmQlHcMTQvxWLbfc+4pWU7wEs2blGdWUgkkqxZ86ltnevXr/d9RLN+/XrbOteuXevromoyCWvXrrWrU1GUHIbm2ZaWxu2JhH/edolEnJaWxkZkk5NVVGcW1q/fSkPDVts6N2xY39jc7N/oq7l5Bxs2rG+yr3NdEXSus6tTUZRshqZnz+H1kHywuXmrjw/yViD5gORtmaLplLyDqTMeT7Bs2XISibhtnfF468OffLKSeDzug844klfrQ3Z0nnLKKfXxeOtDH3+8wpGbup3R4ccfryAeb33wlFNOqdcmQlHcGdEA3NrUtCXmRy88kYjT1LQlhsTRsYvqbMOKFevZuHF1QToTicT0FSs+bm1qavZcZ1NTMytXftyaSCRutntvMpm8ecWK5a0NDY2e69y+vZEVK5a3JpPJW7R5UBQXDU3PnsOXJJOJO7ZvX+/Dg7yeZDJxZ8+ewxcXcLvvOpFoq4HUuWlTPYsXLyCRiBess7m56Y6FCxen3KM9oaUlxsKFi2lsbLyjEJ1jxoxZ0tTU+PNFixb5orOpqfGOMWPGLNbmQVHcHdEATNuxo36ul1M+zc1b2bGjfi4OT65UnbB163bmz19IY+NWRzqTyeSPVq9eMW/FilWeTKHF43FWrFjF6tUr5hWqs6WlBWDaqlWfzF258tPUXhxXaW1tZeXKT1m9+pN5wDSTp6Iobhqanj2HNwGnNzSs37Bjh/tT0zt21NPQsH4DcHrPnsOdzIH4phMIpM716+v44IOFbNq0yhWdiUTitIUL529etWoN8bh7myPj8QSrVq1h4cL5mxOJxGlOdI4YMaIJOH3Bgg82rV691lVj09oaZ/XqdSxY8MGmZDJ52ogRIxq1aVAUb0Y09Ow5fAlwXH39mnVu9sSbm7dSX79mHXCcycMpnus0eQRKZyzWytKla5g/fwEbN65wVWcsFjvmgw/e37h8+Se0trY6TrC1tZXlyz/hgw/e3xiLxY5xQ+eIESOWxGKxYz/4YM6Gjz9eyY4dzkcdO3a08PHHK/nggzkbYrHYsSNGjFji4vMVyvIaC+/j0vWKUvT6uVusm549h78LTGxoWD+3vn4NiUThjU4iEae+fg0NDevnAhNN2m7hmU6TdmB0xmJxVqzYwJw5y1i0aD5bt67xRGcsFjtk/vx5H8yZM4+GhsL3AjU0bGfOnHnMnz/vg1gsdoibOseMGfNuLBY7dP78ufPmzfuQhobGguK8JRIJGhoamTfvQ+bPnzsvFosdOmbMmHddfpDT3eSyDcHSxWcKHV+WI81CiOZ5r8zCfeXZPk+L7xW18F2KpjNPPu1RZ1HrZ8agambUMWHHjvrbt2z5ONbYuAk7HlSJRJzGxk1s2bI8tmNH/e3ABJdGMplGDK7qdGmEULDOeDxJS0sr27Y18umnm5k/fyVvv72QhQsX8umnCzzXmUgkDly9esXPXn/99daPPlqUChljicbGRj76aBGvv/566+rVK36WSCQO9ELnuHHjliQSiYNWrfrk9jfeeL114cKlNDY2k0gkcm7sTCbFwDQ2NrNw4VLeeOP11lWrPrk9kUgcNG7cOKc6M4Uv2JD2elubhzb1UDak/X9dhjQ2t/l/Jg8TO8PlTI1FQxudmUh/P5Yt3UTis4jFdQ4bRk915vnd2qPOotbPrEJ79hzeDFy7ceOi3zc2brqmsXHzOeXl1dXRaCei0UrC4WgqND2JRIJEIkYs1kwstp2WlsYmSP4duK1A7zJbM17AtclkwpFOCvPacl3n7NkfBUHn95qaGu9dvHjB1KVLF5/ds2fvqt69e9OtWxeqq6soKyv7bHqssbGJLVvqWL9+PRs3rm9OJOIPJBKJW0KhkKc6R48e3VxbW3vt7Nmzf79kyYKpy5aJzr59+9K1axeqqqooK4sYnXGamprYurWOtWvXfqYzHo/fcvDBBy+ur3dlDe0B4IK0h/8tdo2Vtg14Gjg5bXrhWWBL2jUvmYe5j/n/duDJNvksM2lPSM1Smryt8hDwtbT/rwX+16bxeQE4Ju29D4AFaf9/BPhhm3T/GgoliSdCJBIhQqHkQgjNZdczZF4Mgs42/1+IhBpq7zqLWj9Dr732oSWVGzcuqgFOBI4ExiNHgXZN61EtB+YArwDP9Ow5vMFKuo890p07fpH9qN4pV6wF4PAjZ1stUFs621js7K1vUwVnnT056+cPPvAvACqrdpS8zlAoRDKZJBwOk0gkbOkMh8MNiUTiszSc6sxH/wGDHNXPVSs/yZtHLp1p9bQ/cAdwGLAIOXnxjTaX7WOu2Q+YB1wOzG8zw/BN4BpTPx4Brmd3J4pDgNuB4cBMYModv+i7ykp5TblibYVpdA4HVgFnAR+1uawbcs7954y+s8216ZwN3Gx0PgR8Z/v2MHv2j3Hc5K0kEhCPhwYCjyIHyP0POGfixFGbvdS5vSG8qv/AFo6bXEc8DvF4aDedGbJzVWcsFvooGk0y+YSt9OjRSlNTuKDydFPnrFnzi1o/Q9+9fE034H7gWKwdL9oCPAycf/qXN7cYY1GJnEP9lSxziW1pNVb+bKDOiqExlaognUDLhIPfAzmWtGCdFhtGRzrNe6rTBZ39BwxqMcbEM52KouQnDPwCmIz1M6zLzVDx+sce6c5jj3QH+IF5L2oxjTKT5502tBasM+091dmBdK5a+UlqxOKHTkVRchiaQrtr6fcd50Iabl6rOlWn3zoVRclhaHoWeG+ftNdupJEP1ak6g6xTUZQchkZRlCzo+oyiqKFRFEVR1NAoiqIoamgURVEURQ2NoiiKooZGURRFUdTQKIqiKGpoFEVRlHZlaOoKvDc9mJsbaeRDdarOIOtUFCWHoXm0wHsfS3vtRhr5UJ2qM8g6FUXJQhlwFVALfAFrx3a2mgfw9rT3bgX6IefXWwl+mEDOUvieDa2qU3UGWaeiKDkMTR0SPt0JLcC3zJ9XqE7VGWSdiqLkMDQdgrdm7+c4jbPO9jZ9t/BDpznfR1EUxZKh6QLci/WpiTgyNXE5Ow/AKgfuAk6zODWRRA6WuhjrC7WqU3UGWaeiKDkMzQzgTJv3XYwcRXqT+f9U4CKbaXwFOafa6n2qU3UGWaeiKFkIA2cUeO/paa/dSCMfqlN1Blmnoig5DE2XAu/t3mZ6w2ka+VCdqjPIOhVFyWFoFEVRFEUNjaIoiqKGRlEURVHU0CiKoihqaBRFURQ1NIqiKIqihkZRFEVRQ6MoiqJ0BEOzscB716W9diONfKhO1RlknYqi5DA0/yrw3mfTXj/nQhr5UJ2qM8g6FUXJYWguNw9zq8V7WoC/Ajenvfdj4G/sjJabj1bzEE+xoVV1qs4g61QUJQv/PwAlukJhy2ScjQAAAABJRU5ErkJggg==",jfgrid.getjfgird_select_save=function(){return jfgird_select_save},jfgrid.setjfgird_select_save=function(e){jfgird_select_save=e},jfgrid.getjfgird_scroll_status=function(){return jfgird_scroll_status},jfgrid.setjfgird_scroll_status=function(e){jfgird_scroll_status=e};var jfgridConfigsetting={allowCopy:!0,showtoolbar:!0,showinfobar:!0,showsheetbar:!0,showstatisticBar:!0,pointEdit:!1,pointEditUpdate:null,pointEditZoom:1,showConfigWindowResize:!0,enableAddRow:!0,enableAddCol:!0,enablePage:!0,pageInfo:null,autoFormatw:!1,accuracy:void 0,editMode:!1,chartConfigChange:null,beforeCreateDom:null,total:0};jfgrid.jfgridConfigsetting=jfgridConfigsetting;var jfgriddefaultstyle={font:"normal "+Math.ceil(10*window.devicePixelRatio)+'pt 微软雅黑, "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',fillStyle:"#000000",textBaseline:"middle",strokeStyle:"#dfdfdf",rowFillStyle:"#5e5e5e",textAlign:"center"};jfgrid.jfgriddefaultstyle=jfgriddefaultstyle,jfgrid.setjfgrid_pointEditZoom=function(e){jfgridConfigsetting.pointEditZoom=e},jfgrid.replaceHtml=function(e,i){return e.replace(/\$\{([\w]+)\}/g,function(e,r){var t=i[r];return void 0!==t?t:e})},jfgrid.isEditMode=function(){return!!jfgrid.jfgridConfigsetting.editMode},jfgrid.flowdataInit=function(e){for(var r=[],t={},i={},a=0;a<e.length;a++){for(var n,o,l=[],d=0;d<e[a].length;d++){null!=e[a][d]&&null!=e[a][d].mc?(null!=(n=$.extend(!0,{},e[a][d])).mc.rs?(i[n.mc.r+"_"+n.mc.c]=[a,d],t[(n.mc.r=a)+"_"+(n.mc.c=d)]=n.mc):n.mc.r+"_"+n.mc.c in i&&(o=i[n.mc.r+"_"+n.mc.c],n.mc.r=o[0],n.mc.c=o[1]),l.push(n)):l.push(e[a][d])}r.push(l)}return 2<JSON.stringify(t).length?{data:r,config:{merge:t}}:{data:r}},jfgrid.getObjType=function(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]},jfgrid.func_methods={getCellDataArr:function(e,r,t){var i=[];if(null==e.data)t||("number"==r?i.push(0):"text"==r&&i.push(""));else if("array"==jfgrid.getObjType(e.data))for(var a=0;a<e.data.length;a++)for(var n=0;n<e.data[a].length;n++)null==e.data[a][n]||jfgrid.func_methods.isRealNull(e.data[a][n].v)?t||("number"==r?i.push(0):"text"==r&&i.push("")):i.push(e.data[a][n].v);else jfgrid.func_methods.isRealNull(e.data.v)?t||("number"==r?i.push(0):"text"==r&&i.push("")):i.push(e.data.v);return i},getCellDataDyadicArr:function(e,r){var t=[];if(null==e.data){var i=[];"number"==r?i.push(0):"text"==r&&i.push(""),t.push(i)}else if("array"==jfgrid.getObjType(e.data))for(var a=0;a<e.data.length;a++){for(var i=[],n=0;n<e.data[a].length;n++){null==e.data[a][n]||jfgrid.func_methods.isRealNull(e.data[a][n].v)?"number"==r?o=0:"text"==r&&(o=""):o=e.data[a][n].v,i.push(o)}t.push(i)}else{var i=[],o=e.data.v;jfgrid.func_methods.isRealNull(o)&&("number"==r?o=0:"text"==r&&(o="")),i.push(o),t.push(i)}return t},getDataArr:function(e,r){var t=[];if(null==r&&(r=!1),"array"==jfgrid.getObjType(e[0]))for(var i=0;i<e.length;i++)for(var a=0;a<e[i].length;a++)r&&!jfgrid.func_methods.isRealNum(e[i][a])||t.push(e[i][a]);else for(i=0;i<e.length;i++)r&&!jfgrid.func_methods.isRealNum(e[i])||t.push(e[i]);return t},getDataDyadicArr:function(e){var r=[];if("array"==jfgrid.getObjType(e[0]))for(var t=0;t<e.length;t++){for(var i=[],a=0;a<e[t].length;a++)i.push(e[t][a]);r.push(i)}else{for(i=[],t=0;t<e.length;t++)i.push(e[t]);r.push(i)}return r},isDyadicArr:function(e){var r=!0;if(1<e.length)for(var t=e[0].length,i=1;i<e.length;i++)if(e[i].length!=t){r=!1;break}return r},getFirstValue:function(e,r){var t;if(null==r&&(r="number"),"array"==jfgrid.getObjType(e))if("array"==jfgrid.getObjType(e[0])){if(!jfgrid.func_methods.isDyadicArr(e))return jfgrid.formula.error.v;t=e[0][0]}else t=e[0];else if("object"==jfgrid.getObjType(e)&&null!=e.startCell)if(null==e.data)"number"==r?t=0:"text"==r&&(t="");else{var i=window.jfgridCurrentRow,a=window.jfgridCurrentColumn;if(1==e.rowl&&1==e.coll)null==(t=e.data)||jfgrid.func_methods.isRealNull(t.v)?"number"==r?t=0:"text"==r&&(t=""):t=t.v;else if(null!=e.data[0][0].mc&&e.data[0][0].mc.rs==e.rowl&&e.data[0][0].mc.cs==e.coll)null==(t=e.data[0][0])||jfgrid.func_methods.isRealNull(t.v)?"number"==r?t=0:"text"==r&&(t=""):t=t.v;else{if(1!=e.rowl&&1!=e.coll)return jfgrid.formula.error.v;var n=jfgrid.formula.getcellrange(e.startCell),o=n.row[0],l=o+e.rowl-1,d=n.column[0],f=d+e.coll-1;if(1==e.rowl){if(a<d||f<a)return jfgrid.formula.error.v;t=e.data[0][a-d]}else if(1==e.coll){if(i<o||l<i)return jfgrid.formula.error.v;t=e.data[i-o][0]}null==t||jfgrid.func_methods.isRealNull(t.v)||null!=t.mc?"number"==r?t=0:"text"==r&&(t=""):t=t.v}}else t=e;return t},getCellBoolen:function(e){var r=jfgrid.func_methods.getFirstValue(e);if(jfgrid.func_methods.valueIsError(r))return r;if("boolean"!=jfgrid.getObjType(r))if("string"!=jfgrid.getObjType(r)||"true"!=r.toLowerCase()&&"false"!=r.toLowerCase()){if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=0!=(r=parseFloat(r))}else"true"==r.toLowerCase()?r=!0:"false"==r.toLowerCase()&&(r=!1);return r},getCellDate:function(e){var r;if("array"==jfgrid.getObjType(e))if("array"==jfgrid.getObjType(e[0])){if(!jfgrid.func_methods.isDyadicArr(e))return jfgrid.formula.error.v;r=e[0][0]}else r=e[0];else if("object"==jfgrid.getObjType(e)&&null!=e.startCell){if(null==e.data||"array"==jfgrid.getObjType(e.data)||jfgrid.func_methods.isRealNull(e.data.v))return jfgrid.formula.error.v;r=e.data.v,null!=e.data.ct&&"d"==e.data.ct.t&&(r=jfgrid.mask.update("YYYY-MM-DD h:mm:ss",r))}else r=e;return r},getCellrangeDate:function(e){var r=[];if("array"==jfgrid.getObjType(e)){if("array"==jfgrid.getObjType(e[0])&&!jfgrid.func_methods.isDyadicArr(e))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(e,!1))}else if("object"==jfgrid.getObjType(e)&&null!=e.startCell)if(null==e.data)r.push(0);else if("array"==jfgrid.getObjType(e.data))for(var t=0;t<e.data.length;t++)for(var i=0;i<e.data[t].length;i++){null==e.data[t][i]||jfgrid.func_methods.isRealNull(e.data[t][i].v)?r.push(0):(a=e.data[t][i].v,null!=e.data[t][i].ct&&"d"==e.data[t][i].ct.t&&(a=jfgrid.mask.update("YYYY-MM-DD h:mm:ss",a)),r.push(a))}else{var a=e.data.v;null!=e.data.ct&&"d"==e.data.ct.t&&(a=jfgrid.mask.update("YYYY-MM-DD h:mm:ss",a)),r.push(a)}else r.push(e);return r},isRealNum:function(e){return null!=e&&""!=e.toString().replace(/\s/g,"")&&("boolean"!=typeof e&&!isNaN(e))},isRealNull:function(e){return null==e||""==e.toString().replace(/\s/g,"")},valueIsError:function(e){var r=!1;for(x in jfgrid.formula.error)if(e==jfgrid.formula.error[x]){r=!0;break}return r},getRegExpStr:function(e){return e.replace("~*","\\*").replace("~?","\\?").replace(".","\\.").replace("*",".*").replace("?",".")},factorial:function(e){return 0==e||1==e?1:e*jfgrid.func_methods.factorial(e-1)},factorialDouble:function(e){return e<=0?1:e*jfgrid.func_methods.factorialDouble(e-2)},variance:function(e){for(var r=0,t=0,i=0;i<e.length;i++){r+=a=e[i],t++}for(var a,n=r/t,o=0,l=0;l<e.length;l++){o+=((a=e[l])-n)*(a-n)}return o/t},variance_s:function(e){for(var r=0,t=0,i=0;i<e.length;i++){r+=a=e[i],t++}for(var a,n=r/t,o=0,l=0;l<e.length;l++){o+=((a=e[l])-n)*(a-n)}return o/(t-1)},standardDeviation:function(e){for(var r=0,t=0,i=0;i<e.length;i++){r+=a=e[i],t++}for(var a,n=r/t,o=0,l=0;l<e.length;l++){o+=((a=e[l])-n)*(a-n)}return Math.sqrt(o/t)},standardDeviation_s:function(e){for(var r=0,t=0,i=0;i<e.length;i++){r+=a=e[i],t++}for(var a,n=r/t,o=0,l=0;l<e.length;l++){o+=((a=e[l])-n)*(a-n)}return Math.sqrt(o/(t-1))},isLeapYear:function(e){return 1===new Date(e,1,29).getMonth()},feb29Between:function(e,r){var t=moment(e).year(),i=moment().set({year:t,month:2,date:1});if(jfgrid.func_methods.isLeapYear(t)&&moment(e)<moment(i)&&moment(r)>=moment(i))return!0;var a=moment(r).year(),n=moment().set({year:a,month:2,date:1});return jfgrid.func_methods.isLeapYear(a)&&moment(r)>=moment(n)&&moment(e)<moment(n)},findResultIndex:function(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;for(var maxCriteriaLength=criterias[0].length,i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result},findField:function(e,r){for(var t=null,i=0;i<e.length;i++)if(e[i][0]==r){t=i;break}return null==t?jfgrid.formula.error.v:t},rest:function(e,r){return r=r||1,e&&"function"==typeof e.slice?e.slice(r):e},compact:function(e){if(!e)return e;for(var r=[],t=0;t<e.length;++t)e[t]&&r.push(e[t]);return r}},jfgrid.hexToRgb=function(e){var r=[],t=[];if(3==(e=e.replace(/#/,"")).length){for(var i=[],a=0;a<3;a++)i.push(e.charAt(a)+e.charAt(a));e=i.join("")}for(a=0;a<3;a++)r[a]="0x"+e.substr(a+2,2),t.push(parseInt(Number(r[a])));return"rgb("+t.join(",")+")"},jfgrid.rgbTohex=function(e){var r;return r=-1<e.indexOf("rgba")?e.replace("rgba(","").replace(")","").split(","):e.replace("rgb(","").replace(")","").split(","),"#"+((1<<24)+(parseInt(r[0])<<16)+(parseInt(r[1])<<8)+parseInt(r[2])).toString(16).slice(1)},jfgrid.jfgridABCatNum=function(e){var r=(e=e.toUpperCase()).length;if(0==r)return NaN;for(var t=e.split(""),i=columeHeader_word.length,a=0,n=r-1;0<=n;n--)a+=n==r-1?columeHeader_word_index[t[n]]:Math.pow(i,r-n-1)*(columeHeader_word_index[t[n]]+1);return a},jfgrid.jfgridchatatABC=function(e){var r=columeHeader_word.length;if(e<r)return columeHeader_word[e];for(var t=0,i="",a=1,n=0;e>=r/(r-1)*(Math.pow(r,a++)-1);)n=a;for(var t=1+(e-r/(r-1)*(Math.pow(r,n-1)-1)),o=n;0<o;o--){var l=t;if(1==o)return 0==(l%=r)&&(l=26),i+columeHeader_word[l-1];l=Math.ceil(l/Math.pow(r,o-1)),i+=columeHeader_word[l-1],1<o&&(t-=(l-1)*r)}},jfgrid.getByteLen=function(e){if(null==e)return 0;for(var r=0,t=0;t<e.length;t++){null!=e.charAt(t).match(/[^\x00-\xff]/gi)?r+=2:r+=1}return r},jfgrid.ceateABC=function(e){var r=columeHeader_word.length;if(e<r)return columeHeader_word;for(var t=[],i=2,a=0;e<r/(r-1)*(Math.pow(r,i)-1);)a=i,i++;for(var n=0;n<a;n++)t=0==n?t.concat(columeHeader_word):t.concat(jfgrid.createABCdim(n),e)},jfgrid.convertRowColumn=function(e){if(0==e.length)return[];for(var r=[],t=0;t<e[0].length;t++){r[t]=[];for(var i=0;i<e.length;i++)r[t][i]=e[i][t]}return r},jfgrid.createABCdim=function(e,r){var t=columeHeader_word.length;if(1==e)for(var i=[],a=0,n=0;n<t;n++)for(var o=columeHeader_word[n],l=0;l<t;l++){var d=o+columeHeader_word[l];if(i.push(d),++a>index)return i}else if(2==e)for(i=[],a=0,n=0;n<t;n++)for(var f=columeHeader_word[n],s=0;s<t;s++)for(var g=columeHeader_word[s],l=0;l<t;l++){var c=f+g+columeHeader_word[l];if(i.push(c),++a>index)return i}},jfgrid.jfshowloading=function(e){$("#jfgrid-cell-loading").find("span").text(e).end().show()},jfgrid.jfhideloading=function(){$("#jfgrid-cell-loading").hide()},jfgrid.browser={mobilecheck:function(){var e,r=!1;return e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(r=!0),document.body&&document.body.clientWidth&&document.body.clientHeight&&document.body.clientWidth<350&&document.body.clientHeight<500&&(r=!0),r},iphoneCheck:function(){return/iPhone/i.test(navigator.userAgent)&&0,!0},isWeixin:function(){return"micromessenger"==navigator.userAgent.toLowerCase().match(/MicroMessenger/i)},isAndroid:function(){var e=navigator.userAgent;return navigator.appVersion,-1<e.indexOf("Android")||-1<e.indexOf("Linux")},tabletCheck:function(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())},BrowserType:function(){var e=navigator.userAgent,r=-1<e.indexOf("Opera"),t=-1<e.indexOf("compatible")&&-1<e.indexOf("MSIE")&&!r,i=-1<e.indexOf("Trident")&&-1<e.indexOf("rv:11.0"),a=-1<e.indexOf("Edge"),n=-1<e.indexOf("Firefox"),o=-1<e.indexOf("Safari")&&-1==e.indexOf("Chrome"),l=-1<e.indexOf("Chrome")&&-1<e.indexOf("Safari");if(t){new RegExp("MSIE (\\d+\\.\\d+);").test(e);var d=parseFloat(RegExp.$1);return 7==d?"IE7":8==d?"IE8":9==d?"IE9":10==d?"IE10":"0"}return n?"FF":r?"Opera":o?"Safari":l?"Chrome":a?"Edge":i?"IE11":void 0},isIE:function(){var e=navigator.userAgent,r=-1<e.indexOf("Opera"),t=-1<e.indexOf("compatible")&&-1<e.indexOf("MSIE")&&!r,i=-1<e.indexOf("Trident")&&-1<e.indexOf("rv:11.0");return t||i?"1":"-1"},IEVersion:function(){var e=navigator.userAgent,r=-1<e.indexOf("Opera"),t=-1<e.indexOf("compatible")&&-1<e.indexOf("MSIE")&&!r,i=-1<e.indexOf("Trident")&&-1<e.indexOf("rv:11.0"),a=-1<e.indexOf("Windows NT 6.1; Trident/7.0;")&&!t;if(t){new RegExp("MSIE (\\d+\\.\\d+);").test(e);var n=parseFloat(RegExp.$1);return 7==n?"IE7":8==n?"IE8":9==n?"IE9":10==n?"IE10":"0"}return a?"Edge":i?"IE11":"-1"},jfgridrefreshfixednum:null,jfgridrefreshfixed:function(){var e=this;return null==e.jfgridrefreshfixednum&&("FF"==e.BrowserType()?e.jfgridrefreshfixednum=5:e.jfgridrefreshfixednum=0),e.jfgridrefreshfixednum}};var mobilecheck=jfgrid.browser.mobilecheck(),jfgrid_touchmove_status,jfgrid_touchmove_startPos,jfgrid_touchhandle_status;mobilecheck&&(cellMainSrollBarSize=0,jfgrid_touchmove_status=!1,jfgrid_touchmove_startPos={},jfgrid_touchhandle_status=!1,$(document).on("touchstart","#jfgrid-grid-window-1",function(e){jfgrid_touchmove_status=!0;var r=e.originalEvent.targetTouches[0];jfgrid_touchmove_startPos={x:r.pageX,y:r.pageY}}),$(document).on("touchmove","#jfgrid-grid-window-1",function(e){var r,t,i,a,n,o,l,d,f,s,g,c,u,m,h,j,p,v,b,_,w,y,x,C;1<e.originalEvent.targetTouches.length||e.scale&&1!==e.scale||(r=e.originalEvent.targetTouches[0],jfgrid_touchmove_status?(t=r.pageX-jfgrid_touchmove_startPos.x,i=r.pageY-jfgrid_touchmove_startPos.y,jfgrid_touchmove_startPos={x:r.pageX,y:r.pageY},a=$("#jfgrid-cell-main").scrollLeft(),n=$("#jfgrid-cell-main").scrollTop(),(a-=t)<0&&(a=0),(n-=i)<0&&(n=0),Math.abs(t)<Math.abs(i)?$("#jfgrid-scrollbar-y").scrollTop(n):$("#jfgrid-scrollbar-x").scrollLeft(a)):jfgrid_touchhandle_status&&(l=(o=jfgrid.mouseposition(r.pageX,r.pageY))[0]+$("#jfgrid-cell-main").scrollLeft(),d=o[1]+$("#jfgrid-cell-main").scrollTop(),s=(f=jfgrid.rowLocation(d))[1],g=f[0],c=f[2],m=(u=jfgrid.colLocation(l))[1],h=u[0],j=u[2],b=v=0,_=[],_=(p=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1])).top>g?(v=g,b=p.top+p.height-g,p.row[1]>p.row_focus&&(p.row[1]=p.row_focus),[c,p.row[1]]):p.top==g?(v=g,b=p.top+p.height-g,[c,p.row[0]]):(v=p.top,b=s-p.top-1,p.row[0]<p.row_focus&&(p.row[0]=p.row_focus),[p.row[0],c]),y=w=0,x=[],x=p.left>h?(w=h,y=p.left+p.width-h,p.column[1]>p.column_focus&&(p.column[1]=p.column_focus),[j,p.column[1]]):p.left==h?(w=h,y=p.left+p.width-h,[j,p.column[0]]):(w=p.left,y=m-p.left-1,p.column[0]<p.column_focus&&(p.column[0]=p.column_focus),[p.column[0],j]),null!=(C=jfgrid.menuButton.mergeMoveMain(x,_,p,v,b,w,y))&&(x=C[0],_=C[1],v=C[2],b=C[3],w=C[4],y=C[5]),p.row=_,p.column=x,p.left_move=w,p.width_move=y,p.top_move=v,p.height_move=b,jfgird_select_save[jfgird_select_save.length-1]=p,jfgrid.selectHightlightShow(),jfgrid.freezen.scrollFreezen()),e.stopPropagation())}),$(document).on("touchend",function(e){jfgrid_touchmove_status=!1,jfgrid_touchhandle_status=!(jfgrid_touchmove_startPos={})}),$(document).on("touchstart",".jfgrid-cs-touchhandle",function(e){jfgrid_touchhandle_status=!0,e.stopPropagation()}),document.addEventListener("touchmove",function(e){e.preventDefault()},{passive:!1})),jfgrid.controlHistory={redo:function(e){if(0!=jfgrid.jfredo.length){var ctr=jfgrid.jfredo.pop();if(jfgrid.jfundo.push(ctr),clearjfundo=!1,jfgrid.sheetmanage.hasSheet(ctr.sheetIndex)&&jfgrid.currentSheetIndex!=ctr.sheetIndex&&jfgrid.sheetmanage.changeSheetExec(ctr.sheetIndex),"datachange"==ctr.type){for(var s=0;s<ctr.range.length;s++)for(var st_r=ctr.range[s].row[0],ed_r=ctr.range[s].row[1],st_c=ctr.range[s].column[0],ed_c=ctr.range[s].column[1],r=st_r;r<ed_r+1;r++)for(var c=st_c;c<ed_c+1;c++)null==ctr.data[r][c]&&jfgrid.formula.delFunctionGroup(r,c);jfgrid.formula.execFunctionGroup(null,null,null,null,ctr.data),jfgrid.jfrefreshgrid(ctr.data,ctr.range,ctr.config,ctr.cdformat,ctr.RowlChange)}else if("pasteCut"==ctr.type){var s={sheetIndex:ctr.source.sheetIndex,data:ctr.source.curData,curData:ctr.source.data,config:ctr.source.curConfig,curConfig:ctr.source.config,cdformat:ctr.source.curCdformat,curCdformat:ctr.source.cdformat,range:ctr.source.range},t={sheetIndex:ctr.target.sheetIndex,data:ctr.target.curData,curData:ctr.target.data,config:ctr.target.curConfig,curConfig:ctr.target.config,cdformat:ctr.target.curCdformat,curCdformat:ctr.target.cdformat,range:ctr.target.range};jfgrid.jfrefreshgrid_pastcut(s,t,ctr.RowlChange)}else if("cellchange"==ctr.type)jfgrid.formula.execFunctionGroup(ctr.uprow,ctr.upcolumn,ctr.value),jfgrid.jfrefreshcell(ctr.value,ctr.uprow,ctr.upcolumn);else if("rangechange"==ctr.type){for(var s=0;s<ctr.range.length;s++)for(var st_r=ctr.range[s].row[0],ed_r=ctr.range[s].row[1],st_c=ctr.range[s].column[0],ed_c=ctr.range[s].column[1],r=st_r;r<ed_r+1;r++)for(var c=st_c;c<ed_c+1;c++)null==ctr.data[r][c]&&jfgrid.formula.delFunctionGroup(r,c);jfgrid.formula.execFunctionGroup(null,null,null,null,ctr.data),jfgrid.jfrefreshrange(ctr.data,ctr.range,ctr.cdformat)}else if("resize"==ctr.type)config=ctr.config,jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].config=config,"resizeR"==ctr.ctrlType?jfgrid.server.saveParam("cg",ctr.sheetIndex,ctr.config.rowlen,{k:"rowlen"}):"resizeC"==ctr.ctrlType&&jfgrid.server.saveParam("cg",ctr.sheetIndex,ctr.config.columlen,{k:"columlen"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length);else if("cellRowChange"==ctr.type)jfgrid.jfrefreshgridall(ctr.data[0].length,ctr.data.length,ctr.data,ctr.config,ctr.range,ctr.ctrlType,ctr.ctrlValue,ctr.cdformat);else if("extend"==ctr.type)jfgrid.jfrefreshgridall(ctr.data[0].length,ctr.data.length,ctr.data,ctr.config,ctr.range,"dele",ctr.ctrlValue);else if("dele"==ctr.type){var ctrlValue1=$.extend(!0,{},ctr.ctrlValue);ctrlValue1.restore=!0,jfgrid.jfrefreshgridall(ctr.data[0].length,ctr.data.length,ctr.data,ctr.config,ctr.range,"extend",ctrlValue1)}else if("addRC"==ctr.type){var ctrlValue=$.extend(!0,{},ctr.ctrlValue);"rightbottom"==ctrlValue.direction&&(ctrlValue.index=ctrlValue.index+1),jfgrid.jfrefreshgrid_adRC(ctr.data,ctr.config,"delRC",ctrlValue,ctr.calc,ctr.filterObj,ctr.cf,ctr.af,ctr.freezen)}else if("delRC"==ctr.type){var ctrlValue=$.extend(!0,{},ctr.ctrlValue);ctrlValue.restore=!0,ctrlValue.direction="lefttop",jfgrid.jfrefreshgrid_adRC(ctr.data,ctr.config,"addRC",ctrlValue,ctr.calc,ctr.filterObj,ctr.cf,ctr.af,ctr.freezen)}else if("datachangeAll"==ctr.type)jfgrid.formula.execFunctionGroup(),jfgrid.jfrefreshgridall(ctr.data[0].length,ctr.data.length,ctr.data,null,ctr.range,"datachangeAll",ctr.ctrlValue);else if("datachangeAll_filter_clear"==ctr.type)jfgrid.createFilterOptions(ctr.filter_save),$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").each(function(e){var r=$(this),t=ctr.optiongroups[e];jfgrid.labelFilterOptionState(r,t.optionstate,t.rowhidden,t.caljs,!1,t.st_r,t.ed_r,t.cindex,t.st_c,t.ed_c)}),jfgrid.server.saveParam("fsr",jfgrid.currentSheetIndex,{filter:ctr.optiongroups,filter_select:ctr.filter_save}),config=ctr.config,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,null==config.rowhidden&&(config.rowhidden={}),jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,config.rowhidden,{k:"rowhidden"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide();else if("datachangeAll_filter"==ctr.type){var $top=$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").eq(ctr.optionsindex),st_r=$top.data("str"),ed_r=$top.data("edr"),cindex=$top.data("cindex"),st_c=$top.data("stc"),ed_c=$top.data("edc");jfgrid.labelFilterOptionState($top,jfgrid.json.hasKey(ctr.rowhidenPre),ctr.rowhidenPre,ctr.caljs,!0,st_r,ed_r,cindex,st_c,ed_c),config=ctr.config,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,null==config.rowhidden&&(config.rowhidden={}),jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,config.rowhidden,{k:"rowhidden"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide()}else if("filtershow"==ctr.type)$("#jfgrid-filter-selected-sheet"+ctr.sheetIndex+", #jfgrid-filter-options-sheet"+ctr.sheetIndex).remove(),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",ctr.sheetIndex,null,{k:"filter_select"});else if("pivotTable_change"==ctr.type)jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].pivotTable=ctr.pivotTable,jfgrid.pivotTable.getCellData(ctr.sheetIndex),jfgrid.pivotTable.initialPivotManage(!0),jfgrid.pivotTable.refreshPivotTable();else if("addSheet"==ctr.type)jfgrid.sheetmanage.deleteSheet(ctr.index),jfgrid.sheetmanage.changeSheetExec(ctr.currentSheetIndex),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide();else if("copySheet"==ctr.type)jfgrid.sheetmanage.deleteSheet(ctr.index),jfgrid.sheetmanage.changeSheetExec(ctr.copyindex);else if("deleteSheet"==ctr.type){for(var isDupName=!1,i=0;i<jfgridfile.length;i++)jfgridfile[i].name==ctr.name&&(isDupName=!0);isDupName||(jfgrid.sheetmanage.createSheetbydata(ctr,"isrenew"),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide())}else if("sheetName"==ctr.type)jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].name=ctr.oldtxt,$("#jfgrid-sheets-item"+ctr.sheetIndex).find(".jfgrid-sheets-item-name").html(ctr.oldtxt),jfgrid.server.saveParam("all",ctr.sheetIndex,ctr.oldtxt,{k:"name"});else if("sheetColor"==ctr.type){jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].color=ctr.oldcolor;var jfgridcurrentSheetitem=$("#jfgrid-sheets-item"+ctr.sheetIndex);jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").remove(),null!=ctr.oldcolor&&jfgridcurrentSheetitem.append('<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+ctr.oldcolor+';"></div>'),jfgrid.server.saveParam("all",ctr.sheetIndex,ctr.oldcolor,{k:"color"})}else if("insertChart"==ctr.type)jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,window.store&&store.commit("deleteChart",ctr.chart_json.chart_id),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0;else if("moveChart"==ctr.type)$("#"+ctr.chart_id+"_c").css({top:ctr.y,left:ctr.x}),$("#jfgrid-scrollbar-y").scrollTop(ctr.scrollTop1),$("#jfgrid-scrollbar-x").scrollLeft(ctr.scrollLeft1),window.store&&store.commit({type:"updateChartItem",key:"left",value:ctr.x,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"top",value:ctr.y,chartId:ctr.chart_id}),jfgrid.server.saveParam("c",ctr.sheetIndex,{left:ctr.x,top:ctr.y,scrollTop:ctr.scrollTop1,scrollLeft:ctr.scrollLeft1},{op:"xy",cid:ctr.chart_id});else if("resizeChart"==ctr.type)$("#"+ctr.chart_id+"_c").css({height:ctr.myHeight1,width:ctr.myWidth1,top:ctr.y,left:ctr.x}),$("#jfgrid-scrollbar-y").scrollTop(ctr.scrollTop1),$("#jfgrid-scrollbar-x").scrollLeft(ctr.scrollLeft1),window.store&&store.commit({type:"updateChartItem",key:"height",value:ctr.myHeight1,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"width",value:ctr.myWidth1,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"left",value:ctr.x,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"top",value:ctr.y,chartId:ctr.chart_id}),window.generator&&generator.resize(ctr.chart_id),jfgrid.server.saveParam("c",ctr.sheetIndex,{width:ctr.myWidth1,height:ctr.myHeight1,top:ctr.y,left:ctr.x,scrollTop:ctr.scrollTop1,scrollLeft:ctr.scrollLeft1},{op:"wh",cid:ctr.chart_id});else if("updateChartRange"==ctr.type)jfgrid.chartparam.jfgrid_chart_redo_click=!0,jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,jfgrid.updateChartTosheet("updateChartRange",ctr.p_sheetIndex,ctr.p_dataSheetIndex,ctr.p_option,ctr.p_chartType,ctr.p_selfOption,ctr.p_defaultOption,ctr.p_row,ctr.p_column,ctr.p_chart_selection_color,ctr.p_chart_id,ctr.p_chart_selection_id,ctr.p_chartStyle,ctr.p_rangeConfigCheck,ctr.p_rangeRowCheck,ctr.p_rangeColCheck,ctr.p_chartMarkConfig,ctr.p_chartTitleConfig,ctr.p_chartTheme),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0,jfgrid.chartparam.jfgrid_chart_redo_click=!1,jfgrid.chartrangechange(ctr.p_row,ctr.p_column,ctr.p_sheetIndex,ctr.p_dataSheetIndex,ctr.p_chart_selection_id,ctr.p_rangeConfigCheck,ctr.p_rangeRowCheck,ctr.p_rangeColCheck,ctr.p_chart_id),jfgrid.isEditMode()||window.generator&&generator.hideChartSettingComponent();else if("updateChartType"==ctr.type)jfgrid.chartparam.jfgrid_chart_redo_click=!0,jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,jfgrid.updateChartTosheet("updateChartType",ctr.p_sheetIndex,ctr.p_dataSheetIndex,ctr.p_option,ctr.p_chartType,ctr.p_selfOption,ctr.p_defaultOption,ctr.p_row,ctr.p_column,ctr.p_chart_selection_color,ctr.p_chart_id,ctr.p_chart_selection_id,ctr.p_chartStyle,ctr.p_rangeConfigCheck,ctr.p_rangeRowCheck,ctr.p_rangeColCheck,ctr.p_chartMarkConfig,ctr.p_chartTitleConfig,ctr.p_chartTheme),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0,jfgrid.chartparam.jfgrid_chart_redo_click=!1,jfgrid.chartTypeChange(ctr.p_chartType,ctr.p_selfOption,ctr.p_defaultOption,ctr.p_chartStyle,ctr.p_chartMarkConfig,ctr.p_chartTitleConfig,ctr.p_chart_id),jfgrid.isEditMode()||window.generator&&generator.hideChartSettingComponent();else if("updateChartTheme"==ctr.type){null!=jfgrid.chartparam.jfgridcurrentChart&&jfgrid.chartparam.jfgridcurrentChart.dispose();var chartTheme="default0000";null!=ctr.p_chartTheme&&0<ctr.p_chartTheme.length&&"object"!=jfgrid.getObjType(ctr.p_chartTheme)&&"default0000"!=ctr.p_chartTheme&&(chartTheme=eval("("+ctr.p_chartTheme+")")),jfgrid.chartparam.jfgridcurrentChart=jgridChart=echarts.init($("#"+ctr.p_chart_id).find(".jfgrid-modal-dialog-content").get(0),chartTheme),jfgrid.chartparam.jfgrid_chart_default_config=eval("("+ctr.p_defaultOption+")"),jfgrid.chartparam.jfgrid_chart_self_config=eval("("+ctr.p_selfOption+")");var $t=$("#"+ctr.p_chart_id);jfgrid.chartparam.jfgrid_chart_redo_click=!0,$t.mousedown(),jfgrid.chartparam.jfgridCurrentChartMove=!1,$t.mouseup(),jfgrid.chartparam.jfgrid_chart_redo_click=!1,jfgrid.chartparam.jfgridcurrentChart.setOption(jfgrid.chartparam.jfgrid_chart_default_config),jfgrid.chartparam.jfgridcurrentChart.setOption(jfgrid.jfgridChartConfigHanddle(ctr.p_chartType,"theme",jfgrid.chartparam.jfgrid_chart_self_config)),$t.attr("chartTheme",ctr.p_chartTheme),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("c",ctr.p_sheetIndex,{chartTheme:ctr.p_chartTheme},{op:"update",cid:ctr.p_chart_id}),jfgrid.isEditMode()||window.generator&&generator.hideChartSettingComponent()}else if("updateChart"==ctr.type)jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,jfgrid.updateChartTosheet(ctr.p_sheetIndex,ctr.p_dataSheetIndex,ctr.p_option,ctr.p_chartType,ctr.p_selfOption,ctr.p_defaultOption,ctr.p_row,ctr.p_column,ctr.p_chart_selection_color,ctr.p_chart_id,ctr.p_chart_selection_id,ctr.p_chartStyle,ctr.p_rangeConfigCheck,ctr.p_rangeRowCheck,ctr.p_rangeColCheck,ctr.p_chartMarkConfig,ctr.p_chartTitleConfig,ctr.p_chartTheme),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0,jfgrid.isEditMode()||window.generator&&generator.hideChartSettingComponent();else if("updateChartAll"==ctr.type){var chart_json=ctr.pre_Chart_json;jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,window.generator&&generator.patchVueSet(chart_json),window.generator&&generator.generateChart(chart_json.defaultOption,chart_json.chartTheme,chart_json.chartAllType,$("#"+chart_json.chart_id).get(0)),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0}else if("deleteChart"==ctr.type)jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,window.store&&store.commit("insertChart",ctr.chart_json),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0;else if("mergeChange"==ctr.type)jfgrid.jfrefreshgrid(ctr.data,ctr.range,ctr.config);else if("updateCF"==ctr.type){for(var historyRules=ctr.data.historyRules,i=0;i<historyRules.length;i++){var sheetIndex=historyRules[i].sheetIndex;jfgridfile[jfgrid.sheetmanage.getSheetIndex(sheetIndex)].jfgrid_conditionformat_save=historyRules[i].jfgrid_conditionformat_save,jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",sheetIndex,historyRules[i].jfgrid_conditionformat_save,{k:"jfgrid_conditionformat_save"})}jfgrid.conditionformat.ref()}else if("updateAF"==ctr.type){var historyRules=ctr.data.historyRules,index=jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex);jfgridfile[index].jfgrid_alternateformat_save=$.extend(!0,[],historyRules),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1)}else if("borderChange"==ctr.type)null==ctr.config.borderInfo?jfgrid.server.saveParam("cg",ctr.sheetIndex,[],{k:"borderInfo"}):jfgrid.server.saveParam("cg",ctr.sheetIndex,ctr.config.borderInfo,{k:"borderInfo"}),config=ctr.config,jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].config=config,setTimeout(function(){jfgrid.jfgridrefreshgrid()},1);else if("postil"==ctr.type){jfgrid.postil.ref(ctr.data,ctr.rc);for(var i=0;i<ctr.rc.length;i++){var r=ctr.rc[i].split("_")[0],c=ctr.rc[i].split("_")[1];null!=ctr.data[r][c]&&null!=ctr.data[r][c].ps?jfgrid.postil.buildPs(r,c,ctr.data[r][c].ps):jfgrid.postil.buildPs(r,c,null)}}jfgrid.cleargridelement(e),clearjfundo=!0}},undo:function(){if(0!=jfgrid.jfundo.length){var ctr=jfgrid.jfundo.pop();if(jfgrid.jfredo.push(ctr),clearjfundo=!1,jfgrid.sheetmanage.hasSheet(ctr.sheetIndex)&&jfgrid.currentSheetIndex!=ctr.sheetIndex&&jfgrid.sheetmanage.changeSheetExec(ctr.sheetIndex),"datachange"==ctr.type)jfgrid.formula.execFunctionGroup(),jfgrid.jfrefreshgrid(ctr.curdata,ctr.range,ctr.curConfig,ctr.curCdformat,ctr.RowlChange);else if("pasteCut"==ctr.type)jfgrid.jfrefreshgrid_pastcut(ctr.source,ctr.target,ctr.RowlChange);else if("cellchange"==ctr.type)jfgrid.formula.execFunctionGroup(ctr.uprow,ctr.upcolumn,ctr.curvalue),jfgrid.jfrefreshcell(ctr.curvalue,ctr.uprow,ctr.upcolumn);else if("rangechange"==ctr.type)jfgrid.formula.execFunctionGroup(),jfgrid.jfrefreshrange(ctr.curdata,ctr.range,ctr.curCdformat);else if("resize"==ctr.type)config=ctr.curconfig,jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].config=config,"resizeR"==ctr.ctrlType?jfgrid.server.saveParam("cg",ctr.sheetIndex,ctr.curconfig.rowlen,{k:"rowlen"}):"resizeC"==ctr.ctrlType&&jfgrid.server.saveParam("cg",ctr.sheetIndex,ctr.curconfig.columlen,{k:"columlen"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length);else if("cellRowChange"==ctr.type)jfgrid.jfrefreshgridall(ctr.curdata[0].length,ctr.curdata.length,ctr.curdata,ctr.curconfig,ctr.currange,ctr.ctrlType,ctr.ctrlValue,ctr.curCdformat);else if("extend"==ctr.type)jfgrid.jfrefreshgridall(ctr.curdata[0].length,ctr.curdata.length,ctr.curdata,ctr.curconfig,ctr.currange,ctr.ctrlType,ctr.ctrlValue);else if("dele"==ctr.type){var ctrlValue1=$.extend(!0,{},ctr.ctrlValue);ctrlValue1.restore=!0,jfgrid.jfrefreshgridall(ctr.curdata[0].length,ctr.curdata.length,ctr.curdata,ctr.curconfig,ctr.currange,ctr.ctrlType,ctr.ctrlValue)}else if("addRC"==ctr.type)jfgrid.jfrefreshgrid_adRC(ctr.curData,ctr.curConfig,"addRC",ctr.ctrlValue,ctr.curCalc,ctr.curFilterObj,ctr.curCf,ctr.curAf,ctr.curFreezen);else if("delRC"==ctr.type)jfgrid.jfrefreshgrid_adRC(ctr.curData,ctr.curConfig,"delRC",ctr.ctrlValue,ctr.curCalc,ctr.curFilterObj,ctr.curCf,ctr.curAf,ctr.curFreezen);else if("datachangeAll"==ctr.type)jfgrid.formula.execFunctionGroup(),jfgrid.jfrefreshgridall(ctr.curdata[0].length,ctr.curdata.length,ctr.curdata,null,ctr.currange,"datachangeAll",ctr.ctrlValue);else if("datachangeAll_filter_clear"==ctr.type)jfgrid.server.saveParam("fsc",jfgrid.currentSheetIndex,null),config=ctr.curconfig,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,{},{k:"rowhidden"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length),$("#jfgrid-filter-menu .jfgrid-filter-selected-input").hide().find("input").val(),$("#jfgrid-filter-selected span").data("type","0").data("type",null).text("无"),$("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex+", #jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).remove(),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide();else if("datachangeAll_filter"==ctr.type){var $top=$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").eq(ctr.optionsindex),st_r=$top.data("str"),ed_r=$top.data("edr"),cindex=$top.data("cindex"),st_c=$top.data("stc"),ed_c=$top.data("edc");jfgrid.labelFilterOptionState($top,jfgrid.json.hasKey(ctr.rowhidden),ctr.rowhidden,ctr.caljs,!0,st_r,ed_r,cindex,st_c,ed_c),config=ctr.curconfig,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,config.rowhidden,{k:"rowhidden"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide()}else if("filtershow"==ctr.type)jfgird_select_save=[ctr.filter_save],filterchage=!1,jfgrid.createFilter(),filterchage=!0,jfgrid.server.saveParam("all",ctr.sheetIndex,ctr.filter_save,{k:"filter_select"});else if("pivotTable_change"==ctr.type)jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].pivotTable=ctr.pivotTablecur,jfgrid.pivotTable.getCellData(ctr.sheetIndex),jfgrid.pivotTable.initialPivotManage(!0),jfgrid.pivotTable.refreshPivotTable();else if("addSheet"==ctr.type)jfgrid.sheetmanage.createSheetbydata(ctr.sheetconfig),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide();else if("copySheet"==ctr.type)jfgrid.sheetmanage.copySheet(ctr.copyindex);else if("deleteSheet"==ctr.type)jfgrid.sheetmanage.deleteSheet(ctr.index),0==ctr.order?jfgrid.sheetmanage.changeSheetExec(jfgridfile[0].index):jfgrid.sheetmanage.changeSheetExec(jfgridfile[ctr.order-1].index),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide();else if("sheetName"==ctr.type)jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].name=ctr.txt,$("#jfgrid-sheets-item"+ctr.sheetIndex).find(".jfgrid-sheets-item-name").html(ctr.txt),jfgrid.server.saveParam("all",ctr.sheetIndex,ctr.txt,{k:"name"});else if("sheetColor"==ctr.type){jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].color=ctr.color;var jfgridcurrentSheetitem=$("#jfgrid-sheets-item"+ctr.sheetIndex);jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").remove(),null!=ctr.color&&jfgridcurrentSheetitem.append('<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+ctr.color+';"></div>'),jfgrid.server.saveParam("all",ctr.sheetIndex,ctr.color,{k:"color"})}else if("insertChart"==ctr.type)jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,window.store&&store.commit("insertChart",ctr.chart_json),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0;else if("moveChart"==ctr.type)$("#"+ctr.chart_id+"_c").css({top:ctr.myTop,left:ctr.myLeft}),$("#jfgrid-scrollbar-y").scrollTop(ctr.scrollTop),$("#jfgrid-scrollbar-x").scrollLeft(ctr.scrollLeft),window.store&&store.commit({type:"updateChartItem",key:"left",value:ctr.myLeft,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"top",value:ctr.myTop,chartId:ctr.chart_id}),jfgrid.server.saveParam("c",ctr.sheetIndex,{left:ctr.myLeft,left:ctr.myTop,scrollTop:ctr.scrollTop,scrollLeft:ctr.scrollLeft},{op:"xy",cid:ctr.chart_id});else if("resizeChart"==ctr.type)$("#"+ctr.chart_id+"_c").css({height:ctr.myHeight,width:ctr.myWidth,top:ctr.myTop,left:ctr.myLeft}),$("#jfgrid-scrollbar-y").scrollTop(ctr.scrollTop),$("#jfgrid-scrollbar-x").scrollLeft(ctr.scrollLeft),window.store&&store.commit({type:"updateChartItem",key:"height",value:ctr.myHeight,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"width",value:ctr.myWidth,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"left",value:ctr.myLeft,chartId:ctr.chart_id}),window.store&&store.commit({type:"updateChartItem",key:"top",value:ctr.myTop,chartId:ctr.chart_id}),window.generator&&generator.resize(ctr.chart_id),jfgrid.server.saveParam("c",ctr.sheetIndex,{width:ctr.myWidth,height:ctr.myHeight,top:ctr.myTop,left:ctr.myLeft,scrollTop:ctr.scrollTop,scrollLeft:ctr.scrollLeft},{op:"wh",cid:ctr.chart_id});else if("updateChartRange"==ctr.type)jfgrid.chartparam.jfgrid_chart_redo_click=!0,jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,jfgrid.updateChartTosheet("updateChartRange",ctr.sheetIndex,ctr.dataSheetIndex,ctr.option,ctr.chartType,ctr.selfOption,ctr.defaultOption,ctr.row,ctr.column,ctr.chart_selection_color,ctr.chart_id,ctr.chart_selection_id,ctr.chartStyle,ctr.rangeConfigCheck,ctr.rangeRowCheck,ctr.rangeColCheck,ctr.chartMarkConfig,ctr.chartTitleConfig,ctr.chartTheme),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0,jfgrid.chartparam.jfgrid_chart_redo_click=!1,jfgrid.chartrangechange(ctr.row,ctr.column,ctr.sheetIndex,ctr.dataSheetIndex,ctr.chart_selection_id,ctr.rangeConfigCheck,ctr.rangeRowCheck,ctr.rangeColCheck,ctr.chart_id),window.generator&&generator.hideChartSettingComponent();else if("updateChartType"==ctr.type)jfgrid.chartparam.jfgrid_chart_redo_click=!0,jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,jfgrid.updateChartTosheet("updateChartType",ctr.sheetIndex,ctr.dataSheetIndex,ctr.option,ctr.chartType,ctr.selfOption,ctr.defaultOption,ctr.row,ctr.column,ctr.chart_selection_color,ctr.chart_id,ctr.chart_selection_id,ctr.chartStyle,ctr.rangeConfigCheck,ctr.rangeRowCheck,ctr.rangeColCheck,ctr.chartMarkConfig,ctr.chartTitleConfig,ctr.chartTheme),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0,jfgrid.chartparam.jfgrid_chart_redo_click=!1,jfgrid.chartTypeChange(ctr.chartType,ctr.selfOption,ctr.defaultOption,ctr.chartStyle,ctr.chartMarkConfig,ctr.chartTitleConfig,ctr.chart_id),window.generator&&generator.hideChartSettingComponent();else if("updateChartTheme"==ctr.type){null!=jfgrid.chartparam.jfgridcurrentChart&&jfgrid.chartparam.jfgridcurrentChart.dispose();var chartTheme="default0000";null!=ctr.chartTheme&&0<ctr.chartTheme.length&&"object"!=jfgrid.getObjType(ctr.chartTheme)&&"default0000"!=ctr.chartTheme&&(chartTheme=eval("("+ctr.chartTheme+")")),jfgrid.chartparam.jfgridcurrentChart=jgridChart=echarts.init($("#"+ctr.chart_id).find(".jfgrid-modal-dialog-content").get(0),chartTheme),jfgrid.chartparam.jfgrid_chart_default_config=eval("("+ctr.defaultOption+")"),jfgrid.chartparam.jfgrid_chart_self_config=eval("("+ctr.selfOption+")");var $t=$("#"+ctr.chart_id);jfgrid.chartparam.jfgrid_chart_redo_click=!0,$t.mousedown(),jfgrid.chartparam.jfgridCurrentChartMove=!1,$t.mouseup(),jfgrid.chartparam.jfgrid_chart_redo_click=!1,jfgrid.chartparam.jfgridcurrentChart.setOption(jfgrid.chartparam.jfgrid_chart_default_config),jfgrid.chartparam.jfgridcurrentChart.setOption(jfgrid.jfgridChartConfigHanddle(ctr.chartType,"theme",jfgrid.chartparam.jfgrid_chart_self_config)),$t.attr("chartTheme",ctr.chartTheme),jfgrid.server.saveParam("c",ctr.sheetIndex,{chartTheme:ctr.chartTheme},{op:"update",cid:ctr.chart_id}),window.generator&&generator.hideChartSettingComponent()}else if("updateChart"==ctr.type)jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,jfgrid.updateChartTosheet(ctr.sheetIndex,ctr.dataSheetIndex,ctr.option,ctr.chartType,ctr.selfOption,ctr.defaultOption,ctr.row,ctr.column,ctr.chart_selection_color,ctr.chart_id,ctr.chart_selection_id,ctr.chartStyle,ctr.rangeConfigCheck,ctr.rangeRowCheck,ctr.rangeColCheck,ctr.chartMarkConfig,ctr.chartTitleConfig,ctr.chartTheme),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0,window.generator&&generator.hideChartSettingComponent();else if("updateChartAll"==ctr.type){var chart_json=ctr.chart_json;jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,window.generator&&generator.patchVueSet(chart_json),window.generator&&generator.generateChart(chart_json.defaultOption,chart_json.chartTheme,chart_json.chartAllType,$("#"+chart_json.chart_id).get(0)),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0}else if("deleteChart"==ctr.type)jfgrid.chartparam.jfgridInsertChartTosheetChange=!1,window.store&&store.commit("deleteChart",ctr.chart_json.chart_id),jfgrid.chartparam.jfgridInsertChartTosheetChange=!0;else if("mergeChange"==ctr.type)jfgrid.jfrefreshgrid(ctr.curData,ctr.range,ctr.curConfig);else if("updateCF"==ctr.type){for(var currentRules=ctr.data.currentRules,i=0;i<currentRules.length;i++){var sheetIndex=currentRules[i].sheetIndex;jfgridfile[jfgrid.sheetmanage.getSheetIndex(sheetIndex)].jfgrid_conditionformat_save=currentRules[i].jfgrid_conditionformat_save,jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",sheetIndex,currentRules[i].jfgrid_conditionformat_save,{k:"jfgrid_conditionformat_save"})}jfgrid.conditionformat.ref()}else if("updateAF"==ctr.type){var currentRules=ctr.data.currentRules,index=jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex);jfgridfile[index].jfgrid_alternateformat_save=$.extend(!0,[],currentRules),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1)}else if("borderChange"==ctr.type)jfgrid.server.saveParam("cg",ctr.sheetIndex,ctr.curconfig.borderInfo,{k:"borderInfo"}),config=ctr.curconfig,jfgridfile[jfgrid.sheetmanage.getSheetIndex(ctr.sheetIndex)].config=config,setTimeout(function(){jfgrid.jfgridrefreshgrid()},1);else if("postil"==ctr.type){jfgrid.postil.ref(ctr.curdata,ctr.rc);for(var i=0;i<ctr.rc.length;i++){var r=ctr.rc[i].split("_")[0],c=ctr.rc[i].split("_")[1];null!=ctr.curdata[r][c]&&null!=ctr.curdata[r][c].ps?jfgrid.postil.buildPs(r,c,ctr.curdata[r][c].ps):jfgrid.postil.buildPs(r,c,null)}}clearjfundo=!0}}},jfgrid.editor={deepCopyFlowDataState:!1,deepCopyFlowDataCache:"",deepCopyFlowDataWorker:null,deepCopyFlowData:function(e){return this.deepCopyFlowDataState?(null!=this.deepCopyFlowDataWorker&&this.deepCopyFlowDataWorker.terminate(),this.deepCopyFlowDataCache):(null==e&&(e=jfgrid.flowdata),$.extend(!0,[],e))},webWorkerFlowDataCache:function(r){var t=this;try{null!=t.deepCopyFlowDataWorker&&t.deepCopyFlowDataWorker.terminate();var e;t.deepCopyFlowDataState=!1,1==jfgrid.browser.isIE()?(e=new Worker("./plugins/Worker-helper.js")).postMessage("self.onmessage=function(e){postMessage(e.data);}"):e=new Worker("data:text/javascript;chartset=US-ASCII,onmessage = function (e) { postMessage(e.data); };"),(t.deepCopyFlowDataWorker=e).postMessage(r),e.onmessage=function(e){t.deepCopyFlowDataCache=e.data,t.deepCopyFlowDataState=!0}}catch(e){t.deepCopyFlowDataCache=$.extend(!0,[],r)}},controlHandler:function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),t=jfgird_select_save[jfgird_select_save.length-1],i=null==t.row?0:t.row[0],a=null==t.column?0:t.column[0],n=e.length,o=e[0].length,l=i+n-r.length,d=a+o-r[0].length;(0<l||0<d)&&(r=jfgrid.datagridgrowth([].concat(r),l,d,!0));for(var f=0;f<n;f++){for(var s=[].concat(r[f+i]),g=0;g<o;g++){var c="";null!=e[f]&&null!=e[f][g]&&(c=e[f][g]),s[g+a]=c}r[f+i]=s}0<l||0<d?jfgrid.jfrefreshgridall(r[0].length,r.length,r,null,jfgird_select_save,"datachangeAll"):jfgrid.jfrefreshrange(r,jfgird_select_save)},clearRangeByindex:function(e,r,t,i,a){for(var n=jfgrid.sheetmanage.getSheetIndex(a),o=$.extend(!0,[],jfgridfile[n].data),l=e;l<=r;l++){for(var d=[].concat(o[l]),f=t;f<=i;f++)jfgrid.formula.delFunctionGroup(l,f),jfgrid.formula.execFunctionGroup(l,f,""),d[f]=null;o[l]=d}a==jfgrid.currentSheetIndex?5e3<r-e+1?jfgrid.jfrefreshgrid(o,e,r,t,i):jfgrid.jfrefreshrange(o,{row:[e,r],column:[t,i]}):jfgridfile[n].data=o},controlHandlerD:function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),t=jfgird_select_save[jfgird_select_save.length-1],i=t.row[0],a=t.row[1],n=t.column[0],o=t.column[1],l=e.length,d=e[0].length,f=i+l-r.length,s=n+d-r[0].length;(0<f||0<s)&&(r=jfgrid.datagridgrowth([].concat(r),f,s,!0));for(var g=i;g<=a;g++)for(var c=n;c<=o;c++)r[g][c]=null;for(var u=0;u<l;u++)for(var m=0;m<d;m++)r[i+u][n+m]=e[u][m];var h=[{row:[i,a],column:[n,o]},{row:[i,i+l-1],column:[n,n+d-1]}];jfgrid.jfrefreshgrid(r,h)}},jfgrid.selection={clearcopy:function(e){var r=window.clipboardData;r||e&&(r=e.originalEvent.clipboardData);if(copyType="normal",copysetting=[],jfgrid_selection_range=[],jfgrid.selectionCopyShow(),jfgrid_copy_save={},r)return r.setData("Text"," "),!1;var t=$("#jfgird-copy-content").css("visibility","hidden");t.val(" "),t.focus(),t.select(),setTimeout(function(){t.blur().css("visibility","visible")},10)},getHtmlBorderStyle:function(e,r){var t="";return-1<(e={0:"none",1:"Thin",2:"Hair",3:"Dotted",4:"Dashed",5:"DashDot",6:"DashDotDot",7:"Double",8:"Medium",9:"MediumDashed",10:"MediumDashDot",11:"MediumDashDotDot",12:"SlantedDashDot",13:"Thick"}[e.toString()]).indexOf("Medium")?t+="1pt ":t+="Thick"==e?"1.5pt ":"0.5pt ","Hair"==e?t+="double ":-1<e.indexOf("DashDotDot")?t+="dotted ":-1<e.indexOf("DashDot")?t+="dashed ":-1<e.indexOf("Dotted")?t+="dotted ":-1<e.indexOf("Dashed")?t+="dashed ":t+="solid ",t+r+";"},copy:function(e){var r=(r=window.clipboardData)||e.originalEvent.clipboardData;jfgrid_selection_range=[];for(var t=jfgird_select_save[0].row[0],i=jfgird_select_save[0].row[1],a=jfgird_select_save[0].column[0],n=jfgird_select_save[0].column[1],o=[],l=!1,d=!1,f=0;f<jfgird_select_save.length;f++){jfgird_select_save[f].row[0]<t&&(t=jfgird_select_save[f].row[0]),jfgird_select_save[f].row[1]>i&&(i=jfgird_select_save[f].row[1]),jfgird_select_save[f].column[0]<a&&(a=jfgird_select_save[f].column[0]),jfgird_select_save[f].column[1]>n&&(n=jfgird_select_save[f].column[1]);for(var s=jfgird_select_save[f].row[0];s<=jfgird_select_save[f].row[1];s++)if(null==config.rowhidden||null==config.rowhidden[s]){null!=config.rowlen&&s in config.rowlen&&(l=!0);for(var g=jfgird_select_save[f].column[0];g<=jfgird_select_save[f].column[1];g++){var c=jfgrid.flowdata[s][g];"object"==jfgrid.getObjType(c)&&"mc"in c&&null!=c.mc.rs&&(d=!0)}}jfgrid_selection_range.push({row:jfgird_select_save[f].row,column:jfgird_select_save[f].column}),o.push({row:jfgird_select_save[f].row,column:jfgird_select_save[f].column})}jfgrid.selectionCopyShow(),jfgrid_copy_save={dataSheetIndex:jfgrid.currentSheetIndex,copyRange:o,RowlChange:l,HasMC:d};var u,m=this;config.borderInfo&&0<config.borderInfo.length&&(u=jfgrid.getBorderInfoCompute());for(var h="",j=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),p="",v=t;v<=i;v++){if(null==config.rowhidden||null==config.rowhidden[v]){h+="<tr>";for(var b=a;b<=n;b++){var _='<td ${span} style="${style}">';if(null!=j[v]&&null!=j[v][b]){var w="",y="";v==t&&(null==config||null==config.columlen||null==config.columlen[b.toString()]?p+='<colgroup width="72px"></colgroup>':p+='<colgroup width="'+config.columlen[b.toString()]+'px"></colgroup>'),b==a&&(null==config||null==config.rowlen||null==config.rowlen[v.toString()]?w+="height:19px;":w+="height:"+config.rowlen[v.toString()]+"px;");var C=null!=j[v][b].ct&&null!=j[v][b].ct.fa&&j[v][b].ct.fa.match(/^(w|W)((0?)|(0\.0+))$/)?jfgrid.getcellvalue(v,b,j):jfgrid.getcellvalue(v,b,j,"m");if(w+=jfgrid.menuButton.getStyleByCell(j,v,b),"object"==jfgrid.getObjType(j[v][b])&&"mc"in j[v][b]){if(!("rs"in j[v][b].mc))continue;if(y='rowspan="'+j[v][b].mc.rs+'" colspan="'+j[v][b].mc.cs+'"',u&&u[v+"_"+b]){for(var T={color:{},style:{}},I={color:{},style:{}},R={color:{},style:{}},k={color:{},style:{}},S=v;S<v+j[v][b].mc.rs;S++)for(var A=b;A<b+j[v][b].mc.cs;A++){S==v&&u[S+"_"+A]&&u[S+"_"+A].t&&(q=u[S+"_"+A].t.style,H=u[S+"_"+A].t.color,null==R.style[q]?R.style[q]=1:R.style[q]=R.style[q]+1,null==R.color[H]?R.color[H]=1:R.color[H]=R.color[H]+1),S==v+j[v][b].mc.rs-1&&u[S+"_"+A]&&u[S+"_"+A].b&&(q=u[S+"_"+A].b.style,H=u[S+"_"+A].b.color,null==k.style[q]?k.style[q]=1:k.style[q]=k.style[q]+1,null==k.color[H]?k.color[H]=1:k.color[H]=k.color[H]+1),A==b&&u[S+"_"+A]&&u[S+"_"+A].l&&(q=u[v+"_"+b].l.style,H=u[S+"_"+A].l.color,null==T.style[q]?T.style[q]=1:T.style[q]=T.style[q]+1,null==T.color[H]?T.color[H]=1:T.color[H]=T.color[H]+1),A==b+j[v][b].mc.cs-1&&u[S+"_"+A]&&u[S+"_"+A].r&&(q=u[S+"_"+A].r.style,H=u[S+"_"+A].r.color,null==I.style[q]?I.style[q]=1:I.style[q]=I.style[q]+1,null==I.color[H]?I.color[H]=1:I.color[H]=I.color[H]+1)}var F=j[v][b].mc.rs,N=j[v][b].mc.cs;if(23<JSON.stringify(T).length){var M=null,E=null;for(x in T.color)T.color[x]>=F/2&&(M=x);for(x in T.style)T.style[x]>=F/2&&(E=x);null!=M&&null!=E&&(w+="border-left:"+m.getHtmlBorderStyle(E,M))}if(23<JSON.stringify(I).length){var O=null,z=null;for(x in I.color)I.color[x]>=F/2&&(O=x);for(x in I.style)I.style[x]>=F/2&&(z=x);null!=O&&null!=z&&(w+="border-right:"+m.getHtmlBorderStyle(z,O))}if(23<JSON.stringify(R).length){var D=null,P=null;for(x in R.color)R.color[x]>=N/2&&(D=x);for(x in R.style)R.style[x]>=N/2&&(P=x);null!=D&&null!=P&&(w+="border-top:"+m.getHtmlBorderStyle(P,D))}if(23<JSON.stringify(k).length){var L=null,B=null;for(x in k.color)k.color[x]>=N/2&&(L=x);for(x in k.style)k.style[x]>=N/2&&(B=x);null!=L&&null!=B&&(w+="border-bottom:"+m.getHtmlBorderStyle(B,L))}}}else{u&&u[v+"_"+b]&&(u[v+"_"+b].l&&(q=u[v+"_"+b].l.style,H=u[v+"_"+b].l.color,w+="border-left:"+m.getHtmlBorderStyle(q,H)),u[v+"_"+b].r&&(q=u[v+"_"+b].r.style,H=u[v+"_"+b].r.color,w+="border-right:"+m.getHtmlBorderStyle(q,H)),u[v+"_"+b].b&&(q=u[v+"_"+b].b.style,H=u[v+"_"+b].b.color,w+="border-bottom:"+m.getHtmlBorderStyle(q,H)),u[v+"_"+b].t&&(q=u[v+"_"+b].t.style,H=u[v+"_"+b].t.color,w+="border-top:"+m.getHtmlBorderStyle(q,H)))}_=jfgrid.replaceHtml(_,{style:w,span:y}),null==C&&(C=jfgrid.getcellvalue(v,b,j)),null==C&&(C=""),_+=C}else{var q,H,w="";u&&u[v+"_"+b]&&(u[v+"_"+b].l&&(q=u[v+"_"+b].l.style,H=u[v+"_"+b].l.color,w+="border-left:"+m.getHtmlBorderStyle(q,H)),u[v+"_"+b].r&&(q=u[v+"_"+b].r.style,H=u[v+"_"+b].r.color,w+="border-right:"+m.getHtmlBorderStyle(q,H)),u[v+"_"+b].b&&(q=u[v+"_"+b].b.style,H=u[v+"_"+b].b.color,w+="border-bottom:"+m.getHtmlBorderStyle(q,H)),u[v+"_"+b].t&&(q=u[v+"_"+b].t.style,H=u[v+"_"+b].t.color,w+="border-top:"+m.getHtmlBorderStyle(q,H))),_+="",v==t&&(null==config||null==config.columlen||null==config.columlen[b.toString()]?p+='<colgroup width="72px"></colgroup>':p+='<colgroup width="'+config.columlen[b.toString()]+'px"></colgroup>'),b==a&&(null==config||null==config.rowlen||null==config.rowlen[v.toString()]?w+="height:19px;":w+="height:"+config.rowlen[v.toString()]+"px;"),_=jfgrid.replaceHtml(_,{style:w,span:""})}h+=_+="</td>"}h+="</tr>"}}if(h='<table data-type="jfgrid_copy_action_table">'+p+h+"</table>",iscopyself=!0,copyType="normal",copysetting=[],r)return r.setData("Text",h),!1;var V=$("#jfgird-copy-content");V.html(h),V.focus(),V.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){$("#jfgird-copy-content").blur()},10)},copybyformat:function(e,r){var t=(t=window.clipboardData)||e.originalEvent.clipboardData;jfgrid_selection_range=[{row:jfgird_select_save[0].row,column:jfgird_select_save[0].column}],jfgrid.selectionCopyShow();var i=r;if(iscopyself=!0,copyType="normal",copysetting=[],t)return t.setData("Text",i),!1;var a=$("#jfgird-copy-content");a.text(i),a.focus(),a.select(),document.execCommand("selectAll"),document.execCommand("Copy"),setTimeout(function(){a.blur()},10)},isPasteAction:!1,paste:function(r,t){var i=$("#jfgird-copy-content"),a=this;i.focus(),i.select(),setTimeout(function(){var e=i.html();-1<e.indexOf("jfgrid_copy_action_table")&&null!=jfgrid_copy_save.copyRange&&0<jfgrid_copy_save.copyRange.length?jfgrid_paste_iscut?(jfgrid_paste_iscut=!1,jfgrid.selection.pasteHandlerOfCutPaste(jfgrid_copy_save),jfgrid.selection.clearcopy(r)):jfgrid.selection.pasteHandlerOfCopyPaste(jfgrid_copy_save):"btn"!=t?a.pasteHandler(e):jfgrid.isEditMode()?alert("在表格中进行复制粘贴: Ctrl + C 进行复制, Ctrl + V 进行粘贴, Ctrl + X 进行剪切"):jfgrid.tooltip.info("在表格中进行复制粘贴","<span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + C</span>&nbsp;&nbsp;进行复制<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + V</span>&nbsp;&nbsp;进行粘贴<br/><span style='line-height: 1.0;font-size:36px;font-weight: bold;color:#666;'>Ctrl + X</span>&nbsp;&nbsp;进行剪切")},10)},pasteHandler:function(e,r){if(1<jfgird_select_save.length&&(jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对多重选择区域执行此操作，请选择单个区域，然后再试")),"object"==typeof e){if(0==e.length)return;var t=$.extend(!0,{},config);null==t.merge&&(t.merge={}),2<JSON.stringify(r).length&&null==t.borderInfo&&(t.borderInfo=[]);var i=e.length,a=e[0].length,n=jfgird_select_save[0].row[0],o=n+i-1,l=jfgird_select_save[0].column[0],d=l+a-1,f=!1;if(null!=t.merge&&(f=jfgrid.hasPartMC(t,n,o,l,d)),f)return void(jfgrid.isEditMode()?alert("不能对合并单元格做部分更改"):jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改"));var s=(I=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata)).length,g=d-I[0].length+1;(0<(N=o-s+1)||0<g)&&(I=jfgrid.datagridgrowth([].concat(I),N,g,!0)),null==t.rowlen&&(t.rowlen={});for(var c=!1,u={},m=n;m<=o;m++){var h=[].concat(I[m]),j=defaultrowlen;null!=t.rowlen[m]&&(j=t.rowlen[m]);for(var p=l;p<=d;p++){"object"==jfgrid.getObjType(h[p])&&"mc"in h[p]&&("rs"in h[p].mc&&delete t.merge[h[p].mc.r+"_"+h[p].mc.c],delete h[p].mc);var v,b=null;null!=e[m-n]&&null!=e[m-n][p-l]&&(b=e[m-n][p-l]),h[p]=$.extend(!0,{},b),null!=b&&"mc"in h[p]&&(null!=h[p].mc.rs?(h[p].mc.r=m,h[p].mc.c=p,t.merge[h[p].mc.r+"_"+h[p].mc.c]=h[p].mc,u[b.mc.r+"_"+b.mc.c]=[h[p].mc.r,h[p].mc.c]):h[p]={mc:{r:u[b.mc.r+"_"+b.mc.c][0],c:u[b.mc.r+"_"+b.mc.c][1]}}),r[m-n+"_"+(p-l)]&&(v={rangeType:"cell",value:{row_index:m,col_index:p,l:r[m-n+"_"+(p-l)].l,r:r[m-n+"_"+(p-l)].r,t:r[m-n+"_"+(p-l)].t,b:r[m-n+"_"+(p-l)].b}},t.borderInfo.push(v));var _=jfgridfontformat(h[p]),w=jfgrid.menuButton.getTextSize("田",_)[1];j<w&&(j=w,c=!0)}I[m]=h,j!=defaultrowlen&&(t.rowlen[m]=j)}jfgird_select_save=[{row:[n,o],column:[l,d]}],0<N||0<g||c?jfgrid.jfrefreshgrid(I,jfgird_select_save,t,null,!0):(jfgrid.jfrefreshgrid(I,jfgird_select_save,t),jfgrid.selectHightlightShow())}else{for(var y=[],x=(e=e.replace(/\r/g,"")).split("\n"),C=x[0].split("\t").length,T=0;T<x.length;T++)x[T].split("\t").length<C||y.push(x[T].split("\t"));var I=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),R=jfgird_select_save[jfgird_select_save.length-1],k=null==R.row?0:R.row[0],S=null==R.column?0:R.column[0],A=y.length,F=y[0].length,f=!1;if(null!=config.merge&&(f=jfgrid.hasPartMC(config,k,k+A-1,S,S+F-1)),f)return void(jfgrid.isEditMode()?alert("不能对合并单元格做部分更改"):jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改"));var N=k+A-I.length,g=S+F-I[0].length;(0<N||0<g)&&(I=jfgrid.datagridgrowth([].concat(I),N,g,!0));for(var M=0;M<A;M++){for(h=[].concat(I[M+k]),p=0;p<F;p++){var E={},O=jfgrid.mask.genarate(y[M][p]);E.v=O[2],E.ct=O[1],E.m=O[0],h[p+S]=E}I[M+k]=h}R.row=[k,k+A-1],R.column=[S,S+F-1],0<N||0<g?jfgrid.jfrefreshgrid(I,jfgird_select_save,null,null,!0):(jfgrid.jfrefreshgrid(I,jfgird_select_save),jfgrid.selectHightlightShow())}},pasteHandlerOfCutPaste:function(e){var r=$.extend(!0,{},config);null==r.merge&&(r.merge={});var t=e.HasMC,i=e.RowlChange,a=e.dataSheetIndex,n=$.extend(!0,[],jfgrid.getdatabyselection({row:e.copyRange[0].row,column:e.copyRange[0].column},a)),o=n.length,l=n[0].length,d=jfgird_select_save[jfgird_select_save.length-1],f=d.row_focus,s=f+o-1,g=d.column_focus,c=g+l-1,u=!1;if(null!=r.merge&&(u=jfgrid.hasPartMC(r,f,s,g,c)),u)jfgrid.isEditMode()?alert("不能对合并单元格做部分更改"):jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改");else{var m=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),h=o+f-m.length,j=l+g-m[0].length;(0<h||0<j)&&(m=jfgrid.datagridgrowth([].concat(m),h,j,!0));var p=jfgrid.getBorderInfoCompute(a);if(jfgrid.currentSheetIndex==a){for(var v=e.copyRange[0].row[0];v<=e.copyRange[0].row[1];v++)for(var b=e.copyRange[0].column[0];b<=e.copyRange[0].column[1];b++){var _=m[v][b];"object"==jfgrid.getObjType(_)&&"mc"in _&&("rs"in _.mc&&delete r.merge[_.mc.r+"_"+_.mc.c],delete _.mc),m[v][b]=null}if(r.borderInfo&&0<r.borderInfo.length){for(var w=[],v=0;v<r.borderInfo.length;v++){if("range"==(B=r.borderInfo[v].rangeType)){for(var y=r.borderInfo[v].range,x=[],b=0;b<y.length;b++)x=x.concat(jfgrid.conditionformat.CFSplitRange(y[b],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[f,s],column:[g,c]},"restPart"));r.borderInfo[v].range=x,w.push(r.borderInfo[v])}else{"cell"==B&&(q=r.borderInfo[v].value.row_index,H=r.borderInfo[v].value.col_index,q>=e.copyRange[0].row[0]&&q<=e.copyRange[0].row[1]&&H>=e.copyRange[0].column[0]&&H<=e.copyRange[0].column[1]||w.push(r.borderInfo[v]))}}r.borderInfo=w}}for(var C={},T=f;T<=s;T++){for(var I,R=[].concat(m[T]),k=g;k<=c;k++){p[e.copyRange[0].row[0]+T-f+"_"+(e.copyRange[0].column[0]+k-g)]?(I={rangeType:"cell",value:{row_index:T,col_index:k,l:p[e.copyRange[0].row[0]+T-f+"_"+(e.copyRange[0].column[0]+k-g)].l,r:p[e.copyRange[0].row[0]+T-f+"_"+(e.copyRange[0].column[0]+k-g)].r,t:p[e.copyRange[0].row[0]+T-f+"_"+(e.copyRange[0].column[0]+k-g)].t,b:p[e.copyRange[0].row[0]+T-f+"_"+(e.copyRange[0].column[0]+k-g)].b}},null==r.borderInfo&&(r.borderInfo=[]),r.borderInfo.push(I)):p[T+"_"+k]&&(I={rangeType:"cell",value:{row_index:T,col_index:k,l:null,r:null,t:null,b:null}},null==r.borderInfo&&(r.borderInfo=[]),r.borderInfo.push(I)),"object"==jfgrid.getObjType(R[k])&&"mc"in R[k]&&("rs"in R[k].mc&&delete r.merge[R[k].mc.r+"_"+R[k].mc.c],delete R[k].mc);var S=null;null!=n[T-f]&&null!=n[T-f][k-g]&&(S=n[T-f][k-g]),R[k]=$.extend(!0,{},S),null!=S&&t&&"mc"in R[k]&&(null!=R[k].mc.rs?(R[k].mc.r=T,R[k].mc.c=k,r.merge[R[k].mc.r+"_"+R[k].mc.c]=R[k].mc,C[S.mc.r+"_"+S.mc.c]=[R[k].mc.r,R[k].mc.c]):R[k]={mc:{r:C[S.mc.r+"_"+S.mc.c][0],c:C[S.mc.r+"_"+S.mc.c][1]}})}m[T]=R}if(d.row=[f,s],d.column=[g,c],i&&(r=(jfgrid.currentSheetIndex!=a||(r=jfgrid.rowlenByRange(m,e.copyRange[0].row[0],e.copyRange[0].row[1],r)),jfgrid.rowlenByRange(m,f,s,r))),jfgrid.currentSheetIndex!=a){var A=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(a)].data),F=$.extend(!0,{},jfgridfile[jfgrid.sheetmanage.getSheetIndex(a)].config),N=$.extend(!0,[],A),M=$.extend(!0,{},F);null==M.merge&&(M.merge={});for(var E=e.copyRange[0].row[0],O=e.copyRange[0].row[1],z=e.copyRange[0].column[0],D=e.copyRange[0].column[1],P=E;P<=O;P++)for(var L=z;L<=D;L++){_=N[P][L];"object"==jfgrid.getObjType(_)&&"mc"in _&&("rs"in _.mc&&delete M.merge[_.mc.r+"_"+_.mc.c],delete _.mc),N[P][L]=null}if(i&&(M=jfgrid.rowlenByRange(N,E,O,M)),M.borderInfo&&0<M.borderInfo.length){for(var B,q,H,w=[],v=0;v<M.borderInfo.length;v++){if("range"==(B=M.borderInfo[v].rangeType)){for(y=M.borderInfo[v].range,x=[],b=0;b<y.length;b++)x=x.concat(jfgrid.conditionformat.CFSplitRange(y[b],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[f,s],column:[g,c]},"restPart"));M.borderInfo[v].range=x,w.push(M.borderInfo[v])}else{"cell"==B&&(q=M.borderInfo[v].value.row_index,H=M.borderInfo[v].value.col_index,q>=e.copyRange[0].row[0]&&q<=e.copyRange[0].row[1]&&H>=e.copyRange[0].column[0]&&H<=e.copyRange[0].column[1]||w.push(M.borderInfo[v]))}}M.borderInfo=w}var V=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(a)].jfgrid_conditionformat_save),U=$.extend(!0,[],V),Y=[];if(null!=U&&0<U.length)for(v=0;v<U.length;v++){for(var W,G=U[v].cellrange,X=[],Z=[],b=0;b<G.length;b++){var K=jfgrid.conditionformat.CFSplitRange(G[b],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[f,s],column:[g,c]},"restPart");X=X.concat(K);var J=jfgrid.conditionformat.CFSplitRange(G[b],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[f,s],column:[g,c]},"operatePart");0<J.length&&(Z=Z.concat(J))}U[v].cellrange=X,0<Z.length&&((W=$.extend(!0,{},U[v])).cellrange=Z,Y.push(W))}var Q=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save),ee=$.extend(!0,[],Q);0<Y.length&&(ee=ee.concat(Y));var re={sheetIndex:a,data:A,curData:N,config:F,curConfig:M,cdformat:V,curCdformat:U,range:{row:e.copyRange[0].row,column:e.copyRange[0].column}},te={sheetIndex:jfgrid.currentSheetIndex,data:jfgrid.flowdata,curData:m,config:$.extend(!0,{},config),curConfig:r,cdformat:Q,curCdformat:ee,range:{row:[f,s],column:[g,c]}}}else{var ie=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save),ae=$.extend(!0,[],ie);if(null!=ae&&0<ae.length)for(v=0;v<ae.length;v++){for(var ne=ae[v].cellrange,X=[],b=0;b<ne.length;b++){K=jfgrid.conditionformat.CFSplitRange(ne[b],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[f,s],column:[g,c]},"allPart");X=X.concat(K)}ae[v].cellrange=X}re={sheetIndex:jfgrid.currentSheetIndex,data:jfgrid.flowdata,curData:m,config:$.extend(!0,{},config),curConfig:r,cdformat:ie,curCdformat:ae,range:{row:e.copyRange[0].row,column:e.copyRange[0].column}},te={sheetIndex:jfgrid.currentSheetIndex,data:jfgrid.flowdata,curData:m,config:$.extend(!0,{},config),curConfig:r,cdformat:ie,curCdformat:ae,range:{row:[f,s],column:[g,c]}}}0<h||0<j?jfgrid.jfrefreshgrid_pastcut(re,te,!0):jfgrid.jfrefreshgrid_pastcut(re,te,i)}},pasteHandlerOfCopyPaste:function(e){var r=$.extend(!0,{},config);null==r.merge&&(r.merge={});for(var t=e.HasMC,i=e.RowlChange,a=e.dataSheetIndex,n=[],o=!1,l=0;l<e.copyRange.length;l++){var d=jfgrid.getdatabyselection({row:e.copyRange[l].row,column:e.copyRange[l].column},a);1<e.copyRange.length?e.copyRange[0].row[0]==e.copyRange[1].row[0]&&e.copyRange[0].row[1]==e.copyRange[1].row[1]?(d=d[0].map(function(e,r){return d.map(function(e){return e[r]})}),n=n.concat(d),o=!0):e.copyRange[0].column[0]==e.copyRange[1].column[0]&&e.copyRange[0].column[1]==e.copyRange[1].column[1]&&(n=n.concat(d)):n=d}o&&(n=n[0].map(function(e,r){return n.map(function(e){return e[r]})}));var f=$.extend(!0,[],n);if(1<e.copyRange.length)for(l=0;l<f.length;l++)for(var s=0;s<f[l].length;s++)null!=f[l][s]&&null!=f[l][s].f&&(delete f[l][s].f,delete f[l][s].spl);var g=f.length,c=f[0].length,u=jfgird_select_save[jfgird_select_save.length-1],m=u.row[0],h=u.row[1],j=u.column[0],p=u.column[1];0==(h-m+1)%g&&0==(p-j+1)%c||(h=m+g-1,p=j+c-1);var v=!1;if(null!=r.merge&&(v=jfgrid.hasPartMC(r,m,h,j,p)),v)jfgrid.isEditMode()?alert("不能对合并单元格做部分更改"):jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改");else{var b=(h-m+1)/g,_=(p-j+1)/c,w=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),y=g+m-w.length,x=c+j-w[0].length;(0<y||0<x)&&(w=jfgrid.datagridgrowth([].concat(w),y,x,!0));for(var C=jfgrid.getBorderInfoCompute(a),T=0,I=0,R=0,k=0,S=1;S<=b;S++)for(var A=1;A<=_;A++){I=j+(A-1)*c,k=m+S*g,R=j+A*c;for(var F=(T=m+(S-1)*g)-e.copyRange[0].row[0],N=I-e.copyRange[0].column[0],M={},E=T;E<k;E++){for(var O,z=[].concat(w[E]),D=I;D<R;D++){C[e.copyRange[0].row[0]+E-T+"_"+(e.copyRange[0].column[0]+D-I)]?(O={rangeType:"cell",value:{row_index:E,col_index:D,l:C[e.copyRange[0].row[0]+E-T+"_"+(e.copyRange[0].column[0]+D-I)].l,r:C[e.copyRange[0].row[0]+E-T+"_"+(e.copyRange[0].column[0]+D-I)].r,t:C[e.copyRange[0].row[0]+E-T+"_"+(e.copyRange[0].column[0]+D-I)].t,b:C[e.copyRange[0].row[0]+E-T+"_"+(e.copyRange[0].column[0]+D-I)].b}},null==r.borderInfo&&(r.borderInfo=[]),r.borderInfo.push(O)):C[E+"_"+D]&&(O={rangeType:"cell",value:{row_index:E,col_index:D,l:null,r:null,t:null,b:null}},null==r.borderInfo&&(r.borderInfo=[]),r.borderInfo.push(O)),"object"==jfgrid.getObjType(z[D])&&"mc"in z[D]&&("rs"in z[D].mc&&delete r.merge[z[D].mc.r+"_"+z[D].mc.c],delete z[D].mc);var P,L,B=null;null!=f[E-T]&&null!=f[E-T][D-I]&&(B=$.extend(!0,{},f[E-T][D-I])),null!=B&&null!=B.f&&(P=B.f,0<F&&(P="="+jfgrid.formula.functionCopy(P,"down",F)),F<0&&(P="="+jfgrid.formula.functionCopy(P,"up",Math.abs(F))),0<N&&(P="="+jfgrid.formula.functionCopy(P,"right",N)),N<0&&(P="="+jfgrid.formula.functionCopy(P,"left",Math.abs(N))),L=jfgrid.formula.execfunction(P,E,D,!0),null!=B.spl?(B.f=L[2],B.v=L[1],B.spl=L[3].data):(B.f=L[2],B.v=L[1],null!=B.ct&&null!=B.ct.fa&&(B.m=jfgrid.mask.update(B.ct.fa,L[1])))),z[D]=$.extend(!0,{},B),null!=B&&t&&"mc"in z[D]&&(null!=z[D].mc.rs?(z[D].mc.r=E,z[D].mc.c=D,r.merge[z[D].mc.r+"_"+z[D].mc.c]=z[D].mc,M[B.mc.r+"_"+B.mc.c]=[z[D].mc.r,z[D].mc.c]):z[D]={mc:{r:M[B.mc.r+"_"+B.mc.c][0],c:M[B.mc.r+"_"+B.mc.c][1]}})}w[E]=z}}if(1==e.copyRange.length){var q=jfgridfile[jfgrid.sheetmanage.getSheetIndex(a)],H=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)],V=e.copyRange[0].row[0],U=e.copyRange[0].row[1],Y=e.copyRange[0].column[0],W=e.copyRange[0].column[1],G=$.extend(!0,[],q.jfgrid_conditionformat_save),X=$.extend(!0,[],H.jfgrid_conditionformat_save);if(null!=G&&0<G.length)for(l=0;l<G.length;l++){for(var Z=G[l].cellrange,K=[],S=1;S<=b;S++)for(A=1;A<=_;A++){T=m+(S-1)*g,I=j+(A-1)*c,k=m+S*g,R=j+A*c;for(s=0;s<Z.length;s++){var J=jfgrid.conditionformat.CFSplitRange(Z[s],{row:[V,U],column:[Y,W]},{row:[T,k-1],column:[I,R-1]},"operatePart");0<J.length&&(K=K.concat(J))}}0<K.length&&(G[l].cellrange=K,X.push(G[l]))}}u.row=[m,h],u.column=[j,p],i||0<y||0<x?(r=jfgrid.rowlenByRange(w,m,h,r),1==e.copyRange.length&&null!=G&&0<G.length?jfgrid.jfrefreshgrid(w,jfgird_select_save,r,X,!0):jfgrid.jfrefreshgrid(w,jfgird_select_save,r,null,!0)):(1==e.copyRange.length&&null!=G&&0<G.length?jfgrid.jfrefreshgrid(w,jfgird_select_save,r,X):jfgrid.jfrefreshgrid(w,jfgird_select_save,r),jfgrid.selectHightlightShow())}},pasteHandlerOfPaintModel:function(e){var r=$.extend(!0,{},config);null==r.merge&&(r.merge={});var t=e.HasMC,i=e.RowlChange,a=e.dataSheetIndex,n=$.extend(!0,[],jfgrid.getdatabyselection({row:e.copyRange[0].row,column:e.copyRange[0].column},a)),o=jfgird_select_save[jfgird_select_save.length-1],l=o.row[0],d=o.row[1],f=o.column[0],s=o.column[1],g=n.length,c=n[0].length;if(l==d&&f==s){var u=!1;if(null!=r.merge&&(u=jfgrid.hasPartMC(r,l,l+g-1,f,f+c-1)),u)return void(jfgrid.isEditMode()?alert("不能对合并单元格做部分更改"):jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"不能对合并单元格做部分更改"));d=l+g-1,s=f+c-1}for(var m=Math.ceil((d-l+1)/g),h=Math.ceil((s-f+1)/c),j=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),p=j[0].length,v=j.length,b=jfgrid.getBorderInfoCompute(a),_=0,w=0,y=0,x=0,C=1;C<=m;C++)for(var T=1;T<=h;T++){w=f+(T-1)*c,d+1<(x=v<l+C*g?v:l+C*g)&&(x=d+1),s+1<(y=p<f+T*c?p:f+T*c)&&(y=s+1);for(var I={},R=_=l+(C-1)*g;R<x;R++){for(var k,S=[].concat(j[R]),A=w;A<y;A++){b[e.copyRange[0].row[0]+R-_+"_"+(e.copyRange[0].column[0]+A-w)]?(k={rangeType:"cell",value:{row_index:R,col_index:A,l:b[e.copyRange[0].row[0]+R-_+"_"+(e.copyRange[0].column[0]+A-w)].l,r:b[e.copyRange[0].row[0]+R-_+"_"+(e.copyRange[0].column[0]+A-w)].r,t:b[e.copyRange[0].row[0]+R-_+"_"+(e.copyRange[0].column[0]+A-w)].t,b:b[e.copyRange[0].row[0]+R-_+"_"+(e.copyRange[0].column[0]+A-w)].b}},null==r.borderInfo&&(r.borderInfo=[]),r.borderInfo.push(k)):b[R+"_"+A]&&(k={rangeType:"cell",value:{row_index:R,col_index:A,l:null,r:null,t:null,b:null}},null==r.borderInfo&&(r.borderInfo=[]),r.borderInfo.push(k)),"object"==jfgrid.getObjType(S[A])&&"mc"in S[A]&&("rs"in S[A].mc&&delete r.merge[S[A].mc.r+"_"+S[A].mc.c],delete S[A].mc);var F,N=null;null!=n[R-_]&&null!=n[R-_][A-w]&&(N=n[R-_][A-w]),null!=N&&(delete N.v,delete N.m,delete N.f,delete N.spl,"object"==jfgrid.getObjType(S[A])||(S[A]={v:S[A]}),S[A]=$.extend(!0,S[A],N),t&&"mc"in S[A]&&(null!=S[A].mc.rs?(S[A].mc.r=R,S[A].mc.rs+R>=x&&(S[A].mc.rs=x-R),S[A].mc.c=A,S[A].mc.cs+A>=y&&(S[A].mc.cs=y-A),r.merge[S[A].mc.r+"_"+S[A].mc.c]=S[A].mc,I[N.mc.r+"_"+N.mc.c]=[S[A].mc.r,S[A].mc.c]):S[A]={mc:{r:I[N.mc.r+"_"+N.mc.c][0],c:I[N.mc.r+"_"+N.mc.c][1]}}),null!=S[A].v&&null!=N.ct&&null!=N.ct.fa&&(F=jfgrid.mask.update(N.ct.fa,S[A].v),S[A].m=F))}j[R]=S}}var M=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(a)].jfgrid_conditionformat_save),E=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save);if(null!=M&&0<M.length)for(var O=0;O<M.length;O++){for(var z=M[O].cellrange,D=[],P=0;P<z.length;P++){var L=jfgrid.conditionformat.CFSplitRange(z[P],{row:e.copyRange[0].row,column:e.copyRange[0].column},{row:[l,d],column:[f,s]},"operatePart");0<L.length&&(D=D.concat(L))}0<D.length&&(M[O].cellrange=[{row:[l,d],column:[f,s]}],E.push(M[O]))}o.row=[l,d],o.column=[f,s],i?(r=jfgrid.rowlenByRange(j,l,d,r),null!=M&&0<M.length?jfgrid.jfrefreshgrid(j,jfgird_select_save,r,E,!0):jfgrid.jfrefreshgrid(j,jfgird_select_save,r,null,!0)):(null!=M&&0<M.length?jfgrid.jfrefreshgrid(j,jfgird_select_save,r,E):jfgrid.jfrefreshgrid(j,jfgird_select_save,r),jfgrid.selectHightlightShow())},matchcopy:function(e,r){var t,i,a=[],n=[];if("object"==typeof e)a=e;else{a=e.split("\n");for(var o=0;o<a.length;o++)a[o]=a[o].split("\t")}if(t=a.length,"object"==typeof r)n=r;else{n=r.split("\n");for(o=0;o<n.length;o++)n[o]=n[o].split("\t")}if(t!=(i=n.length))return!1;for(var l=0;l<t;l++)if(null==config.rowhidden||null==config.rowhidden[l])for(var d=0;d<i;d++)if(a[l].length!=n[d].length)return!1;for(var f=0;f<t;f++)if(null==config.rowhidden||null==config.rowhidden[f])for(var s=0;s<a[0].length;s++)if(jfgrid.getcellvalue(f,s,a)!=jfgrid.getcellvalue(f,s,n))return!1;return!0}},jfgrid.datecontroll={isdatetime:function(e){return!(null==e||e.toString().length<5)&&!!function(e){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(e))return!1;var r=RegExp.$1,t=RegExp.$2,i=RegExp.$3;if(r<1900)return!1;if(12<t)return!1;if(31<i)return!1;if(2==t){if(29==new Date(r,1,29).getDate()&&29<i)return!1;if(29!=new Date(r,1,29).getDate()&&28<i)return!1}return!0}(e)},diff:function(e,r){return moment(e).diff(moment(r))}},jfgrid.isdatatype=function(e){var r="string";return jfgrid.datecontroll.isdatetime(e)?r="date":isNaN(parseFloat(e))||jfgrid.hasChinaword(e)||(r="num"),r},jfgrid.isdatatypemulti=function(e){var r={};return jfgrid.datecontroll.isdatetime(e)&&(r.date=!0),isNaN(parseFloat(e))||jfgrid.hasChinaword(e)||(r.num=!0),r},jfgrid.numfloatlen=function(e){if(null==e||isNaN(parseFloat(e))||jfgrid.hasChinaword(e))return null;var r=numeral(e).value().toString().split(".");return r=1==r.length?0:r[1].length},jfgrid.range_config=function(e,r,t){if(e&&(jfgrid.chartparam.jgridCurrentChartData=jfgrid.jgfridturntrans(jfgrid.chartparam.jgridCurrentChartData)),!r){for(var i,a=[],n=e?(i=jfgrid.chartparam.jgridCurrentChartSelection.row[0],jfgrid.chartparam.jgridCurrentChartSelection.row[1]):(i=jfgrid.chartparam.jgridCurrentChartSelection.column[0],jfgrid.chartparam.jgridCurrentChartSelection.column[1]),o=i;o<=n;o++)t&&o==i?a.push(""):a.push(jfgrid.jfgridchatatABC(o));jfgrid.chartparam.jgridCurrentChartData.unshift(a)}if(!t){var l=jfgrid.chartparam.jgridCurrentChartData.length;jfgrid.chartparam.jgridCurrentChartData[0].unshift("");for(o=1;o<l;o++){var d=r?1:0;jfgrid.chartparam.jgridCurrentChartData[o].unshift(jfgrid.jfgridchatatABC(jfgrid.chartparam.jgridCurrentChartSelection.column[0])+(o+jfgrid.chartparam.jgridCurrentChartSelection.row[0]+d))}}},jfgrid.numFormat=function(e,r){if(null==e||isNaN(parseFloat(e))||jfgrid.hasChinaword(e)||e==-1/0||e==1/0)return null;var t=6,i=!1;null==r||"auto"==r?t=e<1?6:1:"num"==jfgrid.isdatatype(r)?(t=parseInt(r),i=!0):t=6;for(var a="",n=0;n<t;n++)a+="0";return i||(a="["+a+"]"),1e21<=e?parseFloat(numeral(e).value()):parseFloat(numeral(e).format("0."+a))},jfgrid.array={transpose:function(e){var r=[];if(0==e.length)return[];if(0==e[0].length)return[];for(var t=0;t<e[0].length;t++){for(var i=[],a=0;a<e.length;a++){var n="";null!=e[a]&&null!=e[a][t]&&(n=jfgrid.getcellvalue(a,t,e)),i.push(n)}r.push(i)}return r},minusClear:function(e,r){if(r.row[0]>e.row[1]||r.row[1]<e.row[0]||r.column[0]>e.column[1]||r.column[1]<e.column[0])return null;if(r.row[0]==e.row[0]&&r.row[1]<e.row[1]&&r.column[0]>e.column[0]&&r.column[1]<e.column[1])return[];var t=[],i=null,a=[e.column[0],e.column[1]];r.row[1]>e.row[0]&&r.row[1]<e.row[1]?i=[r.row[1]+1,e.row[1]]:r.row[0]>e.row[0]&&r.row[0]<e.row[1]&&(i=[e.row[0],r.row[0]-1]),null!=i&&t.push({row:i,column:a});i=[e.row[0],e.row[1]],a=null;return r.column[1]>e.column[0]&&r.column[1]<e.column[1]?a=[r.column[1]+1,e.column[1]]:r.column[0]>e.column[0]&&r.column[0]<e.column[1]&&(a=[e.column[0],r.column[0]-1]),null!=a&&t.push({row:i,column:a}),t}},jfgrid.analysis={STDEVP:function(e,r){for(var t=0,i=0;i<r.length;i++){var a=r[i];t+=Math.pow(a-e,2)}return jfgrid.numFormat(Math.sqrt(t/r.length))},STDEV:function(e,r){for(var t=0,i=0;i<r.length;i++){var a=r[i];t+=Math.pow(a-e,2)}return jfgrid.numFormat(Math.sqrt(t/(r.length-1)))},VARP:function(e,r){for(var t=0,i=0;i<r.length;i++){var a=r[i];t+=Math.pow(a-e,2)}return jfgrid.numFormat(t/r.length)},VAR:function(e,r){for(var t=0,i=0;i<r.length;i++){var a=r[i];t+=Math.pow(a-e,2)}return jfgrid.numFormat(t/(r.length-1))}},jfgrid.tooltip={info:function(e,r){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-info").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-info",addclass:"",title:e,content:r,botton:'<button class="btn btn-default jfgrid-model-close-btn">&nbsp;&nbsp;关闭&nbsp;&nbsp;</button>',style:"z-index:100003"}));var t=$("#jfgrid-info").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),i=t.outerHeight(),a=t.outerWidth(),n=$(window).width(),o=$(window).height(),l=$(document).scrollLeft(),d=$(document).scrollTop();$("#jfgrid-info").css({left:(n+l-a)/2,top:(o+d-i)/3}).show()},confirm:function(e,r,t,i,a,n){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-confirm").remove(),null==a&&(a="确定"),null==n&&(n="取消"),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-confirm",addclass:"",style:"z-index:100003",title:e,content:r,botton:'<button class="btn btn-primary jfgrid-model-conform-btn">&nbsp;&nbsp;'+a+'&nbsp;&nbsp;</button><button class="btn btn-default jfgrid-model-cancel-btn">&nbsp;&nbsp;'+n+"&nbsp;&nbsp;</button>"}));var o=$("#jfgrid-confirm").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),l=o.outerHeight(),d=o.outerWidth(),f=$(window).width(),s=$(window).height(),g=$(document).scrollLeft(),c=$(document).scrollTop();$("#jfgrid-confirm").css({left:(f+g-d)/2,top:(s+c-l)/3}).show(),o.find(".jfgrid-model-conform-btn").click(function(){"function"==typeof t&&t(),$("#jfgrid-confirm").hide(),$("#jfgrid-modal-dialog-mask").hide()}),o.find(".jfgrid-model-cancel-btn").click(function(){"function"==typeof i&&i(),$("#jfgrid-confirm").hide(),$("#jfgrid-modal-dialog-mask").hide()})},screenshot:function(e,r,t){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-confirm").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-confirm",addclass:"",style:"z-index:100003",title:e,content:r,botton:'<a style="text-decoration:none;color:#fff;" class="download btn btn-primary jfgrid-model-conform-btn">&nbsp;&nbsp;下载&nbsp;&nbsp;</a>&nbsp;&nbsp;<button class="btn btn-danger jfgrid-model-copy-btn">&nbsp;&nbsp;复制到剪切板&nbsp;&nbsp;</button><button class="btn btn-default jfgrid-model-cancel-btn">&nbsp;&nbsp;关闭&nbsp;&nbsp;</button>'}));var i=$("#jfgrid-confirm").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),a=i.outerHeight(),n=i.outerWidth(),o=$(window).width(),l=$(window).height(),d=$(document).scrollLeft(),f=$(document).scrollTop();$("#jfgrid-confirm").css({left:(o+d-n)/2,top:(l+f-a)/3}).show(),i.find(".jfgrid-model-conform-btn").click(function(){"1"==jfgrid.browser.isIE()?alert("下载功能IE浏览器不支持！"):(window.ActiveXObject||"ActiveXObject"in window)&&(0===$("#IframeReportImg").length&&$('<iframe style="display:none;" id="IframeReportImg" name="IframeReportImg" onload="downloadImg();" width="0" height="0" src="about:blank"></iframe>').appendTo("body"),$("#IframeReportImg").attr("src")!=t?$("#IframeReportImg").attr("src",t):"about:blank"!=$("#IframeReportImg").src&&window.frames.IframeReportImg.document.execCommand("SaveAs"))}),i.find(".jfgrid-model-cancel-btn").click(function(){$("#jfgrid-confirm").hide(),$("#jfgrid-modal-dialog-mask").hide()}),$("#jfgrid-confirm .jfgrid-model-copy-btn").click(function(){var e=new clipboard.DT;e.setData("text/html","<img src='"+t+"'>"),"1"==jfgrid.browser.isIE()?alert("请在图片上右键点击'复制'"):(clipboard.write(e),alert("已成功复制（如果粘贴失败，请在图片上右键点击'复制图片'）"))})},chartPointConfig:function(e,r,t){$("body").append(jfgrid.replaceHtml(modelHTML,{id:e,addclass:"jfgrid-chart-point-config-c",title:"数据点批量设置",content:jfgridchartpointconfigHTML,botton:'<button class="btn btn-danger jfgrid-model-save-btn">&nbsp;&nbsp;保存设置&nbsp;&nbsp;</button><button class="btn btn-default jfgrid-model-close-btn">&nbsp;&nbsp;取消&nbsp;&nbsp;</button>',style:"z-index:100003;height:80%;width:80%;top:10%;left:10%;"})),$("#jfgrid-modal-dialog-mask").show();var i=$(window).width(),a=$(window).height();$("#"+e).find(".jfgrid-chart-point-config").css("height",a-160),$("#"+e).css({height:a-90,width:i-100,left:7,top:14}).show().find(".jfgrid-model-save-btn").click(function(){"function"==typeof r&&r(),$("#"+e).hide(),$("#jfgrid-modal-dialog-mask").hide()}),$("#"+e).find(".jfgrid-model-save-btn").click(function(){"function"==typeof t&&t(),$("#"+e).hide(),$("#jfgrid-modal-dialog-mask").hide()})},sheetConfig:function(){},hoverTipshowState:!1,hoverTipshowTimeOut:null,createHoverTip:function(e,r){$(e).on("mouseover",r,function(o){jfgrid.tooltip.hoverTipshowState||(clearTimeout(jfgrid.tooltip.hoverTipshowTimeOut),jfgrid.tooltip.hoverTipshowTimeOut=setTimeout(function(){var e,r,t=$(o.currentTarget),i=t.offset(),a=$("#jfgrid-tooltip-up"),n=t.data("tips");(null!=n&&0!=n.length||null!=(n=t.prev().data("tips"))&&0!=n.length)&&(0==a.length&&($("body").append(jfgridToolHTML),a=$("#jfgrid-tooltip-up")),a.removeClass("jfk-tooltip-hide").find("div.jfk-tooltip-contentId").html(n),e=a.outerWidth(),a.find("div.jfk-tooltip-arrow").css("left",e/2),(r=i.left+(t.outerWidth()-e)/2)<2&&(r=2,a.find("div.jfk-tooltip-arrow").css("left",t.outerWidth()/2)),a.css({top:i.top+t.outerHeight()+1,left:r}))},300))}).on("mouseout",r,function(e){jfgrid.tooltip.hoverTipshowState=!1,clearTimeout(jfgrid.tooltip.hoverTipshowTimeOut),$("#jfgrid-tooltip-up").addClass("jfk-tooltip-hide")}).on("click",r,function(e){jfgrid.tooltip.hoverTipshowState=!0,clearTimeout(jfgrid.tooltip.hoverTipshowTimeOut),$("#jfgrid-tooltip-up").addClass("jfk-tooltip-hide")})},popover:function(e,r,t,i,a,n){null==a&&(a="关闭");var o='<div id="jfgridpopover" class="jfgridpopover"><div class="jfgridpopover-content">格式刷开启</div><div class="jfgridpopover-btn">'+a+"</div></div>";$("#jfgridpopover").remove(),$("body").append(o),$("#jfgridpopover .jfgridpopover-content").html(e);var l=$("#jfgridpopover").outerWidth(),d=$("#jfgridpopover").outerHeight(),f={};"topLeft"==r?(f.top="20px",f.left="20px"):"topCenter"==r?(f.top="20px",f.left="50%",f["margin-left"]=-l/2):"topRight"==r?(f.top="20px",f.right="20px"):"midLeft"==r?(f.top="50%",f["margin-top"]=-d/2,f.left="20px"):"center"==r?(f.top="50%",f["margin-top"]=-d/2,f.left="50%",f["margin-left"]=-l/2):"midRight"==r?(f.top="50%",f["margin-top"]=-d/2,f.right="20px"):"bottomLeft"==r?(f.bottom="20px",f.left="20px"):"bottomCenter"==r?(f.bottom="20px",f.left="50%",f["margin-left"]=-l/2):"bottomRight"==r?(f.bottom="20px",f.right="20px"):(f.top="20px",f.left="50%",f["margin-left"]=-l/2),"white"==i&&(f.background="rgba(255,255,255,0.65)",f.color="#000",$("#jfgridpopover .jfgridpopover-btn").css({border:"1px solid #000"})),setTimeout(function(){$("#jfgridpopover .jfgridpopover-content").css({"margin-left":-$("#jfgridpopover .jfgridpopover-btn").outerWidth()/2})},1),$("#jfgridpopover").css(f).fadeIn(),$("#jfgridpopover .jfgridpopover-btn").click(function(){"function"==typeof n&&n()}),null!=t&&"number"==typeof t&&setTimeout(function(){$("#jfgridpopover").fadeOut().remove(),"function"==typeof n&&n()},t)}},jfgrid.mask=function(){var b={};!function(e){function S(e){for(var r="",t=e.length-1;0<=t;)r+=e.charAt(t--);return r}function A(e,r){for(var t="";t.length<r;)t+=e;return t}function F(e,r){var t=""+e;return r<=t.length?t:A("0",r-t.length)+t}function N(e,r){var t=""+e;return r<=t.length?t:A(" ",r-t.length)+t}function M(e,r){var t=""+e;return r<=t.length?t:t+A(" ",r-t.length)}e.version="0.10.2";var d=Math.pow(2,32);function E(e,r){if(d<e||e<-d)return t=e,i=r,a=""+Math.round(t),i<=a.length?a:A("0",i-a.length)+a;var t,i,a,n,o,l=Math.round(e);return(n=r)<=(o=""+l).length?o:A("0",n-o.length)+o}function $(e,r){return r=r||0,e.length>=7+r&&103==(32|e.charCodeAt(r))&&101==(32|e.charCodeAt(r+1))&&110==(32|e.charCodeAt(r+2))&&101==(32|e.charCodeAt(r+3))&&114==(32|e.charCodeAt(r+4))&&97==(32|e.charCodeAt(r+5))&&108==(32|e.charCodeAt(r+6))}var R=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],k=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function r(e){e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e[65535]="General"}var u={};function O(e,r,t){for(var i=e<0?-1:1,a=e*i,n=0,o=1,l=0,d=1,f=0,s=0,g=Math.floor(a);f<r&&(l=(g=Math.floor(a))*o+n,s=g*f+d,!(a-g<5e-8));)a=1/(a-g),n=o,o=l,d=f,f=s;if(r<s&&(l=r<f?(s=d,n):(s=f,o)),!t)return[0,i*l,s];var c=Math.floor(i*l/s);return[c,i*l-c*s,s]}function z(e,r,t){if(2958465<e||e<0)return null;var i,a=0|e,n=Math.floor(86400*(e-a)),o=0,l=[],d={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};return Math.abs(d.u)<1e-6&&(d.u=0),r&&r.date1904&&(a+=1462),.9999<d.u&&(d.u=0,86400==++n&&(d.T=n=0,++a,++d.D)),60===a?(l=t?[1317,10,29]:[1900,2,29],o=3):0===a?(l=t?[1317,8,29]:[1900,1,0],o=6):(60<a&&--a,(i=new Date(1900,0,1)).setDate(i.getDate()+a-1),l=[i.getFullYear(),i.getMonth()+1,i.getDate()],o=i.getDay(),a<60&&(o=(o+6)%7),t&&(o=0)),d.y=l[0],d.m=l[1],d.d=l[2],d.S=n%60,n=Math.floor(n/60),d.M=n%60,n=Math.floor(n/60),d.H=n,d.q=o,d}r(u),e.parse_date_code=z;var i=new Date(1899,11,31,0,0,0),a=i.getTime(),n=new Date(1900,2,1,0,0,0);function m(e,r){var t=e.getTime();return r?t-=1262304e5:n<=e&&(t+=864e5),(t-(a+6e4*(e.getTimezoneOffset()-i.getTimezoneOffset())))/864e5}function t(e){return e.toString(10)}e._general_int=t;var f,o,s,g,c,l=(f=/\.(\d*[1-9])0+$/,o=/\.0*$/,s=/\.(\d*[1-9])0+/,g=/\.0*[Ee]/,c=/(E[+-])(\d)$/,function(e){var r,t,i,a,n,o=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),l=-4<=o&&o<=-1?e.toPrecision(10+o):Math.abs(o)<=9?(a=(i=e)<0?12:11,(n=h(i.toFixed(12))).length<=a||(n=i.toPrecision(10)).length<=a?n:i.toExponential(5)):10===o?e.toFixed(10).substr(0,12):((t=(r=e).toFixed(11).replace(f,".$1")).length>(r<0?12:11)&&(t=r.toPrecision(6)),t);return h(function(e){for(var r=0;r!=e.length;++r)if(101==(32|e.charCodeAt(r)))return e.replace(s,".$1").replace(g,"E").replace("e","E").replace(c,"$10$2");return e}(l))});function h(e){return-1<e.indexOf(".")?e.replace(o,"").replace(f,".$1"):e}function D(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return((0|e)===e?t:l)(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return y(14,m(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function P(e){if(e.length<=3)return e;for(var r=e.length%3,t=e.substr(0,r);r!=e.length;r+=3)t+=(0<t.length?",":"")+e.substr(r,3);return t}e._general_num=l,e._general=D;var L,B,q,H,V,U=(L=/%/g,B=/# (\?+)( ?)\/( ?)(\d+)/,q=/^#*0*\.([0#]+)/,H=/\).*[0#]/,V=/\(###\) ###\\?-####/,function(e,r,t){return((0|t)===t?w:X)(e,r,t)});function Y(e){for(var r,t="",i=0;i!=e.length;++i)switch(r=e.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function W(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function G(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?0:Math.round((e-Math.floor(e))*Math.pow(10,r))}function X(e,r,t){if(40===e.charCodeAt(0)&&!r.match(H)){var i=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=t?X("n",i,t):"("+X("n",i,-t)+")"}if(44===r.charCodeAt(r.length-1))return function(e,r,t){for(var i=r.length-1;44===r.charCodeAt(i-1);)--i;return U(e,r.substr(0,i),t/Math.pow(10,3*(r.length-i)))}(e,r,t);if(-1!==r.indexOf("%"))return a=e,o=t,l=(n=r).replace(L,""),d=n.length-l.length,U(a,l,o*Math.pow(10,2*d))+A("%",d);var a,n,o,l,d,f;if(-1!==r.indexOf("E"))return function e(r,t){var i,a=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+e(r,-t);var n=r.indexOf(".");-1===n&&(n=r.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%n;if(o<0&&(o+=n),-1===(i=(t/Math.pow(10,o)).toPrecision(1+a+(n+o)%n)).indexOf("e")){var l=Math.floor(Math.log(t)*Math.LOG10E);for(-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(l-i.length+o):i+="E+"+(l-o);"0."===i.substr(0,2);)i=(i=i.charAt(0)+i.substr(2,n)+"."+i.substr(2+n)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");i=i.replace(/\+-/,"-")}i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,r,t,i){return r+t+i.substr(0,(n+o)%n)+"."+i.substr(o)+"E"})}else i=t.toExponential(a);return r.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),r.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}(r,t);if(36===r.charCodeAt(0))return"$"+X(e,r.substr(" "==r.charAt(1)?2:1),t);var s,g,c,u,m,h,j,p,v,b,_,w,y,x=Math.abs(t),C=t<0?"-":"";if(r.match(/^00+$/))return C+E(x,r.length);if(r.match(/^[#?]+$/))return"0"===(f=E(t,0))&&(f=""),f.length>r.length?f:Y(r.substr(0,r.length-f.length))+f;if(s=r.match(B))return u=s,m=x,h=C,j=parseInt(u[4],10),p=Math.round(m*j),v=Math.floor(p/j),h+(0===v?"":""+v)+" "+(0==(b=p-v*(_=j))?A(" ",u[1].length+1+u[4].length):N(b,u[1].length)+u[2]+"/"+u[3]+F(_,u[4].length));if(r.match(/^#+0+$/))return C+E(x,r.length-r.indexOf("0"));if(s=r.match(q))return f=W(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Y(s[1])).replace(/\.$/,"."+Y(s[1])).replace(/\.(\d*)$/,function(e,r){return"."+r+A("0",Y(s[1]).length-r.length)}),-1!==r.indexOf("0.")?f:f.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return C+W(x,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return C+P(E(x,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+X(e,r,-t):P(""+(Math.floor(t)+(w=t,(y=s[1].length)<(""+Math.round((w-Math.floor(w))*Math.pow(10,y))).length?1:0)))+"."+F(G(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return X(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return f=S(X(e,r.replace(/[\\-]/g,""),t)),g=0,S(S(r.replace(/\\/g,"")).replace(/[0#]/g,function(e){return g<f.length?f.charAt(g++):"0"===e?"0":""}));if(r.match(V))return"("+(f=X(e,"##########",t)).substr(0,3)+") "+f.substr(3,3)+"-"+f.substr(6);var T,I="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(s[4].length,7),c=O(x,Math.pow(10,g)-1,!1),f=C," "==(I=U("n",s[1],c[1])).charAt(I.length-1)&&(I=I.substr(0,I.length-1)+"0"),f+=I+s[2]+"/"+s[3],(I=M(c[2],g)).length<s[4].length&&(I=Y(s[4].substr(s[4].length-I.length))+I),f+=I;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(Math.max(s[1].length,s[4].length),7),C+((c=O(x,Math.pow(10,g)-1,!0))[0]||(c[1]?"":"0"))+" "+(c[1]?N(c[1],g)+s[2]+"/"+s[3]+M(c[2],g):A(" ",2*g+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return f=E(t,0),r.length<=f.length?f:Y(r.substr(0,r.length-f.length))+f;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){f=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),g=f.indexOf(".");var $=r.indexOf(".")-g,R=r.length-f.length-$;return Y(r.substr(0,$)+f+r.substr(r.length-R))}if(s=r.match(/^00,000\.([#0]*0)$/))return g=G(t,s[1].length),t<0?"-"+X(e,r,-t):P((T=t)<2147483647&&-2147483648<T?""+(0<=T?0|T:T-1|0):""+Math.floor(T)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?F(0,3-e.length):"")+e})+"."+F(g,s[1].length);switch(r){case"###,##0.00":return X(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var k=P(E(x,0));return"0"!==k?C+k:"";case"###,###.00":return X(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return X(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function w(e,r,t){if(40===e.charCodeAt(0)&&!r.match(H)){var i=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return 0<=t?w("n",i,t):"("+w("n",i,-t)+")"}if(44===r.charCodeAt(r.length-1))return function(e,r,t){for(var i=r.length-1;44===r.charCodeAt(i-1);)--i;return U(e,r.substr(0,i),t/Math.pow(10,3*(r.length-i)))}(e,r,t);if(-1!==r.indexOf("%"))return a=e,o=t,l=(n=r).replace(L,""),d=n.length-l.length,U(a,l,o*Math.pow(10,2*d))+A("%",d);var a,n,o,l,d,f;if(-1!==r.indexOf("E"))return function e(r,t){var i,a=r.indexOf("E")-r.indexOf(".")-1;if(r.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+e(r,-t);var n=r.indexOf(".");-1===n&&(n=r.indexOf("E"));var o,l=Math.floor(Math.log(t)*Math.LOG10E)%n;l<0&&(l+=n),(i=(t/Math.pow(10,l)).toPrecision(1+a+(n+l)%n)).match(/[Ee]/)||(o=Math.floor(Math.log(t)*Math.LOG10E),-1===i.indexOf(".")?i=i.charAt(0)+"."+i.substr(1)+"E+"+(o-i.length+l):i+="E+"+(o-l),i=i.replace(/\+-/,"-")),i=i.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,r,t,i){return r+t+i.substr(0,(n+l)%n)+"."+i.substr(l)+"E"})}else i=t.toExponential(a);return r.match(/E\+00$/)&&i.match(/e[+-]\d$/)&&(i=i.substr(0,i.length-1)+"0"+i.charAt(i.length-1)),r.match(/E\-/)&&i.match(/e\+/)&&(i=i.replace(/e\+/,"e")),i.replace("e","E")}(r,t);if(36===r.charCodeAt(0))return"$"+w(e,r.substr(" "==r.charAt(1)?2:1),t);var s,g,c,u,m,h=Math.abs(t),j=t<0?"-":"";if(r.match(/^00+$/))return j+F(h,r.length);if(r.match(/^[#?]+$/))return(f=0===t?"":""+t).length>r.length?f:Y(r.substr(0,r.length-f.length))+f;if(s=r.match(B))return j+(0===(m=h)?"":""+m)+A(" ",(u=s)[1].length+2+u[4].length);if(r.match(/^#+0+$/))return j+F(h,r.length-r.indexOf("0"));if(s=r.match(q))return f=(f=(""+t).replace(/^([^\.]+)$/,"$1."+Y(s[1])).replace(/\.$/,"."+Y(s[1]))).replace(/\.(\d*)$/,function(e,r){return"."+r+A("0",Y(s[1]).length-r.length)}),-1!==r.indexOf("0.")?f:f.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return j+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return j+P(""+h);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+w(e,r,-t):P(""+t)+"."+A("0",s[1].length);if(s=r.match(/^#,#*,#0/))return w(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return f=S(w(e,r.replace(/[\\-]/g,""),t)),g=0,S(S(r.replace(/\\/g,"")).replace(/[0#]/g,function(e){return g<f.length?f.charAt(g++):"0"===e?"0":""}));if(r.match(V))return"("+(f=w(e,"##########",t)).substr(0,3)+") "+f.substr(3,3)+"-"+f.substr(6);var p="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(s[4].length,7),c=O(h,Math.pow(10,g)-1,!1),f=j," "==(p=U("n",s[1],c[1])).charAt(p.length-1)&&(p=p.substr(0,p.length-1)+"0"),f+=p+s[2]+"/"+s[3],(p=M(c[2],g)).length<s[4].length&&(p=Y(s[4].substr(s[4].length-p.length))+p),f+=p;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(Math.max(s[1].length,s[4].length),7),j+((c=O(h,Math.pow(10,g)-1,!0))[0]||(c[1]?"":"0"))+" "+(c[1]?N(c[1],g)+s[2]+"/"+s[3]+M(c[2],g):A(" ",2*g+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return f=""+t,r.length<=f.length?f:Y(r.substr(0,r.length-f.length))+f;if(s=r.match(/^([#0]+)\.([#0]+)$/)){f=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),g=f.indexOf(".");var v=r.indexOf(".")-g,b=r.length-f.length-v;return Y(r.substr(0,v)+f+r.substr(r.length-b))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+w(e,r,-t):P(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?F(0,3-e.length):"")+e})+"."+F(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var _=P(""+h);return"0"!==_?j+_:"";default:if(r.match(/\.[0#?]*$/))return w(e,r.slice(0,r.lastIndexOf(".")),t)+Y(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function j(e){for(var r=[],t=!1,i=0,a=0;i<e.length;++i)switch(e.charCodeAt(i)){case 34:t=!t;break;case 95:case 42:case 92:++i;break;case 59:r[r.length]=e.substr(a,i-a),a=i+1}if(r[r.length]=e.substr(a),!0===t)throw new Error("Format |"+e+"| unterminated string ");return r}e._split=j;var Z=/\[[HhMmSs]*\]/;function K(e){for(var r=0,t="",i="";r<e.length;)switch(t=e.charAt(r)){case"G":$(e,r)&&(r+=6),r++;break;case'"':for(;34!==e.charCodeAt(++r)&&r<e.length;)++r;++r;break;case"\\":case"_":r+=2;break;case"@":++r;break;case"B":case"b":if("1"===e.charAt(r+1)||"2"===e.charAt(r+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(r,3).toUpperCase())return!0;if("AM/PM"===e.substr(r,5).toUpperCase())return!0;++r;break;case"[":for(i=t;"]"!==e.charAt(r++)&&r<e.length;)i+=e.charAt(r);if(i.match(Z))return!0;break;case".":case"0":case"#":for(;r<e.length&&(-1<"0#?.,E+-%".indexOf(t=e.charAt(++r))||"\\"==t&&"-"==e.charAt(r+1)&&-1<"0#".indexOf(e.charAt(r+2))););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r," "!=e.charAt(r)&&"*"!=e.charAt(r)||++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&-1<"0123456789".indexOf(e.charAt(++r)););break;case" ":default:++r}return!1}function p(e,r,t,i){for(var a,n,o,l=[],d="",f=0,s="",g="t",c="H";f<e.length;)switch(s=e.charAt(f)){case"G":if(!$(e,f))throw new Error("unrecognized character "+s+" in "+e);l[l.length]={t:"G",v:"General"},f+=7;break;case'"':for(d="";34!==(o=e.charCodeAt(++f))&&f<e.length;)d+=String.fromCharCode(o);l[l.length]={t:"t",v:d},++f;break;case"\\":var u=e.charAt(++f),m="("===u||")"===u?u:"t";l[l.length]={t:m,v:u},++f;break;case"_":l[l.length]={t:"t",v:" "},f+=2;break;case"@":l[l.length]={t:"T",v:r},++f;break;case"B":case"b":if("1"===e.charAt(f+1)||"2"===e.charAt(f+1)){if(null==a&&null==(a=z(r,t,"2"===e.charAt(f+1))))return"";l[l.length]={t:"X",v:e.substr(f,2)},g=s,f+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":s=s.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0)return"";if(null==a&&null==(a=z(r,t)))return"######";for(d=s;++f<e.length&&e.charAt(f).toLowerCase()===s;)d+=s;"m"===s&&"h"===g.toLowerCase()&&(s="M"),"h"===s&&(s=c),l[l.length]={t:s,v:d},g=s;break;case"A":case"a":var h={t:s,v:s};if(null==a&&(a=z(r,t)),"A/P"===e.substr(f,3).toUpperCase()?(null!=a&&(h.v=12<=a.H?"P":"A"),h.t="T",c="h",f+=3):"AM/PM"===e.substr(f,5).toUpperCase()?(null!=a&&(h.v=12<=a.H?"PM":"AM"),h.t="T",f+=5,c="h"):(h.t="t",++f),null==a&&"T"===h.t)return"";l[l.length]=h,g=s;break;case"[":for(d=s;"]"!==e.charAt(f++)&&f<e.length;)d+=e.charAt(f);if("]"!==d.slice(-1))throw'unterminated "[" block: |'+d+"|";if(d.match(Z)){if(null==a&&null==(a=z(r,t)))return"";l[l.length]={t:"Z",v:d.toLowerCase()},g=d.charAt(1)}else-1<d.indexOf("$")&&(d=(d.match(/\$([^-\[\]]*)/)||[])[1]||"$",K(e)||(l[l.length]={t:"t",v:d}));break;case".":if(null!=a){for(d=s;++f<e.length&&"0"===(s=e.charAt(f));)d+=s;l[l.length]={t:"s",v:d};break}case"0":case"#":for(d=s;++f<e.length&&-1<"0#?.,E+-%".indexOf(s=e.charAt(f))||"\\"==s&&"-"==e.charAt(f+1)&&f<e.length-2&&-1<"0#".indexOf(e.charAt(f+2));)d+=s;l[l.length]={t:"n",v:d};break;case"?":for(d=s;e.charAt(++f)===s;)d+=s;l[l.length]={t:s,v:d},g=s;break;case"*":++f," "!=e.charAt(f)&&"*"!=e.charAt(f)||++f;break;case"(":case")":l[l.length]={t:1===i?"t":s,v:s},++f;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(d=s;f<e.length&&-1<"0123456789".indexOf(e.charAt(++f));)d+=e.charAt(f);l[l.length]={t:"D",v:d};break;case" ":l[l.length]={t:s,v:s},++f;break;default:if(-1==="¤฿BsBr₵₡₫ƒFtRs.₭kr£₤Lm₥₦₱PQRSkRp৲৳R$S/.〒₮₩¥NT￥zł₴₪៛руб€＄,$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP$￥LekdinAf$dhAflRial?￡BirrKzMOPPGKRsGsB/R$ррlevkrKMzBsPNuFBuKPkrRD$NfkCFA?CVEGMDFrCDHTGNAfLFdjKGSFGGHSRielKCFknKshLSLL￡LtRFRONArRfMWKRMMURsMROS/KMDLMTnRC$kr€GELCHFSLLSCRDbSZLSDGSOSSomFCFPTShT$VUVQUGXгрнsomWSTNT$FtDramRpZMWFCFA".indexOf(s))throw new Error("unrecognized character "+s+" in "+e);l[l.length]={t:"t",v:s},++f}var j,p=0,v=0;for(f=l.length-1,g="t";0<=f;--f)switch(l[f].t){case"h":case"H":l[f].t=c,g="h",p<1&&(p=1);break;case"s":(j=l[f].v.match(/\.0+$/))&&(v=Math.max(v,j[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":g=l[f].t;break;case"m":"s"===g&&(l[f].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&l[f].v.match(/[Hh]/)&&(p=1),p<2&&l[f].v.match(/[Mm]/)&&(p=2),p<3&&l[f].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:.5<=a.u&&(a.u=0,++a.S),60<=a.S&&(a.S=0,++a.M),60<=a.M&&(a.M=0,++a.H);break;case 2:.5<=a.u&&(a.u=0,++a.S),60<=a.S&&(a.S=0,++a.M)}var b,_="";for(f=0;f<l.length;++f)switch(l[f].t){case"t":case"T":case" ":case"D":break;case"X":l[f].v="",l[f].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[f].v=function(e,r,t,i){var a,n="",o=0,l=0,d=t.y,f=0;switch(e){case 98:d=t.y+543;case 121:switch(r.length){case 1:case 2:a=d%100,f=2;break;default:a=d%1e4,f=4}break;case 109:switch(r.length){case 1:case 2:a=t.m,f=r.length;break;case 3:return k[t.m-1][1];case 5:return k[t.m-1][0];default:return k[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:a=t.d,f=r.length;break;case 3:return R[t.q][0];default:return R[t.q][1]}break;case 104:switch(r.length){case 1:case 2:a=1+(t.H+11)%12,f=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:a=t.H,f=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:a=t.M,f=r.length;break;default:throw"bad minute format: "+r}break;case 115:if("s"!=r&&"ss"!=r&&".0"!=r&&".00"!=r&&".000"!=r)throw"bad second format: "+r;return 0!==t.u||"s"!=r&&"ss"!=r?(60*(l=2<=i?3===i?1e3:100:1===i?10:1)<=(o=Math.round(l*(t.S+t.u)))&&(o=0),"s"===r?0===o?"0":""+o/l:(n=F(o,2+i),"ss"===r?n.substr(0,2):"."+n.substr(2,r.length-1))):F(t.S,r.length);case 90:switch(r){case"[h]":case"[hh]":a=24*t.D+t.H;break;case"[m]":case"[mm]":a=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":a=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+r}f=3===r.length?1:2;break;case 101:a=d,f=1}return 0<f?F(a,f):""}(l[f].t.charCodeAt(0),l[f].v,a,v),l[f].t="t";break;case"n":case"(":case"?":for(b=f+1;null!=l[b]&&("?"===(s=l[b].t)||"D"===s||(" "===s||"t"===s)&&null!=l[b+1]&&("?"===l[b+1].t||"t"===l[b+1].t&&"/"===l[b+1].v)||"("===l[f].t&&(" "===s||"n"===s||")"===s)||"t"===s&&("/"===l[b].v||" "===l[b].v&&null!=l[b+1]&&"?"==l[b+1].t));)l[f].v+=l[b].v,l[b]={v:"",t:";"},++b;_+=l[f].v,f=b-1;break;case"G":l[f].t="t",l[f].v=D(r,t)}var w,y,x="";if(0<_.length){40==_.charCodeAt(0)?(w=r<0&&45===_.charCodeAt(0)?-r:r,y=U("(",_,w)):(y=U("n",_,w=r<0&&1<i?-r:r),w<0&&l[0]&&"t"==l[0].t&&(y=y.substr(1),l[0].v="-"+l[0].v)),b=y.length-1;for(var C=l.length,f=0;f<l.length;++f)if(null!=l[f]&&"t"!=l[f].t&&-1<l[f].v.indexOf(".")){C=f;break}var T=l.length;if(C===l.length&&-1===y.toUpperCase().indexOf("E")){for(f=l.length-1;0<=f;--f)null!=l[f]&&-1!=="n?(".indexOf(l[f].t)&&(b>=l[f].v.length-1?(b-=l[f].v.length,l[f].v=y.substr(b+1,l[f].v.length)):b<0?l[f].v="":(l[f].v=y.substr(0,b+1),b=-1),l[f].t="t",T=f);0<=b&&T<l.length&&(l[T].v=y.substr(0,b+1)+l[T].v)}else if(C!==l.length&&-1===y.toUpperCase().indexOf("E")){for(b=y.indexOf(".")-1,f=C;0<=f;--f)if(null!=l[f]&&-1!=="n?(".indexOf(l[f].t)){for(n=-1<l[f].v.indexOf(".")&&f===C?l[f].v.indexOf(".")-1:l[f].v.length-1,x=l[f].v.substr(n+1);0<=n;--n)0<=b&&("0"===l[f].v.charAt(n)||"#"===l[f].v.charAt(n))&&(x=y.charAt(b--)+x);l[f].v=x,l[f].t="t",T=f}for(0<=b&&T<l.length&&(l[T].v=y.substr(0,b+1)+l[T].v),b=y.indexOf(".")+1,f=C;f<l.length;++f)if(null!=l[f]&&(-1!=="n?(".indexOf(l[f].t)||f===C)){for(n=-1<l[f].v.indexOf(".")&&f===C?l[f].v.indexOf(".")+1:0,x=l[f].v.substr(0,n);n<l[f].v.length;++n)b<y.length&&(x+=y.charAt(b++));l[f].v=x,l[f].t="t",T=f}}}for(f=0;f<l.length;++f)null!=l[f]&&-1<"n(?".indexOf(l[f].t)&&(w=1<i&&r<0&&0<f&&"-"===l[f-1].v?-r:r,l[f].v=U(l[f].t,l[f].v,w),l[f].t="t");var I="";for(f=0;f!==l.length;++f)null!=l[f]&&(I+=l[f].v);return I}e.is_date=K,e._eval=p;var v=/\[[=<>]/,b=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function _(e,r){if(null!=r){var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return 1;break;case">":if(t<e)return 1;break;case"<":if(e<t)return 1;break;case"<>":if(e!=t)return 1;break;case">=":if(t<=e)return 1;break;case"<=":if(e<=t)return 1}}}function y(e,r,t){null==t&&(t={});var i="";switch(typeof e){case"string":i="m/d/yy"==e&&t.dateNF?t.dateNF:e;break;case"number":i=14==e&&t.dateNF?t.dateNF:(null!=t.table?t.table:u)[e]}if(i.match(/^(w|W)((0?)|(0\.0+))$/)){if(isNaN(r))return r;var a=i.slice(1),n=!1;!isNaN(r)&&Number(r)<0&&(n=!0,r=Math.abs(r));var o,l,d,f=parseInt(r).toString().length;if(4<f){if(-1!=(r=8<f?(o=parseInt(r/1e8),l=parseInt(jfgrid.floatTool.subtract(r,1e8*o)/1e4),d=jfgrid.floatTool.subtract(r,1e8*o+1e4*l),""!=a&&(d=numeral(d).format(a)),o+"亿"+l+"万"+d):(l=parseInt(r/1e4),d=jfgrid.floatTool.subtract(r,1e4*l),""!=a&&(d=numeral(d).format(a)),l+"万"+d)).indexOf("亿0万0")?r=r.replace("0万0",""):-1!=r.indexOf("亿0万")?r=r.replace("0万",""):-1!=r.indexOf("万0")&&(r=r.replace("万0","万")),-1!=r.indexOf("亿")&&-1==r.indexOf("万")){if("."!==(s=r.substring(r.indexOf("亿")+1)).substring(0,1)&&""!=s){switch((parseInt(s)+"").length){case 1:s="000"+s;break;case 2:s="00"+s;break;case 3:s="0"+s}r=r.substring(0,r.indexOf("亿")+1)+s}}else if(-1==r.indexOf("亿")&&-1!=r.indexOf("万")){if("."!==(g=r.substring(r.indexOf("万")+1)).substring(0,1)&&""!=g){switch((parseInt(g)+"").length){case 1:g="000"+g;break;case 2:g="00"+g;break;case 3:g="0"+g}r=r.substring(0,r.indexOf("万")+1)+g}}else if(-1!=r.indexOf("亿")&&-1!=r.indexOf("万")){var s=r.substring(r.indexOf("亿")+1,r.indexOf("万")),g=r.substring(r.indexOf("万")+1);switch((parseInt(s)+"").length){case 1:s="000"+s;break;case 2:s="00"+s;break;case 3:s="0"+s}if(r=r.substring(0,r.indexOf("亿")+1)+s+r.substring(r.indexOf("万")),"."!==g.substring(0,1)&&""!=g){switch((parseInt(g)+"").length){case 1:g="000"+g;break;case 2:g="00"+g;break;case 3:g="0"+g}r=r.substring(0,r.indexOf("万")+1)+g}}}else""!=a&&(r=numeral(r).format(a));return n?"-"+r:r}if($(i,0))return D(r,t);r instanceof Date&&(r=m(r,t.date1904));var c=function(e,r){var t=j(e),i=t.length,a=t[i-1].indexOf("@");if(i<4&&-1<a&&--i,4<t.length)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof r)return[4,4===t.length||-1<a?t[t.length-1]:"@"];switch(t.length){case 1:t=-1<a?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=-1<a?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=-1<a?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var n=0<r?t[0]:r<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[i,n];if(null==t[0].match(v)&&null==t[1].match(v))return[i,n];var o=t[0].match(b),l=t[1].match(b);return _(r,o)?[i,t[0]]:_(r,l)?[i,t[1]]:[i,t[null!=o&&null!=l?2:1]]}(i,r);if($(c[1]))return D(r,t);if(!0===r)r="TRUE";else if(!1===r)r="FALSE";else if(""===r||null==r)return"";return p(c[1],r,t,c[0])}function x(e,r){if("number"!=typeof r){r=+r||-1;for(var t=0;t<392;++t)if(null!=u[t]){if(u[t]==e){r=t;break}}else r<0&&(r=t);r<0&&(r=391)}return u[r]=e,r}e.load=x,e._table=u,e.get_table=function(){return u},e.load_table=function(e){for(var r=0;392!=r;++r)void 0!==e[r]&&x(e[r],r)},e.init_table=r,e.format=y}(b);var n,o,i={"General Number":"General","General Date":b._table[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":b._table[15],"Short Date":b._table[14],"Long Time":b._table[19],"Medium Time":b._table[18],"Short Time":b._table[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:b._table[2],Standard:b._table[4],Percent:b._table[10],Scientific:b._table[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'},a=(n=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,o=/_x([\da-fA-F]{4})_/g,function e(r){var t=r+"",i=t.indexOf("<![CDATA[");if(-1==i)return t.replace(n,function(e,r){return encodings[e]||String.fromCharCode(parseInt(r,-1<e.indexOf("x")?16:10))||e}).replace(o,function(e,r){return String.fromCharCode(parseInt(r,16))});var a=t.indexOf("]]>");return e(t.slice(0,i))+t.slice(i+9,a)+e(t.slice(a+3))});jfgrid.xlml_format=function(e,r){var t=i[e]||a(e);return"General"===t?b._general(r):b.format(t,r)},jfgrid.SSF=b;new Date(1899,11,31,0,0,0).getTime();var _=new Date(1900,2,1,0,0,0);var l=new Date("2017-02-19T19:06:09.000Z");isNaN(l.getFullYear())&&(l=new Date("2/19/17"));var d=2017==l.getFullYear();function w(e,r){var t=new Date(e);if(d)return 0<r?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):r<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(e instanceof Date)return e;if(1917==l.getFullYear()&&!isNaN(t.getFullYear())){var i=t.getFullYear();return-1<e.indexOf(""+i)?t:(t.setFullYear(t.getFullYear()+100),t)}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+a[0],a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return-1<e.indexOf("Z")&&(n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3)),n}function f(e){var r=Number(e);if("number"==typeof e)return e;if(!isNaN(r))return r;var t=1,i=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(r=Number(i))?(i=i.replace(/[(](.*)[)]/,function(e,r){return t=-t,r}),isNaN(r=Number(i))?r:r/t):r/t}return jfgrid.parseDate=w,jfgrid.fuzzynum=f,jfgrid.fuzzydate=function(e){var r=new Date(e),t=new Date(NaN),i=r.getYear(),a=r.getMonth(),n=r.getDate();return isNaN(n)||i<0||8099<i||(!(0<a||1<n)||101==i)&&!e.toLowerCase().match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)&&e.match(/[^-0-9:,\/\\]/)?t:r},{genarate:function(e){var r,t,i,a,n=null,o={},l=e;if(null==e)return null;if("'"===e.toString().substr(0,1))n=e.toString().substr(1),o={fa:"@",t:"s"};else if("TRUE"===e.toString().toUpperCase())n="TRUE",o={fa:"General",t:"b"},l=!0;else if("FALSE"===e.toString().toUpperCase())n="FALSE",l=!(o={fa:"General",t:"b"});else if(jfgrid.func_methods.valueIsError(e))n=e.toString(),o={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(e))n=e.toString(),o={fa:"@",t:"s"};else if(jfgrid.func_methods.isRealNum(e)&&0<Math.abs(parseFloat(e))&&(1e11<=Math.abs(parseFloat(e))||Math.abs(parseFloat(e))<1e-9))var d,f=(l=numeral(e).value()).toExponential(),o=-1<f.indexOf(".")?(5<(d=f.split(".")[1].split("e")[0].length)&&(d=5),{fa:"#0."+new Array(d+1).join("0")+"E+00",t:"n"}):{fa:"#0.E+00",t:"n"},n=b.format(o.fa,l);else if(-1<e.toString().indexOf("%")){var s=e.toString().indexOf("%"),g=(j=e.toString().substr(0,s)).replace(/,/g,"");if(s==e.toString().length-1&&jfgrid.func_methods.isRealNum(g))if(-1<j.indexOf("."))if(j.indexOf(".")==j.lastIndexOf(".")){var c=j.split(".")[0];if(9<(p=j.split(".")[1].length)&&(p=9),-1<c.indexOf(",")){for(var u=!0,m=c.split(","),h=1;h<m.length;h++)if(m[h].length<3){u=!1;break}u?(o={fa:"#,##0."+new Array(p+1).join("0")+"%",t:"n"},l=numeral(e).value(),n=b.format(o.fa,l)):(n=e.toString(),o={fa:"@",t:"s"})}else o={fa:"0."+new Array(p+1).join("0")+"%",t:"n"},l=numeral(e).value(),n=b.format(o.fa,l)}else n=e.toString(),o={fa:"@",t:"s"};else if(-1<j.indexOf(",")){for(u=!0,m=j.split(","),h=1;h<m.length;h++)if(m[h].length<3){u=!1;break}u?(o={fa:"#,##0%",t:"n"},l=numeral(e).value(),n=b.format(o.fa,l)):(n=e.toString(),o={fa:"@",t:"s"})}else o={fa:"0%",t:"n"},l=numeral(e).value(),n=b.format(o.fa,l);else n=e.toString(),o={fa:"@",t:"s"}}else if(-1<e.toString().indexOf("."))if(e.toString().indexOf(".")==e.toString().lastIndexOf(".")){var j,p,v=e.toString().split(".")[0];if(9<(p=(j=e.toString().split(".")[1]).length)&&(p=9),-1<v.indexOf(",")){for(u=!0,m=v.split(","),h=1;h<m.length;h++)if(!jfgrid.func_methods.isRealNum(m[h])||m[h].length<3){u=!1;break}u?(o={fa:"#,##0."+new Array(p+1).join("0"),t:"n"},l=numeral(e).value(),n=b.format(o.fa,l)):(n=e.toString(),o={fa:"@",t:"s"})}else jfgrid.func_methods.isRealNum(v)&&jfgrid.func_methods.isRealNum(j)?(o={fa:"0."+new Array(p+1).join("0"),t:"n"},l=numeral(e).value(),n=b.format(o.fa,l)):(n=e.toString(),o={fa:"@",t:"s"})}else n=e.toString(),o={fa:"@",t:"s"};else jfgrid.func_methods.isRealNum(e)?(n=e.toString(),o={fa:"General",t:"n"},l=parseFloat(e)):jfgrid.datecontroll.isdatetime(e)&&(-1<e.toString().indexOf(".")||-1<e.toString().indexOf(":")||e.toString().length<16)?(r=w(e.toString().replace(/-/g,"/")),i=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds()),a=Date.UTC(1899,11,31,0,0,0),t?i-=1262304e5:_<=r&&(i+=864e5),-1<(l=(i-a)/864e5).toString().indexOf(".")?18<e.toString().length?o.fa="yyyy-MM-dd hh:mm:ss":11<e.toString().length?o.fa="yyyy-MM-dd hh:mm":o.fa="yyyy-MM-dd":o.fa="yyyy-MM-dd",o.t="d",n=b.format(o.fa,l)):(n=e,o.fa="General",o.t="g");return[n,o,l]},update:function(e,r){return b.format(e,r)},is_date:function(e,r){return b.is_date(e,r)},valueShowEs:function(e,r,t){var i=jfgrid.getcellvalue(e,r,t,"m");return null==i?i=jfgrid.getcellvalue(e,r,t,"v"):isNaN(f(i))?null!=t[e][r].ct&&"d"==t[e][r].ct.t||null!=t[e][r].ct&&"b"==t[e][r].ct.t||(i=jfgrid.getcellvalue(e,r,t,"v")):"string"==typeof i&&-1<i.indexOf("%")||(i=jfgrid.getcellvalue(e,r,t,"v")),i}}}(),jfgrid.pivotTable={pivotDatas:null,pivotSheetIndex:0,pivotDataSheetIndex:0,celldata:null,origindata:null,getCellData:function(cursheetindex,datasheetindex,data_select_save){var sheetIndex,sheetIndex=null!=cursheetindex?cursheetindex:jfgrid.currentSheetIndex,realIndex=jfgrid.sheetmanage.getSheetIndex(sheetIndex);"object"!=jfgrid.getObjType(jfgridfile[realIndex].pivotTable)&&(jfgridfile[realIndex].pivotTable=eval("("+jfgridfile[realIndex].pivotTable+")")),null!=jfgridfile[realIndex].pivotTable?(this.column=jfgridfile[realIndex].pivotTable.column,this.row=jfgridfile[realIndex].pivotTable.row,this.values=jfgridfile[realIndex].pivotTable.values,this.filter=jfgridfile[realIndex].pivotTable.filter,this.showType=jfgridfile[realIndex].pivotTable.showType,this.filterparm=jfgridfile[realIndex].pivotTable.filterparm,null!=jfgridfile[realIndex].pivotTable.drawPivotTable?this.drawPivotTable=jfgridfile[realIndex].pivotTable.drawPivotTable:this.drawPivotTable=!0,null!=jfgridfile[realIndex].pivotTable.pivotTableBoundary?this.pivotTableBoundary=jfgridfile[realIndex].pivotTable.pivotTableBoundary:this.pivotTableBoundary=[12,6],this.pivot_select_save=null!=data_select_save?data_select_save:jfgridfile[realIndex].pivotTable.pivot_select_save,this.pivotDataSheetIndex=null!=datasheetindex?datasheetindex:jfgridfile[realIndex].pivotTable.pivotDataSheetIndex):(this.column=null,this.row=null,this.values=null,this.filter=null,this.showType=null,this.filterparm=null,this.drawPivotTable=!0,this.pivotTableBoundary=[12,6],this.pivot_select_save=null!=data_select_save?data_select_save:jfgird_select_save,this.pivotDataSheetIndex=null!=datasheetindex?datasheetindex:sheetIndex);var pivotrealIndex=jfgrid.sheetmanage.getSheetIndex(this.pivotDataSheetIndex),otherfile=jfgridfile[pivotrealIndex];null==otherfile.data&&(otherfile.data=jfgrid.sheetmanage.buildGridData(otherfile)),this.origindata=jfgrid.getdatabyselectionD(otherfile.data,this.pivot_select_save);var rowhidden={};if(null!=this.filterparm)for(var f in this.filterparm)for(h in this.filterparm[f])null!=h.rowhidden&&(rowhidden=$.extend(!0,rowhidden,h.rowhidden));this.rowhidden=rowhidden,this.pivotSheetIndex=sheetIndex;for(var newdata=[],i=0;i<this.origindata.length;i++)null!=this.rowhidden&&null!=this.rowhidden[i]||newdata.push([].concat(this.origindata[i]));this.celldata=newdata,this.pivot_data_type={};for(var c=0;c<this.celldata[1].length;c++){var type=jfgrid.isdatatype(this.celldata[1][c]);this.pivot_data_type[c.toString()]=type}},pivot_data_type:{},pivot_select_save:null,column:null,row:null,values:null,filter:null,showType:null,rowhidden:null,selected:null,caljs:null,initial:!0,filterparm:null,jfgrid_pivotTable_select_state:!1,jgridCurrentPivotInput:null,movestate:!1,moveitemposition:[],movesave:{},showvaluecolrow:function(){2<=$("#jfgrid-modal-dialog-config-value .jfgrid-modal-dialog-slider-config-item").length?($("#jfgridpivottablevaluecolrowshow").show(),"column"==this.showType?($("#jfgridpivottablevaluecolrow").prop("checked",!0),$("#jfgridpivottablevaluecolrowshow label[for='jfgridpivottablevaluecolrow']").addClass("ui-state-active"),$("#jfgridpivottablevaluecolrow1").prop("checked",!1),$("#jfgridpivottablevaluecolrowshow label[for='jfgridpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#jfgridpivottablevaluecolrow1").prop("checked",!0),$("#jfgridpivottablevaluecolrowshow label[for='jfgridpivottablevaluecolrow1']").addClass("ui-state-active"),$("#jfgridpivottablevaluecolrow").prop("checked",!1),$("#jfgridpivottablevaluecolrowshow label[for='jfgridpivottablevaluecolrow']").removeClass("ui-state-active"))):$("#jfgridpivottablevaluecolrowshow").hide()},resetOrderby:function(e){var r=$("#jfgrid-modal-dialog-config-value .jfgrid-modal-dialog-slider-config-item").index(e);$("#jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column").find(".jfgrid-modal-dialog-slider-config-item").each(function(){$(this).data("orderby")==r&&$(this).data("orderby","self")})},jfgridsliderlistclearfilter:function(e){var r=e.parent(),t=r.data("index"),i={},a=jfgrid.pivotTable.origindata;r.data("rowhidden","").find(".jfgrid-slider-list-item-filtered").hide(),jfgrid.pivotTable.setDatatojsfile("selected",{},t),jfgrid.pivotTable.setDatatojsfile("rowhidden",null,t);for(var n=[],o=0;o<a.length;o++)null==i[o]&&n.push([].concat(a[o]));jfgrid.pivotTable.celldata=n,jfgrid.pivotTable.refreshPivotTable(),$("#jfgrid-pivotTableFilter-menu, #jfgrid-pivotTableFilter-submenu").hide()},jfgridsliderlistitemfilter:function(e){var r=e.parent(),T=r.offset(),t=$("#jfgrid-pivotTableFilter-menu"),I=$(window).height(),R=($(window).width(),r.data("index")),k=r.data("rowhidden");null==k||""==k?k={}:"string"==jfgrid.getObjType(k)&&(k=JSON.parse(k)),$("body .jfgrid-cols-menu").hide(),$("#jfgrid-pivotTableFilter-menu, #jfgrid-pivotTableFilter-submenu").hide(),$("#jfgrid-pivotTableFilter-byvalue-input").val(""),$("#jfgrid-pivotTableFilter-bycondition").next().hide(),$("#jfgrid-pivotTableFilter-byvalue").next().show(),t.data("index",R),$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input").hide().find("input").val(),$("#jfgrid-pivotTableFilter-selected span").data("type","0").data("type",null).text("无");var i,a=r.data("byconditiontype");$("#jfgrid-pivotTableFilter-selected span").data("value",r.data("byconditionvalue")).data("type",a).text(r.data("byconditiontext")),"2"==a?((i=$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input2").show().find("input")).eq(0).val(r.data("byconditionvalue1")),i.eq(1).val(r.data("byconditionvalue2"))):"1"==a&&$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input").eq(0).show().find("input").val(r.data("byconditionvalue1")),$("#jfgrid-pivotTableFilter-byvalue-select").empty().html('<div style="width:100%;text-align:center;position:relative;top:45%;font-size: 14px;"> <div class="jfgridLoaderGif"> </div> <span>数据量大！请稍后</span></div>');var S={};$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").not(r.get(0)).each(function(){var e=$(this).data("rowhidden");if(null==e||""==e)return!0;for(var r in"string"==jfgrid.getObjType(e)&&(e=JSON.parse(e)),e)S[r]=0});var A=jfgrid.pivotTable.origindata;setTimeout(function(){for(var e,r,t,i,a={},n={},o={},l={},d=1;d<A.length;d++){d in S||null!=A[d]&&(null!=(e=A[d][R])&&null!=e.ct&&"d"==e.ct.t?(r=(C=jfgrid.mask.update("YYYY-MM-DD",e.v)).split("-")[0],i=C.split("-")[1],t=C.split("-")[2],r in a||(a[r]={}),i in a[r]||(a[r][i]={}),t in a[r][i]||(a[r][i][t]=0),a[r][i][t]++,d in k&&(n[r]=0,n[i]=0,n[t]=0)):(i=null==e||jfgrid.func_methods.isRealNull(e.v)?C=null:(C=e.v,e.m),C in o||(o[C]={}),i in o[C]||(o[C][i]=0),o[C][i]++,d in k&&(l[C+"#$$$#"+i]=0)))}var f=[];if(2<JSON.stringify(a).length)for(r in a){var s,g=0,c="";for(i in a[r]){var u,m=0,h="";for(t in a[r][i]){var j,p,v=a[r][i][t];m+=v,j=Number(i)<10?"0"+Number(i):i,p=Number(t)<10?"0"+Number(t):t,h+=r in n&&i in n&&t in n?'<div class="day jfgrid-mousedown-cancel cf" data-check="false" title="'+r+"-"+j+"-"+p+'"><input class="jfgrid-mousedown-cancel" type="checkbox"/><label class="jfgrid-mousedown-cancel">'+t+'</label><span class="count jfgrid-mousedown-cancel">( '+v+" )</span></div>":'<div class="day jfgrid-mousedown-cancel cf" data-check="true" title="'+r+"-"+j+"-"+p+'"><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/><label class="jfgrid-mousedown-cancel">'+t+'</label><span class="count jfgrid-mousedown-cancel">( '+v+" )</span></div>"}g+=m,u=Number(i)<10?"0"+Number(i):i,c+=r in n&&i in n?'<div class="monthBox jfgrid-mousedown-cancel"><div class="month jfgrid-mousedown-cancel cf" data-check="false" title="'+r+"-"+u+'"><i class="fa fa-caret-right jfgrid-mousedown-cancel" aria-hidden="true"></i><input class="jfgrid-mousedown-cancel" type="checkbox"/><label class="jfgrid-mousedown-cancel">'+i+'月</label><span class="count jfgrid-mousedown-cancel">( '+m+' )</span></div><div class="dayList jfgrid-mousedown-cancel">'+h+"</div></div>":'<div class="monthBox jfgrid-mousedown-cancel"><div class="month jfgrid-mousedown-cancel cf" data-check="true" title="'+r+"-"+u+'"><i class="fa fa-caret-right jfgrid-mousedown-cancel" aria-hidden="true"></i><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/><label class="jfgrid-mousedown-cancel">'+i+'月</label><span class="count jfgrid-mousedown-cancel">( '+m+' )</span></div><div class="dayList jfgrid-mousedown-cancel">'+h+"</div></div>"}s=r in n?'<div class="yearBox jfgrid-mousedown-cancel"><div class="year jfgrid-mousedown-cancel cf" data-check="false" title="'+r+'"><i class="fa fa-caret-right jfgrid-mousedown-cancel" aria-hidden="true"></i><input class="jfgrid-mousedown-cancel" type="checkbox"/><label class="jfgrid-mousedown-cancel">'+r+'年</label><span class="count jfgrid-mousedown-cancel">( '+g+' )</span></div><div class="monthList jfgrid-mousedown-cancel">'+c+"</div></div>":'<div class="yearBox jfgrid-mousedown-cancel"><div class="year jfgrid-mousedown-cancel cf" data-check="true" title="'+r+'"><i class="fa fa-caret-right jfgrid-mousedown-cancel" aria-hidden="true"></i><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/><label class="jfgrid-mousedown-cancel">'+r+'年</label><span class="count jfgrid-mousedown-cancel">( '+g+' )</span></div><div class="monthList jfgrid-mousedown-cancel">'+c+"</div></div>",f.unshift(s)}if(2<JSON.stringify(o).length)for(var b=Object.keys(o),b=jfgrid.orderbydata1D(b,!0),_=0;_<b.length;_++){var w,y,C=b[_];for(x in o[C]){w=C+"#$$$#"+x=="null#$$$#null"?"(空白)":x,y=C+"#$$$#"+x in l?'<div class="textBox jfgrid-mousedown-cancel cf" data-check="false" data-filter="'+C+"#$$$#"+x+'" title="'+x+'"><input class="jfgrid-mousedown-cancel" type="checkbox"/><label class="jfgrid-mousedown-cancel">'+w+'</label><span class="jfgrid-mousedown-cancel count">( '+o[C][x]+" )</span></div>":'<div class="textBox jfgrid-mousedown-cancel cf" data-check="true" data-filter="'+C+"#$$$#"+x+'" title="'+x+'"><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/><label class="jfgrid-mousedown-cancel">'+w+'</label><span class="jfgrid-mousedown-cancel count">( '+o[C][x]+" )</span></div>",f.push(y)}}$("#jfgrid-pivotTableFilter-byvalue-select").html("<div class='ListBox jfgrid-mousedown-cancel' style='max-height:"+(I-T.top-350)+"px;overflow-y:auto;overflow-x:hidden;'>"+f.join("")+"</div>")},1),showrightclickmenu(t,T.left-250,T.top)},getSumTypeName:function(e){var r="";return"SUM"==e?r="求和":"COUNT"==e?r="数值计数":"COUNTA"==e?r="计数":"COUNTUNIQUE"==e?r="去重计数":"AVERAGE"==e?r="平均值":"MAX"==e?r="最大值":"MIN"==e?r="最小值":"MEDIAN"==e?r="中位数":"PRODUCT"==e?r="乘积":"STDEV"==e?r="标准差":"STDEVP"==e?r="整体标准差":"VAR"==e?r="方差":"VARP"==e&&(r="整体方差"),r},setDatatojsfile:function(e,r,t){var i=jfgrid.sheetmanage.getSheetIndex(this.pivotSheetIndex);null==jfgridfile[i].pivotTable&&(jfgridfile[i].pivotTable={}),null==t?(jfgridfile[i].pivotTable[e]=r,this[e]=r):(null==jfgridfile[i].pivotTable.filterparm&&(jfgridfile[i].pivotTable.filterparm={}),null==jfgridfile[i].pivotTable.filterparm[t.toString()]&&(jfgridfile[i].pivotTable.filterparm[t.toString()]={}),jfgridfile[i].pivotTable.filterparm[t.toString()][e]=r,null==this.filterparm&&(this.filterparm={}),null==this.filterparm[t.toString()]&&(this.filterparm[t.toString()]={}),this.filterparm[t.toString()][e]=r)},createPivotTable:function(e){var r,t=jfgrid.currentSheetIndex;jfgrid.isEditMode()?alert("非编辑模式下禁止该操作！"):1<jfgird_select_save.length?jfgrid.tooltip.info("提示","不能对多重选择区域执行此操作，请选择单个区域，然后再试"):0!=jfgird_select_save.length&&jfgird_select_save[0].row[0]!=jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]!=jfgird_select_save[0].column[1]?(r=$.extend(!0,{},jfgird_select_save[0]),jfgrid.sheetmanage.addNewSheet(e,!0),this.getCellData(jfgrid.currentSheetIndex,t,r),this.setDatatojsfile("pivot_select_save",r),this.setDatatojsfile("pivotDataSheetIndex",t),this.initialPivotManage()):jfgrid.tooltip.info("提示","请选择新建透视表的区域")},changePivotTable:function(e){var r=jfgridfile[jfgrid.sheetmanage.getSheetIndex(e)].pivotTable.pivotDataSheetIndex;null!=jfgrid.sheetmanage.getSheetIndex(r)?(this.getCellData(e),this.initialPivotManage(!0)):jfgrid.tooltip.info("此数据透视表的源数据已损坏！","")},refreshPivotTable:function(){var e={},r=this.getPivotTableData();e.pivotTable=r,e.data=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),this.storePivotTableParam();var t=this.dataHandler(this.column,this.row,this.values,this.showType,this.celldata);this.setDatatojsfile("pivotDatas",t);var i=$.extend(!0,[],jfgrid.sheetmanage.nulldata),a=i;if(0==t.length)this.setDatatojsfile("drawPivotTable",!0),this.setDatatojsfile("pivotTableBoundary",[12,6]);else{this.setDatatojsfile("drawPivotTable",!1),this.setDatatojsfile("pivotTableBoundary",[t.length,t[0].length]);for(var n=t.length,o=t[0].length,l=n-i.length,d=o-i[0].length,a=jfgrid.datagridgrowth(i,l+20,d+10,!0),f=0;f<n;f++){for(var s=[].concat(a[f]),g=0;g<o;g++){var c="";null!=t[f]&&null!=t[f][g]&&(c=jfgrid.getcellvalue(f,g,t)),s[g]=c}a[f]=s}}e.type="pivotTable_change",e.curdata=$.extend(!0,[],a),e.sheetIndex=jfgrid.currentSheetIndex;r=this.getPivotTableData();e.pivotTablecur=r,clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push(e)),jfgrid.cleargridelement(),clearjfundo=!1,0<l||0<d?jfgrid.jfrefreshgridall(a[0].length,a.length,a,null,jfgird_select_save,"datachangeAll"):(jfgrid.jfrefreshgrid(a,jfgird_select_save),jfgrid.selectHightlightShow()),clearjfundo=!0},drawPivotTable:!0,pivotTableBoundary:[12,6],pivotclick:function(e,r,t){null==t&&(t=jfgrid.currentSheetIndex);var i,a=jfgridfile[jfgrid.sheetmanage.getSheetIndex(t)];a.isPivotTable&&(i=a.pivotTable.pivotDataSheetIndex,null!=jfgrid.sheetmanage.getSheetIndex(i)&&(this.isPivotRange(e,r)?($("#jfgrid-modal-dialog-slider-pivot").show(),jfgrid.jfgridsizeauto(),$("#jfgrid-sta-content").css("padding-right",260)):($("#jfgrid-modal-dialog-slider-pivot").hide(),jfgrid.jfgridsizeauto(),$("#jfgrid-sta-content").css("padding-right",10))))},isPivotRange:function(e,r){if(jfgridcurrentisPivotTable)return e<this.pivotTableBoundary[0]&&r<this.pivotTableBoundary[1]},storePivotTableParam:function(){var r=[],t=[],i=[],a=[];$("#jfgrid-modal-dialog-config-filter .jfgrid-modal-dialog-slider-config-item").each(function(){var e={};e.index=$(this).data("index"),e.name=$(this).data("name"),e.fullname=$(this).find(".jfgrid-modal-dialog-slider-config-item-txt").text(),i.push(e)}),$("#jfgrid-modal-dialog-config-row .jfgrid-modal-dialog-slider-config-item").each(function(){var e={};e.index=$(this).data("index"),e.name=$(this).data("name"),e.fullname=$(this).find(".jfgrid-modal-dialog-slider-config-item-txt").text(),e.order=$(this).data("order"),e.orderby=$(this).data("orderby"),e.stastic=$(this).data("stastic"),t.push(e)}),$("#jfgrid-modal-dialog-config-column .jfgrid-modal-dialog-slider-config-item").each(function(){var e={};e.index=$(this).data("index"),e.name=$(this).data("name"),e.fullname=$(this).find(".jfgrid-modal-dialog-slider-config-item-txt").text(),e.order=$(this).data("order"),e.orderby=$(this).data("orderby"),e.stastic=$(this).data("stastic"),r.push(e)}),$("#jfgrid-modal-dialog-config-value .jfgrid-modal-dialog-slider-config-item").each(function(){var e={};e.index=$(this).data("index"),e.name=$(this).data("name"),e.fullname=$(this).find(".jfgrid-modal-dialog-slider-config-item-txt").text(),e.sumtype=$(this).data("sumtype"),e.nameindex=$(this).data("nameindex"),a.push(e)}),this.setDatatojsfile("column",r),this.setDatatojsfile("row",t),this.setDatatojsfile("filter",i),this.setDatatojsfile("values",a);var e=$("#jfgridpivottablevaluecolrow:checked, #jfgridpivottablevaluecolrow1:checked").val();this.setDatatojsfile("showType","0"==e?"row":"column");var n=this.getPivotTableData();delete n.pivotDatas,jfgrid.server.saveParam("all",this.pivotSheetIndex,n,{k:"pivotTable"})},getPivotTableData:function(dataindex){null==dataindex&&(dataindex=this.pivotSheetIndex);var index=jfgrid.sheetmanage.getSheetIndex(dataindex),pivotTable=jfgridfile[index].pivotTable,pivotTable="object"==jfgrid.getObjType(pivotTable)?$.extend(!0,{},jfgridfile[index].pivotTable):eval("("+pivotTable+")");return pivotTable},addValuesToTitle:function(e,r){var t=e.length*r.length,i=e[0].length+1,a=[];if(0==e.length&&0<r.length){for(var n=0;n<r.length;n++)a.push(r[n].fullname);return a}if(0==r.length&&0<e.length)return e;for(var o=0;o<t;o++){a[o]=new Array(i);for(var l=0;l<i-1;l++)a[o][l]=e[Math.floor(o/r.length)][l];a[o][i-1]=r[o%r.length].fullname}return a},initialPivotManage:function(e){var d;this.initial&&(this.initial=!1,$("body").append(jfgridPivotTableHTML),$("#jfgrid-modal-dialog-slider-close").click(function(){$("#jfgrid-modal-dialog-slider-pivot").hide(),jfgrid.jfgridsizeauto()}),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-data-pivotTable-selection",addclass:"jfgrid-data-pivotTable-selection",title:"选取数据范围",content:'<input id="jfgrid-pivotTable-range-selection-input" class="jfgrid-datavisual-range-container" style="font-size: 14px;padding:5px;max-width:none;" spellcheck="false" aria-label="数据范围" placeholder="数据范围">',botton:'<button id="jfgrid-pivotTable-selection-confirm" class="btn btn-primary">确认选取</button><button class="btn btn-default jfgrid-model-close-btn">取消</button>'})),$("body").append(jfgrid.replaceHtml(filtermenuHTML,{menuid:"pivotTableFilter"})),$("body").append(jfgrid.replaceHtml(filtersubmenuHTML,{menuid:"pivotTableFilter"})),$("body").append(pivottableconfigHTML),$("body").append(pivottablesumHTML),$("#jfgrid-pivotTableFilter-orderby-asc").remove(),$("#jfgrid-pivotTableFilter-orderby-desc").next().remove(),$("#jfgrid-pivotTableFilter-orderby-desc").remove(),$("#jfgrid-pivotTableFilter-orderby-color").next().remove(),$("#jfgrid-pivotTableFilter-orderby-color").remove(),$("#jfgridpivottablevaluecolrow, #jfgridpivottablevaluecolrow1").checkboxradio({icon:!1}).change(function(){jfgrid.pivotTable.refreshPivotTable()}),d=null,$("#jfgrid-pivotTableFilter-menu").mouseover(function(){clearTimeout(d),d=setTimeout(function(){$("#jfgrid-pivotTableFilter-submenu").hide()},500)}),$(document).off("click.ptFilterCheckbox1").on("click.ptFilterCheckbox1","#jfgrid-pivotTableFilter-byvalue-select .textBox",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox2").on("click.ptFilterCheckbox2","#jfgrid-pivotTableFilter-byvalue-select .year",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.ptFilterCheckbox3").on("click.ptFilterCheckbox3","#jfgrid-pivotTableFilter-byvalue-select .month",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));var t=!0;$(this).parents(".yearBox").find(".day").each(function(e,r){"true"==$(r).attr("data-check")||(t=!1)}),t?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterCheckbox4").on("click.ptFilterCheckbox4","#jfgrid-pivotTableFilter-byvalue-select .day",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));var t=!0;$(this).parents(".monthBox").find(".day").each(function(e,r){"true"==$(r).attr("data-check")||(t=!1)}),t?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));var i=!0;$(this).parents(".yearBox").find(".day").each(function(e,r){"true"==$(r).attr("data-check")||(i=!1)}),i?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.ptFilterYearDropdown").on("click.ptFilterYearDropdown","#jfgrid-pivotTableFilter-byvalue-select .yearBox .fa-caret-right",function(){var e=$(this).parents(".jfgrid-mousedown-cancel");e.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),e.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle()}),$("#jfgrid-pivotTableFilter-byvalue-btn-all").click(function(){$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".jfgrid-mousedown-cancel").attr("data-check","true")}),$("#jfgrid-pivotTableFilter-byvalue-btn-contra").click(function(){$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(e,r){$(r).is(":checked")?($(r).removeAttr("checked"),$(r).parents(".jfgrid-mousedown-cancel").attr("data-check","false")):($(r).prop("checked",!0),$(r).parents(".jfgrid-mousedown-cancel").attr("data-check","true"))}),$("#jfgrid-pivotTableFilter-byvalue-select .ListBox .monthBox").each(function(e,r){var t=!0;$(r).find(".day input[type='checkbox']").each(function(e,r){$(r).is(":checked")||(t=!1)}),t?($(r).find(".month input[type='checkbox']").prop("checked",!0),$(r).attr("data-check","true")):($(r).find(".month input[type='checkbox']").removeAttr("checked"),$(r).attr("data-check","false"))}),$("#jfgrid-pivotTableFilter-byvalue-select .ListBox .yearBox").each(function(e,r){var t=!0;$(r).find(".day input[type='checkbox']").each(function(e,r){$(r).is(":checked")||(t=!1)}),t?($(r).find(".year input[type='checkbox']").prop("checked",!0),$(r).attr("data-check","true")):($(r).find(".year input[type='checkbox']").removeAttr("checked"),$(r).attr("data-check","false"))})}),$("#jfgrid-pivotTableFilter-byvalue-btn-clear").click(function(){$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").parents(".jfgrid-mousedown-cancel").attr("data-check","false")}),$("#jfgrid-pivotTableFilter-byvalue-input").on("input propertychange",function(){var n=$(this).val().toString();$("#jfgrid-pivotTableFilter-byvalue-select .ListBox .jfgrid-mousedown-cancel").show(),""!=n&&$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(e,r){var t,i,a=$(r).parents(".jfgrid-mousedown-cancel");a.hasClass("day")&&(t=$(r).siblings("label").text().toString(),i=$(r).parents(".monthBox").find(".month label").text().toString(),-1==($(r).parents(".yearBox").find(".year label").text().toString()+"-"+i+"-"+t).indexOf(n)&&($(r).parents(".day").hide(),0==$(r).parents(".dayList").find(".day:visible").length&&$(r).parents(".monthBox").find(".month").hide(),0==$(r).parents(".monthList").find(".day:visible").length&&$(r).parents(".yearBox").find(".year").hide())),a.hasClass("textBox")&&-1==$(r).siblings("label").text().toString().indexOf(n)&&$(r).parents(".textBox").hide()})}),$("#jfgrid-pivotTableFilter-bycondition, #jfgrid-pivotTableFilter-byvalue").click(function(){var e=$(this);e.next().slideToggle(200),setTimeout(function(){"jfgrid-pivotTableFilter-bycondition"==e.attr("id")&&$("#jfgrid-pivotTableFilter-bycondition").next().is(":visible")&&"无"!=$("#jfgrid-pivotTableFilter-selected span").text()&&$("#jfgrid-pivotTableFilter-byvalue").next().slideUp(200),e.is($("#jfgrid-pivotTableFilter-bycondition"))&&$("#jfgrid-pivotTableFilter-bycondition").next().is(":hidden")&&$("#jfgrid-pivotTableFilter-byvalue").next().is(":hidden")&&$("#jfgrid-pivotTableFilter-byvalue").next().slideDown(200)},300)}),$("#jfgrid-pivotTableFilter-cancel").click(function(){$("#jfgrid-pivotTableFilter-menu, #jfgrid-pivotTableFilter-submenu").hide()}),$("#jfgrid-pivotTableFilter-selected").click(function(){var e=$(this).offset(),r=$("#jfgrid-pivotTableFilter-submenu");r.hide();var t=$(window).height(),i=$(window).width(),a=r.width(),n=(r.height(),e.top),o=e.left,l=t-e.top-20;e.left+a>i&&(o=e.left-a),e.top>t/2&&((n=t-e.top)<0&&(n=0),l=e.top-20),r.css({top:n,left:o,height:l}).show(),clearTimeout(d)}),$("#jfgrid-pivotTableFilter-submenu").mouseover(function(){clearTimeout(d)}).find(".jfgrid-cols-menuitem").click(function(e){$("#jfgrid-pivotTableFilter-selected span").html($(this).find(".jfgrid-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input").hide(),"2"==$(this).data("type")?($("#jfgrid-pivotTableFilter-selected span").data("type","2"),$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input2").show()):"0"==$(this).data("type")?$("#jfgrid-pivotTableFilter-selected span").data("type","0"):($("#jfgrid-pivotTableFilter-selected span").data("type","1"),$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input").eq(0).show(),"dateequal"==$(this).attr("data-value")||"datelessthan"==$(this).attr("data-value")||"datemorethan"==$(this).attr("data-value")?$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input input").prop("type","date"):$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input input").prop("type","text")),$("#jfgrid-pivotTableFilter-byvalue").next().slideUp(),$("#jfgrid-pivotTableFilter-submenu").hide()}),$("#jfgrid-modal-dialog-pivotTable-list").on("click"," .jfgrid-slider-list-item-filter",function(e){return jfgrid.pivotTable.jfgridsliderlistitemfilter($(this)),e.stopPropagation(),!1}),$("#jfgrid-modal-dialog-pivotTable-list").on("click"," .jfgrid-slider-list-item-filtered",function(e){return jfgrid.pivotTable.jfgridsliderlistclearfilter($(this).next()),e.stopPropagation(),!1}),$("#jfgrid-dialog-pivotTable-range-seleted").click(function(){$("#jfgrid-modal-dialog-slider-pivot").hide(),jfgrid.jfgridsizeauto();var e=$("#jfgrid-data-pivotTable-selection"),r=e.outerHeight(),t=e.outerWidth(),i=$(window).width(),a=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#jfgrid-data-pivotTable-selection").css({left:(i+n-t)/2,top:(a+o-r)/4}).show(),jfgrid.pivotTable.jgridCurrentPivotInput=$("#jfgrid-dialog-pivotTable-range").html(),$("#jfgrid-pivotTable-range-selection-input").val(jfgrid.pivotTable.jgridCurrentPivotInput),jfgrid.pivotTable.jfgrid_pivotTable_select_state=!0}),$("#jfgrid-pivotTableFilter-initial").click(function(){$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-slider-list-item-filtered").hide(),$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").data("rowhidden",""),$("#jfgrid-pivotTableFilter-menu, #jfgrid-pivotTableFilter-submenu").hide(),$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input").hide().find("input").val(),$("#jfgrid-pivotTableFilter-selected span").data("type","0").data("type",null).text("无"),jfgrid.pivotTable.setDatatojsfile("filterparm",null),jfgrid.pivotTable.celldata=jfgrid.pivotTable.origindata,jfgrid.pivotTable.refreshPivotTable()}),$("#jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column").on("click",".jfgrid-modal-dialog-slider-config-item-icon",function(e){var r=$(e.target).closest(".jfgrid-modal-dialog-slider-config-item"),t=r.data("index"),i=r.offset(),a=r.data("order"),n=r.data("orderby"),o=r.data("stastic");null==a&&(a="default");var l='<option value="self">'+r.find(".jfgrid-modal-dialog-slider-config-item-txt").data("name")+"</option>";return $("#jfgrid-modal-dialog-config-value .jfgrid-modal-dialog-slider-config-item").each(function(e){l+='<option value="'+e+'">'+$(this).find(".jfgrid-modal-dialog-slider-config-item-txt").text()+"</option>"}),$("#jfgrid-pivotTable-config-option-orderby").empty().html(l),null==n&&(n="self"),null==o&&(o="1"),$("#jfgrid-pivotTable-config-option-order").val(a).data("index",t),$("#jfgrid-pivotTable-config-option-orderby").val(n).data("index",t),$("#jfgrid-pivotTable-config-option-stastic").val(o).data("index",t),mouseclickposition($("#jfgrid-pivotTable-config-option"),i.left+r.outerWidth(),i.top-13,"rightbottom"),e.stopPropagation(),!1}),$("#jfgrid-pivotTable-config-option-order,#jfgrid-pivotTable-config-option-orderby,#jfgrid-pivotTable-config-option-stastic").change(function(){var e=$(this),r=e.data("index");$("#jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column").find(".jfgrid-modal-dialog-slider-config-item").each(function(){$(this).data("index")==r&&$(this).data(e.attr("id").replace("jfgrid-pivotTable-config-option-",""),e.val())}),jfgrid.pivotTable.refreshPivotTable()}),$("#jfgrid-modal-dialog-config-value").on("click",".jfgrid-modal-dialog-slider-config-item-icon",function(e){var r=$(e.target).closest(".jfgrid-modal-dialog-slider-config-item"),t=r.data("index"),i=r.offset(),a=r.data("sumtype"),n=jfgrid.pivotTable.pivot_data_type[t.toString()];null==a&&(a="num"==n?"SUM":"COUNTA");var o=$("#jfgrid-pivotTable-config-option-sumtype");return o.find(".jfgrid-submenu-arrow").hide(),o.find(".jfgrid-cols-menuitem[sumtype='"+a+"'] .jfgrid-submenu-arrow").css("display","inline"),o.data("item",r),mouseclickposition(o,i.left+r.outerWidth(),i.top-13,"rightbottom"),e.stopPropagation(),!1}),$("#jfgrid-pivotTable-config-option-sumtype .jfgrid-cols-menuitem").click(function(){var e=$("#jfgrid-pivotTable-config-option-sumtype").data("item"),r=$(this).attr("sumtype");e.data("sumtype",$(this).attr("sumtype"));var t=jfgrid.pivotTable.getSumTypeName(r)+":"+e.data("name");e.attr("title",t).find(".jfgrid-modal-dialog-slider-config-item-txt").html(t),$("#jfgrid-pivotTable-config-option-sumtype").hide(),jfgrid.pivotTable.refreshPivotTable()}),$("#jfgrid-modal-dialog-config-filter").on("click",".jfgrid-modal-dialog-slider-config-item-icon",function(e){var r=$(e.target).closest(".jfgrid-modal-dialog-slider-config-item").data("index");return jfgrid.pivotTable.jfgridsliderlistitemfilter($("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").eq(r).find(".jfgrid-slider-list-item-filter")),e.stopPropagation(),!1}),$("#jfgrid-pivotTableFilter-confirm").click(function(){var i=$("#jfgrid-pivotTableFilter-menu").data("index"),a={};$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").each(function(){var e=$(this),r=e.data("rowhidden");if(e.data("index")!=i){if(null==r||""==r)return!0;for(var t in"string"==jfgrid.getObjType(r)&&(r=JSON.parse(r)),r)a[t]=0}});var e=jfgrid.pivotTable.origindata,o={},r={},t={};if($("#jfgrid-pivotTableFilter-bycondition").next().is(":visible")&&$("#jfgrid-pivotTableFilter-byvalue").next().is(":hidden")&&"null"!=$("#jfgrid-pivotTableFilter-selected span").data("value")){var n,l=$("#jfgrid-pivotTableFilter-selected span"),d=l.data("type"),f=l.data("value");t.value=f,t.text=l.text(),"0"==d?t.type="0":"2"==d?(n=$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input2 input"),t.type="2",t.value1=n.eq(0).val(),t.value2=n.eq(1).val()):(t.type="1",t.value1=$("#jfgrid-pivotTableFilter-menu .jfgrid-pivotTableFilter-selected-input").eq(0).find("input").val());for(var s,g,c,u,m,h=1;h<e.length;h++){h in a||null!=e[h]&&(j=e[h][i],"cellnull"==f?null==j||jfgrid.func_methods.isRealNull(j.v)||(r[h]=0):"cellnonull"==f?null!=j&&!jfgrid.func_methods.isRealNull(j.v)||(r[h]=0):"textinclude"==f?(g=t.value1,null!=j&&!jfgrid.func_methods.isRealNull(j.v)&&-1!=j.m.indexOf(g)||(r[h]=0)):"textnotinclude"==f?(g=t.value1,null==j||jfgrid.func_methods.isRealNull(j.v)||-1<j.m.indexOf(g)&&(r[h]=0)):"textstart"==f?(s=(g=t.value1).length,null!=j&&!jfgrid.func_methods.isRealNull(j.v)&&j.m.substr(0,s)==g||(r[h]=0)):"textend"==f?(s=(g=t.value1).length,(null==j||jfgrid.func_methods.isRealNull(j.v)||s>j.m.length||j.m.substr(j.m.length-s,s)!=g)&&(r[h]=0)):"textequal"==f?(g=t.value1,null!=j&&!jfgrid.func_methods.isRealNull(j.v)&&j.m==g||(r[h]=0)):"dateequal"==f?(g=jfgrid.mask.genarate(t.value1)[2],null!=j&&!jfgrid.func_methods.isRealNull(j.v)&&null!=j.ct&&"d"==j.ct.t&&parseInt(j.v)==g||(r[h]=0)):"datelessthan"==f?(g=jfgrid.mask.genarate(t.value1)[2],(null==j||jfgrid.func_methods.isRealNull(j.v)||null==j.ct||"d"!=j.ct.t||parseInt(j.v)>=g)&&(r[h]=0)):"datemorethan"==f?(g=jfgrid.mask.genarate(t.value1)[2],(null==j||jfgrid.func_methods.isRealNull(j.v)||null==j.ct||"d"!=j.ct.t||parseInt(j.v)<=g)&&(r[h]=0)):"morethan"==f?(g=parseFloat(t.value1),(null==j||jfgrid.func_methods.isRealNull(j.v)||null==j.ct||"n"!=j.ct.t||j.v<=g)&&(r[h]=0)):"moreequalthan"==f?(g=parseFloat(t.value1),(null==j||jfgrid.func_methods.isRealNull(j.v)||null==j.ct||"n"!=j.ct.t||j.v<g)&&(r[h]=0)):"lessthan"==f?(g=parseFloat(t.value1),(null==j||jfgrid.func_methods.isRealNull(j.v)||null==j.ct||"n"!=j.ct.t||j.v>=g)&&(r[h]=0)):"lessequalthan"==f?(g=parseFloat(t.value1),(null==j||jfgrid.func_methods.isRealNull(j.v)||null==j.ct||"n"!=j.ct.t||j.v>g)&&(r[h]=0)):"equal"==f?(g=parseFloat(t.value1),null!=j&&!jfgrid.func_methods.isRealNull(j.v)&&null!=j.ct&&"n"==j.ct.t&&j.v==g||(r[h]=0)):"noequal"==f?(g=parseFloat(t.value1),null!=j&&!jfgrid.func_methods.isRealNull(j.v)&&null!=j.ct&&"n"==j.ct.t&&j.v!=g||(r[h]=0)):"include"==f?((g=parseFloat(t.value1))<(c=parseFloat(t.value2))?(m=g,u=c):(u=g,m=c),(null==j||jfgrid.func_methods.isRealNull(j.v)||null==j.ct||"n"!=j.ct.t||j.v<m||j.v>u)&&(r[h]=0)):"noinclude"==f&&((g=parseFloat(t.value1))<(c=parseFloat(t.value2))?(m=g,u=c):(u=g,m=c),(null==j||jfgrid.func_methods.isRealNull(j.v)||null==j.ct||"n"!=j.ct.t||j.v>=m&&j.v<=u)&&(r[h]=0)))}}else{$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']").each(function(e,r){return!(!$(r).is(":visible")||!$(r).is(":checked"))||(0<$(r).closest(".day").length&&(t=$(r).siblings("label").text(),Number(t)<10&&(t="0"+t),i=$(r).closest(".monthBox").find(".month label").text().replace("月",""),Number(i)<10&&(i="0"+i),a=$(r).closest(".yearBox").find(".year label").text().replace("年",""),o[n="日期格式#$$$#"+a+"-"+i+"-"+t]="1"),void(0<$(r).closest(".textBox").length&&(n=$(r).closest(".textBox").data("filter"),o[n]="1")));var t,i,a,n});for(var j,h=1;h<e.length;h++){h in a||null!=e[h]&&(f=null==(j=e[h][i])||jfgrid.func_methods.isRealNull(j.v)?"null#$$$#null":null!=j.ct&&"d"==j.ct.t?"日期格式#$$$#"+jfgrid.mask.update("YYYY-MM-DD",j.v):j.v+"#$$$#"+j.m)in o&&(r[h]=0)}}var p=$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").eq(i);$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#jfgrid-pivotTableFilter-byvalue-select .ListBox input[type='checkbox']:visible").length||0<$("#jfgrid-pivotTableFilter-byvalue-input").val().length||$("#jfgrid-pivotTableFilter-bycondition").next().is(":visible")&&$("#jfgrid-pivotTableFilter-byvalue").next().is(":hidden")&&"null"!=$("#jfgrid-pivotTableFilter-selected span").data("value")?(p.data("rowhidden",JSON.stringify(r)).find(".jfgrid-slider-list-item-filtered").show(),jfgrid.pivotTable.setDatatojsfile("rowhidden",r,i),null!=t&&(p.data("byconditionvalue",t.value).data("byconditiontype",t.type).data("byconditiontext",t.text),null!=t.value1&&p.data("byconditionvalue1",t.value1),null!=t.value2&&p.data("byconditionvalue2",t.value2),jfgrid.pivotTable.setDatatojsfile("caljs",t,i))):(p.data("rowhidden","").find(".jfgrid-slider-list-item-filtered").hide(),jfgrid.pivotTable.setDatatojsfile("rowhidden",null,i));for(var v=[],b=0;b<e.length;b++)b in r||b in a||v.push([].concat(e[b]));jfgrid.pivotTable.celldata=v,jfgrid.pivotTable.refreshPivotTable(),$("#jfgrid-pivotTableFilter-menu, #jfgrid-pivotTableFilter-submenu").hide(),jfgrid.cleargridelement()}),$("#jfgrid-data-pivotTable-selection .jfgrid-model-close-btn, #jfgrid-data-pivotTable-selection .jfgrid-modal-dialog-title-close").click(function(){$("#jfgrid-modal-dialog-slider-pivot").show(),jfgrid.jfgridsizeauto(),$("#jfgrid-cell-main .jfgrid-pivotTable-selection-set div").show(),$("#jfgrid-data-pivotTable-selection").hide(),jfgrid.sheetmanage.changeSheetExec(jfgrid.pivotTable.pivotSheetIndex),jfgrid.pivotTable.jfgrid_pivotTable_select_state=!1,jfgrid.cleargridelement()}),$("#jfgrid-pivotTable-selection-confirm").click(function(){var e=$("#jfgrid-pivotTable-range-selection-input"),r=e.val();if(0==$.trim(r).length||$.trim(r).toUpperCase()==jfgrid.pivotTable.jgridCurrentPivotInput.toUpperCase())return e.val(jfgrid.pivotTable.jgridCurrentPivotInput),void $("#jfgrid-data-pivotTable-selection .jfgrid-model-close-btn").click();var t=r.split("!"),i="",a="",n=-1;if(1<t.length){for(var o in i=t[0],a=t[1],jfgridfile)if(i==jfgridfile[o].name){n=jfgridfile[o].index;break}-1==n&&(n=0)}else var l=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),i=jfgridfile[l].name,n=jfgridfile[l].index,a=t[0];if(jfgridfile[jfgrid.sheetmanage.getSheetIndex(n)].isPivotTable)return jfgrid.isEditMode()?alert("不可选择数据透视表为源数据！"):jfgrid.tooltip.info("选择失败","不可选择数据透视表为源数据！"),void e.val(jfgrid.pivotTable.jgridCurrentPivotInput);if(-1==a.indexOf(":"))return jfgrid.isEditMode()?alert("选择失败, 输入范围错误！"):jfgrid.tooltip.info("选择失败","输入范围错误！"),void e.val(jfgrid.pivotTable.jgridCurrentPivotInput);a=a.split(":");var d=[],f=[];return d[0]=parseInt(a[0].replace(/[^0-9]/g,""))-1,d[1]=parseInt(a[1].replace(/[^0-9]/g,""))-1,d[0]>d[1]?(jfgrid.isEditMode()?alert("选择失败, 输入范围错误！"):jfgrid.tooltip.info("选择失败","输入范围错误！"),void e.val(jfgrid.pivotTable.jgridCurrentPivotInput)):(f[0]=jfgrid.jfgridABCatNum(a[0].replace(/[^A-Za-z]/g,"")),f[1]=jfgrid.jfgridABCatNum(a[1].replace(/[^A-Za-z]/g,"")),f[0]>f[1]?(jfgrid.isEditMode()?alert("选择失败, 输入范围错误！"):jfgrid.tooltip.info("选择失败","输入范围错误！"),void e.val(jfgrid.pivotTable.jgridCurrentPivotInput)):(jfgrid.sheetmanage.changeSheetExec(jfgrid.pivotTable.pivotSheetIndex),jfgrid.pivotTable.setDatatojsfile("pivot_select_save",{row:d,column:f}),jfgrid.pivotTable.setDatatojsfile("pivotDataSheetIndex",n),jfgrid.pivotTable.getCellData(jfgrid.pivotTable.pivotSheetIndex,n,{row:d,column:f}),jfgrid.pivotTable.initialPivotManage(),$("#jfgrid-dialog-pivotTable-range").html(r),$("#jfgrid-modal-dialog-slider-pivot").show(),$("#jfgrid-data-pivotTable-selection").hide(),jfgrid.pivotTable.jfgrid_pivotTable_select_state=!1,jfgrid.pivotTable.refreshPivotTable(),jfgrid.jfgridsizeauto(),void jfgrid.cleargridelement()))}),$("#jfgrid-modal-dialog-slider-pivot").on("mousedown",".jfgrid-slider-list-item-name, .jfgrid-modal-dialog-slider-config-item-txt",function(e){var r=$(e.target);jfgrid.pivotTable.movestate=!0,jfgrid.pivotTable.movesave.obj=r.parent(),jfgrid.pivotTable.movesave.name=r.data("name"),jfgrid.pivotTable.movesave.containerid=r.parent().parent().attr("id"),jfgrid.pivotTable.movesave.index=r.data("index"),0==$("#jfgrid-modal-dialog-slider-pivot-move").length&&$("body").append('<div id="jfgrid-modal-dialog-slider-pivot-move">'+jfgrid.pivotTable.movesave.name+"</div>"),jfgrid.pivotTable.movesave.width=$("#jfgrid-modal-dialog-slider-pivot-move").outerWidth(),jfgrid.pivotTable.movesave.height=$("#jfgrid-modal-dialog-slider-pivot-move").outerHeight(),$("#jfgrid-modal-dialog-pivotTable-list, #jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column, #jfgrid-modal-dialog-config-value").css("cursor","default")}),$("#jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column, #jfgrid-modal-dialog-config-value").mousemove(function(e){var r,t,i,a;jfgrid.pivotTable&&jfgrid.pivotTable.movestate&&(0==jfgrid.pivotTable.moveitemposition.length&&(jfgrid.pivotTable.moveitemposition=[0],$(this).find(".jfgrid-modal-dialog-slider-config-item").each(function(e){var r=$(this).outerHeight();jfgrid.pivotTable.moveitemposition.push(jfgrid.pivotTable.moveitemposition[e]+r+2)}),$(this).append('<div id="jfgrid-modal-dialog-config-order-help" style="position:absolute;height:3px;width:100%;background:#007ACC;z-index:1;pointer-events: none;user-select:none;"></div>')),$("#jfgrid-modal-dialog-slider-pivot-move").css({background:"#FD8585",color:"#fff",border:"1px solid #FD7070"}),event.pageX,t=event.pageY-(r=$(this)).offset().top+r.scrollTop(),i=jfgrid.pivotTable.moveitemposition,-1==(a=jfgrid_searcharray(i,t))?$("#jfgrid-modal-dialog-config-order-help").css({top:i[i.length-1]}):t-i[a-1]>(i[a]-i[a-1])/2?$("#jfgrid-modal-dialog-config-order-help").css({top:i[a]}):$("#jfgrid-modal-dialog-config-order-help").css({top:i[a-1]}))}).mouseleave(function(){jfgrid.pivotTable&&jfgrid.pivotTable.movestate&&($("#jfgrid-modal-dialog-slider-pivot-move").css({background:"#fff",color:"#000",border:"1px dotted #000"}),jfgrid.pivotTable.moveitemposition=[],$("#jfgrid-modal-dialog-config-order-help").remove())}).mouseup(function(e){var r,t,i,a,n,o,l,d,f;jfgrid.pivotTable&&jfgrid.pivotTable.movestate&&(r=$(this),n=jfgrid.pivotTable.movesave.containerid==r.attr("id")?jfgrid.pivotTable.movesave.obj.clone():(t=jfgrid.pivotTable.movesave.name,a=i="","jfgrid-modal-dialog-config-value"==r.attr("id")&&(i="num"==jfgrid.pivotTable.pivot_data_type[jfgrid.pivotTable.movesave.index.toString()]?(t="求和:"+t,"data-sumtype='SUM'"):(t="计数:"+t,"data-sumtype='COUNTA'"),a="data-nameindex='0'",$("#jfgrid-modal-dialog-config-value").find(".jfgrid-modal-dialog-slider-config-item").each(function(){if($(this).find(".jfgrid-modal-dialog-slider-config-item-txt").text()==t){var e=parseFloat($(this).data("nameindex"))+1;return t+=e.toString(),$(this).data("nameindex",e),!1}})),'<div title="'+t+'" class="jfgrid-modal-dialog-slider-config-item" '+a+" "+i+' data-index="'+jfgrid.pivotTable.movesave.index+'" data-name="'+jfgrid.pivotTable.movesave.name+'"><div class="jfgrid-modal-dialog-slider-config-item-txt" '+a+" "+i+' data-index="'+jfgrid.pivotTable.movesave.index+'" data-name="'+jfgrid.pivotTable.movesave.name+'">'+t+'</div><div class="jfgrid-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'),event.pageX,l=event.pageY-(o=$(this)).offset().top+o.scrollTop(),d=jfgrid.pivotTable.moveitemposition,f=jfgrid_searcharray(d,l),("jfgrid-modal-dialog-pivotTable-list"==jfgrid.pivotTable.movesave.containerid||"jfgrid-modal-dialog-config-value"==jfgrid.pivotTable.movesave.containerid&&jfgrid.pivotTable.movesave.containerid!=r.attr("id"))&&$("#jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column").find(".jfgrid-modal-dialog-slider-config-item").each(function(){$(this).data("index")==jfgrid.pivotTable.movesave.index&&$(this).remove()}),-1==f?0==r.find(".jfgrid-modal-dialog-slider-config-item").length?r.append(n):r.find(".jfgrid-modal-dialog-slider-config-item").last().after(n):l-d[f-1]>(d[f]-d[f-1])/2?r.find(".jfgrid-modal-dialog-slider-config-item").eq(f-1).after(n):r.find(".jfgrid-modal-dialog-slider-config-item").eq(f-1).before(n),"jfgrid-modal-dialog-pivotTable-list"==jfgrid.pivotTable.movesave.containerid||"jfgrid-modal-dialog-config-value"==jfgrid.pivotTable.movesave.containerid&&jfgrid.pivotTable.movesave.containerid!=r.attr("id")||jfgrid.pivotTable.movesave.obj.remove(),$("#jfgrid-modal-dialog-pivotTable-list").find(".jfgrid-modal-dialog-slider-list-item").each(function(){var e=$(this).find(".jfgrid-slider-list-item-selected");$(this).data("index")==jfgrid.pivotTable.movesave.index&&0==e.find("i").length&&e.append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>')}),jfgrid.pivotTable.refreshPivotTable(),$("#jfgrid-modal-dialog-slider-pivot-move").remove(),jfgrid.pivotTable.movestate=!1,$("#jfgrid-modal-dialog-pivotTable-list, #jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column, #jfgrid-modal-dialog-config-value").css("cursor","default"),jfgrid.pivotTable.moveitemposition=[],$("#jfgrid-modal-dialog-config-order-help").remove(),jfgrid.pivotTable.showvaluecolrow(),e.stopPropagation())}),$("#jfgrid-modal-dialog-pivotTable-list").on("click",".jfgrid-slider-list-item-selected",function(){var e,r,t,i,a,n=$(this),o=n.parent(),l=o.data("index"),d=o.data("name");0==n.find("i").length?(n.append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>'),"num"==jfgrid.pivotTable.pivot_data_type[l.toString()]?(e='<div title="'+d+'" class="jfgrid-modal-dialog-slider-config-item" data-nameindex="0" data-sumtype="SUM" data-index="'+l+'" data-name="'+d+'"><div class="jfgrid-modal-dialog-slider-config-item-txt" data-nameindex="0" data-sumtype="SUM" data-index="'+l+'" data-name="'+d+'">求和:'+d+'</div><div class="jfgrid-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>',$("#jfgrid-modal-dialog-config-value").append(e)):(e='<div title="'+d+'" class="jfgrid-modal-dialog-slider-config-item" data-index="'+l+'" data-name="'+d+'"><div class="jfgrid-modal-dialog-slider-config-item-txt" data-index="'+l+'" data-name="'+d+'">'+d+'</div><div class="jfgrid-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>',r=$("#jfgrid-modal-dialog-config-column"),t=$("#jfgrid-modal-dialog-config-row"),i=r.find(".jfgrid-modal-dialog-slider-config-item"),a=t.find(".jfgrid-modal-dialog-slider-config-item"),!(i.length<2)&&a.length<2?t.append(e):r.append(e))):(n.find("i").remove(),$("#jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column, #jfgrid-modal-dialog-config-value").find(".jfgrid-modal-dialog-slider-config-item").each(function(){$(this).data("index")==l&&("jfgrid-modal-dialog-config-value"==$(this).parent().attr("id")&&jfgrid.pivotTable.resetOrderby($(this)),$(this).remove())})),jfgrid.pivotTable.refreshPivotTable(),jfgrid.pivotTable.showvaluecolrow()}),$("#jfgrid-dialog-pivotTable-clearitem").click(function(){$("#jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column, #jfgrid-modal-dialog-config-value").find(".jfgrid-modal-dialog-slider-config-item").each(function(){$(this).remove()}),$("#jfgrid-modal-dialog-pivotTable-list").find(".jfgrid-modal-dialog-slider-list-item").each(function(){$(this).find(".jfgrid-slider-list-item-selected").find("i").remove()}),jfgrid.pivotTable.refreshPivotTable(),jfgrid.pivotTable.showvaluecolrow()})),null==e&&(e=!1),this.celldata.length<=1&&this.celldata[0].length<=1&&(jfgrid.isEditMode()?alert("请扩大选择的数据范围!"):jfgrid.tooltip.info("提示","请扩大选择的数据范围!"));for(var r,t="",i=1,a={},n=1,o=0;o<this.celldata[0].length;o++){null!=(r=this.celldata[0][o]&&this.celldata[0][o].m?this.celldata[0][o].m:jfgrid.getcellvalue(0,o,this.celldata))&&(r=r.toString()),null!=r&&0!=$.trim(r.toString()).length||(r="列 "+n),n++,r in a&&(r+=i++)in a&&(r+=i++)in a&&(r+=i++),a[r]=1;var l,f,s="",g="";e&&null!=this.filterparm&&null!=this.filterparm[o.toString()]&&(null!=(l=this.filterparm[o.toString()]).rowhidden&&(s+="data-rowhidden='"+JSON.stringify(l.rowhidden)+"'"),null!=l.selected&&(s+="data-selected='"+JSON.stringify(l.selected)+"'"),null!=l.caljs&&(null!=(f=l.caljs).value&&(s+="data-byconditionvalue='"+f.value+"'"),null!=f.type&&(s+="data-byconditiontype='"+f.type+"'"),null!=f.text&&(s+="data-byconditiontext='"+f.text+"'"),null!=f.value1&&(s+="data-byconditionvalue1='"+f.value1+"'"),null!=f.value2&&(s+="data-byconditionvalue2='"+f.value2+"'"))),0<s.length&&(g="display:block;"),t+='<div class="jfgrid-modal-dialog-slider-list-item" '+s+' data-index="'+o+'" data-name="'+r+'"><div title="添加列到数据透视表" class="jfgrid-slider-list-item-selected"><div></div></div><div title="移动该列到下方白框" class="jfgrid-slider-list-item-name" '+s+' data-index="'+o+'" data-name="'+r+'">'+r+'</div><div title="清除该列的筛选条件" class="jfgrid-slider-list-item-filtered" style="'+g+'"><i class="fa fa-filter jfgrid-mousedown-cancel" aria-hidden="true"></i><i class="fa fa-times" aria-hidden="true"></i></div><div title="筛选该列" class="jfgrid-slider-list-item-filter"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>'}if($("#jfgrid-modal-dialog-pivotTable-list").html(t),$("#jfgridpivottablevaluecolrowshow").hide(),$("#jfgridpivottablevaluecolrow").prop("checked",!0),$("#jfgridpivottablevaluecolrow1").prop("checked",!1),$("#jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column, #jfgrid-modal-dialog-config-value").empty(),e){if(null!=this.filter&&0<this.filter.length)for(o=0;o<this.filter.length;o++){var c='<div title="'+r+'" class="jfgrid-modal-dialog-slider-config-item" data-index="'+(m=this.filter[o]).index+'" data-name="'+m.name+'"><div class="jfgrid-modal-dialog-slider-config-item-txt" data-index="'+m.index+'" data-name="'+m.name+'">'+m.name+'</div><div class="jfgrid-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#jfgrid-modal-dialog-config-filter").append(c),0==(h=$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").eq(m.index).find(".jfgrid-slider-list-item-selected")).find("i").length&&h.append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>')}if(null!=this.row&&0<this.row.length)for(o=0;o<this.row.length;o++){var u="";null!=(m=this.row[o]).order&&(u+="data-order = '"+m.order+"'"),null!=m.orderby&&(u+="data-orderby = '"+m.orderby+"'"),null!=m.order&&(u+="data-stastic = '"+m.stastic+"'");c='<div title="'+r+'" class="jfgrid-modal-dialog-slider-config-item" '+u+' data-index="'+m.index+'" data-name="'+m.name+'"><div class="jfgrid-modal-dialog-slider-config-item-txt" '+u+' data-index="'+m.index+'" data-name="'+m.name+'">'+m.name+'</div><div class="jfgrid-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#jfgrid-modal-dialog-config-row").append(c),0==(h=$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").eq(m.index).find(".jfgrid-slider-list-item-selected")).find("i").length&&h.append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>')}if(null!=this.column&&0<this.column.length)for(o=0;o<this.column.length;o++){u="";null!=(m=this.column[o]).order&&(u+="data-order = '"+m.order+"'"),null!=m.orderby&&(u+="data-orderby = '"+m.orderby+"'"),null!=m.order&&(u+="data-stastic = '"+m.stastic+"'");c='<div title="'+r+'" class="jfgrid-modal-dialog-slider-config-item" '+u+' data-index="'+m.index+'" data-name="'+m.name+'"><div class="jfgrid-modal-dialog-slider-config-item-txt" '+u+' data-index="'+m.index+'" data-name="'+m.name+'">'+m.name+'</div><div class="jfgrid-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#jfgrid-modal-dialog-config-column").append(c),0==(h=$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").eq(m.index).find(".jfgrid-slider-list-item-selected")).find("i").length&&h.append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>')}if(null!=this.values&&0<this.values.length){for(o=0;o<this.values.length;o++){var m,u="";null!=(m=this.values[o]).sumtype&&(u+="data-sumtype = '"+m.sumtype+"'"),null!=m.nameindex&&(u+="data-nameindex = '"+m.nameindex+"'");var h,c='<div title="'+r+'" class="jfgrid-modal-dialog-slider-config-item" '+u+' data-index="'+m.index+'" data-name="'+m.name+'"><div class="jfgrid-modal-dialog-slider-config-item-txt" '+u+' data-index="'+m.index+'" data-name="'+m.name+'">'+jfgrid.pivotTable.getSumTypeName(m.sumtype)+":"+m.name+'</div><div class="jfgrid-modal-dialog-slider-config-item-icon"><i class="fa fa-sort-desc" aria-hidden="true"></i></div></div>';$("#jfgrid-modal-dialog-config-value").append(c),0==(h=$("#jfgrid-modal-dialog-pivotTable-list .jfgrid-modal-dialog-slider-list-item").eq(m.index).find(".jfgrid-slider-list-item-selected")).find("i").length&&h.append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>')}2<=this.values.length&&($("#jfgridpivottablevaluecolrowshow").show(),"column"==this.showType?($("#jfgridpivottablevaluecolrow").prop("checked",!0),$("#jfgridpivottablevaluecolrowshow label[for='jfgridpivottablevaluecolrow']").addClass("ui-state-active"),$("#jfgridpivottablevaluecolrow1").prop("checked",!1),$("#jfgridpivottablevaluecolrowshow label[for='jfgridpivottablevaluecolrow1']").removeClass("ui-state-active")):($("#jfgridpivottablevaluecolrow1").prop("checked",!0),$("#jfgridpivottablevaluecolrowshow label[for='jfgridpivottablevaluecolrow1']").addClass("ui-state-active"),$("#jfgridpivottablevaluecolrow").prop("checked",!1),$("#jfgridpivottablevaluecolrowshow label[for='jfgridpivottablevaluecolrow']").removeClass("ui-state-active")))}}$("#jfgrid-dialog-pivotTable-range").html(jfgrid.sheetmanage.getRangetxt(this.pivotDataSheetIndex,this.pivot_select_save)),$("#jfgrid-modal-dialog-slider-pivot").show(),jfgrid.jfgridsizeauto()},getComposeArray:function(e){if(0==e.length)return[];for(var r=[],t=0;t<e.length;t++){for(var i="",a=0;a<=t;a++)e[a]&&e[a].m?i+=e[a].m:i+=jfgrid.getcellvalue(a,null,e);r.push(i)}return r},getnameArray:function(e,r){if(0==e.length)return[];if(0==r.length)return[];for(var t,i=[],a=0;a<r.length;a++){t=e[r[a].index]&&e[r[a].index].m?e[r[a].index].m:jfgrid.getcellvalue(r[a].index,null,e),i.push(t)}return i},getTitleFromGroup:function(e,r,t){e.children;var i=this.orderbygroup(e,r,t);return this.generategrouparraymain(i,r)},orderbygroup:function(e,r,t){var i=[];if(0==e.length)return[];for(var a=null,n=(i=e).length,o=i.length,l=0;0!=n;)if(n--,null!=(a=i[l++]).children&&0<a.children.length){a.children=this.orderbygroupchildren(a.children,r[a.index].orderby,r[a.index].order,t);for(var d=0;d<a.children.length;d++)i.push(a.children[d]),n++}return e.splice(0,o)},orderbygroupchildren:function(e,a,r,n){if(0==e.length)return[];var t=!1;null!=r&&"asc"!=r||(t=!0);return t?e.sort(function(e,r){var t=null,i=null;if("self"==a||null==a){if(t=null==e.name?"(空白)":e.name.toString(),i=null==r.name?"(空白)":r.name.toString(),jfgrid.datecontroll.isdatetime(t)&&jfgrid.datecontroll.isdatetime(i))return jfgrid.datecontroll.diff(t,i)}else t=parseFloat(n[e.orderby].result),i=parseFloat(n[r.orderby].result);return isNaN(t)||isNaN(i)?isNaN(t)&&isNaN(i)?t.localeCompare(i):isNaN(t)?1:isNaN(i)?-1:void 0:numeral(t).value()-numeral(i).value()}):e.sort(function(e,r){var t=null,i=null;if("self"==a||null==a){if(t=null==e.name?"(空白)":e.name.toString(),i=null==r.name?"(空白)":r.name.toString(),jfgrid.datecontroll.isdatetime(t)&&jfgrid.datecontroll.isdatetime(i))return jfgrid.datecontroll.diff(t,i)}else t=parseFloat(n[e.orderby].result),i=parseFloat(n[r.orderby].result);return isNaN(t)||isNaN(i)?isNaN(t)&&isNaN(i)?i.localeCompare(t):isNaN(t)?-1:isNaN(i)?1:void 0:numeral(i).value()-numeral(t).value()})},generategroupaddstatic:function(e,r){for(var t=[],i=0;i<e[0].length;i++)0==i?"总计"==r?t.push(r):t.push({name:r,issum:!0}):t.push("");return t},generategrouparraymain:function(e,r){for(var t=[],i=0;i<e.length;i++){var a=e[i].name,n=this.generategrouparray(e[i].children,r,1);"1"!=r[0].stastic&&null!=r[0].stastic||n.push(this.generategroupaddstatic(n,a)),t=t.concat(n)}return t},generategrouparray:function(e,r,t){for(var i=[],a=0;a<e.length;a++){var n,o=e[a].name;if(0==e[a].children||0==e[a].children.length)n=[o],i.push(n);else{n=this.generategrouparray(e[a].children,r,t+1);for(var l=0;l<n.length;l++)n[l].unshift(o);"1"!=r[t].stastic&&null!=r[t].stastic||n.push(this.generategroupaddstatic(n,o)),i=i.concat(n)}}return i},addStatisticsData:function(e,r,t,i){var a,n;null==e[t]&&(e[t]={data:[],count:0,max:-1/0,min:1/0,counta:0,countunique:0,countuniquedata:{},sum:0,digitaldata:[],sumtype:r.sumtype,index:r.index,name:r.fullname,acc:0}),!0===jfgrid.isdatatypemulti(i).num&&(a=jfgrid.numFormat(i),e[t].digitaldata.push(a),e[t].count+=1,e[t].sum+=a,a>e[t].max&&(e[t].max=a),a<e[t].min&&(e[t].min=a),(n=jfgrid.numfloatlen(a))>e[t].acc&&(e[t].acc=n)),""!=i&&(e[t].data.push(i),e[t].counta+=1,i in e[t].countuniquedata||(e[t].countuniquedata[i]=1,e[t].countunique+=1))},dataHandler:function(column,row,values,showType,celldata){if(null==showType&&(showType="column"),0==column.length&&0==row.length&&0==values.length||0==celldata.length)return this.pivotDatas=[],[];for(var dataposition={},data=celldata,datarowtitle=[],datarowtitlegroup=[],datarowposition={},datarowposition_i=0,datacoltitle=[],datacoltitlegroup=[],datacolposition={},datacolposition_i=0,i=1;i<data.length;i++){var d=data[i],groupbyrowtxt="",groupbycoltxt="",rowtxt="",rowtitle=[],rowtitlename=[],coltxt="",coltitle=[],coltitlename=[],rowtitlename=this.getnameArray(d,row),coltitlename=this.getnameArray(d,column),rowtitle=this.getComposeArray(rowtitlename),coltitle=this.getComposeArray(coltitlename);0<rowtitle.length&&rowtitle.unshift("总计"),0<coltitle.length&&coltitle.unshift("总计");for(var curentLevelobj=datarowposition,curentLevelarr=datarowtitlegroup,r=0;r<rowtitle.length;r++){var item=rowtitle[r],name=0==r?"总计":rowtitlename[r-1],orderby;curentLevelarr=null!=curentLevelobj[r.toString()]&&null!=curentLevelobj[r.toString()][item]?curentLevelarr[curentLevelobj[r.toString()][item]].children:(orderby=0==r?"self":"self"==row[r-1].orderby||null==row[r-1].orderby?item:"column"==showType?item+values[parseInt(row[r-1].orderby)].fullname:item+"合计",null==name&&(name="(空白)"),curentLevelarr.push({name:name,fullname:item,index:r,orderby:orderby,children:[]}),null==curentLevelobj[r.toString()]&&(curentLevelobj[r.toString()]={}),null==curentLevelobj[r.toString()][item]&&(curentLevelobj[r.toString()][item]=curentLevelarr.length-1),curentLevelarr[curentLevelarr.length-1].children)}for(var curentLevelobj=datacolposition,curentLevelarr=datacoltitlegroup,r=0;r<coltitle.length;r++){var item=coltitle[r],name=0==r?"总计":coltitlename[r-1],orderby;curentLevelarr=null!=curentLevelobj[r.toString()]&&null!=curentLevelobj[r.toString()][item]?curentLevelarr[curentLevelobj[r.toString()][item]].children:(orderby=0==r?"self":"self"==column[r-1].orderby||null==column[r-1].orderby?item:"column"==showType?"合计"+item:values[parseInt(column[r-1].orderby)].fullname+item,null==name&&(name="(空白)"),curentLevelarr.push({name:name,fullname:item,index:r,orderby:orderby,children:[]}),null==curentLevelobj[r.toString()]&&(curentLevelobj[r.toString()]={}),null==curentLevelobj[r.toString()][item]&&(curentLevelobj[r.toString()][item]=curentLevelarr.length-1),curentLevelarr[curentLevelarr.length-1].children)}for(var v_str="",v=0;v<values.length;v++){var d_value=jfgrid.getcellvalue(values[v].index,null,d),coltitle_c=[].concat(coltitle),rowtitle_c=[].concat(rowtitle);"column"==showType?0<coltitle_c.length?(coltitle_c.push(""),coltitle_c=coltitle_c.join(values[v].fullname+"|||").split("|||").slice(0,coltitle_c.length-1)):coltitle_c.push(values[v].fullname):0<rowtitle_c.length?(rowtitle_c.push(""),rowtitle_c=rowtitle_c.join(values[v].fullname+"|||").split("|||").slice(0,rowtitle_c.length-1)):rowtitle_c.push(values[v].fullname),0==coltitle_c.length&&coltitle_c.push(""),0==rowtitle_c.length&&rowtitle_c.push("");for(var r=0;r<rowtitle_c.length;r++)for(var c=0;c<coltitle_c.length;c++)indicator=rowtitle_c[r]+coltitle_c[c],this.addStatisticsData(dataposition,values[v],indicator,d_value)}}for(indicator in dataposition){var json=dataposition[indicator],numArr,numLen,numindex,mean,mean,mean,mean;"SUM"==json.sumtype?json.result=json.sum:"COUNT"==json.sumtype?json.result=json.count:"COUNTA"==json.sumtype?json.result=json.counta:"COUNTUNIQUE"==json.sumtype?json.result=json.countunique:"AVERAGE"==json.sumtype?json.result=jfgrid.numFormat(json.sum/json.count):"MAX"==json.sumtype?json.result=json.max:"MIN"==json.sumtype?json.result=json.min:"MEDIAN"==json.sumtype?(numArr=json.digitaldata.sort(function(e,r){return e-r}),numLen=numArr.length,numindex=parseInt(numLen/2),json.result=numLen%2==0?(numArr[numindex-1]+numArr[numindex])/2:numArr[numindex]):"PRODUCT"==json.sumtype?json.result=eval(json.digitaldata.join("*")):"STDEV"==json.sumtype?(mean=json.sum/json.count,json.result=jfgrid.analysis.STDEV(mean,json.digitaldata)):"STDEVP"==json.sumtype?(mean=json.sum/json.count,json.result=jfgrid.analysis.STDEVP(mean,json.digitaldata)):"VAR"==json.sumtype?(mean=json.sum/json.count,json.result=jfgrid.analysis.VAR(mean,json.digitaldata)):"VARP"==json.sumtype&&(mean=json.sum/json.count,json.result=jfgrid.analysis.VARP(mean,json.digitaldata));var newAcc=jfgrid.numfloatlen(json.result);newAcc>json.acc&&(json.acc=newAcc),json.result=jfgrid.numFormat(json.result,json.acc)}if(datarowtitle=this.getTitleFromGroup(datarowtitlegroup,row,dataposition),datacoltitle=this.getTitleFromGroup(datacoltitlegroup,column,dataposition),"column"==showType)if(0<datacoltitle.length&&0<datacoltitle[0].length)datacoltitle=this.addValuesToTitle(datacoltitle,values);else for(var v=0;v<values.length;v++)datacoltitle.push([values[v].fullname]);else if(0<datarowtitle.length&&0<datarowtitle[0].length)datarowtitle=this.addValuesToTitle(datarowtitle,values);else for(var v=0;v<values.length;v++)datarowtitle.push([values[v].fullname]);for(var datacoltitle_index=datacoltitle,datacoltitle=jfgrid.array.transpose(datacoltitle),valuenslen=0==values.length?0:1,rowLen=(0==datacoltitle.length?valuenslen:datacoltitle.length)+(0==datarowtitle.length?valuenslen:datarowtitle.length),colLen=(0==datacoltitle.length?valuenslen:datacoltitle[0].length)+(0==datarowtitle.length?valuenslen:datarowtitle[0].length),rowOver=datacoltitle.length,colOver=0==datarowtitle.length?0:datarowtitle[0].length,retdata=[],r=0;r<rowLen;r++){retdata[r]=new Array(colLen);for(var c=0;c<colLen;c++){var drt=datarowtitle[r-rowOver];if(r<rowOver&&c<colOver)retdata[r][c]="";else if(r<rowOver&&colOver<=c)null!=datacoltitle[r]?"object"==jfgrid.getObjType(datacoltitle[r][c-colOver])?retdata[r][c]=datacoltitle[r][c-colOver].name+"总计":retdata[r][c]=datacoltitle[r][c-colOver]:retdata[r][c]="";else if(rowOver<=r&&c<colOver)null!=drt?"object"==jfgrid.getObjType(drt[c])?retdata[r][c]=drt[c].name+"总计":retdata[r][c]=drt[c]:retdata[r][c]="";else{var prefix="";if(null!=drt)if(drt instanceof Array&&1!=drt.length)for(var x=0;x<drt.length;x++)"object"==jfgrid.getObjType(drt[x])?prefix+=drt[x].name:prefix+=drt[x];else prefix=drt instanceof Array?drt[0]:drt;var suffix="",dct=datacoltitle_index[c-colOver];if(null!=dct)if(dct instanceof Array&&1!=dct.length)for(var x=0;x<dct.length;x++)"object"==jfgrid.getObjType(dct[x])?suffix+=dct[x].name:suffix+=dct[x];else suffix=dct instanceof Array?dct[0]:dct;var indicator=prefix;""!=prefix&&""!=suffix?indicator=prefix+suffix:""==prefix&&(indicator=suffix),null==dataposition[indicator]?retdata[r][c]="":retdata[r][c]=dataposition[indicator].result}}}return 1==values.length&&0<column.length&&(retdata[0][0]=values[0].fullname,retdata.splice(column.length,1)),this.pivotDatas=retdata,retdata},drillDown:function(e,r){this.pivotDatas[e][r];for(var t,i=$.extend(!0,[],jfgrid.sheetmanage.nulldata),a=1,n=0;n<this.celldata[0].length;n++){null!=(t=this.celldata[0][n]&&this.celldata[0][n].m?this.celldata[0][n].m:jfgrid.getcellvalue(0,n,this.celldata))&&(t=t.toString()),null!=t&&0!=$.trim(t.toString()).length||(t="列 "+a),a++,i[0][n]=t}var o={};if(null!=this.row&&0<this.row.length)for(var l=0;l<this.row.length;l++)o[this.row[l].index]=this.pivotDatas[e][l];if(null!=this.column&&0<this.column.length)for(var d=0;d<this.column.length;d++)o[this.column[d].index]=this.pivotDatas[d][r];for(var f=[],s=1;s<this.celldata.length;s++){var g=!0;for(x in o){if((u=null!=(u=this.celldata[s][x]&&this.celldata[s][x].m?this.celldata[s][x].m:jfgrid.getcellvalue(s,x,this.celldata))?u.toString():"(空白)")!=o[x]){g=!1;break}}g&&f.push(s)}for(var c=0;c<f.length;c++)for(var u,m=0;m<this.celldata[0].length;m++){u=null!=(u=this.celldata[f[c]][m]&&this.celldata[f[c]][m].m?this.celldata[f[c]][m].m:jfgrid.getcellvalue(f[c],m,this.celldata))?u.toString():"",i[c+1][m]=u}jfgird_select_save=[{row:[0,f.length],column:[0,this.celldata[0].length-1]}],clearjfundo=!1,jfgrid.jfrefreshgrid(i,jfgird_select_save),jfgrid.selectHightlightShow(),clearjfundo=!0}},jfgrid.freezen={freezenHorizontalHTML:'<div id="jfgrid-freezebar-horizontal" class="jfgrid-freezebar" tabindex="0"><div class="jfgrid-freezebar-handle jfgrid-freezebar-horizontal-handle" ><div class="jfgrid-freezebar-handle-bar jfgrid-freezebar-horizontal-handle-title" ></div><div class="jfgrid-freezebar-handle-bar jfgrid-freezebar-horizontal-handle-bar" ></div></div><div class="jfgrid-freezebar-drop jfgrid-freezebar-horizontal-drop" ><div class="jfgrid-freezebar-drop-bar jfgrid-freezebar-horizontal-drop-title" ></div><div class="jfgrid-freezebar-drop-bar jfgrid-freezebar-horizontal-drop-bar" >&nbsp;</div></div></div>',freezenVerticalHTML:'<div id="jfgrid-freezebar-vertical" class="jfgrid-freezebar" tabindex="0"><div class="jfgrid-freezebar-handle jfgrid-freezebar-vertical-handle" ><div class="jfgrid-freezebar-handle-bar jfgrid-freezebar-vertical-handle-title" ></div><div class="jfgrid-freezebar-handle-bar jfgrid-freezebar-vertical-handle-bar" ></div></div><div class="jfgrid-freezebar-drop jfgrid-freezebar-vertical-drop" ><div class="jfgrid-freezebar-drop-bar jfgrid-freezebar-vertical-drop-title" ></div><div class="jfgrid-freezebar-drop-bar jfgrid-freezebar-vertical-drop-bar" >&nbsp;</div></div></div>',initialHorizontal:!0,initialVertical:!0,horizontalmovestate:!1,horizontalmoveposition:null,verticalmovestate:!1,verticalmoveposition:null,windowHeight:null,windowWidth:null,freezenhorizontaldata:null,freezenverticaldata:null,cutVolumn:function(e,r){if(r<=0)return e;for(var t=e.slice(0,r),i=t[t.length-1],a=e.slice(r),n=0;n<a.length;n++)a[n]-=i;return a},cancelFreezenVertical:function(e){$("#jfgrid-freezen-btn-vertical").html('<i class="fa fa-indent"></i> 冻结首列'),jfgrid.freezen.freezenverticaldata=null;var r=$("#jfgrid-freezebar-vertical").is(":visible");$("#jfgrid-freezebar-vertical").hide(),null==e&&(e=jfgrid.currentSheetIndex);var t=jfgridfile[jfgrid.sheetmanage.getSheetIndex(e)];null!=t.freezen&&(t.freezen.vertical=null),null!=t.freezen&&r&&jfgrid.server.saveParam("all",e,t.freezen,{k:"freezen"})},createFreezenVertical:function(e,r){var t,i,a;this.initialVertical&&(this.initialVertical=!1,$("#jfgrid-grid-window-1").append(this.freezenVerticalHTML),$("#jfgrid-freezebar-vertical").find(".jfgrid-freezebar-vertical-drop").hover(function(){$(this).parent().addClass("jfgrid-freezebar-hover")},function(){$(this).parent().removeClass("jfgrid-freezebar-hover")}),$("#jfgrid-freezebar-vertical").find(".jfgrid-freezebar-vertical-drop").mousedown(function(){jfgrid.freezen.verticalmovestate=!0,jfgrid.freezen.verticalmoveposition=$(this).position().left,jfgrid.freezen.windowWidth=$("#jfgrid-grid-window-1").width(),$(this).parent().addClass("jfgrid-freezebar-active"),$("#jfgrid-freezebar-vertical").find(".jfgrid-freezebar-vertical-handle").css("cursor","-webkit-grabbing")}),t=$("#jfgrid-grid-window-1").height(),$("#jfgrid-freezebar-vertical").find(".jfgrid-freezebar-vertical-handle").css({height:t-10,width:"4px",cursor:"-webkit-grab",top:"0px"}).end().find(".jfgrid-freezebar-vertical-drop").css({height:t-10,width:"4px",top:"0px",cursor:"-webkit-grab"})),null==e&&(i=$("#jfgrid-cell-main").scrollLeft(),-1==(a=jfgrid_searcharray(visibledatacolumn,i))&&(a=0),r=visibledatacolumn[a]-2-i+rowHeaderWidth,e=[visibledatacolumn[a],a+1,i,jfgrid.freezen.cutVolumn(visibledatacolumn,a+1),r],jfgrid.freezen.saveFreezen(null,null,e,r)),jfgrid.freezen.freezenverticaldata=e,$("#jfgrid-freezen-btn-horizontal").html('<i class="fa fa-indent"></i> 取消冻结'),$("#jfgrid-freezebar-vertical").show().find(".jfgrid-freezebar-vertical-handle").css({left:r}).end().find(".jfgrid-freezebar-vertical-drop").css({left:r})},saveFreezen:function(e,r,t,i){var a=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)];null==a.freezen&&(a.freezen={}),null!=e&&(null==a.freezen.horizontal&&(a.freezen.horizontal={}),a.freezen.horizontal.freezenhorizontaldata=e,a.freezen.horizontal.top=r),null!=t&&(null==a.freezen.vertical&&(a.freezen.vertical={}),a.freezen.vertical.freezenverticaldata=t,a.freezen.vertical.left=i),null!=a.freezen&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,a.freezen,{k:"freezen"})},initialFreezen:function(e){var r=jfgridfile[jfgrid.sheetmanage.getSheetIndex(e)];null!=r.freezen&&null!=r.freezen.horizontal&&null!=r.freezen.horizontal.freezenhorizontaldata?this.createFreezenHorizontal(r.freezen.horizontal.freezenhorizontaldata,r.freezen.horizontal.top):this.cancelFreezenHorizontal(e),null!=r.freezen&&null!=r.freezen.vertical&&null!=r.freezen.vertical.freezenverticaldata?this.createFreezenVertical(r.freezen.vertical.freezenverticaldata,r.freezen.vertical.left):this.cancelFreezenVertical(e),this.createAssistCanvas()},changeFreezenIndex:function(e,r){var t,i,a;return"v"==r&&null!=this.freezenverticaldata?(t=this.freezenverticaldata[1],e-(a=jfgrid_searcharray(visibledatacolumn,$("#jfgrid-cell-main").scrollLeft()))<t&&(e-=a)):"h"==r&&null!=this.freezenhorizontaldata&&(i=this.freezenhorizontaldata[1],e-(a=jfgrid_searcharray(visibledatarow,$("#jfgrid-cell-main").scrollTop()))<i&&(e-=a)),e},scrollFreezen:function(){var e,r=jfgird_select_save[0].row_focus;r==jfgird_select_save[0].row[0]?e=jfgird_select_save[0].row[1]:r==jfgird_select_save[0].row[1]&&(e=jfgird_select_save[0].row[0]);var t,i,a,n=jfgird_select_save[0].column_focus;n==jfgird_select_save[0].column[0]?t=jfgird_select_save[0].column[1]:n==jfgird_select_save[0].column[1]&&(t=jfgird_select_save[0].column[0]),null!=this.freezenverticaldata&&(i=this.freezenverticaldata[1],t<=(i+=jfgrid_searcharray(this.freezenverticaldata[3],$("#jfgrid-cell-main").scrollLeft()))&&setTimeout(function(){$("#jfgrid-scrollbar-x").scrollLeft(0)},10)),null!=this.freezenhorizontaldata&&(a=this.freezenhorizontaldata[1],e<=(a+=jfgrid_searcharray(this.freezenhorizontaldata[3],$("#jfgrid-cell-main").scrollTop()))&&setTimeout(function(){$("#jfgrid-scrollbar-y").scrollTop(0)},10))},cancelFreezenHorizontal:function(e){$("#jfgrid-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> 冻结首行'),jfgrid.freezen.freezenhorizontaldata=null;var r=$("#jfgrid-freezebar-horizontal").is(":visible");$("#jfgrid-freezebar-horizontal").hide(),null==e&&(e=jfgrid.currentSheetIndex);var t=jfgridfile[jfgrid.sheetmanage.getSheetIndex(e)];null!=t.freezen&&(t.freezen.horizontal=null),null!=t.freezen&&r&&jfgrid.server.saveParam("all",e,t.freezen,{k:"freezen"})},createFreezenHorizontal:function(e,r){var t,i,a;this.initialHorizontal&&(this.initialHorizontal=!1,$("#jfgrid-grid-window-1").append(this.freezenHorizontalHTML),$("#jfgrid-freezebar-horizontal").find(".jfgrid-freezebar-horizontal-drop").hover(function(){$(this).parent().addClass("jfgrid-freezebar-hover")},function(){$(this).parent().removeClass("jfgrid-freezebar-hover")}),$("#jfgrid-freezebar-horizontal").find(".jfgrid-freezebar-horizontal-drop").mousedown(function(){jfgrid.freezen.horizontalmovestate=!0,jfgrid.freezen.horizontalmoveposition=$(this).position().top,jfgrid.freezen.windowHeight=$("#jfgrid-grid-window-1").height(),$(this).parent().addClass("jfgrid-freezebar-active"),$("#jfgrid-freezebar-horizontal").find(".jfgrid-freezebar-horizontal-handle").css("cursor","-webkit-grabbing")}),t=$("#jfgrid-grid-window-1").width(),$("#jfgrid-freezebar-horizontal").find(".jfgrid-freezebar-horizontal-handle").css({width:t-10,height:"4px",cursor:"-webkit-grab",left:"0px"}).end().find(".jfgrid-freezebar-horizontal-drop").css({width:t-10,height:"4px",left:"0px",cursor:"-webkit-grab"})),null==e&&(i=$("#jfgrid-cell-main").scrollTop(),-1==(a=jfgrid_searcharray(visibledatarow,i))&&(a=0),r=visibledatarow[a]-2-i+columeHeaderHeight,e=[visibledatarow[a],a+1,i,jfgrid.freezen.cutVolumn(visibledatarow,a+1),r],jfgrid.freezen.saveFreezen(e,r,null,null)),jfgrid.freezen.freezenhorizontaldata=e,$("#jfgrid-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> 取消冻结'),$("#jfgrid-freezebar-horizontal").show().find(".jfgrid-freezebar-horizontal-handle").css({top:r}).end().find(".jfgrid-freezebar-horizontal-drop").css({top:r})},createAssistCanvas:function(){var e,r,t,i,a,n,o=this;o.removeAssistCanvas(),null==o.freezenverticaldata&&null==o.freezenhorizontaldata||(a=jfgridTableContentHW[0],n=jfgridTableContentHW[1],null!=o.freezenverticaldata&&null!=o.freezenhorizontaldata?(e=o.freezenhorizontaldata[0],o.freezenhorizontaldata[1],r=o.freezenhorizontaldata[2],t=o.freezenverticaldata[0],o.freezenverticaldata[1],i=o.freezenverticaldata[2],o.createCanvas("freezen_3",t-i,e-r+1,rowHeaderWidth-1,columeHeaderHeight-1),o.createCanvas("freezen_4",a-t+i,e-r+1,t-i+rowHeaderWidth-1,columeHeaderHeight-1),o.createCanvas("freezen_7",t-i,n-e+r-columeHeaderHeight,rowHeaderWidth-1,e-r+columeHeaderHeight-1)):null!=o.freezenhorizontaldata?(e=o.freezenhorizontaldata[0],o.freezenhorizontaldata[1],r=o.freezenhorizontaldata[2],o.createCanvas("freezen_h",a,e-r+1,rowHeaderWidth-1,columeHeaderHeight-1)):null!=o.freezenverticaldata&&(t=o.freezenverticaldata[0],o.freezenverticaldata[1],i=o.freezenverticaldata[2],o.createCanvas("freezen_v",t-i,n,rowHeaderWidth-1,columeHeaderHeight-1)),jfgrid.freezen.scrollAdapt())},createCanvas:function(e,r,t,i,a){$("<canvas/>").appendTo("#jfgrid-grid-window-1").attr({id:e,width:Math.ceil(r*devicePixelRatio),height:Math.ceil(t*devicePixelRatio)}).css({"user-select":"none",postion:"absolute",left:i,top:a,width:r,height:t,"z-index":10,"pointer-events":"none"})},removeAssistCanvas:function(){$("#jfgrid-grid-window-1 > canvas").not($("#jfgridTableContent")).remove(),$("#jfgrid-cell-selected").css("z-index",15)},scrollAdapt:function(){null!=jfgird_select_save&&0<jfgird_select_save.length&&jfgrid.freezen.scrollAdaptOfselect(),0<$("#jfgrid-cell-main .jfgrid-data-visualization-chart").length&&jfgrid.freezen.scrollAdaptOfchart(),0<$("#jfgrid-postil-showBoxs .jfgrid-postil-show").length&&jfgrid.freezen.scrollAdaptOfpostil(),0<$("#jfgrid-dropCell-icon").length&&jfgrid.freezen.scrollAdaptOfdpicon(),0<$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").length&&jfgrid.freezen.scrollAdaptOffilteroptions()},scrollAdaptOfselect:function(){$("#jfgrid-row-count-show").is(":visible")&&$("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").is(":visible")&&$("#jfgrid-column-count-show").hide(),$("#jfgrid-rows-h-selected").empty(),$("#jfgrid-cols-h-selected").empty();var e=$("#jfgrid-cell-main").scrollTop(),r=$("#jfgrid-cell-main").scrollLeft();if(null!=jfgrid.freezen.freezenhorizontaldata&&null!=jfgrid.freezen.freezenverticaldata)for(var t=jfgrid.freezen.freezenhorizontaldata[0],i=jfgrid.freezen.freezenhorizontaldata[1],a=e-jfgrid.freezen.freezenhorizontaldata[2],n=jfgrid.freezen.freezenverticaldata[0],o=jfgrid.freezen.freezenverticaldata[1],l=r-jfgrid.freezen.freezenverticaldata[2],d=0;d<jfgird_select_save.length;d++){var f=(I=$.extend(!0,{},jfgird_select_save[d])).row[0],s=I.row[1],g=visibledatarow[s],c=w=f-1==-1?0:visibledatarow[f-1],u=g-w-1,m=!0;i<=f?c+u<t+a?m=!1:c<t+a?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({top:t+a,height:u-(t+a-c)}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({top:c,height:u}):i<=s?c+u<t+a?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({top:c+a,height:t-c}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({top:c+a,height:u-a}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css("top",c+a);var h,j=I.column[0],p=I.column[1],v=visibledatacolumn[p],b=R=j-1==-1?0:visibledatacolumn[j-1],_=v-R-1;o<=j?b+_<n+l?m=!1:b<n+l?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({left:n+l,width:_-(n+l-b)}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({left:b,width:_}):o<=p?b+_<n+l?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({left:b+l,width:n-b}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({left:b+l,width:_-l}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css("left",b+l),m||$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).hide(),d==jfgird_select_save.length-1&&(k=null==I.row_focus?f:I.row_focus,S=null==I.column_focus?j:I.column_focus,y=visibledatarow[k],x=k-1==-1?0:visibledatarow[k-1],A=visibledatacolumn[S],F=S-1==-1?0:visibledatacolumn[S-1],(N=jfgrid.menuButton.mergeborer(jfgrid.flowdata,k,S))&&(y=N.row[1],x=N.row[0],A=N.column[1],F=N.column[0]),T=y-x-1,E=A-(M=F)-1,h=!0,t<=(C=x)?C+T<t+a?h=!1:C<t+a?$("#jfgrid-cell-selected-focus").show().css({top:t+a,height:T-(t+a-C)}):$("#jfgrid-cell-selected-focus").show().css({top:C,height:T}):t<=C+T?C+T<t+a?$("#jfgrid-cell-selected-focus").show().css({top:C+a,height:t-C}):$("#jfgrid-cell-selected-focus").show().css({top:C+a,height:T-a}):$("#jfgrid-cell-selected-focus").show().css("top",C+a),n<=M?M+E<n+l?h=!1:M<n+l?$("#jfgrid-cell-selected-focus").show().css({left:n+l,width:E-(n+l-M)}):$("#jfgrid-cell-selected-focus").show().css({left:M,width:E}):n<=M+E?M+E<n+l?$("#jfgrid-cell-selected-focus").show().css({left:M+l,width:n-M}):$("#jfgrid-cell-selected-focus").show().css({left:M+l,width:E-l}):$("#jfgrid-cell-selected-focus").show().css("left",M+l),h||$("#jfgrid-cell-selected-focus").hide())}else if(null!=jfgrid.freezen.freezenhorizontaldata)for(t=jfgrid.freezen.freezenhorizontaldata[0],i=jfgrid.freezen.freezenhorizontaldata[1],a=e-jfgrid.freezen.freezenhorizontaldata[2],d=0;d<jfgird_select_save.length;d++){var w,y,x,C,T,f=(I=$.extend(!0,{},jfgird_select_save[d])).row[0],s=I.row[1],g=visibledatarow[s],c=w=f-1==-1?0:visibledatarow[f-1],u=g-w-1;i<=f?c+u<t+a?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).hide():c<t+a?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({top:t+a,height:u-(t+a-c)}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({top:c,height:u}):i<=s?c+u<t+a?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({top:c+a,height:t-c}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({top:c+a,height:u-a}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css("top",c+a),d==jfgird_select_save.length-1&&(k=null==I.row_focus?f:I.row_focus,S=null==I.column_focus?I.column[0]:I.column_focus,y=visibledatarow[k],x=k-1==-1?0:visibledatarow[k-1],(N=jfgrid.menuButton.mergeborer(jfgrid.flowdata,k,S))&&(y=N.row[1],x=N.row[0]),T=y-x-1,t<=(C=x)?C+T<t+a?$("#jfgrid-cell-selected-focus").hide():C<t+a?$("#jfgrid-cell-selected-focus").show().css({top:t+a,height:T-(t+a-C)}):$("#jfgrid-cell-selected-focus").show().css({top:C,height:T}):t<=C+T?C+T<t+a?$("#jfgrid-cell-selected-focus").show().css({top:C+a,height:t-C}):$("#jfgrid-cell-selected-focus").show().css({top:C+a,height:T-a}):$("#jfgrid-cell-selected-focus").show().css("top",C+a))}else if(null!=jfgrid.freezen.freezenverticaldata)for(n=jfgrid.freezen.freezenverticaldata[0],o=jfgrid.freezen.freezenverticaldata[1],l=r-jfgrid.freezen.freezenverticaldata[2],d=0;d<jfgird_select_save.length;d++){var I,R,k,S,A,F,N,M,E,j=(I=$.extend(!0,{},jfgird_select_save[d])).column[0],p=I.column[1],v=visibledatacolumn[p],b=R=j-1==-1?0:visibledatacolumn[j-1],_=v-R-1;o<=j?b+_<n+l?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).hide():b<n+l?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({left:n+l,width:_-(n+l-b)}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({left:b,width:_}):o<=p?b+_<n+l?$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({left:b+l,width:n-b}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css({left:b+l,width:_-l}):$("#jfgrid-cell-selected-boxs").find(".jfgrid-cell-selected").eq(d).show().css("left",b+l),d==jfgird_select_save.length-1&&(k=null==I.row_focus?I.row[0]:I.row_focus,S=null==I.column_focus?j:I.column_focus,A=visibledatacolumn[S],F=S-1==-1?0:visibledatacolumn[S-1],(N=jfgrid.menuButton.mergeborer(jfgrid.flowdata,k,S))&&(A=N.column[1],F=N.column[0]),E=A-F-1,n<=(M=F)?M+E<n+l?$("#jfgrid-cell-selected-focus").hide():M<n+l?$("#jfgrid-cell-selected-focus").show().css({left:n+l,width:E-(n+l-M)}):$("#jfgrid-cell-selected-focus").show().css({left:M,width:E}):n<=M+E?M+E<n+l?$("#jfgrid-cell-selected-focus").show().css({left:M+l,width:n-M}):$("#jfgrid-cell-selected-focus").show().css({left:M+l,width:E-l}):$("#jfgrid-cell-selected-focus").show().css("left",M+l))}else jfgrid.selectHightlightShow()},scrollAdaptOfchart:function(){var s,g,c=$("#jfgrid-cell-main").scrollTop(),u=$("#jfgrid-cell-main").scrollLeft();null!=jfgrid.freezen.freezenhorizontaldata&&null!=jfgrid.freezen.freezenverticaldata?(s=jfgrid.freezen.freezenhorizontaldata[0]-jfgrid.freezen.freezenhorizontaldata[2],g=jfgrid.freezen.freezenverticaldata[0]-jfgrid.freezen.freezenverticaldata[2],$("#jfgrid-cell-main .jfgrid-data-visualization-chart").each(function(e,r){var t,i=$(r).position(),a=$(r).width(),n=$(r).height(),o=$(r).find("canvas").width(),l=$(r).find("canvas").height(),d=l-n,f=o-a;i.top-d<s?l+40+2<(t=s-(i.top-d))?$(r).css("visibility","hidden"):($(r).css({top:s+c,height:l-t,visibility:"visible"}),$(r).find("canvas").css("top",-t)):($(r).css({top:i.top-d+c,height:l,visibility:"visible"}),$(r).find("canvas").css("top",0)),i.left-f<g?o+20+2<(t=g-(i.left-f))?$(r).css("visibility","hidden"):($(r).css({left:g+u,width:o-t,visibility:"visible"}),$(r).find("canvas").css("left",-t)):($(r).css({left:i.left-f+u,width:o,visibility:"visible"}),$(r).find("canvas").css("left",0))})):null!=jfgrid.freezen.freezenhorizontaldata?(s=jfgrid.freezen.freezenhorizontaldata[0]-jfgrid.freezen.freezenhorizontaldata[2],$("#jfgrid-cell-main .jfgrid-data-visualization-chart").each(function(e,r){var t,i=$(r).position(),a=$(r).height(),n=$(r).find("canvas").height(),o=n-a;i.top-o<s?n+40+2<(t=s-(i.top-o))?$(r).css("visibility","hidden"):($(r).css({top:s+c,height:n-t,visibility:"visible"}),$(r).find("canvas").css("top",-t)):($(r).css({top:i.top-o+c,height:n,visibility:"visible"}),$(r).find("canvas").css("top",0))})):null!=jfgrid.freezen.freezenverticaldata?(g=jfgrid.freezen.freezenverticaldata[0]-jfgrid.freezen.freezenverticaldata[2],$("#jfgrid-cell-main .jfgrid-data-visualization-chart").each(function(e,r){var t,i=$(r).position(),a=$(r).width(),n=$(r).find("canvas").width(),o=n-a;i.left-o<g?n+20+2<(t=g-(i.left-o))?$(r).css("visibility","hidden"):($(r).css({left:g+u,width:n-t,visibility:"visible"}),$(r).find("canvas").css("left",-t)):($(r).css({left:i.left-o+u,width:n,visibility:"visible"}),$(r).find("canvas").css("left",0))})):$("#jfgrid-cell-main .jfgrid-data-visualization-chart").each(function(e,r){var t=$(r).position(),i=$(r).width(),a=$(r).height(),n=$(r).find("canvas").width(),o=$(r).find("canvas").height(),l=o-a,d=n-i;$(r).css({top:t.top-l+c,height:o,left:t.left-d+u,width:n,visibility:"visible"}),$(r).find("canvas").css({top:0,left:0})})},scrollAdaptOfpostil:function(){var j,p,v,b,e=$("#jfgrid-cell-main").scrollTop(),r=$("#jfgrid-cell-main").scrollLeft();null!=jfgrid.freezen.freezenhorizontaldata&&null!=jfgrid.freezen.freezenverticaldata?(j=jfgrid.freezen.freezenhorizontaldata[0],v=jfgrid.freezen.freezenverticaldata[0],p=e-jfgrid.freezen.freezenhorizontaldata[2],b=r-jfgrid.freezen.freezenverticaldata[2],$("#jfgrid-postil-showBoxs .jfgrid-postil-show").each(function(e,r){var t=$(r).attr("id"),i=t.split("jfgrid-postil-show_")[1].split("_")[0],a=t.split("jfgrid-postil-show_")[1].split("_")[1],n=jfgrid.flowdata[i][a].ps,o=(visibledatarow[i],i-1==-1?0:visibledatarow[i-1]),l=visibledatacolumn[a],d=(a-1==-1||visibledatacolumn[a-1],jfgrid.menuButton.mergeborer(jfgrid.flowdata,i,a));d&&(d.row[1],o=d.row[0],l=d.column[1],d.column[0]);var f=null==n.left?l+18:n.left,s=null==n.top?o-18:n.top,g=null==n.width?jfgrid.postil.defaultWidth:n.width,c=null==n.height?jfgrid.postil.defaultHeight:n.height;s<0&&(s=2);var u=jfgrid.postil.getArrowCanvasSize(f,s,l,o),m=!0,h=!0;s+c<j?($(r).show().find(".jfgrid-postil-show-main").css("top",s+p),$(r).show().find(".arrowCanvas").css("top",u[1]+p)):s<j+p?s+c<=j+p?m=!1:($(r).show().find(".jfgrid-postil-show-main").css({top:j+p,height:c-(j+p-s)}),$(r).show().find(".formulaInputFocus").css("margin-top",-(j+p-s)),$(r).show().find(".arrowCanvas").hide(),h=!1):($(r).show().find(".jfgrid-postil-show-main").css({top:s,height:c}),$(r).show().find(".formulaInputFocus").css("margin-top",0),$(r).show().find(".arrowCanvas").css("top",u[1])),f+g<v?($(r).show().find(".jfgrid-postil-show-main").css("left",f+b),$(r).show().find(".arrowCanvas").css("left",u[0]+b)):f<v+b?f+g<=v+b?m=!1:($(r).show().find(".jfgrid-postil-show-main").css({left:v+b,width:g-(v+b-f)}),$(r).show().find(".formulaInputFocus").css("margin-left",-(v+b-f)),$(r).show().find(".arrowCanvas").hide(),h=!1):($(r).show().find(".jfgrid-postil-show-main").css({left:f,width:g}),$(r).show().find(".formulaInputFocus").css("margin-left",0),$(r).show().find(".arrowCanvas").css("left",u[0])),m||$(r).hide(),m&&h&&$(r).show().find(".arrowCanvas").show()})):null!=jfgrid.freezen.freezenhorizontaldata?(j=jfgrid.freezen.freezenhorizontaldata[0],p=e-jfgrid.freezen.freezenhorizontaldata[2],$("#jfgrid-postil-showBoxs .jfgrid-postil-show").each(function(e,r){var t=$(r).attr("id"),i=t.split("jfgrid-postil-show_")[1].split("_")[0],a=t.split("jfgrid-postil-show_")[1].split("_")[1],n=jfgrid.flowdata[i][a].ps,o=(visibledatarow[i],i-1==-1?0:visibledatarow[i-1]),l=visibledatacolumn[a],d=(a-1==-1||visibledatacolumn[a-1],jfgrid.menuButton.mergeborer(jfgrid.flowdata,i,a));d&&(d.row[1],o=d.row[0],l=d.column[1],d.column[0]);var f=null==n.left?l+18:n.left,s=null==n.top?o-18:n.top,g=(null==n.width?jfgrid.postil.defaultWidth:n.width,null==n.height?jfgrid.postil.defaultHeight:n.height);s<0&&(s=2);var c=jfgrid.postil.getArrowCanvasSize(f,s,l,o);s+g<j?($(r).show().find(".jfgrid-postil-show-main").css("top",s+p),$(r).show().find(".arrowCanvas").css("top",c[1]+p)):s<j+p?s+g<=j+p?$(r).hide():($(r).show().find(".jfgrid-postil-show-main").css({top:j+p,height:g-(j+p-s)}),$(r).show().find(".formulaInputFocus").css("margin-top",-(j+p-s)),$(r).show().find(".arrowCanvas").hide()):jfgrid.postil.buildPs(i,a,n)})):null!=jfgrid.freezen.freezenverticaldata?(v=jfgrid.freezen.freezenverticaldata[0],b=r-jfgrid.freezen.freezenverticaldata[2],$("#jfgrid-postil-showBoxs .jfgrid-postil-show").each(function(e,r){var t=$(r).attr("id"),i=t.split("jfgrid-postil-show_")[1].split("_")[0],a=t.split("jfgrid-postil-show_")[1].split("_")[1],n=jfgrid.flowdata[i][a].ps,o=(visibledatarow[i],i-1==-1?0:visibledatarow[i-1]),l=visibledatacolumn[a],d=(a-1==-1||visibledatacolumn[a-1],jfgrid.menuButton.mergeborer(jfgrid.flowdata,i,a));d&&(d.row[1],o=d.row[0],l=d.column[1],d.column[0]);var f=null==n.left?l+18:n.left,s=null==n.top?o-18:n.top,g=null==n.width?jfgrid.postil.defaultWidth:n.width;null==n.height?jfgrid.postil.defaultHeight:n.height;s<0&&(s=2);var c=jfgrid.postil.getArrowCanvasSize(f,s,l,o);f+g<v?($(r).show().find(".jfgrid-postil-show-main").css("left",f+b),$(r).show().find(".arrowCanvas").css("left",c[0]+b)):f<v+b?f+g<=v+b?$(r).hide():($(r).show().find(".jfgrid-postil-show-main").css({left:v+b,width:g-(v+b-f)}),$(r).show().find(".formulaInputFocus").css("margin-left",-(v+b-f)),$(r).show().find(".arrowCanvas").hide()):jfgrid.postil.buildPs(i,a,n)})):$("#jfgrid-postil-showBoxs .jfgrid-postil-show").each(function(e,r){var t=$(r).attr("id"),i=t.split("jfgrid-postil-show_")[1].split("_")[0],a=t.split("jfgrid-postil-show_")[1].split("_")[1],n=jfgrid.flowdata[i][a].ps;jfgrid.postil.buildPs(i,a,n)})},scrollAdaptOfdpicon:function(){var e,r,t,i,a,n,o,l,d=jfgrid.dropCell.copyRange.row[1],f=jfgrid.dropCell.copyRange.column[1],s=jfgrid.dropCell.applyRange.row[1],g=jfgrid.dropCell.applyRange.column[1];r=d<=s&&f<=g?(e=s,g):(e=d,f),null!=jfgrid.freezen.freezenhorizontaldata&&null!=jfgrid.freezen.freezenverticaldata?(t=jfgrid.freezen.freezenhorizontaldata[1],i=jfgrid_searcharray(jfgrid.freezen.freezenhorizontaldata[3],$("#jfgrid-cell-main").scrollTop()-jfgrid.freezen.freezenhorizontaldata[2]),a=jfgrid.freezen.freezenverticaldata[1],n=jfgrid_searcharray(jfgrid.freezen.freezenverticaldata[3],$("#jfgrid-cell-main").scrollLeft()-jfgrid.freezen.freezenverticaldata[2]),t<=e&&a<=r?e<t+i-1||r<a+n-1?$("#jfgrid-dropCell-icon").hide():$("#jfgrid-dropCell-icon").show():t<=e?e<t+i-1?$("#jfgrid-dropCell-icon").hide():(l=jfgrid.colLocationByIndex(r+n)[1],$("#jfgrid-dropCell-icon").show().css("left",l)):a<=r?r<a+n-1?$("#jfgrid-dropCell-icon").hide():(o=jfgrid.rowLocationByIndex(e+i)[1],$("#jfgrid-dropCell-icon").show().css("top",o)):(o=jfgrid.rowLocationByIndex(e+i)[1],l=jfgrid.colLocationByIndex(r+n)[1],$("#jfgrid-dropCell-icon").show().css({left:l,top:o}))):null!=jfgrid.freezen.freezenhorizontaldata?(t=jfgrid.freezen.freezenhorizontaldata[1],i=jfgrid_searcharray(jfgrid.freezen.freezenhorizontaldata[3],$("#jfgrid-cell-main").scrollTop()-jfgrid.freezen.freezenhorizontaldata[2]),t<=e?e<t+i-1?$("#jfgrid-dropCell-icon").hide():$("#jfgrid-dropCell-icon").show():(o=jfgrid.rowLocationByIndex(e+i)[1],$("#jfgrid-dropCell-icon").show().css("top",o))):null!=jfgrid.freezen.freezenverticaldata?(a=jfgrid.freezen.freezenverticaldata[1],n=jfgrid_searcharray(jfgrid.freezen.freezenverticaldata[3],$("#jfgrid-cell-main").scrollLeft()-jfgrid.freezen.freezenverticaldata[2]),a<=r?r<a+n-1?$("#jfgrid-dropCell-icon").hide():$("#jfgrid-dropCell-icon").show():(l=jfgrid.colLocationByIndex(r+n)[1],$("#jfgrid-dropCell-icon").show().css("left",l))):(o=jfgrid.rowLocationByIndex(e)[1],l=jfgrid.colLocationByIndex(r)[1],$("#jfgrid-dropCell-icon").show().css({left:l,top:o}))},scrollAdaptOffilteroptions:function(){var o,l,d,f;null!=jfgrid.freezen.freezenhorizontaldata&&null!=jfgrid.freezen.freezenverticaldata?(o=jfgrid.freezen.freezenhorizontaldata[1],l=jfgrid.freezen.freezenhorizontaldata[0]+$("#jfgrid-cell-main").scrollTop(),d=jfgrid.freezen.freezenverticaldata[1],f=jfgrid_searcharray(jfgrid.freezen.freezenverticaldata[3],$("#jfgrid-cell-main").scrollLeft()-jfgrid.freezen.freezenverticaldata[2]),$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").each(function(e,r){var t,i=$(r).data("str"),a=i-1==-1?0:visibledatarow[i-1],n=$(r).data("cindex");o<=i&&d<=n?a<l||n<d+f?$(r).hide():$(r).show():o<=i?a<l?$(r).hide():(t=visibledatacolumn[n+f]-20,$(r).show().css("left",t)):d<=n?n<d+f?$(r).hide():$(r).show().css("top",a+$("#jfgrid-cell-main").scrollTop()):(t=visibledatacolumn[n+f]-20,$(r).show().css({left:t,top:a+$("#jfgrid-cell-main").scrollTop()}))})):null!=jfgrid.freezen.freezenhorizontaldata?(o=jfgrid.freezen.freezenhorizontaldata[1],l=jfgrid.freezen.freezenhorizontaldata[0]+$("#jfgrid-cell-main").scrollTop(),$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").each(function(e,r){var t=$(r).data("str"),i=t-1==-1?0:visibledatarow[t-1];o<=t?i<l?$(r).hide():$(r).show():$(r).show().css("top",i+$("#jfgrid-cell-main").scrollTop())})):null!=jfgrid.freezen.freezenverticaldata?(d=jfgrid.freezen.freezenverticaldata[1],f=jfgrid_searcharray(jfgrid.freezen.freezenverticaldata[3],$("#jfgrid-cell-main").scrollLeft()-jfgrid.freezen.freezenverticaldata[2]),$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").each(function(e,r){var t,i=$(r).data("cindex");d<=i?i<d+f?$(r).hide():$(r).show():(t=visibledatacolumn[i+f]-20,$(r).show().css("left",t))})):($("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).empty(),jfgrid.createFilterOptions(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].filter_select))}},jfgrid.conditionformat={fileClone:[],editorRule:null,ruleTypeHtml:'<div class="ruleTypeBox"><div class="ruleTypeItem"><span class="icon">► </span><span>基于各自值设置所有单元格的格式</span></div><div class="ruleTypeItem"><span class="icon">► </span><span>只为包含以下内容的单元格设置格式</span></div><div class="ruleTypeItem"><span class="icon">► </span><span>仅对排名靠前或靠后的数值设置格式</span></div><div class="ruleTypeItem"><span class="icon">► </span><span>仅对高于或低于平均值的数值设置格式</span></div><div class="ruleTypeItem"><span class="icon">► </span><span>仅对唯一值或重复值设置格式</span></div></div>',textCellColorHtml:'<div id="textCellColor"><div class="colorbox"><input id="checkTextColor" type="checkbox" checked="checked"><label for="checkTextColor">文本颜色：</label><input id="textcolorshow" data-tips="文本颜色" data-func="background" class="jfgrid-conditionformat-config-color" type="text" value="#9c0006" style="display: none;"></div><div class="colorbox"><input id="checkCellColor" type="checkbox" checked="checked"><label for="checkCellColor">单元格颜色：</label><input id="cellcolorshow" data-tips="单元格颜色" data-func="background" class="jfgrid-conditionformat-config-color" type="text" value="#ffc7ce" style="display: none;"></div></div>',selectRange:[],selectStatus:!1,dataBarList:[{format:["#638ec6","#ffffff"]},{format:["#63c384","#ffffff"]},{format:["#ff555a","#ffffff"]},{format:["#ffb628","#ffffff"]},{format:["#008aef","#ffffff"]},{format:["#d6007b","#ffffff"]},{format:["#638ec6"]},{format:["#63c384"]},{format:["#ff555a"]},{format:["#ffb628"]},{format:["#008aef"]},{format:["#d6007b"]}],colorGradationList:[{format:["rgb(99, 190, 123)","rgb(255, 235, 132)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(255, 235, 132)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(90, 138, 198)","rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)","rgb(90, 138, 198)"]},{format:["rgb(252, 252, 255)","rgb(248, 105, 107)"]},{format:["rgb(248, 105, 107)","rgb(252, 252, 255)"]},{format:["rgb(99, 190, 123)","rgb(252, 252, 255)"]},{format:["rgb(252, 252, 255)","rgb(99, 190, 123)"]},{format:["rgb(99, 190, 123)","rgb(255, 235, 132)"]},{format:["rgb(255, 235, 132)","rgb(99, 190, 123)"]}],init:function(){$(document).off("change.CFchooseSheet").on("change.CFchooseSheet","#jfgrid-administerRule-dialog .chooseSheet",function(){var e=$("#jfgrid-administerRule-dialog .chooseSheet option:selected").val();jfgrid.conditionformat.getConditionRuleList(e)}),$(document).off("click.CFadministerRuleItem").on("click.CFadministerRuleItem","#jfgrid-administerRule-dialog .ruleList .listBox .item",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.CFadministerRuleConfirm").on("click.CFadministerRuleConfirm","#jfgrid-administerRule-dialog-confirm",function(){for(var e=$.extend(!0,[],jfgrid.getjfgridfile()),r=jfgrid.conditionformat.getHistoryRules(e),t=$.extend(!0,[],jfgrid.conditionformat.fileClone),i=0;i<t.length;i++){var a=t[i].index;jfgridfile[jfgrid.sheetmanage.getSheetIndex(a)].jfgrid_conditionformat_save=t[jfgrid.sheetmanage.getSheetIndex(a)].jfgrid_conditionformat_save}var n=$.extend(!0,[],jfgrid.getjfgridfile()),o=jfgrid.conditionformat.getCurrentRules(n);if(jfgrid.conditionformat.ref(r,o),$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-administerRule-dialog").hide(),jfgrid.server.allowUpdate)for(var l=$.extend(!0,[],jfgrid.getjfgridfile()),d=0;d<l.length;d++)jfgrid.server.saveParam("all",l[d].index,l[d].jfgrid_conditionformat_save,{k:"jfgrid_conditionformat_save"})}),$(document).off("click.CFadministerRuleClose").on("click.CFadministerRuleClose","#jfgrid-administerRule-dialog-close",function(){$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-administerRule-dialog").hide(),jfgrid.conditionformat.fileClone=[]}),$(document).off("click.CFadministerRuleFa").on("click.CFadministerRuleFa","#jfgrid-administerRule-dialog .item .fa-table",function(){$(this).parents("#jfgrid-administerRule-dialog").hide();var e=$("#jfgrid-administerRule-dialog .chooseSheet select option:selected").val();e!=jfgrid.currentSheetIndex&&jfgrid.sheetmanage.changeSheetExec(e);var r=$(this).siblings("input").val().trim(),t=$(this).parents(".item").attr("data-item");jfgrid.conditionformat.multiRangeDialog(t,r),jfgrid.conditionformat.selectRange=[];var i=jfgrid.conditionformat.getRangeByTxt(r);if(0<i.length)for(var a=0;a<i.length;a++){var n=i[a].row[0],o=i[a].row[1],l=i[a].column[0],d=i[a].column[1],f=visibledatarow[o],s=n-1==-1?0:visibledatarow[n-1],g=visibledatacolumn[d],c=l-1==-1?0:visibledatacolumn[l-1];jfgrid.conditionformat.selectRange.push({left:c,width:g-c-1,top:s,height:f-s-1,left_move:c,width_move:g-c-1,top_move:s,height_move:f-s-1,row:[n,o],column:[l,d],row_focus:n,column_focus:l})}jfgrid.selectionCopyShow(jfgrid.conditionformat.selectRange)}),$(document).off("click.CFmultiRangeConfirm").on("click.CFmultiRangeConfirm","#jfgrid-multiRange-dialog-confirm",function(){$(this).parents("#jfgrid-multiRange-dialog").hide();var e=$(this).attr("data-item"),r=$(this).parents("#jfgrid-multiRange-dialog").find("input").val();$("#jfgrid-administerRule-dialog .item[data-item="+e+"] input").val(r);var t=$("#jfgrid-administerRule-dialog .chooseSheet option:selected").val();jfgrid.conditionformat.fileClone[jfgrid.sheetmanage.getSheetIndex(t)].jfgrid_conditionformat_save[e].cellrange=jfgrid.conditionformat.getRangeByTxt(r),$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-administerRule-dialog").show();jfgrid.selectionCopyShow([])}),$(document).off("click.CFmultiRangeClose").on("click.CFmultiRangeClose","#jfgrid-multiRange-dialog-close",function(){$(this).parents("#jfgrid-multiRange-dialog").hide(),$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-administerRule-dialog").show(),$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").hide();jfgrid.selectionCopyShow([])}),$(document).off("click.CFnewConditionRule").on("click.CFnewConditionRule","#newConditionRule",function(){0!=jfgird_select_save.length?jfgrid.conditionformat.newConditionRuleDialog(1):jfgrid.isEditMode()?alert("请选择应用范围"):jfgrid.tooltip.info("请选择应用范围","")}),$(document).off("click.CFnewConditionRuleConfirm").on("click.CFnewConditionRuleConfirm","#jfgrid-newConditionRule-dialog-confirm",function(){var e,r,t,i,a,n=$("#jfgrid-newConditionRule-dialog .ruleTypeItem.on").index(),o=$("#jfgrid-newConditionRule-dialog #type1 option:selected").val(),l=$("#jfgrid-newConditionRule-dialog ."+o+"Box #type2 option:selected").val();if(0==n){"dataBar"==o?(e=$(this).parents("#jfgrid-newConditionRule-dialog").find(".dataBarBox .jfgrid-conditionformat-config-color").spectrum("get").toHexString(),"gradient"==l?a=[e,"#ffffff"]:"solid"==l&&(a=[e]),w={type:"dataBar",cellrange:$.extend(!0,[],jfgird_select_save),format:a}):"colorGradation"==o?(r=$(this).parents("#jfgrid-newConditionRule-dialog").find(".colorGradationBox .maxVal .jfgrid-conditionformat-config-color").spectrum("get").toRgbString(),t=$(this).parents("#jfgrid-newConditionRule-dialog").find(".colorGradationBox .midVal .jfgrid-conditionformat-config-color").spectrum("get").toRgbString(),i=$(this).parents("#jfgrid-newConditionRule-dialog").find(".colorGradationBox .minVal .jfgrid-conditionformat-config-color").spectrum("get").toRgbString(),"threeColor"==l?a=[r,t,i]:"twoColor"==l&&(a=[r,i]),w={type:"colorGradation",cellrange:$.extend(!0,[],jfgird_select_save),format:a}):"icons"==o&&(a={len:$(this).parents("#jfgrid-newConditionRule-dialog").find(".iconsBox .model").attr("data-len"),leftMin:$(this).parents("#jfgrid-newConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),top:$(this).parents("#jfgrid-newConditionRule-dialog").find(".iconsBox .model").attr("data-top")},w={type:"icons",cellrange:$.extend(!0,[],jfgird_select_save),format:a})}else{var d="",f=[],s=[];if(1==n){if("number"==o)if("betweenness"==(d=l)){var g=$("#jfgrid-newConditionRule-dialog #conditionVal input").val().trim(),c=$("#jfgrid-newConditionRule-dialog #conditionVal2 input").val().trim(),u=jfgrid.conditionformat.getRangeByTxt(g);if(1<u.length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==u.length){var m=u[0].row[0],h=u[0].row[1],j=u[0].column[0],p=u[0].column[1];if(m!=h||j!=p)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");g=jfgrid.getcellvalue(m,j,jfgrid.flowdata),f.push({row:u[0].row,column:u[0].column}),s.push(g)}else if(0==u.length){if(isNaN(g)||""==g)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");s.push(g)}var v=jfgrid.conditionformat.getRangeByTxt(c);if(1<v.length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==v.length){m=v[0].row[0],h=v[0].row[1],j=v[0].column[0],p=v[0].column[1];if(m!=h||j!=p)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");c=jfgrid.getcellvalue(m,j,jfgrid.flowdata),f.push({row:v[0].row,column:v[0].column}),s.push(c)}else if(0==v.length){if(isNaN(c)||""==c)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");s.push(c)}}else{var b=$("#jfgrid-newConditionRule-dialog #conditionVal input").val().trim();if(1<(_=jfgrid.conditionformat.getRangeByTxt(b)).length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==_.length){m=_[0].row[0],h=_[0].row[1],j=_[0].column[0],p=_[0].column[1];if(m!=h||j!=p)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");b=jfgrid.getcellvalue(m,j,jfgrid.flowdata),f.push({row:_[0].row,column:_[0].column}),s.push(b)}else if(0==_.length){if(isNaN(b)||""==b)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");s.push(b)}}else if("text"==o){d="textContains";var _,b=$("#jfgrid-newConditionRule-dialog #conditionVal input").val().trim();if(1<(_=jfgrid.conditionformat.getRangeByTxt(b)).length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==_.length){m=_[0].row[0],h=_[0].row[1],j=_[0].column[0],p=_[0].column[1];if(m!=h||j!=p)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");b=jfgrid.getcellvalue(m,j,jfgrid.flowdata),f.push({row:_[0].row,column:_[0].column}),s.push(b)}else if(0==_.length){if(isNaN(b)||""==b)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");s.push(b)}}else if("date"==o){if(d="occurrenceDate",""==(b=$("#jfgrid-newConditionRule-dialog #daterange-btn").val())||null==b)return void jfgrid.conditionformat.infoDialog("请选择日期","");s.push(b)}}else if(2==n){"top"==o?d=$("#jfgrid-newConditionRule-dialog #isPercent").is(":selected")?"top10%":"top10":"last"==o&&(d=$("#jfgrid-newConditionRule-dialog #isPercent").is(":selected")?"last10%":"last10");b=$("#jfgrid-newConditionRule-dialog #conditionVal input").val().trim();if(parseInt(b)!=b||parseInt(b)<1||1e3<parseInt(b))return void jfgrid.conditionformat.infoDialog("请输入一个介于 1 和 1000 之间的整数","");s.push(b)}else 3==n?"AboveAverage"==o?(d="AboveAverage",s.push("AboveAverage")):"SubAverage"==o&&(d="SubAverage",s.push("SubAverage")):4==n&&(d="duplicateValue",s.push(o));a={textColor:$("#jfgrid-newConditionRule-dialog #checkTextColor").is(":checked")?$("#jfgrid-newConditionRule-dialog #textcolorshow").spectrum("get").toHexString():null,cellColor:$("#jfgrid-newConditionRule-dialog #checkCellColor").is(":checked")?$("#jfgrid-newConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():null};var w={type:"default",cellrange:$.extend(!0,[],jfgird_select_save),format:a,conditionName:d,conditionRange:f,conditionValue:s}}$("#jfgrid-newConditionRule-dialog").hide();var y,x,C,T,I,R=$(this).attr("data-source");0==R?($("#jfgrid-modal-dialog-mask").hide(),y=$.extend(!0,[],jfgrid.getjfgridfile()),x=jfgrid.conditionformat.getHistoryRules(y),(I=null==jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save?[]:jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save).push(w),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save=I,C=$.extend(!0,[],jfgrid.getjfgridfile()),T=jfgrid.conditionformat.getCurrentRules(C),jfgrid.conditionformat.ref(x,T),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,I,{k:"jfgrid_conditionformat_save"})):1==R&&((I=jfgrid.conditionformat.fileClone[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save?jfgrid.conditionformat.fileClone[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save:[]).push(w),jfgrid.conditionformat.fileClone[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save=I,jfgrid.conditionformat.administerRuleDialog())}),$(document).off("click.CFnewConditionRuleClose").on("click.CFnewConditionRuleClose","#jfgrid-newConditionRule-dialog-close",function(){var e=$(this).attr("data-source");0==e&&$("#jfgrid-modal-dialog-mask").hide(),1==e&&$("#jfgrid-administerRule-dialog").show(),$("#jfgrid-newConditionRule-dialog").hide(),$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").hide()}),$(document).off("click.CFeditorConditionRule").on("click.CFeditorConditionRule","#editorConditionRule",function(){var e=$("#jfgrid-administerRule-dialog .chooseSheet option:selected").val(),r=$("#jfgrid-administerRule-dialog .ruleList .listBox .item.on").attr("data-item"),t={sheetIndex:e,itemIndex:r,data:jfgrid.conditionformat.fileClone[jfgrid.sheetmanage.getSheetIndex(e)].jfgrid_conditionformat_save[r]};jfgrid.conditionformat.editorRule=t,jfgrid.conditionformat.editorConditionRuleDialog()}),$(document).off("click.CFeditorConditionRuleConfirm").on("click.CFeditorConditionRuleConfirm","#jfgrid-editorConditionRule-dialog-confirm",function(){var e,r,t,i,a,n=$("#jfgrid-editorConditionRule-dialog .ruleTypeItem.on").index(),o=$("#jfgrid-editorConditionRule-dialog #type1 option:selected").val(),l=$("#jfgrid-editorConditionRule-dialog ."+o+"Box #type2 option:selected").val(),d=jfgrid.conditionformat.editorRule.data.cellrange;if(0==n){"dataBar"==o?(e=$(this).parents("#jfgrid-editorConditionRule-dialog").find(".dataBarBox .jfgrid-conditionformat-config-color").spectrum("get").toHexString(),"gradient"==l?a=[e,"#ffffff"]:"solid"==l&&(a=[e]),y={type:"dataBar",cellrange:d,format:a}):"colorGradation"==o?(r=$(this).parents("#jfgrid-editorConditionRule-dialog").find(".colorGradationBox .maxVal .jfgrid-conditionformat-config-color").spectrum("get").toRgbString(),t=$(this).parents("#jfgrid-editorConditionRule-dialog").find(".colorGradationBox .midVal .jfgrid-conditionformat-config-color").spectrum("get").toRgbString(),i=$(this).parents("#jfgrid-editorConditionRule-dialog").find(".colorGradationBox .minVal .jfgrid-conditionformat-config-color").spectrum("get").toRgbString(),"threeColor"==l?a=[r,t,i]:"twoColor"==l&&(a=[r,i]),y={type:"colorGradation",cellrange:d,format:a}):"icons"==o&&(y={type:"icons",cellrange:d,format:a={len:$(this).parents("#jfgrid-editorConditionRule-dialog").find(".iconsBox .model").attr("data-len"),leftMin:$(this).parents("#jfgrid-editorConditionRule-dialog").find(".iconsBox .model").attr("data-leftmin"),top:$(this).parents("#jfgrid-editorConditionRule-dialog").find(".iconsBox .model").attr("data-top")}})}else{var f="",s=[],g=[];if(1==n){if("number"==o)if("betweenness"==(f=l)){var c=$("#jfgrid-editorConditionRule-dialog #conditionVal input").val().trim(),u=$("#jfgrid-editorConditionRule-dialog #conditionVal2 input").val().trim(),m=jfgrid.conditionformat.getRangeByTxt(c);if(1<m.length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==m.length){var h=m[0].row[0],j=m[0].row[1],p=m[0].column[0],v=m[0].column[1];if(h!=j||p!=v)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");c=jfgrid.getcellvalue(h,p,jfgrid.flowdata),s.push({row:m[0].row,column:m[0].column}),g.push(c)}else if(0==m.length){if(isNaN(c)||""==c)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");g.push(c)}var b=jfgrid.conditionformat.getRangeByTxt(u);if(1<b.length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==b.length){h=b[0].row[0],j=b[0].row[1],p=b[0].column[0],v=b[0].column[1];if(h!=j||p!=v)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");u=jfgrid.getcellvalue(h,p,jfgrid.flowdata),s.push({row:b[0].row,column:b[0].column}),g.push(u)}else if(0==b.length){if(isNaN(u)||""==u)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");g.push(u)}}else{var _=$("#jfgrid-editorConditionRule-dialog #conditionVal input").val().trim();if(1<(w=jfgrid.conditionformat.getRangeByTxt(_)).length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==w.length){h=w[0].row[0],j=w[0].row[1],p=w[0].column[0],v=w[0].column[1];if(h!=j||p!=v)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");_=jfgrid.getcellvalue(h,p,jfgrid.flowdata),s.push({row:w[0].row,column:w[0].column}),g.push(_)}else if(0==w.length){if(isNaN(_)||""==_)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");g.push(_)}}else if("text"==o){f="textContains";var w,_=$("#jfgrid-editorConditionRule-dialog #conditionVal input").val().trim();if(1<(w=jfgrid.conditionformat.getRangeByTxt(_)).length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==w.length){h=w[0].row[0],j=w[0].row[1],p=w[0].column[0],v=w[0].column[1];if(h!=j||p!=v)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");_=jfgrid.getcellvalue(h,p,jfgrid.flowdata),s.push({row:w[0].row,column:w[0].column}),g.push(_)}else if(0==w.length){if(isNaN(_)||""==_)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");g.push(_)}}else if("date"==o){if(f="occurrenceDate",""==(_=$("#jfgrid-editorConditionRule-dialog #daterange-btn").val())||null==_)return void jfgrid.conditionformat.infoDialog("请选择日期","");g.push(_)}}else if(2==n){"top"==o?f=$("#jfgrid-editorConditionRule-dialog #isPercent").is(":selected")?"top10%":"top10":"last"==o&&(f=$("#jfgrid-editorConditionRule-dialog #isPercent").is(":selected")?"last10%":"last10");_=$("#jfgrid-editorConditionRule-dialog #conditionVal input").val().trim();if(parseInt(_)!=_||parseInt(_)<1||1e3<parseInt(_))return void jfgrid.conditionformat.infoDialog("请输入一个介于 1 和 1000 之间的整数","");g.push(_)}else 3==n?"AboveAverage"==o?(f="AboveAverage",g.push("AboveAverage")):"SubAverage"==o&&(f="SubAverage",g.push("SubAverage")):4==n&&(f="duplicateValue",g.push(o));var y={type:"default",cellrange:d,format:a={textColor:$("#jfgrid-editorConditionRule-dialog #checkTextColor").is(":checked")?$("#jfgrid-editorConditionRule-dialog #textcolorshow").spectrum("get").toHexString():null,cellColor:$("#jfgrid-editorConditionRule-dialog #checkCellColor").is(":checked")?$("#jfgrid-editorConditionRule-dialog #cellcolorshow").spectrum("get").toHexString():null},conditionName:f,conditionRange:s,conditionValue:g}}var x=jfgrid.conditionformat.editorRule.sheetIndex,C=jfgrid.conditionformat.editorRule.itemIndex;jfgrid.conditionformat.fileClone[jfgrid.sheetmanage.getSheetIndex(x)].jfgrid_conditionformat_save[C]=y,$("#jfgrid-editorConditionRule-dialog").hide(),jfgrid.conditionformat.administerRuleDialog()}),$(document).off("click.CFeditorConditionRuleClose").on("click.CFeditorConditionRuleClose","#jfgrid-editorConditionRule-dialog-close",function(){$("#jfgrid-editorConditionRule-dialog").hide(),$("#jfgrid-administerRule-dialog").show(),$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").hide()}),$(document).off("click.CFnewEditorRuleItem").on("click.CFnewEditorRuleItem",".jfgrid-newEditorRule-dialog .ruleTypeItem",function(){$(this).addClass("on").siblings().removeClass("on");var e=$(this).index();$(this).parents(".jfgrid-newEditorRule-dialog").find(".ruleExplainBox").html(jfgrid.conditionformat.getRuleExplain(e)),jfgrid.conditionformat.colorSelectInit()}),$(document).off("change.CFnewEditorRuleType1").on("change.CFnewEditorRuleType1",".jfgrid-newEditorRule-dialog #type1",function(){var e=$(this).find("option:selected").val();"dataBar"!=e&&"colorGradation"!=e&&"icons"!=e&&"number"!=e&&"text"!=e&&"date"!=e||$(this).parents(".jfgrid-newEditorRule-dialog").find("."+e+"Box").show().siblings().hide(),"date"==e&&jfgrid.conditionformat.daterangeInit($(this).parents(".jfgrid-newEditorRule-dialog").attr("id"))}),$(document).off("change.CFnewEditorRuleType2").on("change.CFnewEditorRuleType2",".jfgrid-newEditorRule-dialog #type2",function(){var e=$(this).parents(".jfgrid-newEditorRule-dialog").find("#type1 option:selected").val();"colorGradation"==e?"threeColor"==$(this).find("option:selected").val()?$(this).parents(".jfgrid-newEditorRule-dialog").find(".midVal").show():$(this).parents(".jfgrid-newEditorRule-dialog").find(".midVal").hide():"number"==e&&("betweenness"==$(this).find("option:selected").val()?($(this).parents(".jfgrid-newEditorRule-dialog").find(".txt").show(),$(this).parents(".jfgrid-newEditorRule-dialog").find("#conditionVal2").show()):($(this).parents(".jfgrid-newEditorRule-dialog").find(".txt").hide(),$(this).parents(".jfgrid-newEditorRule-dialog").find("#conditionVal2").hide()))}),$(document).off("click.CFiconsShowbox").on("click.CFiconsShowbox",".jfgrid-newEditorRule-dialog .iconsBox .showbox",function(){$(this).parents(".iconsBox").find("ul").toggle()}),$(document).off("click.CFiconsLi").on("click.CFiconsLi",".jfgrid-newEditorRule-dialog .iconsBox li",function(){var e=$(this).find("div").attr("data-len"),r=$(this).find("div").attr("data-leftmin"),t=$(this).find("div").attr("data-top"),i=$(this).find("div").attr("title"),a=$(this).find("div").css("background-position");$(this).parents(".iconsBox").find(".showbox .model").css("background-position",a),$(this).parents(".iconsBox").find(".showbox .model").attr("data-len",e),$(this).parents(".iconsBox").find(".showbox .model").attr("data-leftmin",r),$(this).parents(".iconsBox").find(".showbox .model").attr("data-top",t),$(this).parents(".iconsBox").find(".showbox .model").attr("title",i),$(this).parents("ul").hide()}),$(document).off("click.CFdeleteConditionRule").on("click.CFdeleteConditionRule","#deleteConditionRule",function(){var e=$("#jfgrid-administerRule-dialog .chooseSheet option:selected").val(),r=$("#jfgrid-administerRule-dialog .ruleList .listBox .item.on").attr("data-item");jfgrid.conditionformat.fileClone[jfgrid.sheetmanage.getSheetIndex(e)].jfgrid_conditionformat_save.splice(r,1),jfgrid.conditionformat.administerRuleDialog()}),$(document).off("click.CFdefault").on("click.CFdefault","#jfgrid-conditionformat-dialog-confirm",function(){var e,r,t=$("#jfgrid-conditionformat-dialog .box").attr("data-itemvalue"),i=[],a=[];if("greaterThan"==t||"lessThan"==t||"equal"==t||"textContains"==t){var n=$("#jfgrid-conditionformat-dialog #conditionVal").val().trim(),o=jfgrid.conditionformat.getRangeByTxt(n);if(1<o.length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==o.length){var l=o[0].row[0],d=o[0].row[1],f=o[0].column[0],s=o[0].column[1];if(l!=d||f!=s)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");n=jfgrid.getcellvalue(l,f,jfgrid.flowdata),i.push({row:o[0].row,column:o[0].column}),a.push(n)}else if(0==o.length){if(isNaN(n)||""==n)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");a.push(n)}}else if("betweenness"==t){var g=$("#jfgrid-conditionformat-dialog #conditionVal").val().trim(),c=$("#jfgrid-conditionformat-dialog #conditionVal2").val().trim(),u=jfgrid.conditionformat.getRangeByTxt(g);if(1<u.length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==u.length){l=u[0].row[0],d=u[0].row[1],f=u[0].column[0],s=u[0].column[1];if(l!=d||f!=s)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");g=jfgrid.getcellvalue(l,f,jfgrid.flowdata),i.push({row:u[0].row,column:u[0].column}),a.push(g)}else if(0==u.length){if(isNaN(g)||""==g)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");a.push(g)}var m=jfgrid.conditionformat.getRangeByTxt(c);if(1<m.length)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");if(1==m.length){l=m[0].row[0],d=m[0].row[1],f=m[0].column[0],s=m[0].column[1];if(l!=d||f!=s)return void jfgrid.conditionformat.infoDialog("只能对单个单元格进行引用","");c=jfgrid.getcellvalue(l,f,jfgrid.flowdata),i.push({row:m[0].row,column:m[0].column}),a.push(c)}else if(0==m.length){if(isNaN(c)||""==c)return void jfgrid.conditionformat.infoDialog("条件值只能是数字或者单个单元格","");a.push(c)}}else if("occurrenceDate"==t){if(""==(n=$("#jfgrid-conditionformat-dialog #daterange-btn").val())||null==n)return void jfgrid.conditionformat.infoDialog("请选择日期","");a.push(n)}else if("duplicateValue"==t)a.push($("#jfgrid-conditionformat-dialog #conditionVal option:selected").val());else if("top10"==t||"top10%"==t||"last10"==t||"last10%"==t){n=$("#jfgrid-conditionformat-dialog #conditionVal").val().trim();if(parseInt(n)!=n||parseInt(n)<1||1e3<parseInt(n))return void jfgrid.conditionformat.infoDialog("请输入一个介于 1 和 1000 之间的整数","");a.push(n)}else"AboveAverage"==t?a.push("AboveAverage"):"SubAverage"==t&&a.push("SubAverage");e=$("#checkTextColor").is(":checked")?$("#textcolorshow").spectrum("get").toHexString():null,r=$("#checkCellColor").is(":checked")?$("#cellcolorshow").spectrum("get").toHexString():null;var h=$.extend(!0,[],jfgrid.getjfgridfile()),j=jfgrid.conditionformat.getHistoryRules(h),p={type:"default",cellrange:$.extend(!0,[],jfgird_select_save),format:{textColor:e,cellColor:r},conditionName:t,conditionRange:i,conditionValue:a},v=null==jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save?[]:jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save;v.push(p),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save=v;var b=$.extend(!0,[],jfgrid.getjfgridfile()),_=jfgrid.conditionformat.getCurrentRules(b);jfgrid.conditionformat.ref(j,_),$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-conditionformat-dialog").hide(),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,v,{k:"jfgrid_conditionformat_save"})}),$(document).off("click.CFicons").on("click.CFicons","#jfgrid-CFicons-dialog .item",function(){var e,r;$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-CFicons-dialog").hide(),0<jfgird_select_save.length&&(e=$.extend(!0,[],jfgird_select_save),r={len:$(this).attr("data-len"),leftMin:$(this).attr("data-leftMin"),top:$(this).attr("data-top")},jfgrid.conditionformat.updateItem("icons",e,r))}),$(document).on("click",".range .fa-table",function(){var e,r=$(this).parents(".jfgrid-modal-dialog").attr("id");$("#"+r).hide(),"jfgrid-conditionformat-dialog"==r?e="conditionVal"==$(this).siblings("input").attr("id")?"0_1":"0_2":"jfgrid-newConditionRule-dialog"==r?e="conditionVal"==$(this).parents(".range").attr("id")?"1_1":"1_2":"jfgrid-editorConditionRule-dialog"==r&&(e="conditionVal"==$(this).parents(".range").attr("id")?"2_1":"2_2");var t=$(this).siblings("input").val();jfgrid.conditionformat.singleRangeDialog(e,t),jfgrid.selectionCopyShow(jfgrid.conditionformat.getRangeByTxt(t))}),$(document).on("click","#jfgrid-singleRange-dialog-confirm",function(){$("#jfgrid-modal-dialog-mask").show(),$(this).parents("#jfgrid-singleRange-dialog").hide();var e=$(this).attr("data-source"),r=$(this).parents("#jfgrid-singleRange-dialog").find("input").val();"0_1"==e?($("#jfgrid-conditionformat-dialog").show(),$("#jfgrid-conditionformat-dialog #conditionVal").val(r)):"0_2"==e?($("#jfgrid-conditionformat-dialog").show(),$("#jfgrid-conditionformat-dialog #conditionVal2").val(r)):"1_1"==e?($("#jfgrid-newConditionRule-dialog").show(),$("#jfgrid-newConditionRule-dialog #conditionVal input").val(r)):"1_2"==e?($("#jfgrid-newConditionRule-dialog").show(),$("#jfgrid-newConditionRule-dialog #conditionVal2 input").val(r)):"2_1"==e?($("#jfgrid-editorConditionRule-dialog").show(),$("#jfgrid-editorConditionRule-dialog #conditionVal input").val(r)):"2_2"==e&&($("#jfgrid-editorConditionRule-dialog").show(),$("#jfgrid-editorConditionRule-dialog #conditionVal2 input").val(r));jfgrid.selectionCopyShow([])}),$(document).on("click","#jfgrid-singleRange-dialog-close",function(){$("#jfgrid-modal-dialog-mask").show(),$(this).parents("#jfgrid-singleRange-dialog").hide();var e=$(this).attr("data-source");"0_1"==e||"0_2"==e?$("#jfgrid-conditionformat-dialog").show():"1_1"==e||"1_2"==e?$("#jfgrid-newConditionRule-dialog").show():"2_1"!=e&&"2_2"!=e||$("#jfgrid-editorConditionRule-dialog").show();jfgrid.selectionCopyShow([])}),$(document).on("click",".jfgrid-modal-dialog-title-close",function(){var e,r,t=$(this).parents(".jfgrid-modal-dialog").attr("id");"jfgrid-newConditionRule-dialog"==t&&1==(e=$("#"+t).find("#jfgrid-newConditionRule-dialog-close").attr("data-source"))&&$("#jfgrid-administerRule-dialog").show(),"jfgrid-editorConditionRule-dialog"==t&&$("#jfgrid-administerRule-dialog").show(),"jfgrid-singleRange-dialog"==t&&($("#jfgrid-modal-dialog-mask").show(),"0_1"==(e=$(this).parents("#jfgrid-singleRange-dialog").find("#jfgrid-singleRange-dialog-confirm").attr("data-source"))||"0_2"==e?$("#jfgrid-conditionformat-dialog").show():"1_1"==e||"1_2"==e?$("#jfgrid-newConditionRule-dialog").show():"2_1"!=e&&"2_2"!=e||$("#jfgrid-editorConditionRule-dialog").show(),r=[],jfgrid.selectionCopyShow(r)),"jfgrid-multiRange-dialog"==t&&($("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-administerRule-dialog").show(),r=[],jfgrid.selectionCopyShow(r)),"jfgrid-conditionformat-info-dialog"==t&&$("#jfgrid-modal-dialog-mask").show()}),$(document).on("click","#jfgrid-conditionformat-info-dialog-close",function(){$(this).parents("#jfgrid-conditionformat-info-dialog").hide()})},singleRangeDialog:function(e,r){$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-singleRange-dialog").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-singleRange-dialog",addclass:"jfgrid-singleRange-dialog",title:"选择单元格",content:'<input readonly="readonly" placeholder="请选择单元格" value="'+r+'"/>',botton:'<button id="jfgrid-singleRange-dialog-confirm" class="btn btn-primary" data-source="'+e+'">确定</button><button id="jfgrid-singleRange-dialog-close" class="btn btn-default" data-source="'+e+'">取消</button>',style:"z-index:100003"}));var t=$("#jfgrid-singleRange-dialog").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),i=t.outerHeight(),a=t.outerWidth(),n=$(window).width(),o=$(window).height(),l=$(document).scrollLeft(),d=$(document).scrollTop();$("#jfgrid-singleRange-dialog").css({left:(n+l-a)/2,top:(o+d-i)/3}).show()},multiRangeDialog:function(e,r){$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-multiRange-dialog").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-multiRange-dialog",addclass:"jfgrid-multiRange-dialog",title:"选择应用范围",content:'<input readonly="readonly" placeholder="请选择应用范围" value="'+r+'"/>',botton:'<button id="jfgrid-multiRange-dialog-confirm" class="btn btn-primary" data-item="'+e+'">确定</button><button id="jfgrid-multiRange-dialog-close" class="btn btn-default">取消</button>',style:"z-index:100003"}));var t=$("#jfgrid-multiRange-dialog").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),i=t.outerHeight(),a=t.outerWidth(),n=$(window).width(),o=$(window).height(),l=$(document).scrollLeft(),d=$(document).scrollTop();$("#jfgrid-multiRange-dialog").css({left:(n+l-a)/2,top:(o+d-i)/3}).show(),jfgrid.selectionCopyShow(jfgrid.conditionformat.getRangeByTxt(r))},getTxtByRange:function(e){if(0<e.length){for(var r=[],t=0;t<e.length;t++){var i=e[t].row[0],a=e[t].row[1],n=e[t].column[0],o=e[t].column[1];r.push(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:[i,a],column:[n,o]},jfgrid.currentSheetIndex))}return r.join(",")}},getRangeByTxt:function(e){var r=[];if(-1!=e.indexOf(","))for(var t=e.split(","),i=0;i<t.length;i++){if(!jfgrid.formula.iscelldata(t[i])){r=[];break}r.push(jfgrid.formula.getcellrange(t[i]))}else jfgrid.formula.iscelldata(e)&&r.push(jfgrid.formula.getcellrange(e));return r},colorSelectInit:function(){$(".jfgrid-conditionformat-config-color").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.textcolor"+jfgrid.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(e){null!=e&&(e=e.toHexString())}})},conditionformatDialog:function(e,r){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-conditionformat-dialog").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-conditionformat-dialog",addclass:"jfgrid-conditionformat-dialog",title:e,content:r,botton:'<button id="jfgrid-conditionformat-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default jfgrid-model-close-btn">取消</button>',style:"z-index:100003"}));var t=$("#jfgrid-conditionformat-dialog").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),i=t.outerHeight(),a=t.outerWidth(),n=$(window).width(),o=$(window).height(),l=$(document).scrollLeft(),d=$(document).scrollTop();$("#jfgrid-conditionformat-dialog").css({left:(n+l-a)/2,top:(o+d-i)/3}).show(),jfgrid.conditionformat.init(),jfgrid.conditionformat.colorSelectInit(),"条件格式——发生日期"==e&&jfgrid.conditionformat.daterangeInit("jfgrid-conditionformat-dialog")},CFiconsDialog:function(){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-CFicons-dialog").remove();$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-CFicons-dialog",addclass:"jfgrid-CFicons-dialog",title:"图标集",content:'<div class="box"><div style="margin-bottom: 10px;">请点击选择一组图标：</div><div class="title">方向</div><div class="list"><div class="left"><div class="item" data-len="3" data-leftMin="0" data-top="0" title="三向箭头(彩色)"><div style="background-position:0 0;"></div></div><div class="item" data-len="3" data-leftMin="0" data-top="1" title="3个三角形"><div style="background-position:0 -20px;"></div></div><div class="item" data-len="4" data-leftMin="0" data-top="2" title="四向箭头(彩色)"><div style="background-position:0 -40px;"></div></div><div class="item" data-len="5" data-leftMin="0" data-top="3" title="五向箭头(彩色)"><div style="background-position:0 -60px;"></div></div></div><div class="right"><div class="item" data-len="3" data-leftMin="5" data-top="0" title="三向箭头(灰色)"><div style="background-position:-131px 0;"></div></div><div class="item" data-len="4" data-leftMin="5" data-top="1" title="四向箭头(灰色)"><div style="background-position:-131px -20px;"></div></div><div class="item" data-len="5" data-leftMin="5" data-top="2" title="五向箭头(灰色)"><div style="background-position:-131px -40px;"></div></div></div><div style="clear:both;"></div></div><div class="title">形状</div><div class="list"><div class="left"><div class="item" data-len="3" data-leftMin="0" data-top="4" title="三色交通灯(无边框)"><div style="background-position:0 -80px;"></div></div><div class="item" data-len="3" data-leftMin="0" data-top="5" title="三标志"><div style="background-position:0 -100px;"></div></div><div class="item" data-len="4" data-leftMin="0" data-top="6" title="绿-红-黑渐变"><div style="background-position:0 -120px;"></div></div></div><div class="right"><div class="item" data-len="3" data-leftMin="5" data-top="4" title="三色交通灯(有边框)"><div style="background-position:-131px -80px;"></div></div><div class="item" data-len="4" data-leftMin="5" data-top="5" title="四色交通灯"><div style="background-position:-131px -100px;"></div></div></div><div style="clear:both;"></div></div><div class="title">标记</div><div class="list"><div class="left"><div class="item" data-len="3" data-leftMin="0" data-top="7" title="三个符号(有圆圈)"><div style="background-position:0 -140px;"></div></div><div class="item" data-len="3" data-leftMin="0" data-top="8" title="三色旗"><div style="background-position:0 -160px;"></div></div></div><div class="right"><div class="item" data-len="3" data-leftMin="5" data-top="7" title="三个符号(无圆圈)"><div style="background-position:-131px -140px;"></div></div></div><div style="clear:both;"></div></div><div class="title">等级</div><div class="list"><div class="left"><div class="item" data-len="3" data-leftMin="0" data-top="9" title="3个星形"><div style="background-position:0 -180px;"></div></div><div class="item" data-len="5" data-leftMin="0" data-top="10" title="五象限图"><div style="background-position:0 -200px;"></div></div><div class="item" data-len="5" data-leftMin="0" data-top="11" title="5个框"><div style="background-position:0 -220px;"></div></div></div><div class="right"><div class="item" data-len="4" data-leftMin="5" data-top="9" title="四等级"><div style="background-position:-131px -180px;"></div></div><div class="item" data-len="5" data-leftMin="5" data-top="10" title="五等级"><div style="background-position:-131px -200px;"></div></div></div><div style="clear:both;"></div></div></div>',botton:'<button class="btn btn-default jfgrid-model-close-btn">关闭</button>',style:"z-index:100003"}));var e=$("#jfgrid-CFicons-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),r=e.outerHeight(),t=e.outerWidth(),i=$(window).width(),a=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#jfgrid-CFicons-dialog").css({left:(i+n-t)/2,top:(a+o-r)/3}).show()},administerRuleDialog:function(){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-administerRule-dialog").remove();for(var e="",r=0;r<jfgridfile.length;r++)"1"==jfgridfile[r].status?e+='<option value="'+jfgridfile[r].index+'" selected="selected">当前工作表：'+jfgridfile[r].name+"</option>":e+='<option value="'+jfgridfile[r].index+'">表：'+jfgridfile[r].name+"</option>";var t='<div class="chooseSheet"><label>显示其格式规则：</label><select>'+e+'</select></div><div class="ruleBox"><div class="ruleBtn"><button id="newConditionRule" class="btn btn-default">新建规则</button><button id="editorConditionRule" class="btn btn-default">编辑规则</button><button id="deleteConditionRule" class="btn btn-default">删除规则</button></div><div class="ruleList"><div class="listTitle"><span>规则</span><span>格式</span><span>应用范围</span></div><div class="listBox"></div></div></div>';$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-administerRule-dialog",addclass:"jfgrid-administerRule-dialog",title:"条件格式规则管理器",content:t,botton:'<button id="jfgrid-administerRule-dialog-confirm" class="btn btn-primary">确定</button><button id="jfgrid-administerRule-dialog-close" class="btn btn-default">关闭</button>',style:"z-index:100003"}));var i=$("#jfgrid-administerRule-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),a=i.outerHeight(),n=i.outerWidth(),o=$(window).width(),l=$(window).height(),d=$(document).scrollLeft(),f=$(document).scrollTop();$("#jfgrid-administerRule-dialog").css({left:(o+d-n)/2,top:(l+f-a)/3}).show();var s=$("#jfgrid-administerRule-dialog .chooseSheet option:selected").val();jfgrid.conditionformat.getConditionRuleList(s)},getConditionRuleList:function(e){$("#jfgrid-administerRule-dialog .ruleList .listBox").empty();var g=jfgrid.conditionformat.fileClone[jfgrid.sheetmanage.getSheetIndex(e)].jfgrid_conditionformat_save;if(null!=g&&0<g.length){for(var r=0;r<g.length;r++){var t,i=g[r].type,a=g[r].format,n=g[r].cellrange,o="";"dataBar"==i?(t="数据条",o='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):"colorGradation"==i?(t="色阶",o='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):"icons"==i?(t="图标集",o='<canvas width="46" height="18" style="width: 46px;height: 18px;margin: 3px 0 0 5px;"></canvas>'):(t=jfgrid.conditionformat.getConditionRuleName(g[r].conditionName,g[r].conditionRange,g[r].conditionValue),null!=a.textColor&&(o+='<span class="colorbox" title="文本颜色" style="background-color:'+a.textColor+'"></span>'),null!=a.cellColor&&(o+='<span class="colorbox" title="单元格颜色" style="background-color:'+a.cellColor+'"></span>'));for(var l=[],d=0;d<n.length;d++){var f=n[d].row[0],s=n[d].row[1],c=n[d].column[0],u=n[d].column[1];l.push(jfgrid.jfgridchatatABC(c)+(f+1)+":"+jfgrid.jfgridchatatABC(u)+(s+1))}var m='<div class="item" data-item="'+r+'"><div class="ruleName" title="'+t+'">'+t+'</div><div class="format">'+o+'</div><div class="ruleRange"><input class="formulaInputFocus" readonly="true" value="'+l.join(",")+'"/><i class="fa fa-table" aria-hidden="true" title="点击选择应用范围"></i></div></div>';$("#jfgrid-administerRule-dialog .ruleList .listBox").prepend(m)}$("#jfgrid-administerRule-dialog .ruleList .listBox .item canvas").each(function(e){var r,t,i,a,n,o,l=$(this).closest(".item").attr("data-item"),d=g[l].type,f=g[l].format,s=$(this).get(0).getContext("2d");"dataBar"==d?2==f.length?((r=s.createLinearGradient(0,0,46,0)).addColorStop(0,f[0]),r.addColorStop(1,f[1]),s.fillStyle=r,s.fillRect(0,0,46,18),s.beginPath(),s.moveTo(0,0),s.lineTo(0,18),s.lineTo(46,18),s.lineTo(46,0),s.lineTo(0,0),s.lineWidth=devicePixelRatio,s.strokeStyle=f[0],s.stroke(),s.closePath()):1==f.length&&(s.fillStyle=f[0],s.fillRect(0,0,46,18),s.beginPath(),s.moveTo(0,0),s.lineTo(0,18),s.lineTo(46,18),s.lineTo(46,0),s.lineTo(0,0),s.lineWidth=devicePixelRatio,s.strokeStyle=f[0],s.stroke(),s.closePath()):"colorGradation"==d?(r=s.createLinearGradient(0,0,46,0),3==f.length?(r.addColorStop(0,f[0]),r.addColorStop(.5,f[1]),r.addColorStop(1,f[2])):2==f.length&&(r.addColorStop(0,f[0]),r.addColorStop(1,f[1])),s.fillStyle=r,s.fillRect(0,0,46,18)):"icons"==d&&(t=f.len,i=f.leftMin,a=f.top,o=1472/(n=32*t+10*(t-1)),"0"==i?s.drawImage(jfgrid_CFiconsImg,0,32*a,n,32,0,(18-o)/2,46,o):"5"==i&&s.drawImage(jfgrid_CFiconsImg,210,32*a,n,32,0,(18-o)/2,46,o))}),$("#jfgrid-administerRule-dialog .ruleList .listBox .item").eq(0).addClass("on")}},getConditionRuleName:function(e,r,t){var i;if(i=null!=r[0]?jfgrid.jfgridchatatABC(r[0].column[0])+(r[0].row[0]+1):t[0],"greaterThan"==e)return"单元格值 > "+i;if("lessThan"==e)return"单元格值 < "+i;if("betweenness"==e)return"单元格值介于 "+i+" 和 "+(null!=r[1]?jfgrid.jfgridchatatABC(r[1].column[0])+(r[1].row[0]+1):t[1])+" 之间";if("equal"==e)return"单元格值 = "+i;if("textContains"==e)return"单元格值包含 ="+i;if("occurrenceDate"==e)return t;if("duplicateValue"==e){if("0"==t)return"重复值";if("1"==t)return"唯一值"}else{if("top10"==e)return"前 "+i+" 个";if("top10%"==e)return"前 "+i+"% 个";if("last10"==e)return"后 "+i+" 个";if("last10%"==e)return"后 "+i+"% 个";if("AboveAverage"==e)return"高于平均值";if("SubAverage"==e)return"低于平均值"}},newConditionRuleDialog:function(e){var r=jfgrid.conditionformat.getRuleExplain(0);$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-administerRule-dialog").hide(),$("#jfgrid-newConditionRule-dialog").remove();var t='<div><div class="boxTitle">选择规则类型：</div>'+jfgrid.conditionformat.ruleTypeHtml+'<div class="boxTitle">编辑规则说明：</div><div class="ruleExplainBox">'+r+"</div></div>";$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-newConditionRule-dialog",addclass:"jfgrid-newEditorRule-dialog",title:"新建格式规则",content:t,botton:'<button id="jfgrid-newConditionRule-dialog-confirm" class="btn btn-primary" data-source="'+e+'">确定</button><button id="jfgrid-newConditionRule-dialog-close" class="btn btn-default" data-source="'+e+'">取消</button>',style:"z-index:100003"}));var i=$("#jfgrid-newConditionRule-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),a=i.outerHeight(),n=i.outerWidth(),o=$(window).width(),l=$(window).height(),d=$(document).scrollLeft(),f=$(document).scrollTop();$("#jfgrid-newConditionRule-dialog").css({left:(o+d-n)/2,top:(l+f-a)/3}).show(),$("#jfgrid-newConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq(0)").addClass("on").siblings().removeClass("on"),jfgrid.conditionformat.colorSelectInit()},editorConditionRuleDialog:function(){var e,r,t,i=jfgrid.conditionformat.editorRule.data,a=i.type,n=i.format;"dataBar"==a||"colorGradation"==a||"icons"==a?(e=0,r=a):"greaterThan"==(t=i.conditionName)||"lessThan"==t||"betweenness"==t||"equal"==t||"textContains"==t||"occurrenceDate"==t?(e=1,"greaterThan"==t||"lessThan"==t||"betweenness"==t||"equal"==t?r="number":"textContains"==t?r="text":"occurrenceDate"==t&&(r="date")):"top10"==t||"top10%"==t||"last10"==t||"last10%"==t?(e=2,"top10"==t||"top10%"==t?r="top":"last10"!=t&&"last10%"!=t||(r="last")):"AboveAverage"==t||"SubAverage"==t?(e=3,r=t):"duplicateValue"==t&&(e=4,r=i.conditionValue);var o=jfgrid.conditionformat.getRuleExplain(e);$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-administerRule-dialog").hide(),$("#jfgrid-editorConditionRule-dialog").remove();var l='<div><div class="boxTitle">选择规则类型：</div>'+jfgrid.conditionformat.ruleTypeHtml+'<div class="boxTitle">编辑规则说明：</div><div class="ruleExplainBox">'+o+"</div></div>";$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-editorConditionRule-dialog",addclass:"jfgrid-newEditorRule-dialog",title:"编辑格式规则",content:l,botton:'<button id="jfgrid-editorConditionRule-dialog-confirm" class="btn btn-primary">确定</button><button id="jfgrid-editorConditionRule-dialog-close" class="btn btn-default">取消</button>',style:"z-index:100003"}));var d,f,s,g,c,u=$("#jfgrid-editorConditionRule-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),m=u.outerHeight(),h=u.outerWidth(),j=$(window).width(),p=$(window).height(),v=$(document).scrollLeft(),b=$(document).scrollTop();$("#jfgrid-editorConditionRule-dialog").css({left:(j+v-h)/2,top:(p+b-m)/3}).show(),jfgrid.conditionformat.colorSelectInit(),$("#jfgrid-editorConditionRule-dialog .ruleTypeBox .ruleTypeItem:eq("+e+")").addClass("on").siblings().removeClass("on"),$("#jfgrid-editorConditionRule-dialog #type1").val(r),"dataBar"!=r&&"colorGradation"!=r&&"icons"!=r&&"number"!=r&&"text"!=r&&"date"!=r||($("#jfgrid-editorConditionRule-dialog ."+r+"Box").show(),$("#jfgrid-editorConditionRule-dialog ."+r+"Box").siblings().hide()),"date"==r&&jfgrid.conditionformat.daterangeInit("jfgrid-editorConditionRule-dialog"),"dataBar"==a||"colorGradation"==a||"icons"==a?"dataBar"==r?(2==n.length?$("#jfgrid-editorConditionRule-dialog .dataBarBox #type2").val("gradient"):1==n.length&&$("#jfgrid-editorConditionRule-dialog .dataBarBox #type2").val("solid"),$("#jfgrid-editorConditionRule-dialog .dataBarBox .jfgrid-conditionformat-config-color").spectrum("set",n[0])):"colorGradation"==r?3==n.length?($("#jfgrid-editorConditionRule-dialog .colorGradationBox #type2").val("threeColor"),$("#jfgrid-editorConditionRule-dialog .colorGradationBox .midVal").show(),$("#jfgrid-editorConditionRule-dialog .colorGradationBox .maxVal .jfgrid-conditionformat-config-color").spectrum("set",n[0]),$("#jfgrid-editorConditionRule-dialog .colorGradationBox .midVal .jfgrid-conditionformat-config-color").spectrum("set",n[1]),$("#jfgrid-editorConditionRule-dialog .colorGradationBox .minVal .jfgrid-conditionformat-config-color").spectrum("set",n[2])):2==n.length&&($("#jfgrid-editorConditionRule-dialog .colorGradationBox #type2").val("twoColor"),$("#jfgrid-editorConditionRule-dialog .colorGradationBox .midVal").hide(),$("#jfgrid-editorConditionRule-dialog .colorGradationBox .maxVal .jfgrid-conditionformat-config-color").spectrum("set",n[0]),$("#jfgrid-editorConditionRule-dialog .colorGradationBox .minVal .jfgrid-conditionformat-config-color").spectrum("set",n[1])):"icons"==r&&(d=n.len,f=n.leftMin,s=n.top,$("#jfgrid-editorConditionRule-dialog .iconsBox li").each(function(e,r){if($(r).find("div").attr("data-len")==d&&$(r).find("div").attr("data-leftmin")==f&&$(r).find("div").attr("data-top")==s)return $("#jfgrid-editorConditionRule-dialog .iconsBox .showbox .model").css("background-position",$(r).find("div").css("background-position")),$("#jfgrid-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-len",$(r).find("div").attr("data-len")),$("#jfgrid-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-leftmin",$(r).find("div").attr("data-leftmin")),$("#jfgrid-editorConditionRule-dialog .iconsBox .showbox .model").attr("data-top",$(r).find("div").attr("data-leftmin")),$("#jfgrid-editorConditionRule-dialog .iconsBox .showbox .model").attr("title",$(r).find("div").attr("title")),!0})):"number"==r?($("#jfgrid-editorConditionRule-dialog .numberBox #type2").val(t),c=null!=i.conditionRange[0]?jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:i.conditionRange[0].row,column:i.conditionRange[0].column},jfgrid.currentSheetIndex):i.conditionValue[0],$("#jfgrid-editorConditionRule-dialog .numberBox #conditionVal input").val(c),"betweenness"==t?($("#jfgrid-editorConditionRule-dialog .numberBox .txt").show(),$("#jfgrid-editorConditionRule-dialog .numberBox #conditionVal2").show(),g=null!=i.conditionRange[1]?jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:i.conditionRange[1].row,column:i.conditionRange[1].column},jfgrid.currentSheetIndex):i.conditionValue[1],$("#jfgrid-editorConditionRule-dialog .numberBox #conditionVal2 input").val(g)):($("#jfgrid-editorConditionRule-dialog .numberBox .txt").hide(),$("#jfgrid-editorConditionRule-dialog .numberBox #conditionVal2").hide())):"text"==r?(c=null!=i.conditionRange[0]?jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:i.conditionRange[0].row,column:i.conditionRange[0].column},jfgrid.currentSheetIndex):i.conditionValue[0],$("#jfgrid-editorConditionRule-dialog .textBox #conditionVal input").val(c)):"date"==r?(jfgrid.conditionformat.daterangeInit("jfgrid-editorConditionRule-dialog"),c=i.conditionValue[0],$("#jfgrid-editorConditionRule-dialog .dateBox #daterange-btn").val(c)):"top"!=r&&"last"!=r||(c=i.conditionValue[0],"top10%"!=t&&"last10%"!=t||$("#jfgrid-editorConditionRule-dialog #isPercent").attr("checked","checked"))},infoDialog:function(e,r){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-conditionformat-info-dialog").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-conditionformat-info-dialog",addclass:"",title:e,content:r,botton:'<button id="jfgrid-conditionformat-info-dialog-close" class="btn btn-default">&nbsp;&nbsp;关闭&nbsp;&nbsp;</button>',style:"z-index:100003"}));var t=$("#jfgrid-conditionformat-info-dialog").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),i=t.outerHeight(),a=t.outerWidth(),n=$(window).width(),o=$(window).height(),l=$(document).scrollLeft(),d=$(document).scrollTop();$("#jfgrid-conditionformat-info-dialog").css({left:(n+l-a)/2,top:(o+d-i)/3}).show()},getRuleExplain:function(e){var r=jfgrid.conditionformat.textCellColorHtml;switch(e){case 0:var t='<div class="title">基于各自值设置所有单元格的格式：</div><div style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">格式样式：</label><select id="type1"><option value="dataBar">数据条</option><option value="colorGradation">色阶</option><option value="icons">图标集</option></select></div><div><div class="type1Box dataBarBox"><div style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">填充类型：</label><select id="type2"><option value="gradient">渐变</option><option value="solid">实心</option></select></div><div style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">颜色：</label><input data-tips="数据条颜色" data-func="background" class="jfgrid-conditionformat-config-color" type="text" value="#638ec6" style="display: none;"></div></div><div class="type1Box colorGradationBox" style="display: none;"><div style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">填充类型：</label><select id="type2"><option value="threeColor">三色</option><option value="twoColor">双色</option></select></div><div class="maxVal" style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">最大值：</label><input data-tips="最大值颜色" data-func="background" class="jfgrid-conditionformat-config-color" type="text" value="rgb(99, 190, 123)" style="display: none;"></div><div class="midVal" style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">中间值：</label><input data-tips="中间值颜色" data-func="background" class="jfgrid-conditionformat-config-color" type="text" value="rgb(255, 235, 132)" style="display: none;"></div><div class="minVal" style="height: 30px;margin-bottom: 5px;"><label style="display: block;width: 80px;height: 30px;line-height: 30px;float: left;">最小值：</label><input data-tips="最小值颜色" data-func="background" class="jfgrid-conditionformat-config-color" type="text" value="rgb(248, 105, 107)" style="display: none;"></div></div><div class="type1Box iconsBox" style="display: none;"><label>填充类型：</label><div class="showbox"><div class="model" data-len="3" data-leftmin="0" data-top="0" title="三向箭头(彩色)" style="background-position: 0 0;"></div><span class="ui-selectmenu-icon ui-icon ui-icon-triangle-1-s" style="margin-top: 2px;"></span></div><ul><li><div data-len="3" data-leftmin="0" data-top="0" title="三向箭头(彩色)" style="background-position: 0 0;"></div></li><li><div data-len="3" data-leftmin="5" data-top="0" title="三向箭头(灰色)" style="background-position: -131px 0;"></div></li><li><div data-len="3" data-leftmin="0" data-top="1" title="3个三角形" style="background-position: 0 -20px;"></div></li><li><div data-len="4" data-leftmin="0" data-top="2" title="四向箭头(彩色)" style="background-position: 0 -40px;"></div></li><li><div data-len="4" data-leftmin="5" data-top="1" title="四向箭头(灰色)" style="background-position: -131px -20px;"></div></li><li><div data-len="5" data-leftmin="0" data-top="3" title="五向箭头(彩色)" style="background-position: 0 -60px;"></div></li><li><div data-len="5" data-leftmin="5" data-top="2" title="五向箭头(灰色)" style="background-position: -131px -40px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="4" title="三色交通灯(无边框)" style="background-position: 0 -80px;"></div></li><li><div data-len="3" data-leftmin="5" data-top="4" title="三色交通灯(有边框)" style="background-position: -131px -80px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="5" title="三标志" style="background-position: 0 -100px;"></div></li><li><div data-len="4" data-leftmin="5" data-top="5" title="四色交通灯" style="background-position: -131px -100px;"></div></li><li><div data-len="4" data-leftmin="0" data-top="6" title="绿-红-黑渐变" style="background-position: 0 -120px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="7" title="三个符号(有圆圈)" style="background-position: 0 -140px;"></div></li><li><div data-len="3" data-leftmin="5" data-top="7" title="三个符号(无圆圈)" style="background-position: -131px -140px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="8" title="三色旗" style="background-position: 0 -160px;"></div></li><li><div data-len="3" data-leftmin="0" data-top="9" title="3个星形" style="background-position: 0 -180px;"></div></li><li><div data-len="5" data-leftmin="0" data-top="10" title="五象限图" style="background-position: 0 -200px;"></div></li><li><div data-len="5" data-leftmin="0" data-top="11" title="5个框" style="background-position: 0 -220px;"></div></li><li><div data-len="4" data-leftmin="5" data-top="9" title="四等级" style="background-position: -131px -180px;"></div></li><li><div data-len="5" data-leftmin="5" data-top="10" title="五等级" style="background-position: -131px -200px;"></div></li></ul></div></div>';break;case 1:t='<div class="title">只为满足以下条件的单元格：</div><div style="height: 30px;margin-bottom: 10px;"><select id="type1"><option value="number">单元格值</option><option value="text">特定文本</option><option value="date">发生日期</option></select><div><div class="type1Box numberBox"><select id="type2"><option value="greaterThan">大于</option><option value="lessThan">小于</option><option value="betweenness">介于</option><option value="equal">等于</option></select><div class="inpbox range" id="conditionVal"><input class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><span class="txt" style="display: none;">到</span><div class="inpbox range" id="conditionVal2" style="display: none;"><input class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择数据范围"></i></div></div><div class="type1Box textBox" style="display: none;"><select id="type2"><option value="">包含</option></select><div class="inpbox range" id="conditionVal"><input class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div></div><div class="type1Box dateBox" style="display: none;"><div style="width: 162px;" class="inpbox"><input style="width: 150px;" id="daterange-btn" readonly="readonly" placeholder="请选择日期"/></div></div></div></div><div class="title">设置格式：</div>'+r;break;case 2:t='<div class="title">为以下排名内的值：</div><div style="height: 30px;margin-bottom: 10px;"><select id="type1"><option value="top">前</option><option value="last">后</option></select><div class="inpbox" id="conditionVal"><input class="formulaInputFocus" type="number" value="10"/></div><input id="isPercent" type="checkbox"/><label for="isPercent" class="txt">所选范围的百分比</label></div><div class="title">设置格式：</div>'+r;break;case 3:t='<div class="title">为满足以下条件的值：</div><div style="height: 30px;margin-bottom: 10px;"><select id="type1"><option value="AboveAverage">高于</option><option value="SubAverage">低于</option></select><span class="txt">选定范围的平均值</span></div><div class="title">设置格式：</div>'+r;break;case 4:t='<div class="title">全部：</div><div style="height: 30px;margin-bottom: 10px;"><select id="type1"><option value="0">重复</option><option value="1">唯一</option></select><span class="txt">选定范围中的数值</span></div><div class="title">设置格式：</div>'+r}return t},daterangeInit:function(e){$(".ranges_1 ul").remove(),$("#"+e).find("#daterange-btn").daterangepicker({ranges:{"昨天":[moment().subtract(1,"days"),moment().subtract(1,"days")],"今天":[moment(),moment()],"上周":[moment(moment().subtract(1,"week")).subtract((new Date).getDay()-1,"days"),moment().subtract((new Date).getDay(),"days")],"本周":[moment().subtract((new Date).getDay()-1,"days"),moment().add(7-(new Date).getDay(),"days")],"上月":[moment(moment().format("YYYY-MM")).subtract(1,"month"),moment(moment().format("YYYY-MM")).subtract(1,"day")],"本月":[moment().format("YYYY-MM"),moment(moment(moment().format("YYYY-MM")).add(1,"month")).subtract(1,"day")],"去年":[moment(moment(moment().format("YYYY"))).subtract(1,"years").format("YYYY"),moment(moment().format("YYYY")).subtract(1,"day")],"本年":[moment().format("YYYY"),moment(moment(moment().add(1,"years")).format("YYYY")).subtract(1,"day")],"最近7天":[moment().subtract(6,"days"),moment()],"最近30天":[moment().subtract(29,"days"),moment()]},startDate:moment(),endDate:moment()},function(e,r,t){"全部"==t?$("#daterange-btn").val(""):"昨天"==t||"今天"==t?$("#daterange-btn").val(e.format("YYYY/MM/DD")):"上周"!=t&&"本周"!=t&&"上月"!=t&&"本月"!=t&&"去年"!=t&&"本年"!=t&&"最近7天"!=t&&"最近30天"!=t||$("#daterange-btn").val(e.format("YYYY/MM/DD")+"-"+r.format("YYYY/MM/DD"))})},CFSplitRange:function(e,r,t,i){var a=[],n=t.row[0]-r.row[0],o=t.column[0]-r.column[0],l=e.row[0],d=e.row[1],f=e.column[0],s=e.column[1];return l>=r.row[0]&&d<=r.row[1]&&f>=r.column[0]&&s<=r.column[1]?"allPart"==i?a=[{row:[l+n,d+n],column:[f+o,s+o]}]:"restPart"==i?a=[]:"operatePart"==i&&(a=[{row:[l+n,d+n],column:[f+o,s+o]}]):l>=r.row[0]&&l<=r.row[1]&&f>=r.column[0]&&s<=r.column[1]?"allPart"==i?a=[{row:[r.row[1]+1,d],column:[f,s]},{row:[l+n,r.row[1]+n],column:[f+o,s+o]}]:"restPart"==i?a=[{row:[r.row[1]+1,d],column:[f,s]}]:"operatePart"==i&&(a=[{row:[l+n,r.row[1]+n],column:[f+o,s+o]}]):d>=r.row[0]&&d<=r.row[1]&&f>=r.column[0]&&s<=r.column[1]?"allPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0]+n,d+n],column:[f+o,s+o]}]:"restPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]}]:"operatePart"==i&&(a=[{row:[r.row[0]+n,d+n],column:[f+o,s+o]}]):l<r.row[0]&&d>r.row[1]&&f>=r.column[0]&&s<=r.column[1]?"allPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[1]+1,d],column:[f,s]},{row:[r.row[0]+n,r.row[1]+n],column:[f+o,s+o]}]:"restPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[1]+1,d],column:[f,s]}]:"operatePart"==i&&(a=[{row:[r.row[0]+n,r.row[1]+n],column:[f+o,s+o]}]):f>=r.column[0]&&f<=r.column[1]&&l>=r.row[0]&&d<=r.row[1]?"allPart"==i?a=[{row:[l,d],column:[r.column[1]+1,s]},{row:[l+n,d+n],column:[f+o,r.column[1]+o]}]:"restPart"==i?a=[{row:[l,d],column:[r.column[1]+1,s]}]:"operatePart"==i&&(a=[{row:[l+n,d+n],column:[f+o,r.column[1]+o]}]):s>=r.column[0]&&s<=r.column[1]&&l>=r.row[0]&&d<=r.row[1]?"allPart"==i?a=[{row:[l,d],column:[f,r.column[0]-1]},{row:[l+n,d+n],column:[r.column[0]+o,s+o]}]:"restPart"==i?a=[{row:[l,d],column:[f,r.column[0]-1]}]:"operatePart"==i&&(a=[{row:[l+n,d+n],column:[r.column[0]+o,s+o]}]):f<r.column[0]&&s>r.column[1]&&l>=r.row[0]&&d<=r.row[1]?"allPart"==i?a=[{row:[l,d],column:[f,r.column[0]-1]},{row:[l,d],column:[r.column[1]+1,s]},{row:[l+n,d+n],column:[r.column[0]+o,r.column[1]+o]}]:"restPart"==i?a=[{row:[l,d],column:[f,r.column[0]-1]},{row:[l,d],column:[r.column[1]+1,s]}]:"operatePart"==i&&(a=[{row:[l+n,d+n],column:[r.column[0]+o,r.column[1]+o]}]):l>=r.row[0]&&l<=r.row[1]&&f>=r.column[0]&&f<=r.column[1]?"allPart"==i?a=[{row:[l,r.row[1]],column:[r.column[1]+1,s]},{row:[r.row[1]+1,d],column:[f,s]},{row:[l+n,r.row[1]+n],column:[f+o,r.column[1]+o]}]:"restPart"==i?a=[{row:[l,r.row[1]],column:[r.column[1]+1,s]},{row:[r.row[1]+1,d],column:[f,s]}]:"operatePart"==i&&(a=[{row:[l+n,r.row[1]+n],column:[f+o,r.column[1]+o]}]):l>=r.row[0]&&l<=r.row[1]&&s>=r.column[0]&&s<=r.column[1]?"allPart"==i?a=[{row:[l,r.row[1]],column:[f,r.column[0]-1]},{row:[r.row[1]+1,d],column:[f,s]},{row:[l+n,r.row[1]+n],column:[r.column[0]+o,s+o]}]:"restPart"==i?a=[{row:[l,r.row[1]],column:[f,r.column[0]-1]},{row:[r.row[1]+1,d],column:[f,s]}]:"operatePart"==i&&(a=[{row:[l+n,r.row[1]+n],column:[r.column[0]+o,s+o]}]):d>=r.row[0]&&d<=r.row[1]&&f>=r.column[0]&&f<=r.column[1]?"allPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],d],column:[r.column[1]+1,s]},{row:[r.row[0]+n,d+n],column:[f+o,r.column[1]+o]}]:"restPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],d],column:[r.column[1]+1,s]}]:"operatePart"==i&&(a=[{row:[r.row[0]+n,d+n],column:[f+o,r.column[1]+o]}]):d>=r.row[0]&&d<=r.row[1]&&s>=r.column[0]&&s<=r.column[1]?"allPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],d],column:[f,r.column[0]-1]},{row:[r.row[0]+n,d+n],column:[r.column[0]+o,s+o]}]:"restPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],d],column:[f,r.column[0]-1]}]:"operatePart"==i&&(a=[{row:[r.row[0]+n,d+n],column:[r.column[0]+o,s+o]}]):l<r.row[0]&&d>r.row[1]&&f>=r.column[0]&&f<=r.column[1]?"allPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],r.row[1]],column:[r.column[1]+1,s]},{row:[r.row[1]+1,d],column:[f,s]},{row:[r.row[0]+n,r.row[1]+n],column:[f+o,r.column[1]+o]}]:"restPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],r.row[1]],column:[r.column[1]+1,s]},{row:[r.row[1]+1,d],column:[f,s]}]:"operatePart"==i&&(a=[{row:[r.row[0]+n,r.row[1]+n],column:[f+o,r.column[1]+o]}]):l<r.row[0]&&d>r.row[1]&&s>=r.column[0]&&s<=r.column[1]?"allPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],r.row[1]],column:[f,r.column[0]-1]},{row:[r.row[1]+1,d],column:[f,s]},{row:[r.row[0]+n,r.row[1]+n],column:[r.column[0]+o,s+o]}]:"restPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],r.row[1]],column:[f,r.column[0]-1]},{row:[r.row[1]+1,d],column:[f,s]}]:"operatePart"==i&&(a=[{row:[r.row[0]+n,r.row[1]+n],column:[r.column[0]+o,s+o]}]):f<r.column[0]&&s>r.column[1]&&l>=r.row[0]&&l<=r.row[1]?"allPart"==i?a=[{row:[l,r.row[1]],column:[f,r.column[0]-1]},{row:[l,r.row[1]],column:[r.column[1]+1,s]},{row:[r.row[1]+1,d],column:[f,s]},{row:[l+n,r.row[1]+n],column:[r.column[0]+o,r.column[1]+o]}]:"restPart"==i?a=[{row:[l,r.row[1]],column:[f,r.column[0]-1]},{row:[l,r.row[1]],column:[r.column[1]+1,s]},{row:[r.row[1]+1,d],column:[f,s]}]:"operatePart"==i&&(a=[{row:[l+n,r.row[1]+n],column:[r.column[0]+o,r.column[1]+o]}]):f<r.column[0]&&s>r.column[1]&&d>=r.row[0]&&d<=r.row[1]?"allPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],d],column:[f,r.column[0]-1]},{row:[r.row[0],d],column:[r.column[1]+1,s]},{row:[r.row[0]+n,d+n],column:[r.column[0]+o,r.column[1]+o]}]:"restPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],d],column:[f,r.column[0]-1]},{row:[r.row[0],d],column:[r.column[1]+1,s]}]:"operatePart"==i&&(a=[{row:[r.row[0]+n,d+n],column:[r.column[0]+o,r.column[1]+o]}]):l<r.row[0]&&d>r.row[1]&&f<r.column[0]&&s>r.column[1]?"allPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],r.row[1]],column:[f,r.column[0]-1]},{row:[r.row[0],r.row[1]],column:[r.column[1]+1,s]},{row:[r.row[1]+1,d],column:[f,s]},{row:[r.row[0]+n,r.row[1]+n],column:[r.column[0]+o,r.column[1]+o]}]:"restPart"==i?a=[{row:[l,r.row[0]-1],column:[f,s]},{row:[r.row[0],r.row[1]],column:[f,r.column[0]-1]},{row:[r.row[0],r.row[1]],column:[r.column[1]+1,s]},{row:[r.row[1]+1,d],column:[f,s]}]:"operatePart"==i&&(a=[{row:[r.row[0]+n,r.row[1]+n],column:[r.column[0]+o,r.column[1]+o]}]):"allPart"==i||"restPart"==i?a=[{row:[l,d],column:[f,s]}]:"operatePart"==i&&(a=[]),a},getcolorGradation:function(e,r,t,i,a){var n=e.split(","),o=parseInt(n[0].split("(")[1]),l=parseInt(n[1]),d=parseInt(n[2].split(")")[0]),f=r.split(","),s=parseInt(f[0].split("(")[1]),g=parseInt(f[1]),c=parseInt(f[2].split(")")[0]);return"rgb("+Math.round(o-(o-s)/(t-i)*(t-a))+", "+Math.round(l-(l-g)/(t-i)*(t-a))+", "+Math.round(d-(d-c)/(t-i)*(t-a))+")"},getCFPartRange:function(e,r,t){var i=[],a=jfgridfile[jfgrid.sheetmanage.getSheetIndex(e)].jfgrid_conditionformat_save;if(null!=a&&0<a.length)e:for(var n=0;n<a.length;n++)for(var o=a[n].cellrange,l=0;l<o.length;l++)for(var d=o[l].row[0],f=o[l].row[1],s=o[l].column[0],g=o[l].column[1],c=0;c<range.length;c++)if(range[c].row[0]>=d&&range[c].row[0]<=f||range[c].row[1]>=d&&range[c].row[1]<=f||range[c].column[0]>=s&&range[c].column[0]<=g||range[c].column[1]>=s&&range[c].column[1]<=g){i.push(a[n]);continue e}return i},checksCF:function(e,r,t){return null!=t&&e+"_"+r in t?t[e+"_"+r]:null},getComputeMap:function(){var e=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),r=jfgridfile[e].jfgrid_conditionformat_save,t=jfgridfile[e].data;return null==t?null:jfgrid.conditionformat.compute(r,t)},compute:function(e,r){null==e&&(e=[]);var t={};if(0<e.length)for(var i=0;i<e.length;i++){var a=e[i].type,n=e[i].cellrange,o=e[i].format;if("dataBar"==a){for(var l=null,d=null,f=0;f<n.length;f++)for(var s=n[f].row[0];s<=n[f].row[1];s++)for(var g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&((null==l||parseInt(D.v)>l)&&(l=parseInt(D.v)),(null==d||parseInt(D.v)<d)&&(d=parseInt(D.v))))}if(null!=l&&null!=d)if(d<0)for(var c=Math.round(l/(l-d)*10)/10,u=Math.round(Math.abs(d)/(l-d)*10)/10,f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)<0&&(m=Math.round(Math.abs(parseInt(D.v))/Math.abs(d)*100)/100,s+"_"+g in t?t[s+"_"+g].dataBar={valueType:"minus",minusLen:u,valueLen:m,format:o}:t[s+"_"+g]={dataBar:{valueType:"minus",minusLen:u,valueLen:m,format:o}}),0<parseInt(D.v)&&(m=Math.round(parseInt(D.v)/l*100)/100,s+"_"+g in t?t[s+"_"+g].dataBar={valueType:"plus",plusLen:c,minusLen:u,valueLen:m,format:o}:t[s+"_"+g]={dataBar:{valueType:"plus",plusLen:c,minusLen:u,valueLen:m,format:o}})))}else for(c=1,f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(var m,g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(m=0==l?1:Math.round(parseInt(D.v)/l*100)/100,s+"_"+g in t?t[s+"_"+g].dataBar={valueType:"plus",plusLen:c,valueLen:m,format:o}:t[s+"_"+g]={dataBar:{valueType:"plus",plusLen:c,valueLen:m,format:o}}))}}else if("colorGradation"==a){for(var l=null,d=null,h=0,j=0,f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(j++,h+=parseInt(D.v),(null==l||parseInt(D.v)>l)&&(l=parseInt(D.v)),(null==d||parseInt(D.v)<d)&&(d=parseInt(D.v))))}if(null!=l&&null!=d)if(3==o.length)for(var p=Math.floor(h/j),f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)==d?s+"_"+g in t?t[s+"_"+g].cellColor=o[2]:t[s+"_"+g]={cellColor:o[2]}:parseInt(D.v)>d&&parseInt(D.v)<p?s+"_"+g in t?t[s+"_"+g].cellColor=jfgrid.conditionformat.getcolorGradation(o[2],o[1],d,p,parseInt(D.v)):t[s+"_"+g]={cellColor:jfgrid.conditionformat.getcolorGradation(o[2],o[1],d,p,parseInt(D.v))}:parseInt(D.v)==p?s+"_"+g in t?t[s+"_"+g].cellColor=o[1]:t[s+"_"+g]={cellColor:o[1]}:parseInt(D.v)>p&&parseInt(D.v)<l?s+"_"+g in t?t[s+"_"+g].cellColor=jfgrid.conditionformat.getcolorGradation(o[1],o[0],p,l,parseInt(D.v)):t[s+"_"+g]={cellColor:jfgrid.conditionformat.getcolorGradation(o[1],o[0],p,l,parseInt(D.v))}:parseInt(D.v)==l&&(s+"_"+g in t?t[s+"_"+g].cellColor=o[0]:t[s+"_"+g]={cellColor:o[0]})))}else if(2==o.length)for(f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)==d?s+"_"+g in t?t[s+"_"+g].cellColor=o[1]:t[s+"_"+g]={cellColor:o[1]}:parseInt(D.v)>d&&parseInt(D.v)<l?s+"_"+g in t?t[s+"_"+g].cellColor=jfgrid.conditionformat.getcolorGradation(o[1],o[0],d,l,parseInt(D.v)):t[s+"_"+g]={cellColor:jfgrid.conditionformat.getcolorGradation(o[1],o[0],d,l,parseInt(D.v))}:parseInt(D.v)==l&&(s+"_"+g in t?t[s+"_"+g].cellColor=o[0]:t[s+"_"+g]={cellColor:o[0]})))}}else if("icons"==a){for(var v=parseInt(o.len),b=parseInt(o.leftMin),_=parseInt(o.top),l=null,d=null,f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&((null==l||parseInt(D.v)>l)&&(l=parseInt(D.v)),(null==d||parseInt(D.v)<d)&&(d=parseInt(D.v))))}if(null!=l&&null!=d){var w,y,C,T,I,$=Math.floor((l-d+1)/v),R=(l-d+1)%v;if(3==v){C=2==R?(w=[d,d+$],y=[d+$+1,d+2*$],[d+2*$+1,l]):(w=[d,d+$-1],y=[d+$,d+2*$-1],[d+2*$,l]);for(f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)>=w[0]&&parseInt(D.v)<=w[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+2,top:_}:t[s+"_"+g]={icons:{left:b+2,top:_}}:parseInt(D.v)>=y[0]&&parseInt(D.v)<=y[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+1,top:_}:t[s+"_"+g]={icons:{left:b+1,top:_}}:parseInt(D.v)>=C[0]&&parseInt(D.v)<=C[1]&&(s+"_"+g in t?t[s+"_"+g].icons={left:b,top:_}:t[s+"_"+g]={icons:{left:b,top:_}})))}}else if(4==v){T=2==R?(w=[d,d+$],y=[d+$+1,d+2*$],C=[d+2*$+1,d+3*$],[d+3*$+1,l]):3==R?(w=[d,d+$],y=[d+$+1,d+2*$],C=[d+2*$+1,d+3*$+1],[d+3*$+2,l]):(w=[d,d+$-1],y=[d+$,d+2*$-1],C=[d+2*$,d+3*$-1],[d+3*$,l]);for(f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)>=w[0]&&parseInt(D.v)<=w[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+3,top:_}:t[s+"_"+g]={icons:{left:b+3,top:_}}:parseInt(D.v)>=y[0]&&parseInt(D.v)<=y[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+2,top:_}:t[s+"_"+g]={icons:{left:b+2,top:_}}:parseInt(D.v)>=C[0]&&parseInt(D.v)<=C[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+1,top:_}:t[s+"_"+g]={icons:{left:b+1,top:_}}:parseInt(D.v)>=T[0]&&parseInt(D.v)<=T[1]&&(s+"_"+g in t?t[s+"_"+g].icons={left:b,top:_}:t[s+"_"+g]={icons:{left:b,top:_}})))}}else if(5==v){I=2==R?(w=[d,d+$],y=[d+$+1,d+2*$],C=[d+2*$+1,d+3*$],T=[d+3*$+1,d+4*$],[d+4*$+1,l]):3==R?(w=[d,d+$],y=[d+$+1,d+2*$],C=[d+2*$+1,d+3*$+1],T=[d+3*$+2,d+4*$+1],[d+4*$+2,l]):4==R?(w=[d,d+$],y=[d+$+1,d+2*$+1],C=[d+2*$+2,d+3*$+1],T=[d+3*$+2,d+4*$+2],[d+4*$+3,l]):(w=[d,d+$-1],y=[d+$,d+2*$-1],C=[d+2*$,d+3*$-1],T=[d+3*$,d+4*$-1],[d+4*$,l]);for(f=0;f<n.length;f++)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"==jfgrid.getObjType(D)&&null!=D.ct&&"n"==D.ct.t&&null!=D.v&&(parseInt(D.v)>=w[0]&&parseInt(D.v)<=w[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+4,top:_}:t[s+"_"+g]={icons:{left:b+4,top:_}}:parseInt(D.v)>=y[0]&&parseInt(D.v)<=y[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+3,top:_}:t[s+"_"+g]={icons:{left:b+3,top:_}}:parseInt(D.v)>=C[0]&&parseInt(D.v)<=C[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+2,top:_}:t[s+"_"+g]={icons:{left:b+2,top:_}}:parseInt(D.v)>=T[0]&&parseInt(D.v)<=T[1]?s+"_"+g in t?t[s+"_"+g].icons={left:b+1,top:_}:t[s+"_"+g]={icons:{left:b+1,top:_}}:parseInt(D.v)>=I[0]&&parseInt(D.v)<=I[1]&&(s+"_"+g in t?t[s+"_"+g].icons={left:b,top:_}:t[s+"_"+g]={icons:{left:b,top:_}})))}}}}else for(var k,S,A,F,N=e[i].conditionName,M=e[i].conditionValue[0],E=e[i].conditionValue[1],O=o.textColor,z=o.cellColor,f=0;f<n.length;f++)if("greaterThan"==N||"lessThan"==N||"equal"==N||"textContains"==N)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"!=jfgrid.getObjType(D)||jfgrid.func_methods.isRealNull(D.v)||("greaterThan"==N&&D.v>M||"lessThan"==N&&D.v<M||"equal"==N&&D.v==M||"textContains"==N&&-1!=D.v.toString().indexOf(M))&&(s+"_"+g in t?(t[s+"_"+g].textColor=O,t[s+"_"+g].cellColor=z):t[s+"_"+g]={textColor:O,cellColor:z}))}else if("betweenness"==N){S=E<M?(k=M,E):(k=E,M);for(s=n[f].row[0];s<=n[f].row[1];s++)for(var D,g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(D=r[s][g],"object"!=jfgrid.getObjType(D)||jfgrid.func_methods.isRealNull(D.v)||D.v>=S&&D.v<=k&&(s+"_"+g in t?(t[s+"_"+g].textColor=O,t[s+"_"+g].cellColor=z):t[s+"_"+g]={textColor:O,cellColor:z}))}}else if("occurrenceDate"==N){F=-1==M.toString().indexOf("-")?(A=jfgrid.mask.genarate(M)[2],jfgrid.mask.genarate(M)[2]):(A=jfgrid.mask.genarate(M.toString().split("-")[1])[2],jfgrid.mask.genarate(M.toString().split("-")[0])[2]);for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&null!=r[s][g].ct&&"d"==r[s][g].ct.t&&F<=(W=jfgrid.getcellvalue(s,g,r))&&W<=A&&(s+"_"+g in t?(t[s+"_"+g].textColor=O,t[s+"_"+g].cellColor=z):t[s+"_"+g]={textColor:O,cellColor:z})}}else if("duplicateValue"==N){for(var P={},s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){var L=jfgrid.getcellvalue(s,g,r);L in P||(P[L]=[]),P[L].push({r:s,c:g})}if("0"==M)for(x in P)if("null"!=x&&"undefined"!=x&&1<P[x].length)for(var B=0;B<P[x].length;B++)P[x][B].r+"_"+P[x][B].c in t?(t[P[x][B].r+"_"+P[x][B].c].textColor=O,t[P[x][B].r+"_"+P[x][B].c].cellColor=z):t[P[x][B].r+"_"+P[x][B].c]={textColor:O,cellColor:z};if("1"==M)for(x in P)"null"!=x&&"undefined"!=x&&1==P[x].length&&(P[x][0].r+"_"+P[x][0].c in t?(t[P[x][0].r+"_"+P[x][0].c].textColor=O,t[P[x][0].r+"_"+P[x][0].c].cellColor=z):t[P[x][0].r+"_"+P[x][0].c]={textColor:O,cellColor:z})}else if("top10"==N||"top10%"==N||"last10"==N||"last10%"==N||"AboveAverage"==N||"SubAverage"==N){for(var q=[],s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++)null!=r[s]&&null!=r[s][g]&&null!=r[s][g].ct&&"n"==r[s][g].ct.t&&q.push(jfgrid.getcellvalue(s,g,r));if("top10"==N||"top10%"==N||"last10"==N||"last10%"==N){for(var H,B=0;B<q.length;B++)for(var V,U=0;U<q.length-1-B;U++){q[U]<q[U+1]&&(V=q[U],q[U]=q[U+1],q[U+1]=V)}"top10"==N?H=q.slice(0,M):"top10%"==N?H=q.slice(0,Math.floor(M*q.length/100)):"last10"==N?H=q.slice(q.length-M,q.length):"last10%"==N&&(H=q.slice(q.length-Math.floor(M*q.length/100),q.length));for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(W=jfgrid.getcellvalue(s,g,r),-1!=H.indexOf(W)&&(s+"_"+g in t?(t[s+"_"+g].textColor=O,t[s+"_"+g].cellColor=z):t[s+"_"+g]={textColor:O,cellColor:z}))}}else if("AboveAverage"==N||"SubAverage"==N){for(h=0,B=0;B<q.length;B++)h+=q[B];var Y=h/q.length;if("AboveAverage"==N)for(s=n[f].row[0];s<=n[f].row[1];s++)for(g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&Y<(W=jfgrid.getcellvalue(s,g,r))&&(s+"_"+g in t?(t[s+"_"+g].textColor=O,t[s+"_"+g].cellColor=z):t[s+"_"+g]={textColor:O,cellColor:z})}else if("SubAverage"==N)for(s=n[f].row[0];s<=n[f].row[1];s++)for(var W,g=n[f].column[0];g<=n[f].column[1];g++){null!=r[s]&&null!=r[s][g]&&(W=jfgrid.getcellvalue(s,g,r))<Y&&(s+"_"+g in t?(t[s+"_"+g].textColor=O,t[s+"_"+g].cellColor=z):t[s+"_"+g]={textColor:O,cellColor:z})}}}}return t},updateItem:function(e,r,t){var i,a,n=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),o=jfgrid.getjfgridfile(),l=$.extend(!0,[],o),d=jfgrid.conditionformat.getHistoryRules(l);"delSheet"==e?a=[]:(i={type:e,cellrange:r,format:t},(a=null==o[n].jfgrid_conditionformat_save?[]:o[n].jfgrid_conditionformat_save).push(i)),o[n].jfgrid_conditionformat_save=a;var f=$.extend(!0,[],o),s=jfgrid.conditionformat.getCurrentRules(f);jfgrid.conditionformat.ref(d,s),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,a,{k:"jfgrid_conditionformat_save"})},getHistoryRules:function(e){for(var r=[],t=0;t<e.length;t++)r.push({sheetIndex:e[t].index,jfgrid_conditionformat_save:e[t].jfgrid_conditionformat_save});return r},getCurrentRules:function(e){for(var r=[],t=0;t<e.length;t++)r.push({sheetIndex:e[t].index,jfgrid_conditionformat_save:e[t].jfgrid_conditionformat_save});return r},ref:function(e,r){var t;clearjfundo&&(jfgrid.jfundo=[],(t={type:"updateCF"}).data={historyRules:e,currentRules:r},jfgrid.jfredo.push(t)),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1),jfgridConfigsetting.pointEdit&&jfgrid.pointEdit_updateData()}},jfgrid.alternateformat={rangefocus:!1,modelfocusIndex:null,FixedModelColor:[{head:{fc:"#000",bc:"#bfbdbe"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f3f7"},foot:{fc:"#000",bc:"#dde2de"}},{head:{fc:"#000",bc:"#4bd4e7"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eaf7ff"},foot:{fc:"#000",bc:"#aae9f8"}},{head:{fc:"#000",bc:"#5ed593"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#e5fbee"},foot:{fc:"#000",bc:"#a5efcc"}},{head:{fc:"#000",bc:"#f6cb4b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fff9e7"},foot:{fc:"#000",bc:"#ffebac"}},{head:{fc:"#000",bc:"#f96420"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ffe5d9"},foot:{fc:"#000",bc:"#ffcfba"}},{head:{fc:"#000",bc:"#5599fc"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ecf2fe"},foot:{fc:"#000",bc:"#afcbfa"}},{head:{fc:"#000",bc:"#22a69b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#dff2f8"},foot:{fc:"#000",bc:"#8dd4d0"}},{head:{fc:"#000",bc:"#7a939a"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0eff7"},foot:{fc:"#000",bc:"#bdcad0"}},{head:{fc:"#000",bc:"#d7a270"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fdf3f1"},foot:{fc:"#000",bc:"#ead2b6"}},{head:{fc:"#000",bc:"#89c54b"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f1f7e9"},foot:{fc:"#000",bc:"#c5e3a7"}},{head:{fc:"#000",bc:"#8f88f0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0e5ff"},foot:{fc:"#000",bc:"#c6c4f6"}},{head:{fc:"#000",bc:"#fd1664"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#feddee"},foot:{fc:"#000",bc:"#f98ab5"}},{head:{fc:"#000",bc:"#da96d3"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fce8fb"},foot:{fc:"#000",bc:"#f2caee"}},{head:{fc:"#000",bc:"#b49191"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f5ebe8"},foot:{fc:"#000",bc:"#d8c3c3"}},{head:{fc:"#000",bc:"#91b493"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f0fbf0"},foot:{fc:"#000",bc:"#b4cfb6"}},{head:{fc:"#000",bc:"#b4a891"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f8f6f1"},foot:{fc:"#000",bc:"#d3cab8"}},{head:{fc:"#000",bc:"#91abb4"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#eff7fa"},foot:{fc:"#000",bc:"#b7cbd3"}},{head:{fc:"#000",bc:"#b7ba82"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fafbeb"},foot:{fc:"#000",bc:"#dadcb4"}},{head:{fc:"#000",bc:"#df3e3e"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fde9e9"},foot:{fc:"#000",bc:"#f89292"}},{head:{fc:"#000",bc:"#f2711c"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#fef0d7"},foot:{fc:"#000",bc:"#fbb335"}},{head:{fc:"#000",bc:"#b5cc18"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f9fbd4"},foot:{fc:"#000",bc:"#e2ed2a"}},{head:{fc:"#000",bc:"#00b5ad"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#ccfaf9"},foot:{fc:"#000",bc:"#00e4df"}},{head:{fc:"#000",bc:"#2185d0"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#d8f3fc"},foot:{fc:"#000",bc:"#3cc4f0"}},{head:{fc:"#000",bc:"#a5673f"},one:{fc:"#000",bc:"#ffffff"},two:{fc:"#000",bc:"#f6ede5"},foot:{fc:"#000",bc:"#d3a47c"}}],getModelBox:function(e,r){$("#jfgrid-modal-dialog-slider-alternateformat #jfgrid-alternateformat-modelList").empty(),$("#jfgrid-modal-dialog-slider-alternateformat #jfgrid-alternateformat-modelCustom").empty();for(var t="",i=0;i<jfgrid.alternateformat.FixedModelColor.length;i++){var a=jfgrid.alternateformat.FixedModelColor[i];s=e&&r?(l=a.head,d=a.one,f=a.two,a.foot):e?(l=a.head,d=a.one,f=a.two,a.one):r?(l=a.one,d=a.two,f=a.one,a.foot):(l=a.one,d=a.two,f=a.one,a.two),t+='<div class="modelbox"><div class="box"><span style="color:'+l.fc+";background-color:"+l.bc+'"> — </span><span style="color:'+d.fc+";background-color:"+d.bc+'"> — </span><span style="color:'+f.fc+";background-color:"+f.bc+'"> — </span><span style="color:'+s.fc+";background-color:"+s.bc+'"> — </span></div></div>'}$("#jfgrid-modal-dialog-slider-alternateformat #jfgrid-alternateformat-modelList").append(t);var n=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save_modelCustom;if(null!=n&&0<n.length){for(var o="",i=0;i<n.length;i++){var l,d,f,s,a=n[i];s=e&&r?(l=a.head,d=a.one,f=a.two,a.foot):e?(l=a.head,d=a.one,f=a.two,a.one):r?(l=a.one,d=a.two,f=a.one,a.foot):(l=a.one,d=a.two,f=a.one,a.two),o+='<div class="modelbox"><div class="box"><span style="color:'+l.fc+";background-color:"+l.bc+'"> — </span><span style="color:'+d.fc+";background-color:"+d.bc+'"> — </span><span style="color:'+f.fc+";background-color:"+f.bc+'"> — </span><span style="color:'+s.fc+";background-color:"+s.bc+'"> — </span></div></div>'}$("#jfgrid-modal-dialog-slider-alternateformat #jfgrid-alternateformat-modelCustom").append(o)}},init:function(){$("#jfgrid-modal-dialog-slider-alternateformat").remove(),$("body").append(jfgridAlternateformatHtml),jfgrid.jfgridsizeauto(),$("#jfgrid-modal-dialog-slider-alternateformat .jfgrid-model-close-btn").click(function(){$("#jfgrid-modal-dialog-slider-alternateformat").hide(),jfgrid.jfgridsizeauto()}),$(document).off("focus.AFrangeInput").on("focus.AFrangeInput","#jfgrid-alternateformat-range input",function(){jfgrid.alternateformat.rangefocus=!0}),$(document).off("blur.AFrangeInput").on("blur.AFrangeInput","#jfgrid-alternateformat-range input",function(){jfgrid.alternateformat.rangefocus=!1}),$(document).off("keydown.AFrangeInput").on("keydown.AFrangeInput","#jfgrid-alternateformat-range input",function(e){$(this).val().trim();13==e.keyCode&&jfgrid.alternateformat.update()}),$(document).off("click.AFrangeIcon").on("click.AFrangeIcon","#jfgrid-alternateformat-range .fa-table",function(){$("#jfgrid-modal-dialog-slider-alternateformat").hide(),jfgrid.jfgridsizeauto();var e=$(this).parents("#jfgrid-alternateformat-range").find("input").val().trim();jfgrid.alternateformat.rangeDialog(e)}),$(document).off("click.AFrDCf").on("click.AFrDCf","#jfgrid-alternateformat-rangeDialog-confirm",function(){var e=$(this).parents("#jfgrid-alternateformat-rangeDialog").find("input").val().trim();$("#jfgrid-modal-dialog-slider-alternateformat #jfgrid-alternateformat-range input").val(e),$(this).parents("#jfgrid-alternateformat-rangeDialog").hide(),$("#jfgrid-modal-dialog-slider-alternateformat").show(),jfgrid.jfgridsizeauto(),jfgrid.alternateformat.update()}),$(document).off("click.AFrDCl").on("click.AFrDCl","#jfgrid-alternateformat-rangeDialog-close",function(){$(this).parents("#jfgrid-alternateformat-rangeDialog").hide(),$("#jfgrid-modal-dialog-slider-alternateformat").show(),jfgrid.jfgridsizeauto()}),$(document).off("click.AFrDTitle").on("click.AFrDTitle","#jfgrid-alternateformat-rangeDialog .jfgrid-modal-dialog-title-close",function(){$(this).parents("#jfgrid-alternateformat-rangeDialog").hide(),$("#jfgrid-modal-dialog-slider-alternateformat").show(),jfgrid.jfgridsizeauto()}),$(document).off("change.AFrowHeader").on("change.AFrowHeader","#jfgrid-alternateformat-rowHeader",function(){var e,r;e=!!$(this).is(":checked"),r=!!$("#jfgrid-alternateformat-rowFooter").is(":checked"),jfgrid.alternateformat.checkboxChange(e,r),jfgrid.alternateformat.modelboxOn(),jfgrid.alternateformat.update()}),$(document).off("change.AFrowFooter").on("change.AFrowFooter","#jfgrid-alternateformat-rowFooter",function(){var e,r;e=!!$("#jfgrid-alternateformat-rowHeader").is(":checked"),r=!!$(this).is(":checked"),jfgrid.alternateformat.checkboxChange(e,r),jfgrid.alternateformat.modelboxOn(),jfgrid.alternateformat.update()}),$(document).off("click.AFmodelbox").on("click.AFmodelbox","#jfgrid-modal-dialog-slider-alternateformat .modelbox",function(){var e,r=$(this).index(),t=$(this).parents(".cf").attr("id");"jfgrid-alternateformat-modelList"==t?jfgrid.alternateformat.modelfocusIndex=r:"jfgrid-alternateformat-modelCustom"==t&&(e=jfgrid.alternateformat.FixedModelColor.length,jfgrid.alternateformat.modelfocusIndex=r+e),jfgrid.alternateformat.modelboxOn(),jfgrid.alternateformat.update()}),$(document).off("click.AFselectColor").on("click.AFselectColor","#jfgrid-modal-dialog-slider-alternateformat .jfgrid-color-menu-button-indicator",function(){var e,r,t,i=$(this).closest(".toningbox");$(this).find(".jfgrid-icon-img").hasClass("jfgrid-icon-text-color")?(e="fc",r=i.find(".toningShow").data("fc")):$(this).find(".jfgrid-icon-img").hasClass("jfgrid-icon-cell-color")&&(e="bc",r=i.find(".toningShow").data("bc")),i.hasClass("header")?t="0":i.hasClass("ctOne")?t="1":i.hasClass("ctTwo")?t="2":i.hasClass("footer")&&(t="3"),jfgrid.alternateformat.colorSelectDialog(r,e,t)}),$(document).off("click.AFselectColorConfirm").on("click.AFselectColorConfirm","#jfgrid-alternateformat-colorSelect-dialog-confirm",function(){var e=$(this).parents("#jfgrid-alternateformat-colorSelect-dialog");$("#jfgrid-modal-dialog-mask").hide(),e.hide();var r,t=e.find(".currenColor span").attr("title");"选择文本颜色"==e.find(".jfgrid-modal-dialog-title-text").text()?r="fc":"选择单元格颜色"==e.find(".jfgrid-modal-dialog-title-text").text()&&(r="bc");var i,a,n=e.find(".currenColor").attr("data-source");"0"==n?("fc"==r&&($("#jfgrid-alternateformat-modelToning .header .toningShow").css("color",t),$("#jfgrid-alternateformat-modelToning .header .toningShow").data("fc",t),$("#jfgrid-alternateformat-modelToning .header .jfgrid-icon-text-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",t)),"bc"==r&&($("#jfgrid-alternateformat-modelToning .header .toningShow").css("background-color",t),$("#jfgrid-alternateformat-modelToning .header .toningShow").data("bc",t),$("#jfgrid-alternateformat-modelToning .header .jfgrid-icon-cell-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",t))):"1"==n?("fc"==r&&($("#jfgrid-alternateformat-modelToning .ctOne .toningShow").css("color",t),$("#jfgrid-alternateformat-modelToning .ctOne .toningShow").data("fc",t),$("#jfgrid-alternateformat-modelToning .ctOne .jfgrid-icon-text-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",t)),"bc"==r&&($("#jfgrid-alternateformat-modelToning .ctOne .toningShow").css("background-color",t),$("#jfgrid-alternateformat-modelToning .ctOne .toningShow").data("bc",t),$("#jfgrid-alternateformat-modelToning .ctOne .jfgrid-icon-cell-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",t))):"2"==n?("fc"==r&&($("#jfgrid-alternateformat-modelToning .ctTwo .toningShow").css("color",t),$("#jfgrid-alternateformat-modelToning .ctTwo .toningShow").data("fc",t),$("#jfgrid-alternateformat-modelToning .ctTwo .jfgrid-icon-text-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",t)),"bc"==r&&($("#jfgrid-alternateformat-modelToning .ctTwo .toningShow").css("background-color",t),$("#jfgrid-alternateformat-modelToning .ctTwo .toningShow").data("bc",t),$("#jfgrid-alternateformat-modelToning .ctTwo .jfgrid-icon-cell-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",t))):"3"==n&&("fc"==r&&($("#jfgrid-alternateformat-modelToning .footer .toningShow").css("color",t),$("#jfgrid-alternateformat-modelToning .footer .toningShow").data("fc",t),$("#jfgrid-alternateformat-modelToning .footer .jfgrid-icon-text-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",t)),"bc"==r&&($("#jfgrid-alternateformat-modelToning .footer .toningShow").css("background-color",t),$("#jfgrid-alternateformat-modelToning .footer .toningShow").data("bc",t),$("#jfgrid-alternateformat-modelToning .footer .jfgrid-icon-cell-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",t))),i=!!$("#jfgrid-alternateformat-rowHeader").is(":checked"),a=!!$("#jfgrid-alternateformat-rowFooter").is(":checked");var o,l,d,f=jfgrid.alternateformat.modelfocusIndex,s=jfgrid.alternateformat.FixedModelColor.length;d=f<s?$.extend(!0,{},jfgrid.alternateformat.getFormatByIndex()):(l=(o=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)]).jfgrid_alternateformat_save_modelCustom,$.extend(!0,{},l[f-s])),"0"==n?"fc"==r?d.head.fc=t:"bc"==r&&(d.head.bc=t):"1"==n?"fc"==r?d.one.fc=t:"bc"==r&&(d.one.bc=t):"2"==n?"fc"==r?d.two.fc=t:"bc"==r&&(d.two.bc=t):"3"==n&&("fc"==r&&(d.foot.fc=t),"bc"==r&&(d.foot.bc=t)),jfgrid.alternateformat.modelfocusIndex<s?(jfgrid.alternateformat.addCustomModel(d),jfgrid.alternateformat.modelfocusIndex=jfgrid.alternateformat.getIndexByFormat(d)):(o.jfgrid_alternateformat_save_modelCustom[f-s]=d,jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,o.jfgrid_alternateformat_save_modelCustom,{k:"jfgrid_alternateformat_save_modelCustom"})),jfgrid.alternateformat.getModelBox(i,a),jfgrid.alternateformat.modelboxOn(),jfgrid.alternateformat.update()}),$(document).off("click.AFremove").on("click.AFremove","#jfgrid-alternateformat-remove",function(){var e=$(this).data("index"),r=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save,t=$.extend(!0,[],r);1<r.length?r.splice(e,1):r=[];var i=$.extend(!0,[],r);jfgrid.alternateformat.ref(t,i),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,r,{k:"jfgrid_alternateformat_save"}),$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-modal-dialog-slider-alternateformat").hide(),jfgrid.jfgridsizeauto()})},perfect:function(){var e=$.extend(!0,{},jfgird_select_save[0]),r=jfgrid.alternateformat.rangeIsExists(e)[1],t=$.extend(!0,{},jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save[r]),i=t.cellrange;$("#jfgrid-alternateformat-range input").val(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:i.row,column:i.column},jfgrid.currentSheetIndex)),jfgird_select_save=[{row:i.row,column:i.column}],jfgrid.selectHightlightShow();var a=t.hasRowHeader,n=t.hasRowFooter,o=t.format;jfgrid.alternateformat.modelfocusIndex=jfgrid.alternateformat.getIndexByFormat(o),null==jfgrid.alternateformat.modelfocusIndex&&(jfgrid.alternateformat.addCustomModel(o),jfgrid.alternateformat.modelfocusIndex=jfgrid.alternateformat.getIndexByFormat(o)),jfgrid.alternateformat.checkboxChange(a,n),jfgrid.alternateformat.modelboxOn(),$("#jfgrid-alternateformat-remove").data("index",r)},checkboxChange:function(e,r){e?($("#jfgrid-alternateformat-rowHeader").prop("checked",!0),$("#jfgrid-alternateformat-modelToning .header").show()):($("#jfgrid-alternateformat-rowHeader").removeAttr("checked"),$("#jfgrid-alternateformat-modelToning .header").hide()),r?($("#jfgrid-alternateformat-rowFooter").prop("checked",!0),$("#jfgrid-alternateformat-modelToning .footer").show()):($("#jfgrid-alternateformat-rowFooter").removeAttr("checked"),$("#jfgrid-alternateformat-modelToning .footer").hide()),jfgrid.alternateformat.getModelBox(e,r)},modelboxOn:function(){$("#jfgrid-modal-dialog-slider-alternateformat .modelbox").removeClass("on");var e=jfgrid.alternateformat.modelfocusIndex,r=jfgrid.alternateformat.FixedModelColor.length;e<r?$("#jfgrid-alternateformat-modelList .modelbox").eq(e).addClass("on"):$("#jfgrid-alternateformat-modelCustom .modelbox").eq(e-r).addClass("on"),jfgrid.alternateformat.modelToningColor()},modelToningColor:function(){var e=jfgrid.alternateformat.getFormatByIndex();$("#jfgrid-alternateformat-modelToning .header .toningShow").css({color:e.head.fc,"background-color":e.head.bc}),$("#jfgrid-alternateformat-modelToning .header .toningShow").data("fc",e.head.fc).data("bc",e.head.bc),$("#jfgrid-alternateformat-modelToning .header .jfgrid-icon-text-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",e.head.fc),$("#jfgrid-alternateformat-modelToning .header .jfgrid-icon-cell-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",e.head.bc),$("#jfgrid-alternateformat-modelToning .ctOne .toningShow").css({color:e.one.fc,"background-color":e.one.bc}),$("#jfgrid-alternateformat-modelToning .ctOne .toningShow").data("fc",e.one.fc).data("bc",e.one.bc),$("#jfgrid-alternateformat-modelToning .ctOne .jfgrid-icon-text-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",e.one.fc),$("#jfgrid-alternateformat-modelToning .ctOne .jfgrid-icon-cell-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",e.one.bc),$("#jfgrid-alternateformat-modelToning .ctTwo .toningShow").css({color:e.two.fc,"background-color":e.two.bc}),$("#jfgrid-alternateformat-modelToning .ctTwo .toningShow").data("fc",e.two.fc).data("bc",e.two.bc),$("#jfgrid-alternateformat-modelToning .ctTwo .jfgrid-icon-text-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",e.two.fc),$("#jfgrid-alternateformat-modelToning .ctTwo .jfgrid-icon-cell-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",e.two.bc),$("#jfgrid-alternateformat-modelToning .footer .toningShow").css({color:e.foot.fc,"background-color":e.foot.bc}),$("#jfgrid-alternateformat-modelToning .footer .toningShow").data("fc",e.foot.fc).data("bc",e.foot.bc),$("#jfgrid-alternateformat-modelToning .footer .jfgrid-icon-text-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",e.foot.fc),$("#jfgrid-alternateformat-modelToning .footer .jfgrid-icon-cell-color").parents(".jfgrid-color-menu-button-indicator").css("border-bottom-color",e.foot.bc)},addCustomModel:function(e){var r=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)];null==r.jfgrid_alternateformat_save_modelCustom&&(r.jfgrid_alternateformat_save_modelCustom=[]),r.jfgrid_alternateformat_save_modelCustom.push(e),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,r.jfgrid_alternateformat_save_modelCustom,{k:"jfgrid_alternateformat_save_modelCustom"})},colorSelectDialog:function(e,r,t){var i;$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-alternateformat-colorSelect-dialog").remove(),"fc"==r?i="选择文本颜色":"bc"==r&&(i="选择单元格颜色"),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-alternateformat-colorSelect-dialog",addclass:"jfgrid-alternateformat-colorSelect-dialog",title:i,content:"<div class='currenColor' data-source='"+t+"'>当前颜色：<span title='"+e+"' style='background-color:"+e+"'></span></div><div class='colorshowbox'></div>",botton:'<button id="jfgrid-alternateformat-colorSelect-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default jfgrid-model-close-btn">取消</button>',style:"z-index:100003"}));var a=$("#jfgrid-alternateformat-colorSelect-dialog").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),n=a.outerHeight(),o=a.outerWidth(),l=$(window).width(),d=$(window).height(),f=$(document).scrollLeft(),s=$(document).scrollTop();$("#jfgrid-alternateformat-colorSelect-dialog").css({left:(l+f-o)/2,top:(d+s-n)/3}).show(),$("#jfgrid-alternateformat-colorSelect-dialog").find(".colorshowbox").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,showButtons:!1,maxPaletteSize:8,maxSelectionSize:8,color:e,cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.textcolor"+jfgrid.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],move:function(e){e=null!=e?e.toHexString():"#000",$("#jfgrid-alternateformat-colorSelect-dialog .currenColor span").css("background-color",e).attr("title",e)}})},rangeDialog:function(e){$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-alternateformat-rangeDialog").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-alternateformat-rangeDialog",addclass:"jfgrid-alternateformat-rangeDialog",title:"选择应用范围",content:'<input readonly="readonly" placeholder="请选择交替颜色应用范围" value="'+e+'"/>',botton:'<button id="jfgrid-alternateformat-rangeDialog-confirm" class="btn btn-primary">确定</button><button id="jfgrid-alternateformat-rangeDialog-close" class="btn btn-default">取消</button>',style:"z-index:100003"}));var r=$("#jfgrid-alternateformat-rangeDialog").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),t=r.outerHeight(),i=r.outerWidth(),a=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),l=$(document).scrollTop();$("#jfgrid-alternateformat-rangeDialog").css({left:(a+o-i)/2,top:(n+l-t)/3}).show()},rangeIsExists:function(e,r){var t=!1,i=null,a=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save);if(null!=r&&null!=r&&(1<a.length?a.splice(r,1):a=[]),0<a.length){for(var n=[],o=0;o<a.length;o++){var l={index:o,map:jfgrid.alternateformat.getRangeMap(a[o].cellrange.row,a[o].cellrange.column)};n.push(l)}var d=jfgrid.alternateformat.getRangeMap(e.row,e.column);for(x in d){if(t)break;for(var f=0;f<n.length;f++)if(x in n[f].map){t=!0,i=n[f].index;break}}}return[t,i]},getRangeMap:function(e,r){for(var t={},i=e[0],a=e[1],n=r[0],o=r[1],l=i;l<=a;l++)for(var d=n;d<=o;d++)t[l+"_"+d]=0;return t},getIndexByFormat:function(e){for(var r=null,t=jfgrid.alternateformat.FixedModelColor,i=0;i<t.length;i++){var a=t[i];if(e.head.fc==a.head.fc&&e.head.bc==a.head.bc&&e.one.fc==a.one.fc&&e.one.bc==a.one.bc&&e.two.fc==a.two.fc&&e.two.bc==a.two.bc&&e.foot.fc==a.foot.fc&&e.foot.bc==a.foot.bc){r=i;break}}var n=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save_modelCustom;if(null!=n&&0<n.length)for(var o=0;o<n.length;o++){a=n[o];if(e.head.fc==a.head.fc&&e.head.bc==a.head.bc&&e.one.fc==a.one.fc&&e.one.bc==a.one.bc&&e.two.fc==a.two.fc&&e.two.bc==a.two.bc&&e.foot.fc==a.foot.fc&&e.foot.bc==a.foot.bc){r=t.length+o;break}}return r},getFormatByIndex:function(){var e=jfgrid.alternateformat.modelfocusIndex,r=jfgrid.alternateformat.FixedModelColor.length;return e<r?jfgrid.alternateformat.FixedModelColor[e]:jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save_modelCustom[e-r]},new:function(e){var r=jfgrid.alternateformat.getFormatByIndex(),t=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save;null==t&&(t=[]);var i=$.extend(!0,[],t),a={cellrange:{row:e.row,column:e.column},format:r,hasRowHeader:!0,hasRowFooter:!1};t.push(a);var n=$.extend(!0,[],t);jfgrid.alternateformat.ref(i,n),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,t,{k:"jfgrid_alternateformat_save"})},update:function(){var e,r,t,i,a,n,o,l,d=$("#jfgrid-alternateformat-remove").data("index"),f=$("#jfgrid-modal-dialog-slider-alternateformat #jfgrid-alternateformat-range input").val().trim();jfgrid.formula.iscelldata(f)?(e=jfgrid.formula.getcellrange(f),jfgrid.alternateformat.rangeIsExists(e,d)[0]?jfgrid.isEditMode()?alert("您选择的应用范围已存在交替颜色且不属于你要编辑的应用范围！"):jfgrid.tooltip.info("您选择的应用范围已存在交替颜色且不属于你要编辑的应用范围！",""):(r=!!$("#jfgrid-modal-dialog-slider-alternateformat #jfgrid-alternateformat-rowHeader").is(":checked"),t=!!$("#jfgrid-modal-dialog-slider-alternateformat #jfgrid-alternateformat-rowFooter").is(":checked"),i=jfgrid.alternateformat.getFormatByIndex(),null==(a=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save)&&(a=[]),n=$.extend(!0,[],a),o={cellrange:{row:e.row,column:e.column},format:i,hasRowHeader:r,hasRowFooter:t},a[d]=o,l=$.extend(!0,[],a),jfgrid.alternateformat.ref(n,l),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,a,{k:"jfgrid_alternateformat_save"}))):jfgrid.isEditMode()?alert("您选择的应用范围不是选区！"):jfgrid.tooltip.info("您选择的应用范围不是选区！","")},checksAF:function(e,r,t){return e+"_"+r in t?t[e+"_"+r]:null},getComputeMap:function(){var e=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_alternateformat_save;return jfgrid.alternateformat.compute(e)},compute:function(e){var r={};if(null!=e&&0<e.length)for(var t=0;t<e.length;t++){var i=e[t].cellrange,a=e[t].format,n=e[t].hasRowHeader,o=e[t].hasRowFooter,l=i.row[0],d=i.row[1],f=i.column[0],s=i.column[1];if(n&&o){for(var g=f;g<=s;g++)r[l+"_"+g]=[a.head.fc,a.head.bc];if(1<d-l)for(var c=l+1;c<d;c++){m=(c-l)%2!=0?(u=a.one.fc,a.one.bc):(u=a.two.fc,a.two.bc);for(g=f;g<=s;g++)r[c+"_"+g]=[u,m]}if(l<d)for(g=f;g<=s;g++)r[d+"_"+g]=[a.foot.fc,a.foot.bc]}else if(n){for(g=f;g<=s;g++)r[l+"_"+g]=[a.head.fc,a.head.bc];if(l<d)for(c=l+1;c<=d;c++){m=(c-l)%2!=0?(u=a.one.fc,a.one.bc):(u=a.two.fc,a.two.bc);for(g=f;g<=s;g++)r[c+"_"+g]=[u,m]}}else if(o){if(l<d)for(c=l;c<d;c++){m=(c-l)%2==0?(u=a.one.fc,a.one.bc):(u=a.two.fc,a.two.bc);for(g=f;g<=s;g++)r[c+"_"+g]=[u,m]}for(g=f;g<=s;g++)r[d+"_"+g]=[a.foot.fc,a.foot.bc]}else for(var u,m,c=l;c<=d;c++){m=(c-l)%2==0?(u=a.one.fc,a.one.bc):(u=a.two.fc,a.two.bc);for(g=f;g<=s;g++)r[c+"_"+g]=[u,m]}}return r},ref:function(e,r){var t;clearjfundo&&(jfgrid.jfundo=[],(t={type:"updateAF"}).sheetIndex=jfgrid.currentSheetIndex,t.data={historyRules:e,currentRules:r},jfgrid.jfredo.push(t));var i=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex);jfgridfile[i].jfgrid_alternateformat_save=r,setTimeout(function(){jfgrid.jfgridrefreshgrid()},1)}},jfgrid.ifFormulaGenerator={singleRangeFocus:!1,init:function(){$(document).off("focus.IFcompareValue").on("focus.IFcompareValue","#jfgrid-ifFormulaGenerator-dialog #compareValue",function(){$("#jfgrid-modal-dialog-mask").hide(),jfgrid.ifFormulaGenerator.singleRangeFocus=!0}),$(document).off("click.IFsingRange").on("click.IFsingRange","#jfgrid-ifFormulaGenerator-dialog .singRange",function(){var e=$("#jfgrid-ifFormulaGenerator-dialog #compareValue").val().trim();jfgrid.formula.iscelldata(e)?jfgrid.ifFormulaGenerator.singleRangeDialog(e):jfgrid.ifFormulaGenerator.singleRangeDialog()}),$(document).off("click.IFsingRangeConfirm").on("click.IFsingRangeConfirm","#jfgrid-ifFormulaGenerator-singleRange-confirm",function(){$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-ifFormulaGenerator-singleRange-dialog").hide(),$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-ifFormulaGenerator-dialog").show();var e=$(this).parents("#jfgrid-ifFormulaGenerator-singleRange-dialog").find("input").val().trim();$("#jfgrid-ifFormulaGenerator-dialog #compareValue").val(e),jfgrid.ifFormulaGenerator.singleRangeFocus=!1}),$(document).off("click.IFsingRangeCancel").on("click.IFsingRangeCancel","#jfgrid-ifFormulaGenerator-singleRange-cancel",function(){$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-ifFormulaGenerator-singleRange-dialog").hide(),$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-ifFormulaGenerator-dialog").show(),jfgrid.ifFormulaGenerator.singleRangeFocus=!1}),$(document).off("click.IFsingRangeClose").on("click.IFsingRangeClose","#jfgrid-ifFormulaGenerator-singleRange-dialog .jfgrid-modal-dialog-title-close",function(){$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-ifFormulaGenerator-dialog").show(),jfgrid.ifFormulaGenerator.singleRangeFocus=!1}),$(document).off("click.IFmultiRange").on("click.IFmultiRange","#jfgrid-ifFormulaGenerator-dialog .multiRange",function(){jfgrid.ifFormulaGenerator.multiRangeDialog(),jfgrid.ifFormulaGenerator.singleRangeFocus=!1}),$(document).off("click.IFmultiRangeConfirm").on("click.IFmultiRangeConfirm","#jfgrid-ifFormulaGenerator-multiRange-confirm",function(){$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").hide(),$("#jfgrid-ifFormulaGenerator-multiRange-dialog").hide(),$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-ifFormulaGenerator-dialog").show();for(var e=$(this).parents("#jfgrid-ifFormulaGenerator-multiRange-dialog").find("input").val().trim(),r=jfgrid.formula.getcellrange(e),t=r.row[0],i=r.row[1],a=r.column[0],n=r.column[1],o=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),l=[],d=t;d<=i;d++)for(var f=a;f<=n;f++)null!=o[d]&&null!=o[d][f]&&null!=o[d][f].ct&&"n"==o[d][f].ct.t&&l.push(o[d][f].v);for(var s=0;s<l.length;s++)for(var g,c=0;c<l.length-1-s;c++){l[c]<l[c+1]&&(g=l[c],l[c]=l[c+1],l[c+1]=g)}var u=l[0],m=l[l.length-1];$("#jfgrid-ifFormulaGenerator-dialog #smallRange").val(m),$("#jfgrid-ifFormulaGenerator-dialog #largeRange").val(u)}),$(document).off("click.IFmultiRangeCancel").on("click.IFmultiRangeCancel","#jfgrid-ifFormulaGenerator-multiRange-cancel",function(){$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").hide(),$("#jfgrid-ifFormulaGenerator-multiRange-dialog").hide(),$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-ifFormulaGenerator-dialog").show()}),$(document).off("click.IFmultiRangeClose").on("click.IFmultiRangeClose","#jfgrid-ifFormulaGenerator-multiRange-dialog .jfgrid-modal-dialog-title-close",function(){$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").hide(),$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-ifFormulaGenerator-dialog").show()}),$(document).on("change","#DivisionMethod",function(){"2"==$(this).find("option:selected").val()?$("#DivisionMethodVal").hide():$("#DivisionMethodVal").show(),$("#jfgrid-ifFormulaGenerator-dialog .ifList").empty()}),$(document).off("click.IFcreateBtn").on("click.IFcreateBtn","#jfgrid-ifFormulaGenerator-dialog #createBtn",function(){var e=$(this).parents("#jfgrid-ifFormulaGenerator-dialog").find("#compareValue").val().trim();if(""!=e){var r=$(this).parents("#jfgrid-ifFormulaGenerator-dialog").find("#DivisionMethod option:selected").val();if("2"==r){var t='<div class="item"><input type="number" class="smallNum formulaInputFocus"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+e+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus"/><span>标签：</span><input type="text" class="markText formulaInputFocus" value=""><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#jfgrid-ifFormulaGenerator-dialog .ifList").append(t)}else{var i=$(this).parents("#jfgrid-ifFormulaGenerator-dialog").find("#smallRange").val().trim(),a=$(this).parents("#jfgrid-ifFormulaGenerator-dialog").find("#largeRange").val().trim(),n=$(this).parents("#jfgrid-ifFormulaGenerator-dialog").find("#DivisionMethodVal").val().trim();if(""==i||""==a)return void jfgrid.ifFormulaGenerator.info("范围不能为空！");if(""==n)return void jfgrid.ifFormulaGenerator.info("划分值不能为空！");jfgrid.ifFormulaGenerator.getIfList(e,i,a,r,n)}}else jfgrid.ifFormulaGenerator.info("比较值不能为空！")}),$(document).on("click","#jfgrid-ifFormulaGenerator-dialog .item .fa-remove",function(){$(this).parents(".item").remove()}),$(document).off("click.IFconfirmBtn").on("click.IFconfirmBtn","#jfgrid-ifFormulaGenerator-dialog-confirm",function(){var e,r,t,i,a,n,o,g=$(this).parents("#jfgrid-ifFormulaGenerator-dialog").find(".ifList .item"),c="";$(g.toArray().reverse()).each(function(e,r){var t,i,a,n=$(r).find(".smallNum").val().trim(),o=$(r).find(".largeNum").val().trim(),l=$(r).find(".operator option:selected").val(),d=$(r).find(".operator2 option:selected").val(),f=$(r).find(".compareValue").text(),s=$(r).find(".markText").val().trim();if(""==s&&(s="标签"+(e+1)),""==n&&""==o)return!0;t="0"==l?f+">="+n:f+">"+n,i="0"==d?f+"<="+o:f+"<"+o,a=0==e&&""==o?t:e==g.length-1&&""==n?i:"and("+t+","+i+")",c=0==e?"if("+a+',"'+s+'")':"if("+a+',"'+s+'",'+c+")"}),0!=c.length?($("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-ifFormulaGenerator-dialog").hide(),r=(e=jfgird_select_save[jfgird_select_save.length-1]).row_focus,t=e.column_focus,i=visibledatarow[r],a=r-1==-1?0:visibledatarow[r-1],n=visibledatacolumn[t],o=t-1==-1?0:visibledatacolumn[t-1],jfgrid.jfgridupdateCell(i,a,r,n,o,t,jfgrid.flowdata),$("#jfgrid-rich-text-editor").html("="+c),$("#jfgrid-functionbox-cell").html($("#jfgrid-rich-text-editor").html()),$("#jfgrid-wa-functionbox-confirm").click()):jfgrid.ifFormulaGenerator.info("没有生成可用的条件！")}),$(document).on("click","#jfgrid-ifFormulaGenerator-info .jfgrid-model-close-btn",function(){$("#jfgrid-modal-dialog-mask").show()}),$(document).on("click","#jfgrid-ifFormulaGenerator-info .jfgrid-modal-dialog-title-close",function(){$("#jfgrid-modal-dialog-mask").show()})},ifFormulaDialog:function(e){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-ifFormulaGenerator-dialog").remove();var r="",t="";if(e)for(var i=e.split("if("),a=1;a<i.length;a++){var n,o,l,d=i[a].replace("and(","").replace(/\)/g,"").replace(/\"/g,"").split(","),d=jfgrid.ifFormulaGenerator.clearArr(d),r=jfgrid.ifFormulaGenerator.splitTxt(d[0])[0];l=3==d.length?(n=jfgrid.ifFormulaGenerator.splitTxt(d[0])[1],o=jfgrid.ifFormulaGenerator.splitTxt(d[1])[2],d[2]):(n=jfgrid.ifFormulaGenerator.splitTxt(d[0])[1],o=jfgrid.ifFormulaGenerator.splitTxt(d[0])[2],d[1]),t+='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+n+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+r+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+o+'"/><span>标签：</span><input type="text" class="markText formulaInputFocus" value="'+l+'"><i class="fa fa-remove" aria-hidden="true"></i></div>'}var f='<div class="ifAttr"><div class="attrBox"><label for="compareValue"> 比较值 </label><div class="inpBox"><input id="compareValue" class="formulaInputFocus" value="'+r+'"/><i class="singRange fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div></div><div class="attrBox"><label for="smallRange"> 范围 </label><input type="number" id="smallRange" class="formulaInputFocus"/><span class="text"> 至 </span><input type="number" id="largeRange" class="formulaInputFocus"/><div id="rangeAssess"><span> 范围评估 </span><i class="multiRange fa fa-table" aria-hidden="true" title="点击选择范围"></i></div></div><div class="attrBox"><label for="DivisionMethod"> 划分方式 </label><select id="DivisionMethod"><option value="0"> 划分值相同 </option><option value="1"> 划分为N份 </option><option value="2"> 自定义输入 </option></select><input id="DivisionMethodVal" class="formulaInputFocus"/><div id="createBtn"> 生成 </div></div></div><div class="ifList">'+t+"</div>";$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-ifFormulaGenerator-dialog",addclass:"jfgrid-ifFormulaGenerator-dialog",title:"if公式生成器",content:f,botton:'<button id="jfgrid-ifFormulaGenerator-dialog-confirm" class="btn btn-primary">确认</button><button class="btn btn-default jfgrid-model-close-btn">取消</button>',style:"z-index:100003"}));var s=$("#jfgrid-ifFormulaGenerator-dialog").find(".jfgrid-modal-dialog-content").css("min-width",590).end(),g=s.outerHeight(),c=s.outerWidth(),u=$(window).width(),m=$(window).height(),h=$(document).scrollLeft(),j=$(document).scrollTop();$("#jfgrid-ifFormulaGenerator-dialog").css({left:(u+h-c)/2,top:(m+j-g)/3}).show()},clearArr:function(e){for(var r=0;r<e.length;r++)""!=e[r]&&null!=e[r]&&null!=e[r]||e.splice(r,1);return e},splitTxt:function(e){var r,t;return-1!=e.indexOf(">=")?[e.split(">=")[0],r=e.split(">=")[1],t]:-1!=e.indexOf(">")?[e.split(">")[0],r=e.split(">")[1],t]:-1!=e.indexOf("<=")?[e.split("<=")[0],r,t=e.split("<=")[1]]:-1!=e.indexOf("<")?[e.split("<")[0],r,t=e.split("<")[1]]:void 0},singleRangeDialog:function(e){var r;$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-ifFormulaGenerator-dialog").hide(),$("#jfgrid-ifFormulaGenerator-singleRange-dialog").remove(),r=null!=e&&null!=e?e:"",$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-ifFormulaGenerator-singleRange-dialog",addclass:"jfgrid-ifFormulaGenerator-singleRange-dialog",title:"选择单元格",content:'<input readonly="readonly" placeholder="请选择单元格" value="'+r+'">',botton:'<button id="jfgrid-ifFormulaGenerator-singleRange-confirm" class="btn btn-primary">确认</button><button id="jfgrid-ifFormulaGenerator-singleRange-cancel" class="btn btn-default">取消</button>',style:"z-index:100003"}));var t=$("#jfgrid-ifFormulaGenerator-singleRange-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),i=t.outerHeight(),a=t.outerWidth(),n=$(window).width(),o=$(window).height(),l=$(document).scrollLeft(),d=$(document).scrollTop();$("#jfgrid-ifFormulaGenerator-singleRange-dialog").css({left:(n+l-a)/2,top:(o+d-i)/3}).show()},multiRangeDialog:function(){$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-ifFormulaGenerator-dialog").hide(),$("#jfgrid-ifFormulaGenerator-multiRange-dialog").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-ifFormulaGenerator-multiRange-dialog",addclass:"jfgrid-ifFormulaGenerator-multiRange-dialog",title:"选择范围",content:'<input readonly="readonly" placeholder="请选择范围" value="">',botton:'<button id="jfgrid-ifFormulaGenerator-multiRange-confirm" class="btn btn-primary">确认</button><button id="jfgrid-ifFormulaGenerator-multiRange-cancel" class="btn btn-default">取消</button>',style:"z-index:100003"}));var e=$("#jfgrid-ifFormulaGenerator-multiRange-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),r=e.outerHeight(),t=e.outerWidth(),i=$(window).width(),a=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#jfgrid-ifFormulaGenerator-multiRange-dialog").css({left:(i+n-t)/2,top:(a+o-r)/3}).show()},getIfList:function(e,r,t,i,a){$("#jfgrid-ifFormulaGenerator-dialog .ifList").empty();var r=parseInt(r),t=parseInt(t),a=parseInt(a),n=[];if("0"==i)for(var o=Math.ceil((t-r)/a),l=0;l<=o;l++){var d=r+a*l;0==l||t<=d?n.push(""):n.push(d)}else if("1"==i)for(var f=Math.ceil((t-r)/a),l=0;l<=a;l++){d=r+f*l;0==l||t<=d?n.push(""):n.push(d)}for(var s,g=0;g<n.length-1;g++){s=0==g?"小于"+n[g+1]:g==n.length-2?"大于等于"+n[g]:n[g]+"到"+n[g+1];var c='<div class="item"><input type="number" class="smallNum formulaInputFocus" value="'+n[g]+'"/><select class="operator"><option value="0"> <= </option><option value="1"> < </option></select><span class="compareValue">'+e+'</span><select class="operator2"><option value="0"> <= </option><option value="1" selected="selected"> < </option></select><input type="number" class="largeNum formulaInputFocus" value="'+n[g+1]+'"/><span>标签：</span><input type="text" class="markText formulaInputFocus" value="'+s+'"><i class="fa fa-remove" aria-hidden="true"></i></div>';$("#jfgrid-ifFormulaGenerator-dialog .ifList").append(c)}},info:function(e){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-ifFormulaGenerator-info").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-ifFormulaGenerator-info",addclass:"",title:e,content:"",botton:'<button class="btn btn-default jfgrid-model-close-btn">&nbsp;&nbsp;关闭&nbsp;&nbsp;</button>',style:"z-index:100003"}));var r=$("#jfgrid-ifFormulaGenerator-info").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),t=r.outerHeight(),i=r.outerWidth(),a=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),l=$(document).scrollTop();$("#jfgrid-ifFormulaGenerator-info").css({left:(a+o-i)/2,top:(n+l-t)/3}).show()}},jfgrid.insertFormula={init:function(){$(document).off("keyup.fxSFLI").on("keyup.fxSFLI","#searchFormulaListInput",function(){$("#formulaTypeList").empty();var e=$(this).val().toUpperCase();if(""==e)jfgrid.insertFormula.formulaListByType($("#formulaTypeSelect option:selected").val());else for(var r=0;r<jfgrid.functionlist.length;r++)/^[a-zA-Z]+$/.test(e)?"-1"!=jfgrid.functionlist[r].n.indexOf(e)&&$('<div class="listBox" name="'+jfgrid.functionlist[r].n+'"><span>'+jfgrid.functionlist[r].n+"</span><span>"+jfgrid.functionlist[r].a+"</span></div>").appendTo($("#formulaTypeList")):"-1"!=jfgrid.functionlist[r].a.indexOf(e)&&$('<div class="listBox" name="'+jfgrid.functionlist[r].n+'"><span>'+jfgrid.functionlist[r].n+"</span><span>"+jfgrid.functionlist[r].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")}),$(document).off("change.fxFormulaTS").on("change.fxFormulaTS","#formulaTypeSelect",function(){var e=$("#formulaTypeSelect option:selected").val();jfgrid.insertFormula.formulaListByType(e)}),$(document).off("click.fxListbox").on("click.fxListbox","#formulaTypeList .listBox",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.fxFormulaCf").on("click.fxFormulaCf","#jfgrid-search-formula-confirm",function(){var e=$("#jfgrid-search-formula .listBox.on").attr("name"),r='<span dir="auto" class="jfgrid-formula-text-color">=</span><span dir="auto" class="jfgrid-formula-text-color">'+e.toUpperCase()+'</span><span dir="auto" class="jfgrid-formula-text-color">(</span><span dir="auto" class="jfgrid-formula-text-color">)</span>';$("#jfgrid-rich-text-editor").html(r),$("#jfgrid-functionbox-cell").html($("#jfgrid-rich-text-editor").html()),jfgrid.insertFormula.formulaParmDialog(e)}),$(document).off("focus.fxParamInput").on("focus.fxParamInput","#jfgrid-search-formula-parm .parmBox input",function(){var e=$(this).parents(".parmBox").index();jfgrid.formula.data_parm_index=e;var r,t,i=$(this).parents("#jfgrid-search-formula-parm").find(".jfgrid-modal-dialog-title-text").text(),a=window.jfgrid_function[i].p.length;t=a<=e?(r=window.jfgrid_function[i].p[a-1].detail,window.jfgrid_function[i].p[a-1].repeat):(r=window.jfgrid_function[i].p[e].detail,window.jfgrid_function[i].p[e].repeat),jfgrid.insertFormula.parmTxtShow($(this).val()),jfgrid.insertFormula.functionStrCompute(),$("#jfgrid-search-formula-parm .parmDetailsBox").empty();var n,o=$(this).parents(".parmBox").find(".name").text();$("<span>"+o+":</span><span>"+r+"</span>").appendTo($("#jfgrid-search-formula-parm .parmDetailsBox")),"y"!=t||(n=$("#jfgrid-search-formula-parm .parmBox").length)<5&&e==n-1&&$('<div class="parmBox"><div class="name">值'+(n+1)+'</div><div class="txt"><input class="formulaInputFocus" /><i class="fa fa-table" aria-hidden="true" title="点击选择数据范围"></i></div><div class="val">=</div></div>').appendTo($("#jfgrid-search-formula-parm .parmListBox"))}),$(document).off("blur.fxParamInput").on("blur.fxParamInput","#jfgrid-search-formula-parm .parmBox input",function(){var e=$(this).val();null!=jfgrid.formula.getfunctionParam(e).fn||jfgrid.formula.iscelldata(e)||!jfgrid.func_methods.isRealNum(e)&&""!=e&&e.length<=2&&0!=e.indexOf('"')&&0!=e.lastIndexOf('"')&&(e='"'+e+'"',$(this).val(e),jfgrid.insertFormula.parmTxtShow(e),jfgrid.insertFormula.functionStrCompute())}),$(document).off("keyup.fxParamInput").on("keyup.fxParamInput","#jfgrid-search-formula-parm .parmBox input",function(){jfgrid.insertFormula.parmTxtShow($(this).val()),jfgrid.insertFormula.functionStrCompute()}),$(document).off("click.fxParamI").on("click.fxParamI","#jfgrid-search-formula-parm .parmBox i",function(){jfgrid.formula.data_parm_index=$(this).parents(".parmBox").index(),$("#jfgrid-search-formula-parm").hide(),$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-search-formula-parm-select").remove(),""==$(this).parents(".parmBox").find(".txt input").val()?$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-search-formula-parm-select",addclass:"jfgrid-search-formula-parm-select",title:"选取数据范围",content:"<input id='jfgrid-search-formula-parm-select-input' class='jfgrid-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='数据范围' readonly='true' placeholder='数据范围'>",botton:'<button id="jfgrid-search-formula-parm-select-confirm" class="btn btn-primary">确认</button>',style:"z-index:100003"})):$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-search-formula-parm-select",addclass:"jfgrid-search-formula-parm-select",title:"选取数据范围",content:"<input id='jfgrid-search-formula-parm-select-input' class='jfgrid-datavisual-range-container' style='font-size: 14px;padding:5px;max-width:none;' spellcheck='false' aria-label='数据范围' readonly='true' value='"+$(this).parents(".parmBox").find(".txt input").val()+"'>",botton:'<button id="jfgrid-search-formula-parm-select-confirm" class="btn btn-primary">确认</button>',style:"z-index:100003"}));var e=$("#jfgrid-search-formula-parm-select").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),r=e.outerHeight(),t=e.outerWidth(),i=$(window).width(),a=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#jfgrid-search-formula-parm-select").css({left:(i+n-t)/2,top:(a+o-r)/3}).show(),jfgrid.insertFormula.parmTxtShow($(this).parents(".parmBox").find(".txt input").val())}),$(document).off("click.fxParamCf").on("click.fxParamCf","#jfgrid-search-formula-parm-confirm",function(){$("#jfgrid-wa-functionbox-confirm").click()}),$(document).off("click.fxParamSelectCf").on("click.fxParamSelectCf","#jfgrid-search-formula-parm-select-confirm",function(){var e=$("#jfgrid-search-formula-parm-select-input").attr("data_parm_index");$("#jfgrid-search-formula-parm-select").hide(),$("#jfgrid-search-formula-parm").show(),$("#jfgrid-search-formula-parm .parmBox").eq(e).find(".txt input").focus()})},formulaListDialog:function(){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-search-formula").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-search-formula",addclass:"jfgrid-search-formula",title:"",content:"<div class='inpbox'><label for='searchFormulaListInput'>查找函数：</label><input class='formulaInputFocus' id='searchFormulaListInput' placeholder='请输入您要查找的函数名称或函数功能的简要描述' spellcheck='false'/></div><div class='selbox'><label>或选择类别：</label><select id='formulaTypeSelect'><option value='0'>数学</option><option value='1'>统计</option><option value='2'>查找</option><option value='3'>兔表哥</option><option value='4'>数据挖掘</option><option value='5'>数据源</option><option value='6'>日期</option><option value='7'>过滤器</option><option value='8'>财务</option><option value='9'>工程计算</option><option value='10'>逻辑</option><option value='11'>运算符</option><option value='12'>文本</option><option value='13'>转换工具</option><option value='14'>数组</option><option value='-1'>其它</option></select></div><div class='listbox'><label>选择函数：</label><div id='formulaTypeList'></div></div>",botton:'<button id="jfgrid-search-formula-confirm" class="btn btn-primary">确认</button><button class="btn btn-default jfgrid-model-close-btn">取消</button>',style:"z-index:100003"}));var e=$("#jfgrid-search-formula").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),r=e.outerHeight(),t=e.outerWidth(),i=$(window).width(),a=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#jfgrid-search-formula").css({left:(i+n-t)/2,top:(a+o-r)/3,"user-select":"none"}).show(),jfgrid.insertFormula.formulaListByType("0"),$("#searchFormulaListInput").focus()},formulaListByType:function(e){$("#formulaTypeList").empty();for(var r=0;r<jfgrid.functionlist.length;r++)("-1"==e&&14<jfgrid.functionlist[r].t||jfgrid.functionlist[r].t==e)&&$('<div class="listBox" name="'+jfgrid.functionlist[r].n+'"><span>'+jfgrid.functionlist[r].n+"</span><span>"+jfgrid.functionlist[r].a+"</span></div>").appendTo($("#formulaTypeList"));$("#formulaTypeList .listBox:first-child").addClass("on")},formulaParmDialog:function(formula,parm){for(var parm_title="",parm_content="",parm_list_content="",i=0;i<jfgrid.functionlist.length;i++)if(jfgrid.functionlist[i].n==formula.toUpperCase()){parm_title=jfgrid.functionlist[i].n;for(var j=0;j<jfgrid.functionlist[i].p.length;j++)null==parm?parm_list_content+='<div class="parmBox"><div class="name">'+jfgrid.functionlist[i].p[j].name+'</div><div class="txt"><input class="formulaInputFocus" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="点击选择数据范围"></i></div><div class="val">=</div></div>':(null==parm[j]&&(parm[j]=""),parm_list_content+='<div class="parmBox"><div class="name">'+jfgrid.functionlist[i].p[j].name+'</div><div class="txt"><input class="formulaInputFocus" value="'+parm[j]+'" spellcheck="false"/><i class="fa fa-table" aria-hidden="true" title="点击选择数据范围"></i></div><div class="val">=</div></div>');parm_content='<div><div class="parmListBox">'+parm_list_content+'</div><div class="formulaDetails">'+jfgrid.functionlist[i].d+'</div><div class="parmDetailsBox"></div><div class="result">计算结果 = <span></span></div></div>'}$("#jfgrid-search-formula").hide(),$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-search-formula-parm").remove(),$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-search-formula-parm",addclass:"jfgrid-search-formula-parm",title:parm_title,content:parm_content,botton:'<button id="jfgrid-search-formula-parm-confirm" class="btn btn-primary">确认</button><button class="btn btn-default jfgrid-model-close-btn">取消</button>',style:"z-index:100003"}));var $t=$("#jfgrid-search-formula-parm").find(".jfgrid-modal-dialog-content").css("min-width",300).end(),myh=$t.outerHeight(),myw=$t.outerWidth(),winw=$(window).width(),winh=$(window).height(),scrollLeft=$(document).scrollLeft(),scrollTop=$(document).scrollTop();$("#jfgrid-search-formula-parm").css({left:(winw+scrollLeft-myw)/2,top:(winh+scrollTop-myh)/3}).show(),$("#jfgrid-search-formula-parm .parmBox:eq(0) input").focus(),$("#jfgrid-search-formula-parm .parmBox").each(function(index,e){var parmtxt=$(e).find(".txt input").val();if(null==jfgrid.formula.getfunctionParam(parmtxt).fn)if(jfgrid.formula.iscelldata(parmtxt)){var txtdata=window.jfgrid_getcelldata(parmtxt).data;if("array"==jfgrid.getObjType(txtdata)){for(var txtArr=[],i=0;i<txtdata.length;i++)for(var j=0;j<txtdata[i].length;j++){var cell=txtdata[i][j];null==cell||jfgrid.func_methods.isRealNull(cell.v)?txtArr.push(null):txtArr.push(cell.v)}$("#jfgrid-search-formula-parm .parmBox").eq(index).find(".val").text(" = {"+txtArr.join(",")+"}")}else $("#jfgrid-search-formula-parm .parmBox").eq(index).find(".val").text(" = {"+txtdata.v+"}")}else $("#jfgrid-search-formula-parm .parmBox").eq(index).find(".val").text(" = {"+parmtxt+"}");else $("#jfgrid-search-formula-parm .parmBox").eq(index).find(".val").text(" = {"+eval($.trim(jfgrid.formula.functionParser("="+parmtxt)))+"}")}),$("#jfgrid-formula-functionrange .jfgrid-formula-functionrange-highlight").remove(),jfgrid.formula.data_parm_index=0,jfgrid.formula.rangestart=!0},parmTxtShow:function(parmtxt){if(null==jfgrid.formula.getfunctionParam(parmtxt).fn)if(jfgrid.formula.iscelldata(parmtxt)){var cellrange=jfgrid.formula.getcellrange(parmtxt),r1=cellrange.row[0],r2=cellrange.row[1],c1=cellrange.column[0],c2=cellrange.column[1],row=visibledatarow[r2],row_pre=r1-1==-1?0:visibledatarow[r1-1],col=visibledatacolumn[c2],col_pre=c1-1==-1?0:visibledatacolumn[c1-1];$("#jfgrid-formula-functionrange-select").css({left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1}).show(),$("#jfgrid-formula-help-c").hide(),jfgrid.jfgrid_count_show(col_pre,row_pre,col-col_pre-1,row-row_pre-1,cellrange.row,cellrange.column);var txtdata=window.jfgrid_getcelldata(parmtxt).data;if("array"==jfgrid.getObjType(txtdata)){for(var txtArr=[],i=0;i<txtdata.length;i++)for(var j=0;j<txtdata[i].length;j++){var cell=txtdata[i][j];null==cell||jfgrid.func_methods.isRealNull(cell.v)?txtArr.push(null):txtArr.push(cell.v)}$("#jfgrid-search-formula-parm .parmBox").eq(jfgrid.formula.data_parm_index).find(".val").text(" = {"+txtArr.join(",")+"}")}else $("#jfgrid-search-formula-parm .parmBox").eq(jfgrid.formula.data_parm_index).find(".val").text(" = {"+txtdata.v+"}")}else $("#jfgrid-search-formula-parm .parmBox").eq(jfgrid.formula.data_parm_index).find(".val").text(" = {"+parmtxt+"}"),$("#jfgrid-formula-functionrange-select").hide();else{for(var txt,k=0;k<jfgrid.formula.getfunctionParam(parmtxt).param.length;k++)if(jfgrid.formula.iscelldata(jfgrid.formula.getfunctionParam(parmtxt).param[k])){txt=jfgrid.formula.getfunctionParam(parmtxt).param[k];break}var cellrange=jfgrid.formula.getcellrange(txt),r1=cellrange.row[0],r2=cellrange.row[1],c1=cellrange.column[0],c2=cellrange.column[1],row=visibledatarow[r2],row_pre=r1-1==-1?0:visibledatarow[r1-1],col=visibledatacolumn[c2],col_pre=c1-1==-1?0:visibledatacolumn[c1-1];$("#jfgrid-formula-functionrange-select").css({left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1}).show(),$("#jfgrid-formula-help-c").hide(),jfgrid.jfgrid_count_show(col_pre,row_pre,col-col_pre-1,row-row_pre-1,cellrange.row,cellrange.column),$("#jfgrid-search-formula-parm .parmBox").eq(jfgrid.formula.data_parm_index).find(".val").text(" = {"+eval($.trim(jfgrid.formula.functionParser("="+parmtxt)))+"}")}},functionStrCompute:function(){var isVal=!0,parmValArr=[],lvi=-1,formulatxt=$("#jfgrid-search-formula-parm").find(".jfgrid-modal-dialog-title-text").text();if($("#jfgrid-search-formula-parm .parmBox").each(function(e,r){var t=$(r).find(".txt input").val(),i=window.jfgrid_function[formulatxt].p[e].require;""==t&&"m"==i&&(isVal=!1),""!=t&&(lvi=e)}),-1==lvi)var functionHtmlTxt="="+$("#jfgrid-search-formula-parm .jfgrid-modal-dialog-title-text").text()+"()";else if(0==lvi)var functionHtmlTxt="="+$("#jfgrid-search-formula-parm .jfgrid-modal-dialog-title-text").text()+"("+$("#jfgrid-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(var j=0;j<=lvi;j++)parmValArr.push($("#jfgrid-search-formula-parm .parmBox").eq(j).find(".txt input").val());var functionHtmlTxt="="+$("#jfgrid-search-formula-parm .jfgrid-modal-dialog-title-text").text()+"("+parmValArr.join(",")+")"}var function_str=jfgrid.formula.functionHTMLGenerate(functionHtmlTxt);if($("#jfgrid-rich-text-editor").html(function_str),$("#jfgrid-functionbox-cell").html($("#jfgrid-rich-text-editor").html()),isVal){var fp=$.trim(jfgrid.formula.functionParser($("#jfgrid-rich-text-editor").text())),result=null;try{result=eval(fp)}catch(e){result=jfgrid.formula.error.n}$("#jfgrid-search-formula-parm .result span").text(result)}}},jfgrid.dropCell={iconHtml:'<div id="jfgrid-dropCell-icon" style="position: absolute;padding: 2px;background-color: #f1f1f1;z-index: 990;cursor: pointer;"><div id="icon_dropCell"></div></div>',typeListHtml:'<div id="jfgrid-dropCell-typeList" class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="0"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>复制单元格</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="1"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>填充序列</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="2"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>仅填充格式</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="3"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>不带格式填充</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="4"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>以天数填充</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="5"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>以工作日填充</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="6"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>以月填充</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="7"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>以年填充</div></div><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" data-type="8"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 2px;"><span style="margin-right:5px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span>以中文小写数字填充</div></div></div>',copyRange:{},applyRange:{},applyType:null,direction:null,chnNumChar:{"零":0,"一":1,"二":2,"三":3,"四":4,"五":5,"六":6,"七":7,"八":8,"九":9},chnNameValue:{"十":{value:10,secUnit:!1},"百":{value:100,secUnit:!1},"千":{value:1e3,secUnit:!1},"万":{value:1e4,secUnit:!0},"亿":{value:1e8,secUnit:!0}},ChineseToNumber:function(e){for(var r=0,t=0,i=0,a=e.split(""),n=0;n<a.length;n++){var o,l=jfgrid.dropCell.chnNumChar[a[n]];void 0!==l?(i=l,n==a.length-1&&(t+=i)):(o=jfgrid.dropCell.chnNameValue[a[n]].value,jfgrid.dropCell.chnNameValue[a[n]].secUnit?(r+=t=(t+i)*o,t=0):t+=i*o,i=0)}return r+t},chnNumChar2:["零","一","二","三","四","五","六","七","八","九"],chnUnitSection:["","万","亿","万亿","亿亿"],chnUnitChar:["","十","百","千"],SectionToChinese:function(e){for(var r="",t="",i=0,a=!0;0<e;){var n=e%10;0==n?a||(a=!0,t=jfgrid.dropCell.chnNumChar2[n]+t):(a=!1,r=jfgrid.dropCell.chnNumChar2[n],t=(r+=jfgrid.dropCell.chnUnitChar[i])+t),i++,e=Math.floor(e/10)}return t},NumberToChinese:function(e){var r=0,t="",i="",a=!1;if(0==e)return jfgrid.dropCell.chnNumChar2[0];for(;0<e;){var n=e%1e4;a&&(i=jfgrid.dropCell.chnNumChar2[0]+i),t=jfgrid.dropCell.SectionToChinese(n),i=(t+=0!=n?jfgrid.dropCell.chnUnitSection[r]:jfgrid.dropCell.chnUnitSection[0])+i,a=n<1e3&&0<n,e=Math.floor(e/1e4),r++}return i},isChnNumber:function(e){var r=!0;if(1==e.length)r="日"==e||e in jfgrid.dropCell.chnNumChar;else for(var t=e.split(""),i=0;i<t.length;i++)if(!(t[i]in jfgrid.dropCell.chnNumChar||t[i]in jfgrid.dropCell.chnNameValue)){r=!1;break}return r},isExtendNumber:function(e){var r,t=/[0-9]/;if(r=!!t.test(e.substr(e.length-1,1))){var i=e.split("");i.reverse();for(var a=0,n=0;n<i.length;n++)if(!t.test(i[n])){a=n;break}return[r,e.substr(0,e.length-a),e.substr(e.length-a,a)]}return[r]},isChnWeek1:function(e){return 1==e.length&&("日"==e||jfgrid.dropCell.ChineseToNumber(e)<7)},isChnWeek2:function(e){return 2==e.length&&("周一"==e||"周二"==e||"周三"==e||"周四"==e||"周五"==e||"周六"==e||"周日"==e)},isChnWeek3:function(e){return 3==e.length&&("星期一"==e||"星期二"==e||"星期三"==e||"星期四"==e||"星期五"==e||"星期六"==e||"星期日"==e)},createIcon:function(){var e,r,t=jfgrid.dropCell.copyRange.row[1],i=jfgrid.dropCell.copyRange.column[1],a=jfgrid.dropCell.applyRange.row[1],n=jfgrid.dropCell.applyRange.column[1];r=t<=a&&i<=n?(e=a,n):(e=t,i);var o=jfgrid.rowLocationByIndex(e)[1],l=(jfgrid.rowLocationByIndex(e)[0],jfgrid.colLocationByIndex(r)[1]);jfgrid.colLocationByIndex(r)[0];$("#jfgrid-dropCell-icon").remove(),$("#jfgrid-cell-main").append(jfgrid.dropCell.iconHtml),$("#jfgrid-dropCell-icon").css({left:l,top:o}),$("#jfgrid-dropCell-icon").mouseover(function(){$(this).css("background-color","#ffe8e8")}).mouseleave(function(){$(this).css("background-color","#f1f1f1")}).mousedown(function(e){$("#jfgrid-dropCell-typeList").remove(),$("body").append(jfgrid.dropCell.typeListHtml);var r=jfgrid.dropCell.typeItemHide();r[0]||r[1]||r[2]||r[3]||r[4]||r[5]||r[6]||($("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=1]").hide(),$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=4]").hide(),$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=5]").hide(),$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=6]").hide(),$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=7]").hide(),$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=8]").hide()),r[2]||($("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=4]").hide(),$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=5]").hide(),$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=6]").hide(),$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=7]").hide()),r[3]||$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type=8]").hide();var t=$(this).offset().left,i=$(this).offset().top+25,a=$(window).height(),n=$(window).width(),o=$("#jfgrid-dropCell-typeList").width(),l=$("#jfgrid-dropCell-typeList").height();n<t+o&&(t-=o),a<i+l&&(i=i-l-38),i<0&&(i=0),$("#jfgrid-dropCell-typeList").css({left:t,top:i}).show(),$("#jfgrid-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#ffe8e8")});var d=jfgrid.dropCell.applyType;$("#jfgrid-dropCell-typeList .jfgrid-cols-menuitem[data-type="+d+"]").find("span").append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>'),e.stopPropagation()}),$(document).off("click.dCtypeList").on("click.dCtypeList","#jfgrid-dropCell-typeList .jfgrid-cols-menuitem",function(){$("#jfgrid-dropCell-typeList .fa-check").remove(),$(this).find("span").append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>');var e=$(this).attr("data-type");jfgrid.dropCell.applyType=e,jfgrid.dropCell.update(),$("#jfgrid-dropCell-typeList").hide(),$("#jfgrid-dropCell-icon").css("backgroundColor","#f1f1f1"),$("#jfgrid-dropCell-icon").mouseleave(function(){$(this).css("backgroundColor","#f1f1f1")}),jfgrid.jfcountfunc()})},typeItemHide:function(){for(var e=jfgrid.dropCell.copyRange,r=e.row[0],t=e.row[1],i=e.column[0],a=e.column[1],n=!1,o=!1,l=!1,d=!1,f=!1,s=!1,g=!1,c=r;c<=t;c++)for(var u,m=i;m<=a;m++){jfgrid.flowdata[c][m]&&(u=jfgrid.flowdata[c][m],"object"==jfgrid.getObjType(u)&&null!=u.v&&null==u.f&&(null!=u.ct&&"n"==u.ct.t?n=!0:null!=u.ct&&"d"==u.ct.t?l=!0:jfgrid.dropCell.isExtendNumber(u.m)[0]?o=!0:jfgrid.dropCell.isChnNumber(u.m)&&"日"!=u.m?d=!0:"日"==u.m?f=!0:jfgrid.dropCell.isChnWeek2(u.m)?s=!0:jfgrid.dropCell.isChnWeek3(u.m)&&(g=!0)))}return[n,o,l,d,f,s,g]},update:function(){var e,r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),t=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)],i=$.extend(!0,{},config),a=jfgrid.getBorderInfoCompute(),n=jfgrid.dropCell.direction,o=(jfgrid.dropCell.applyType,jfgrid.dropCell.copyRange),l=o.row[0],d=o.row[1],f=o.column[0],s=o.column[1],g=jfgrid.dropCell.getCopyData(r,l,d,f,s,n);"down"==n||"up"==n?e=d-l+1:"right"!=n&&"left"!=n||(e=s-f+1);var c=jfgrid.dropCell.applyRange,u=c.row[0],m=c.row[1],h=c.column[0],j=c.column[1];if("down"==n||"up"==n)for(var p=m-u+1,v=h;v<=j;v++){var b=g[v-h],_=jfgrid.dropCell.getApplyData(b,e,p);if("down"==n)for(var w=u;w<=m;w++){null!=(y=_[w-u]).f&&(x="="+jfgrid.formula.functionCopy(y.f,"down",w-u+1),C=jfgrid.formula.execfunction(x,w,v,!0),y.f=C[2],y.v=C[1],null!=y.spl?y.spl=C[3].data:jfgrid.func_methods.isRealNum(y.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(y.v)?(y.v==1/0||y.v==-1/0?y.m=y.v.toString():-1<y.v.toString().indexOf("e")?(5<(T=y.v.toString().split(".")[1].split("e")[0].length)&&(T=5),y.m=y.v.toExponential(T).toString()):(I=jfgrid.mask.genarate(Math.round(1e9*y.v)/1e9),y.m=I[0].toString()),y.ct={fa:"General",t:"n"}):(I=jfgrid.mask.genarate(y.v),y.m=I[0].toString(),y.ct=I[1])),r[w][v]=y,a[(R=l+(w-u)%e)+"_"+(k=v)]?(S={rangeType:"cell",value:{row_index:w,col_index:v,l:a[R+"_"+k].l,r:a[R+"_"+k].r,t:a[R+"_"+k].t,b:a[R+"_"+k].b}},i.borderInfo.push(S)):a[w+"_"+v]&&(S={rangeType:"cell",value:{row_index:w,col_index:v,l:null,r:null,t:null,b:null}},i.borderInfo.push(S))}if("up"==n)for(w=m;u<=w;w--){null!=(y=_[m-w]).f&&(x="="+jfgrid.formula.functionCopy(y.f,"up",m-w+1),C=jfgrid.formula.execfunction(x,w,v,!0),y.f=C[2],y.v=C[1],null!=y.spl?y.spl=C[3].data:jfgrid.func_methods.isRealNum(y.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(y.v)?(y.v==1/0||y.v==-1/0?y.m=y.v.toString():-1<y.v.toString().indexOf("e")?(5<(T=y.v.toString().split(".")[1].split("e")[0].length)&&(T=5),y.m=y.v.toExponential(T).toString()):(I=jfgrid.mask.genarate(Math.round(1e9*y.v)/1e9),y.m=I[0].toString()),y.ct={fa:"General",t:"n"}):(I=jfgrid.mask.genarate(y.v),y.m=I[0].toString(),y.ct=I[1])),r[w][v]=y,a[(R=d-(m-w)%e)+"_"+(k=v)]?(S={rangeType:"cell",value:{row_index:w,col_index:v,l:a[R+"_"+k].l,r:a[R+"_"+k].r,t:a[R+"_"+k].t,b:a[R+"_"+k].b}},i.borderInfo.push(S)):a[w+"_"+v]&&(S={rangeType:"cell",value:{row_index:w,col_index:v,l:null,r:null,t:null,b:null}},i.borderInfo.push(S))}}else if("right"==n||"left"==n)for(p=j-h+1,v=u;v<=m;v++){b=g[v-u],_=jfgrid.dropCell.getApplyData(b,e,p);if("right"==n)for(w=h;w<=j;w++){null!=(y=_[w-h]).f&&(x="="+jfgrid.formula.functionCopy(y.f,"right",w-h+1),C=jfgrid.formula.execfunction(x,v,w,!0),y.f=C[2],y.v=C[1],null!=y.spl?y.spl=C[3].data:jfgrid.func_methods.isRealNum(y.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(y.v)?(y.v==1/0||y.v==-1/0?y.m=y.v.toString():-1<y.v.toString().indexOf("e")?(5<(T=y.v.toString().split(".")[1].split("e")[0].length)&&(T=5),y.m=y.v.toExponential(T).toString()):(I=jfgrid.mask.genarate(Math.round(1e9*y.v)/1e9),y.m=I[0].toString()),y.ct={fa:"General",t:"n"}):(I=jfgrid.mask.genarate(y.v),y.m=I[0].toString(),y.ct=I[1])),r[v][w]=y,a[(R=v)+"_"+(k=f+(w-h)%e)]?(S={rangeType:"cell",value:{row_index:v,col_index:w,l:a[R+"_"+k].l,r:a[R+"_"+k].r,t:a[R+"_"+k].t,b:a[R+"_"+k].b}},i.borderInfo.push(S)):a[v+"_"+w]&&(S={rangeType:"cell",value:{row_index:v,col_index:w,l:null,r:null,t:null,b:null}},i.borderInfo.push(S))}if("left"==n)for(var y,x,C,T,I,R,k,S,w=j;h<=w;w--){null!=(y=_[j-w]).f&&(x="="+jfgrid.formula.functionCopy(y.f,"left",j-w+1),C=jfgrid.formula.execfunction(x,v,w,!0),y.f=C[2],y.v=C[1],null!=y.spl?y.spl=C[3].data:jfgrid.func_methods.isRealNum(y.v)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(y.v)?(y.v==1/0||y.v==-1/0?y.m=y.v.toString():-1<y.v.toString().indexOf("e")?(5<(T=y.v.toString().split(".")[1].split("e")[0].length)&&(T=5),y.m=y.v.toExponential(T).toString()):(I=jfgrid.mask.genarate(Math.round(1e9*y.v)/1e9),y.m=I[0].toString()),y.ct={fa:"General",t:"n"}):(I=jfgrid.mask.genarate(y.v),y.m=I[0].toString(),y.ct=I[1])),r[v][w]=y,a[(R=v)+"_"+(k=s-(j-w)%e)]?(S={rangeType:"cell",value:{row_index:v,col_index:w,l:a[R+"_"+k].l,r:a[R+"_"+k].r,t:a[R+"_"+k].t,b:a[R+"_"+k].b}},i.borderInfo.push(S)):a[v+"_"+w]&&(S={rangeType:"cell",value:{row_index:v,col_index:w,l:null,r:null,t:null,b:null}},i.borderInfo.push(S))}}var A=$.extend(!0,[],t.jfgrid_conditionformat_save);if(null!=A&&0<A.length)for(v=0;v<A.length;v++){for(var F=A[v].cellrange,N=[],w=0;w<F.length;w++){var M=jfgrid.conditionformat.CFSplitRange(F[w],{row:o.row,column:o.column},{row:c.row,column:c.column},"operatePart");0<M.length&&(N=N.concat(M))}0<N.length&&A[v].cellrange.push(c)}jfgrid.jfrefreshgrid(r,jfgird_select_save,i,A),jfgrid.selectHightlightShow()},getCopyData:function(e,r,t,i,a,n){var o,l,d,f,s=[];"down"==n||"up"==n?(o=i,l=a,d=r,f=t):"right"!=n&&"left"!=n||(o=r,l=t,d=i,f=a);for(var g=o;g<=l;g++){for(var c,u,m={},h=[],j=[],p="",v=null,b=!0,_=d;_<=f;_++){"down"==n||"up"==n?c=e[_][g]:"right"!=n&&"left"!=n||(c=e[g][_]),c&&c.v&&null==c.f?c.ct&&"n"==c.ct.t?(u="number",v=null):c.ct&&"d"==c.ct.t?(u="date",v=null):jfgrid.dropCell.isExtendNumber(c.m)[0]?(u="extendNumber",null==v?(b=!0,v=jfgrid.dropCell.isExtendNumber(c.m)[1]):jfgrid.dropCell.isExtendNumber(c.m)[1]!=v?(b=!1,v=jfgrid.dropCell.isExtendNumber(c.m)[1]):b=!0):v=(u=jfgrid.dropCell.isChnNumber(c.m)?"chnNumber":jfgrid.dropCell.isChnWeek2(c.m)?"chnWeek2":jfgrid.dropCell.isChnWeek3(c.m)?"chnWeek3":"other",null):(u="other",v=null),"extendNumber"==u?_==d?d==f?(p=u,h.push(c),j.push(_-d+1),m[p]=[],m[p].push({data:h,index:j})):(p=u,h.push(c),j.push(_-d+1)):_==f?(p==u&&b?(h.push(c),j.push(_-d+1)):(p in m||(m[p]=[]),m[p].push({data:h,index:j}),p=u,(h=[]).push(c),(j=[]).push(_-d+1)),p in m||(m[p]=[]),m[p].push({data:h,index:j})):p==u&&b?(h.push(c),j.push(_-d+1)):(p in m||(m[p]=[]),m[p].push({data:h,index:j}),p=u,(h=[]).push(c),(j=[]).push(_-d+1)):_==d?d==f?(p=u,h.push(c),j.push(_-d+1),m[p]=[],m[p].push({data:h,index:j})):(p=u,h.push(c),j.push(_-d+1)):_==f?(p==u?(h.push(c),j.push(_-d+1)):(p in m||(m[p]=[]),m[p].push({data:h,index:j}),p=u,(h=[]).push(c),(j=[]).push(_-d+1)),p in m||(m[p]=[]),m[p].push({data:h,index:j})):p==u?(h.push(c),j.push(_-d+1)):(p in m||(m[p]=[]),m[p].push({data:h,index:j}),p=u,(h=[]).push(c),(j=[]).push(_-d+1))}s.push(m)}return s},getApplyData:function(e,r,t){var i=[],a=jfgrid.dropCell.direction,n=jfgrid.dropCell.applyType,o=Math.floor(t/r),l=t%r,d=e.number,f=[];if(d)for(var s=0;s<d.length;s++){var g=jfgrid.dropCell.getLenS(d[s].index,l),c=d[s].index.length*o+g;I="1"==n||"3"==n?jfgrid.dropCell.getDataByType(d[s].data,c,a,n,"number"):"2"==n?jfgrid.dropCell.getDataByType(d[s].data,c,a,n):jfgrid.dropCell.getDataByType(d[s].data,c,a,"0");var u=jfgrid.dropCell.getDataIndex(r,t,d[s].index);f.push({data:I,index:u})}var m=e.extendNumber,h=[];if(m)for(s=0;s<m.length;s++){g=jfgrid.dropCell.getLenS(m[s].index,l),c=m[s].index.length*o+g;I="1"==n||"3"==n?jfgrid.dropCell.getDataByType(m[s].data,c,a,n,"extendNumber"):"2"==n?jfgrid.dropCell.getDataByType(m[s].data,c,a,n):jfgrid.dropCell.getDataByType(m[s].data,c,a,"0");u=jfgrid.dropCell.getDataIndex(r,t,m[s].index);h.push({data:I,index:u})}var j=e.date,p=[];if(j)for(s=0;s<j.length;s++){g=jfgrid.dropCell.getLenS(j[s].index,l),c=j[s].index.length*o+g;I="1"==n||"3"==n?jfgrid.dropCell.getDataByType(j[s].data,c,a,n,"date"):"8"==n?jfgrid.dropCell.getDataByType(j[s].data,c,a,"0"):jfgrid.dropCell.getDataByType(j[s].data,c,a,n);u=jfgrid.dropCell.getDataIndex(r,t,j[s].index);p.push({data:I,index:u})}var v=e.chnNumber,b=[];if(v)for(s=0;s<v.length;s++){g=jfgrid.dropCell.getLenS(v[s].index,l),c=v[s].index.length*o+g;I="1"==n||"3"==n?jfgrid.dropCell.getDataByType(v[s].data,c,a,n,"chnNumber"):"2"==n||"8"==n?jfgrid.dropCell.getDataByType(v[s].data,c,a,n):jfgrid.dropCell.getDataByType(v[s].data,c,a,"0");u=jfgrid.dropCell.getDataIndex(r,t,v[s].index);b.push({data:I,index:u})}var _=e.chnWeek2,w=[];if(_)for(s=0;s<_.length;s++){g=jfgrid.dropCell.getLenS(_[s].index,l),c=_[s].index.length*o+g;I="1"==n||"3"==n?jfgrid.dropCell.getDataByType(_[s].data,c,a,n,"chnWeek2"):"2"==n?jfgrid.dropCell.getDataByType(_[s].data,c,a,n):jfgrid.dropCell.getDataByType(_[s].data,c,a,"0");u=jfgrid.dropCell.getDataIndex(r,t,_[s].index);w.push({data:I,index:u})}var y=e.chnWeek3,x=[];if(y)for(s=0;s<y.length;s++){g=jfgrid.dropCell.getLenS(y[s].index,l),c=y[s].index.length*o+g;I="1"==n||"3"==n?jfgrid.dropCell.getDataByType(y[s].data,c,a,n,"chnWeek3"):"2"==n?jfgrid.dropCell.getDataByType(y[s].data,c,a,n):jfgrid.dropCell.getDataByType(y[s].data,c,a,"0");u=jfgrid.dropCell.getDataIndex(r,t,y[s].index);x.push({data:I,index:u})}var C=e.other,T=[];if(C)for(s=0;s<C.length;s++){var I,g=jfgrid.dropCell.getLenS(C[s].index,l),c=C[s].index.length*o+g;I="2"==n||"3"==n?jfgrid.dropCell.getDataByType(C[s].data,c,a,n):jfgrid.dropCell.getDataByType(C[s].data,c,a,"0");u=jfgrid.dropCell.getDataIndex(r,t,C[s].index);T.push({data:I,index:u})}for(var $=1;$<=t;$++){if(0<f.length)for(var R=0;R<f.length;R++)$ in f[R].index&&i.push(f[R].data[f[R].index[$]]);if(0<h.length)for(R=0;R<h.length;R++)$ in h[R].index&&i.push(h[R].data[h[R].index[$]]);if(0<p.length)for(R=0;R<p.length;R++)$ in p[R].index&&i.push(p[R].data[p[R].index[$]]);if(0<b.length)for(R=0;R<b.length;R++)$ in b[R].index&&i.push(b[R].data[b[R].index[$]]);if(0<w.length)for(R=0;R<w.length;R++)$ in w[R].index&&i.push(w[R].data[w[R].index[$]]);if(0<x.length)for(R=0;R<x.length;R++)$ in x[R].index&&i.push(x[R].data[x[R].index[$]]);if(0<T.length)for(R=0;R<T.length;R++)$ in T[R].index&&i.push(T[R].data[T[R].index[$]])}return i},getLenS:function(e,r){for(var t=0,i=0;i<e.length&&e[i]<=r;i++)t++;return t},getDataIndex:function(e,r,t){var i={},a=Math.floor(r/e),n=r%e,o=0;if(0<a){for(var l=1;l<=a;l++)for(var d=0;d<t.length;d++)i[t[d]+(l-1)*e]=o,o++;for(var f=0;f<t.length&&t[f]<=n;f++)i[t[f]+e*a]=o,o++}else for(f=0;f<t.length&&t[f]<=n;f++)i[t[f]]=o,o++;return i},getDataByType:function(e,r,t,i,a){var n,o,l,d,f=[];if("0"==i)"up"!=t&&"left"!=t||e.reverse(),f=jfgrid.dropCell.FillCopy(e,r);else if("1"==i)if("number"==a)f=jfgrid.dropCell.FillSeries(e,r,t);else if("extendNumber"==a)if(1==e.length){"down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),f=jfgrid.dropCell.FillExtendNumber(e,r,_)}else{for(var s=[],g=0;g<e.length;g++){var c=e[g].m;s.push(Number(jfgrid.dropCell.isExtendNumber(c)[2]))}"up"!=t&&"left"!=t||(e.reverse(),s.reverse()),f=jfgrid.dropCell.isEqualDiff(s)?(_=s[1]-s[0],jfgrid.dropCell.FillExtendNumber(e,r,_)):jfgrid.dropCell.FillCopy(e,r)}else if("date"==a){f=1==e.length?("down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),jfgrid.dropCell.FillDays(e,r,_)):("up"!=t&&"left"!=t||e.reverse(),(l=jfgrid.dropCell.judgeDate(e))[0]&&l[3]?(_=moment(e[1].m).diff(moment(e[0].m),"months"),jfgrid.dropCell.FillMonths(e,r,_)):!l[0]&&l[2]?(_=moment(e[1].m).diff(moment(e[0].m),"days"),jfgrid.dropCell.FillDays(e,r,_)):jfgrid.dropCell.FillCopy(e,r))}else if("chnNumber"==a)if(1==e.length){f="日"==e[0].m||jfgrid.dropCell.ChineseToNumber(e[0].m)<7?("down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),jfgrid.dropCell.FillChnWeek(e,r,_)):("down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),jfgrid.dropCell.FillChnNumber(e,r,_))}else{for(var u=!1,g=0;g<e.length;g++)if("日"==e[g].m){u=!0;break}for(var s=[],m=0,g=0;g<e.length;g++)"日"==e[g].m?0==g?s.push(0):(m++,s.push(7*m)):u&&0<jfgrid.dropCell.ChineseToNumber(e[g].m)&&jfgrid.dropCell.ChineseToNumber(e[g].m)<7?s.push(jfgrid.dropCell.ChineseToNumber(e[g].m)+7*m):s.push(jfgrid.dropCell.ChineseToNumber(e[g].m));"up"!=t&&"left"!=t||(e.reverse(),s.reverse()),f=jfgrid.dropCell.isEqualDiff(s)?u||s[s.length-1]<6&&0<s[0]||s[0]<6&&0<s[s.length-1]?(_=s[1]-s[0],jfgrid.dropCell.FillChnWeek(e,r,_)):(_=s[1]-s[0],jfgrid.dropCell.FillChnNumber(e,r,_)):jfgrid.dropCell.FillCopy(e,r)}else if("chnWeek2"==a)if(1==e.length){"down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),f=jfgrid.dropCell.FillChnWeek2(e,r,_)}else{for(s=[],m=0,g=0;g<e.length;g++){var h=e[g].m.substr(e[g].m.length-1,1);"周日"==e[g].m?0==g?s.push(0):(m++,s.push(7*m)):s.push(jfgrid.dropCell.ChineseToNumber(h)+7*m)}"up"!=t&&"left"!=t||(e.reverse(),s.reverse()),f=jfgrid.dropCell.isEqualDiff(s)?(_=s[1]-s[0],jfgrid.dropCell.FillChnWeek2(e,r,_)):jfgrid.dropCell.FillCopy(e,r)}else if("chnWeek3"==a)if(1==e.length){"down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),f=jfgrid.dropCell.FillChnWeek3(e,r,_)}else{for(s=[],m=0,g=0;g<e.length;g++){h=e[g].m.substr(e[g].m.length-1,1);"星期日"==e[g].m?0==g?s.push(0):(m++,s.push(7*m)):s.push(jfgrid.dropCell.ChineseToNumber(h)+7*m)}"up"!=t&&"left"!=t||(e.reverse(),s.reverse()),f=jfgrid.dropCell.isEqualDiff(s)?(_=s[1]-s[0],jfgrid.dropCell.FillChnWeek3(e,r,_)):jfgrid.dropCell.FillCopy(e,r)}else"up"!=t&&"left"!=t||e.reverse(),f=jfgrid.dropCell.FillCopy(e,r);else if("2"==i)"up"!=t&&"left"!=t||e.reverse(),f=jfgrid.dropCell.FillOnlyFormat(e,r);else if("3"==i){var j=jfgrid.dropCell.getDataByType(e,r,t,"1",a);f=jfgrid.dropCell.FillWithoutFormat(j)}else if("4"==i){f=1==e.length?("down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),jfgrid.dropCell.FillDays(e,r,_)):2==e.length?("up"!=t&&"left"!=t||e.reverse(),_=moment(e[1].m).diff(moment(e[0].m),"days"),jfgrid.dropCell.FillDays(e,r,_)):("up"!=t&&"left"!=t||e.reverse(),(l=jfgrid.dropCell.judgeDate(e))[0]&&l[3]?(_=moment(e[1].m).diff(moment(e[0].m),"months"),jfgrid.dropCell.FillMonths(e,r,_)):!l[0]&&l[2]?(_=moment(e[1].m).diff(moment(e[0].m),"days"),jfgrid.dropCell.FillDays(e,r,_)):jfgrid.dropCell.FillCopy(e,r))}else if("5"==i)if(1==e.length){"down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1);for(var p=Math.round(1.5*r),g=1;g<=p;g++){var v=$.extend(!0,{},e[0]);if(0!=(x=moment(v.m).add(g,"days").day())&&6!=x){var b=moment(v.m).add(_*g,"days").format("YYYY-MM-DD");if(v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v),f.length==r)break}}}else if(2==e.length)if(moment(e[1].m).date()==moment(e[0].m).date()&&0!=moment(e[1].m).diff(moment(e[0].m),"months")){"up"!=t&&"left"!=t||e.reverse();for(var _=moment(e[1].m).diff(moment(e[0].m),"months"),g=1;g<=r;g++){var w=(g-1)%e.length,v=$.extend(!0,{},e[w]);b=0==(x=moment(e[e.length-1]).add(_*g,"months").day())?moment(e[e.length-1]).add(_*g,"months").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(e[e.length-1]).add(_*g,"months").subtract(1,"days").format("YYYY-MM-DD"):moment(e[e.length-1]).add(_*g,"months").format("YYYY-MM-DD"),v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else if(7<Math.abs(moment(e[1].m).diff(moment(e[0].m)))){"down"==t||"right"==t?o=1:"up"!=t&&"left"!=t||(o=-1,e.reverse());for(g=1;g<=r;g++){var w=(g-1)%e.length,v=$.extend(!0,{},e[w]),y=Math.ceil(g/e.length);0==w&&(_=moment(v.m).add(o*y,"months").diff(moment(v.m),"days")),b=0==(x=moment(v.m).add(_,"days").day())?moment(v.m).add(_,"days").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(v.m).add(_,"days").subtract(1,"days").format("YYYY-MM-DD"):moment(v.m).add(_,"days").format("YYYY-MM-DD"),v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else{"down"==t||"right"==t?n=7:"up"!=t&&"left"!=t||(n=-7,e.reverse());for(g=1;g<=r;g++){w=(g-1)%e.length,v=$.extend(!0,{},e[w]),y=Math.ceil(g/e.length);0==w&&(_=moment(v.m).add(n*y,"days").diff(moment(v.m),"days")),b=0==(x=moment(v.m).add(_,"days").day())?moment(v.m).add(_,"days").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(v.m).add(_,"days").subtract(1,"days").format("YYYY-MM-DD"):moment(v.m).add(_,"days").format("YYYY-MM-DD"),v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else{if((l=jfgrid.dropCell.judgeDate(e))[0]&&l[3]){"up"!=t&&"left"!=t||e.reverse();for(var _=moment(e[1].m).diff(moment(e[0].m),"months"),g=1;g<=r;g++){w=(g-1)%e.length,v=$.extend(!0,{},e[w]);b=0==(x=moment(e[e.length-1].m).add(_*g,"months").day())?moment(e[e.length-1].m).add(_*g,"months").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(e[e.length-1].m).add(_*g,"months").subtract(1,"days").format("YYYY-MM-DD"):moment(e[e.length-1].m).add(_*g,"months").format("YYYY-MM-DD"),v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else if(!l[0]&&l[2])if(7<Math.abs(moment(e[1].m).diff(moment(e[0].m)))){"down"==t||"right"==t?o=1:"up"!=t&&"left"!=t||(o=-1,e.reverse());for(g=1;g<=r;g++){w=(g-1)%e.length,v=$.extend(!0,{},e[w]),y=Math.ceil(g/e.length);0==w&&(_=moment(v.m).add(o*y,"months").diff(moment(v.m),"days")),b=0==(x=moment(v.m).add(_,"days").day())?moment(v.m).add(_,"days").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(v.m).add(_,"days").subtract(1,"days").format("YYYY-MM-DD"):moment(v.m).add(_,"days").format("YYYY-MM-DD"),v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else{"down"==t||"right"==t?n=7:"up"!=t&&"left"!=t||(n=-7,e.reverse());for(g=1;g<=r;g++){var x,w=(g-1)%e.length,v=$.extend(!0,{},e[w]),y=Math.ceil(g/e.length);0==w&&(_=moment(v.m).add(n*y,"days").diff(moment(v.m),"days")),b=0==(x=moment(v.m).add(_,"days").day())?moment(v.m).add(_,"days").subtract(2,"days").format("YYYY-MM-DD"):6==x?moment(v.m).add(_,"days").subtract(1,"days").format("YYYY-MM-DD"):moment(v.m).add(_,"days").format("YYYY-MM-DD"),v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else"up"!=t&&"left"!=t||e.reverse(),f=jfgrid.dropCell.FillCopy(e,r)}else if("6"==i){if(1==e.length)"down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),f=jfgrid.dropCell.FillMonths(e,r,_);else if(2==e.length)if(moment(e[1].m).date()==moment(e[0].m).date()&&0!=moment(e[1].m).diff(moment(e[0].m),"months")){"up"!=t&&"left"!=t||e.reverse();var _=moment(e[1].m).diff(moment(e[0].m),"months");f=jfgrid.dropCell.FillMonths(e,r,_)}else{"down"==t||"right"==t?o=1:"up"!=t&&"left"!=t||(o=-1,e.reverse());for(g=1;g<=r;g++){w=(g-1)%e.length,v=$.extend(!0,{},e[w]),y=Math.ceil(g/e.length);0==w&&(_=moment(v.m).add(o*y,"months").diff(moment(v.m),"days"));b=moment(v.m).add(_,"days").format("YYYY-MM-DD");v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else{if((l=jfgrid.dropCell.judgeDate(e))[0]&&l[3]){"up"!=t&&"left"!=t||e.reverse();var _=moment(e[1].m).diff(moment(e[0].m),"months");f=jfgrid.dropCell.FillMonths(e,r,_)}else if(!l[0]&&l[2]){"down"==t||"right"==t?o=1:"up"!=t&&"left"!=t||(o=-1,e.reverse());for(g=1;g<=r;g++){w=(g-1)%e.length,v=$.extend(!0,{},e[w]),y=Math.ceil(g/e.length);0==w&&(_=moment(v.m).add(o*y,"months").diff(moment(v.m),"days"));b=moment(v.m).add(_,"days").format("YYYY-MM-DD");v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else"up"!=t&&"left"!=t||e.reverse(),f=jfgrid.dropCell.FillCopy(e,r)}}else if("7"==i){if(1==e.length)"down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),f=jfgrid.dropCell.FillYears(e,r,_);else if(2==e.length)if(moment(e[1].m).date()==moment(e[0].m).date()&&moment(e[1].m).month()==moment(e[0].m).month()&&0!=moment(e[1].m).diff(moment(e[0].m),"years")){"up"!=t&&"left"!=t||e.reverse();var _=moment(e[1].m).diff(moment(e[0].m),"years");f=jfgrid.dropCell.FillYears(e,r,_)}else{"down"==t||"right"==t?d=1:"up"!=t&&"left"!=t||(d=-1,e.reverse());for(g=1;g<=r;g++){w=(g-1)%e.length,v=$.extend(!0,{},e[w]),y=Math.ceil(g/e.length);0==w&&(_=moment(v.m).add(d*y,"years").diff(moment(v.m),"days"));b=moment(v.m).add(_,"days").format("YYYY-MM-DD");v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else{if((l=jfgrid.dropCell.judgeDate(e))[0]&&l[1]&&l[4]){"up"!=t&&"left"!=t||e.reverse();_=moment(e[1].m).diff(moment(e[0].m),"years");f=jfgrid.dropCell.FillYears(e,r,_)}else if(l[0]&&l[3]||l[2]){"down"==t||"right"==t?d=1:"up"!=t&&"left"!=t||(d=-1,e.reverse());for(g=1;g<=r;g++){w=(g-1)%e.length,v=$.extend(!0,{},e[w]),y=Math.ceil(g/e.length);0==w&&(_=moment(v.m).add(d*y,"years").diff(moment(v.m),"days"));b=moment(v.m).add(_,"days").format("YYYY-MM-DD");v.m=b,v.v=jfgrid.mask.genarate(b)[2],f.push(v)}}else"up"!=t&&"left"!=t||e.reverse(),f=jfgrid.dropCell.FillCopy(e,r)}}else if("8"==i)if(1==e.length){"down"==t||"right"==t?_=1:"up"!=t&&"left"!=t||(_=-1),f=jfgrid.dropCell.FillChnNumber(e,r,_)}else{for(s=[],g=0;g<e.length;g++)s.push(jfgrid.dropCell.ChineseToNumber(e[g].m));"up"!=t&&"left"!=t||(e.reverse(),s.reverse()),f=jfgrid.dropCell.isEqualDiff(s)?(_=s[1]-s[0],jfgrid.dropCell.FillChnNumber(e,r,_)):jfgrid.dropCell.FillCopy(e,r)}return f},FillCopy:function(e,r){for(var t=[],i=1;i<=r;i++){var a=(i-1)%e.length,n=$.extend(!0,{},e[a]);t.push(n)}return t},FillSeries:function(e,r,t){for(var i=[],a=[],n=0;n<e.length;n++)a.push(Number(e[n].v));if(2<e.length&&jfgrid.dropCell.isEqualRatio(a))for(var o=1;o<=r;o++){var l,d=(o-1)%e.length,f=$.extend(!0,{},e[d]);"down"==t||"right"==t?l=Number(e[e.length-1].v)*Math.pow(Number(e[1].v)/Number(e[0].v),o):"up"!=t&&"left"!=t||(l=Number(e[0].v)/Math.pow(Number(e[1].v)/Number(e[0].v),o)),f.v=l,f.m=jfgrid.mask.update(f.ct.fa,l),i.push(f)}else for(var s=jfgrid.dropCell.getXArr(e.length),o=1;o<=r;o++){var g,d=(o-1)%e.length,f=$.extend(!0,{},e[d]);"down"==t||"right"==t?g=jfgrid.dropCell.forecast(e.length+o,a,s):"up"!=t&&"left"!=t||(g=jfgrid.dropCell.forecast(1-o,a,s)),f.v=g,f.m=jfgrid.mask.update(f.ct.fa,g),i.push(f)}return i},FillExtendNumber:function(e,r,t){for(var i=[],a=1;a<=r;a++){var n=(a-1)%e.length,o=$.extend(!0,{},e[n]),l=e[e.length-1].m,d=jfgrid.dropCell.isExtendNumber(l)[1],f=jfgrid.dropCell.isExtendNumber(l)[2],s=Math.abs(Number(f)+t*a);o.v=d+s.toString(),o.m=d+s.toString(),i.push(o)}return i},FillOnlyFormat:function(e,r){for(var t=[],i=1;i<=r;i++){var a=(i-1)%e.length,n=$.extend(!0,{},e[a]);delete n.f,delete n.m,delete n.v,t.push(n)}return t},FillWithoutFormat:function(e){for(var r=[],t=0;t<e.length;t++){var i,a=$.extend(!0,{},e[t]);i=null==a.f?{m:a.v.toString(),v:a.v}:{f:a.f,m:a.v.toString(),v:a.v},r.push(i)}return r},FillDays:function(e,r,t){for(var i=[],a=1;a<=r;a++){var n=(a-1)%e.length,o=$.extend(!0,{},e[n]),l=jfgrid.mask.update("yyyy-MM-dd",o.v),l=moment(l).add(t*a,"days").format("YYYY-MM-DD");o.v=jfgrid.mask.genarate(l)[2],o.m=jfgrid.mask.update(o.ct.fa,o.v),i.push(o)}return i},FillMonths:function(e,r,t){for(var i=[],a=1;a<=r;a++){var n=(a-1)%e.length,o=$.extend(!0,{},e[n]),l=jfgrid.mask.update("yyyy-MM-dd",o.v),l=moment(l).add(t*a,"months").format("YYYY-MM-DD");o.v=jfgrid.mask.genarate(l)[2],o.m=jfgrid.mask.update(o.ct.fa,o.v),i.push(o)}return i},FillYears:function(e,r,t){for(var i=[],a=1;a<=r;a++){var n=(a-1)%e.length,o=$.extend(!0,{},e[n]),l=jfgrid.mask.update("yyyy-MM-dd",o.v),l=moment(l).add(t*a,"years").format("YYYY-MM-DD");o.v=jfgrid.mask.genarate(l)[2],o.m=jfgrid.mask.update(o.ct.fa,o.v),i.push(o)}return i},FillChnWeek:function(e,r,t){for(var i=[],a=1;a<=r;a++){var n,o=(a-1)%e.length,l=$.extend(!0,{},e[o]);(n="日"==e[e.length-1].m?7+t*a:jfgrid.dropCell.ChineseToNumber(e[e.length-1].m)+t*a)<0&&(n=7*Math.ceil(Math.abs(n)/7)+n);var d=n%7;0==d?(l.m="日",l.v="日"):1==d?(l.m="一",l.v="一"):2==d?(l.m="二",l.v="二"):3==d?(l.m="三",l.v="三"):4==d?(l.m="四",l.v="四"):5==d?(l.m="五",l.v="五"):6==d&&(l.m="六",l.v="六"),i.push(l)}return i},FillChnWeek2:function(e,r,t){for(var i=[],a=1;a<=r;a++){var n,o,l,d=(a-1)%e.length,f=$.extend(!0,{},e[d]);(l="周日"==e[e.length-1].m?7+t*a:(o=(n=e[e.length-1].m).substr(n.length-1,1),jfgrid.dropCell.ChineseToNumber(o)+t*a))<0&&(l=7*Math.ceil(Math.abs(l)/7)+l);var s=l%7;0==s?(f.m="周日",f.v="周日"):1==s?(f.m="周一",f.v="周一"):2==s?(f.m="周二",f.v="周二"):3==s?(f.m="周三",f.v="周三"):4==s?(f.m="周四",f.v="周四"):5==s?(f.m="周五",f.v="周五"):6==s&&(f.m="周六",f.v="周六"),i.push(f)}return i},FillChnWeek3:function(e,r,t){for(var i=[],a=1;a<=r;a++){var n,o,l,d=(a-1)%e.length,f=$.extend(!0,{},e[d]);(l="星期日"==e[e.length-1].m?7+t*a:(o=(n=e[e.length-1].m).substr(n.length-1,1),jfgrid.dropCell.ChineseToNumber(o)+t*a))<0&&(l=7*Math.ceil(Math.abs(l)/7)+l);var s=l%7;0==s?(f.m="星期日",f.v="星期日"):1==s?(f.m="星期一",f.v="星期一"):2==s?(f.m="星期二",f.v="星期二"):3==s?(f.m="星期三",f.v="星期三"):4==s?(f.m="星期四",f.v="星期四"):5==s?(f.m="星期五",f.v="星期五"):6==s&&(f.m="星期六",f.v="星期六"),i.push(f)}return i},FillChnNumber:function(e,r,t){for(var i=[],a=1;a<=r;a++){var n,o=(a-1)%e.length,l=$.extend(!0,{},e[o]),d=jfgrid.dropCell.ChineseToNumber(e[e.length-1].m)+t*a;n=d<=0?"零":jfgrid.dropCell.NumberToChinese(d),l.v=n,l.m=n.toString(),i.push(l)}return i},isEqualDiff:function(e){for(var r=!0,t=e[1]-e[0],i=1;i<e.length;i++)if(e[i]-e[i-1]!=t){r=!1;break}return r},isEqualRatio:function(e){for(var r=!0,t=e[1]/e[0],i=1;i<e.length;i++)if(e[i]/e[i-1]!=t){r=!1;break}return r},getXArr:function(e){for(var r=[],t=1;t<=e;t++)r.push(t);return r},forecast:function(e,r,t){function i(e){for(var r=0,t=0;t<e.length;t++)r+=e[t];return r/e.length}for(var a,n=i(t),o=i(r),l=0,d=0,f=0;f<t.length;f++)l+=(t[f]-n)*(r[f]-o),d+=(t[f]-n)*(t[f]-n);var s=o-(a=0==d?1:l/d)*n;return Math.round(1e5*(s+a*e))/1e5},judgeDate:function(e){for(var r=!0,t=!0,i=!0,a=!0,n=!0,o=moment(e[0].m).date(),l=moment(e[0].m).month(),d=moment(e[1].m).diff(moment(e[0].m),"days"),f=moment(e[1].m).diff(moment(e[0].m),"months"),s=moment(e[1].m).diff(moment(e[0].m),"years"),g=1;g<e.length;g++)moment(e[g].m).date()!=o&&(r=!1),moment(e[g].m).month()!=l&&(t=!1),moment(e[g].m).diff(moment(e[g-1].m),"days")!=d&&(i=!1),moment(e[g].m).diff(moment(e[g-1].m),"months")!=f&&(a=!1),moment(e[g].m).diff(moment(e[g-1].m),"years")!=s&&(n=!1);return 0==d&&(i=!1),0==f&&(a=!1),0==s&&(n=!1),[r,t,i,a,n]}},jfgrid.locationCell={createDialog:function(){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-locationCell-dialog").remove();$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-locationCell-dialog",addclass:"jfgrid-locationCell-dialog",title:"定位条件",content:'<div class="listbox"><div class="listItem"><input type="radio" name="locationType" checked="checked" id="locationConstant"><label for="locationConstant">常量</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationConstantDate"><label for="locationConstantDate">日期</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationConstantNumber"><label for="locationConstantNumber">数字</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationConstantString"><label for="locationConstantString">字符</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationConstantBoolean"><label for="locationConstantBoolean">逻辑值</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationConstantError"><label for="locationConstantError">错误</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationFormula"><label for="locationFormula">公式</label><div class="subbox"><div class="subItem"><input type="checkbox" checked="checked" class="date" id="locationFormulaDate" disabled="true"><label for="locationFormulaDate" style="color: #666">日期</label></div><div class="subItem"><input type="checkbox" checked="checked" class="number" id="locationFormulaNumber" disabled="true"><label for="locationFormulaNumber" style="color: #666">数字</label></div><div class="subItem"><input type="checkbox" checked="checked" class="string" id="locationFormulaString" disabled="true"><label for="locationFormulaString" style="color: #666">字符</label></div><div class="subItem"><input type="checkbox" checked="checked" class="boolean" id="locationFormulaBoolean" disabled="true"><label for="locationFormulaBoolean" style="color: #666">逻辑值</label></div><div class="subItem"><input type="checkbox" checked="checked" class="error" id="locationFormulaError" disabled="true"><label for="locationFormulaError" style="color: #666">错误</label></div></div></div><div class="listItem"><input type="radio" name="locationType" id="locationNull"><label for="locationNull">空值</label></div><div class="listItem"><input type="radio" name="locationType" id="locationCF"><label for="locationCF">条件格式</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepRow"><label for="locationStepRow">间隔行</label></div><div class="listItem"><input type="radio" name="locationType" id="locationStepColumn"><label for="locationStepColumn">间隔列</label></div></div>',botton:'<button id="jfgrid-locationCell-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default jfgrid-model-close-btn">取消</button>',style:"z-index:100003"}));var e=$("#jfgrid-locationCell-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),r=e.outerHeight(),t=e.outerWidth(),i=$(window).width(),a=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#jfgrid-locationCell-dialog").css({left:(i+n-t)/2,top:(a+o-r)/3}).show()},init:function(){$(document).on("click","#jfgrid-locationCell-dialog .listItem input:radio",function(e){$("#jfgrid-locationCell-dialog .listItem input:checkbox").prop("disabled",!0),$("#jfgrid-locationCell-dialog .listItem .subbox label").css("color","#666"),$(this).siblings(".subbox").find("input:checkbox").removeAttr("disabled"),$(this).siblings(".subbox").find("label").css("color","#000")}),$(document).off("click.locationCellConfirm").on("click.locationCellConfirm","#jfgrid-locationCell-dialog #jfgrid-locationCell-dialog-confirm",function(){$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-locationCell-dialog").hide();var e=$("#jfgrid-locationCell-dialog .listItem input:radio:checked"),r=e.attr("id");if("locationConstant"==r||"locationFormula"==r){var t=e.siblings(".subbox").find("input:checkbox:checked");if(0==t.length)return;if(5==t.length)var i="all";else{for(var a=[],n=0;n<t.length;n++)$(t[n]).hasClass("date")?a.push("d"):$(t[n]).hasClass("number")?a.push("n"):$(t[n]).hasClass("string")?a.push("s,g"):$(t[n]).hasClass("boolean")?a.push("b"):$(t[n]).hasClass("error")&&a.push("e");i=a.join(",")}o=0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]?[{row:[0,jfgrid.flowdata.length-1],column:[0,jfgrid.flowdata[0].length-1]}]:$.extend(!0,[],jfgird_select_save),jfgrid.locationCell.apply(o,r,i)}else if("locationStepRow"==r){if(0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1])return void(jfgrid.isEditMode()?alert("请选择最少两行"):jfgrid.tooltip.info("提示","请选择最少两行"));var o=$.extend(!0,[],jfgird_select_save);jfgrid.locationCell.apply(o,"locationStepRow")}else if("locationStepColumn"==r){if(0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1])return void(jfgrid.isEditMode()?alert("请选择最少两列"):jfgrid.tooltip.info("提示","请选择最少两列"));var o=$.extend(!0,[],jfgird_select_save);jfgrid.locationCell.apply(o,"locationStepColumn")}else{o=0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]?[{row:[0,jfgrid.flowdata.length-1],column:[0,jfgrid.flowdata[0].length-1]}]:$.extend(!0,[],jfgird_select_save),jfgrid.locationCell.apply(o,r)}})},apply:function(range,type,value){var rangeArr=[],str,str,str,str,scrollLeft,scrollTop,winH,winW,row,row_pre,col,col_pre;if("locationFormula"==type||"locationConstant"==type||"locationNull"==type||"locationCF"==type){if("locationFormula"==type)str="all"==value?"jfgrid.flowdata[r] != null && jfgrid.flowdata[r][c] != null && jfgrid.flowdata[r][c].v != null && jfgrid.flowdata[r][c].f != null":"jfgrid.flowdata[r] != null && jfgrid.flowdata[r][c] != null && jfgrid.flowdata[r][c].v != null && jfgrid.flowdata[r][c].f != null && jfgrid.flowdata[r][c].ct != null && value.indexOf(jfgrid.flowdata[r][c].ct.t) != -1";else if("locationConstant"==type){str="all"==value?"jfgrid.flowdata[r] != null && jfgrid.flowdata[r][c] != null && jfgrid.flowdata[r][c].v != null && jfgrid.flowdata[r][c].f == null && jfgrid.flowdata[r][c].ct != null":"jfgrid.flowdata[r] != null && jfgrid.flowdata[r][c] != null && jfgrid.flowdata[r][c].v != null && jfgrid.flowdata[r][c].f == null && jfgrid.flowdata[r][c].ct != null && value.indexOf(jfgrid.flowdata[r][c].ct.t) != -1"}else if("locationNull"==type)var str="jfgrid.flowdata[r] != null && (jfgrid.flowdata[r][c] == null || jfgrid.flowdata[r][c].v == null || jfgrid.flowdata[r][c].v == '') ";else if("locationCF"==type){var index=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),ruleArr=jfgridfile[index].jfgrid_conditionformat_save,data=jfgridfile[index].data,computeMap=jfgrid.conditionformat.compute(ruleArr,data);if("{}"==JSON.stringify(computeMap))return void(jfgrid.isEditMode()?alert("未找到单元格"):jfgrid.tooltip.info("提示","未找到单元格"));var str="(r + '_' + c) in computeMap"}for(var s=0;s<range.length;s++){var st_r=range[s].row[0],ed_r=range[s].row[1],st_c=range[s].column[0],ed_c=range[s].column[1];if(st_r==ed_r)for(var stack_stc=null,stack_edc=null,r=st_r,c=st_c;c<=ed_c;c++)c==st_c?stack_stc=eval(str)?c:null:c==ed_c?eval(str)?null==stack_stc?rangeArr.push({row:[st_r,ed_r],column:[ed_c,ed_c]}):rangeArr.push({row:[st_r,ed_r],column:[stack_stc,ed_c]}):null==stack_edc&&null!=stack_stc?rangeArr.push({row:[st_r,ed_r],column:[stack_stc,stack_stc]}):null!=stack_edc&&rangeArr.push({row:[st_r,ed_r],column:[stack_stc,stack_edc]}):eval(str)?null==stack_stc?stack_stc=c:stack_edc=c:null==stack_edc&&null!=stack_stc?(rangeArr.push({row:[st_r,ed_r],column:[stack_stc,stack_stc]}),stack_stc=null):null!=stack_edc&&(rangeArr.push({row:[st_r,ed_r],column:[stack_stc,stack_edc]}),stack_stc=null,stack_edc=null);else{for(var stack={},r=st_r;r<=ed_r;r++){stack[r]=[];for(var stack_stc=null,stack_edc=null,c=st_c;c<=ed_c;c++)c==ed_c?eval(str)?null==stack_stc?stack[r].push({status:!1,range:[ed_c,ed_c]}):stack[r].push({status:!1,range:[stack_stc,ed_c]}):null==stack_edc&&null!=stack_stc?stack[r].push({status:!1,range:[stack_stc,stack_stc]}):null!=stack_edc&&stack[r].push({status:!1,range:[stack_stc,stack_edc]}):c==st_c?stack_stc=eval(str)?c:null:eval(str)?null==stack_stc?stack_stc=c:stack_edc=c:null==stack_edc&&null!=stack_stc?(stack[r].push({status:!1,range:[stack_stc,stack_stc]}),stack_stc=null):null!=stack_edc&&(stack[r].push({status:!1,range:[stack_stc,stack_edc]}),stack_stc=null,stack_edc=null)}for(var i=st_r;i<=ed_r;i++)if(i==ed_r){if(0<stack[i].length)for(var j=0;j<stack[i].length;j++)stack[i][j].status||rangeArr.push({row:[ed_r,ed_r],column:stack[i][j].range})}else if(0<stack[i].length)for(var j=0;j<stack[i].length;j++)if(!stack[i][j].status){for(var b=0,a=1;a<ed_r-i&&(null!=stack[i+a][j]&&stack[i+a][j].range[0]==stack[i][j].range[0]&&stack[i+a][j].range[1]==stack[i][j].range[1]);a++)b=a,stack[i+a][j].status=!0;rangeArr.push({row:[i,i+b],column:stack[i][j].range})}}}}else if("locationStepRow"==type){for(var s=0;s<range.length;s++)if(range[s].row[0]!=range[s].row[1])for(var st_r=range[s].row[0],ed_r=range[s].row[1],st_c=range[s].column[0],ed_c=range[s].column[1],r=st_r;r<=ed_r;r++)(r-st_r)%2==0&&rangeArr.push({row:[r,r],column:[st_c,ed_c]})}else if("locationStepColumn"==type)for(var s=0;s<range.length;s++)if(range[s].column[0]!=range[s].column[1])for(var st_r=range[s].row[0],ed_r=range[s].row[1],st_c=range[s].column[0],ed_c=range[s].column[1],c=st_c;c<=ed_c;c++)(c-st_c)%2==0&&rangeArr.push({row:[st_r,ed_r],column:[c,c]});0==rangeArr.length?jfgrid.isEditMode()?alert("未找到单元格"):jfgrid.tooltip.info("提示","未找到单元格"):(jfgird_select_save=rangeArr,jfgrid.selectHightlightShow(),scrollLeft=$("#jfgrid-cell-main").scrollLeft(),scrollTop=$("#jfgrid-cell-main").scrollTop(),winH=$("#jfgrid-cell-main").height(),winW=$("#jfgrid-cell-main").width(),row=visibledatarow[jfgird_select_save[0].row[1]],row_pre=jfgird_select_save[0].row[0]-1==-1?0:visibledatarow[jfgird_select_save[0].row[0]-1],col=visibledatacolumn[jfgird_select_save[0].column[1]],col_pre=jfgird_select_save[0].column[0]-1==-1?0:visibledatacolumn[jfgird_select_save[0].column[0]-1],0<col-scrollLeft-winW+20?$("#jfgrid-scrollbar-x").scrollLeft(col-winW+20):col_pre-scrollLeft-20<0&&$("#jfgrid-scrollbar-x").scrollLeft(col_pre-20),0<row-scrollTop-winH+20?$("#jfgrid-scrollbar-y").scrollTop(row-winH+20):row_pre-scrollTop-20<0&&$("#jfgrid-scrollbar-y").scrollTop(row_pre-20))}},jfgrid.moreFormat={moneyFmtList:[{name:"人民币",pos:"before",value:"¥"},{name:"美元",pos:"before",value:"$"},{name:"欧元",pos:"before",value:"€"},{name:"英镑",pos:"before",value:"￡"},{name:"港元",pos:"before",value:"$"},{name:"日元",pos:"before",value:"￥"},{name:"阿尔巴尼亚列克",pos:"before",value:"Lek"},{name:"阿尔及利亚第纳尔",pos:"before",value:"din"},{name:"阿富汗尼",pos:"after",value:"Af"},{name:"阿根廷比索",pos:"before",value:"$"},{name:"阿拉伯联合酋长国迪拉姆",pos:"before",value:"dh"},{name:"阿鲁巴弗罗林",pos:"before",value:"Afl"},{name:"阿曼里亚尔",pos:"before",value:"Rial"},{name:"阿塞拜疆马纳特",pos:"before",value:"?"},{name:"埃及镑",pos:"before",value:"￡"},{name:"埃塞俄比亚比尔",pos:"before",value:"Birr"},{name:"安哥拉宽扎",pos:"before",value:"Kz"},{name:"澳大利亚元",pos:"before",value:"$"},{name:"澳门元",pos:"before",value:"MOP"},{name:"巴巴多斯元",pos:"before",value:"$"},{name:"巴布亚新几内亚基那",pos:"before",value:"PGK"},{name:"巴哈马元",pos:"before",value:"$"},{name:"巴基斯坦卢比",pos:"before",value:"Rs"},{name:"巴拉圭瓜拉尼",pos:"after",value:"Gs"},{name:"巴林第纳尔",pos:"before",value:"din"},{name:"巴拿马巴波亚",pos:"before",value:"B/"},{name:"巴西里亚伊",pos:"before",value:"R$"},{name:"白俄罗斯卢布",pos:"after",value:"р"},{name:"百慕大元",pos:"before",value:"$"},{name:"保加利亚列弗",pos:"before",value:"lev"},{name:"冰岛克朗",pos:"before",value:"kr"},{name:"波黑可兑换马克",pos:"before",value:"KM"},{name:"波兰兹罗提",pos:"after",value:"z?"},{name:"玻利维亚诺",pos:"before",value:"Bs"},{name:"伯利兹元",pos:"before",value:"$"},{name:"博茨瓦纳普拉",pos:"before",value:"P"},{name:"不丹努扎姆",pos:"before",value:"Nu"},{name:"布隆迪法郎",pos:"before",value:"FBu"},{name:"朝鲜圆",pos:"before",value:"?KP"},{name:"丹麦克朗",pos:"after",value:"kr"},{name:"东加勒比元",pos:"before",value:"$"},{name:"多米尼加比索",pos:"before",value:"RD$"},{name:"俄国卢布",pos:"after",value:"?"},{name:"厄立特里亚纳克法",pos:"before",value:"Nfk"},{name:"非洲金融共同体法郎",pos:"before",value:"CFA"},{name:"菲律宾比索",pos:"before",value:"?"},{name:"斐济元",pos:"before",value:"$"},{name:"佛得角埃斯库多",pos:"before",value:"CVE"},{name:"福克兰群岛镑",pos:"before",value:"￡"},{name:"冈比亚达拉西",pos:"before",value:"GMD"},{name:"刚果法郎",pos:"before",value:"FrCD"},{name:"哥伦比亚比索",pos:"before",value:"$"},{name:"哥斯达黎加科朗",pos:"before",value:"?"},{name:"古巴比索",pos:"before",value:"$"},{name:"古巴可兑换比索",pos:"before",value:"$"},{name:"圭亚那元",pos:"before",value:"$"},{name:"哈萨克斯坦坚戈",pos:"before",value:"?"},{name:"海地古德",pos:"before",value:"HTG"},{name:"韩元",pos:"before",value:"?"},{name:"荷属安的列斯盾",pos:"before",value:"NAf."},{name:"洪都拉斯拉伦皮拉",pos:"before",value:"L"},{name:"吉布提法郎",pos:"before",value:"Fdj"},{name:"吉尔吉斯斯坦索姆",pos:"before",value:"KGS"},{name:"几内亚法郎",pos:"before",value:"FG"},{name:"加拿大元",pos:"before",value:"$"},{name:"加纳塞地",pos:"before",value:"GHS"},{name:"柬埔寨瑞尔",pos:"before",value:"Riel"},{name:"捷克克朗",pos:"after",value:"K?"},{name:"津巴布韦元",pos:"before",value:"$"},{name:"卡塔尔里亚尔",pos:"before",value:"Rial"},{name:"开曼群岛元",pos:"before",value:"$"},{name:"科摩罗法郎",pos:"before",value:"CF"},{name:"科威特第纳尔",pos:"before",value:"din"},{name:"克罗地亚库纳",pos:"before",value:"kn"},{name:"肯尼亚先令",pos:"before",value:"Ksh"},{name:"莱索托洛蒂",pos:"before",value:"LSL"},{name:"老挝基普",pos:"before",value:"?"},{name:"黎巴嫩镑",pos:"before",value:"L￡"},{name:"立陶宛立特",pos:"before",value:"Lt"},{name:"利比亚第纳尔",pos:"before",value:"din"},{name:"利比亚元",pos:"before",value:"$"},{name:"卢旺达法郎",pos:"before",value:"RF"},{name:"罗马尼亚列伊",pos:"before",value:"RON"},{name:"马达加斯加阿里亚里",pos:"before",value:"Ar"},{name:"马尔代夫拉菲亚",pos:"before",value:"Rf"},{name:"马拉维克瓦查",pos:"before",value:"MWK"},{name:"马来西亚林吉特",pos:"before",value:"RM"},{name:"马其顿戴第纳尔",pos:"before",value:"din"},{name:"毛里求斯卢比",pos:"before",value:"MURs"},{name:"毛里塔尼亚乌吉亚",pos:"before",value:"MRO"},{name:"蒙古图格里克",pos:"before",value:"?"},{name:"孟加拉塔卡",pos:"before",value:"?"},{name:"秘鲁新索尔",pos:"before",value:"S/"},{name:"缅甸开亚特",pos:"before",value:"K"},{name:"摩尔多瓦列伊",pos:"before",value:"MDL"},{name:"摩洛哥迪拉姆",pos:"before",value:"dh"},{name:"莫桑比克梅蒂卡尔",pos:"before",value:"MTn"},{name:"墨西哥比索",pos:"before",value:"$"},{name:"纳米比亚元",pos:"before",value:"$"},{name:"南非兰特",pos:"before",value:"R"},{name:"南苏丹镑",pos:"before",value:"￡"},{name:"尼加拉瓜科多巴",pos:"before",value:"C$"},{name:"尼泊尔卢比",pos:"before",value:"Rs"},{name:"尼日利亚奈拉",pos:"before",value:"?"},{name:"挪威克朗",pos:"after",value:"kr"},{name:"乔治亚拉瑞",pos:"before",value:"GEL"},{name:"人民币（离岸）",pos:"before",value:"￥"},{name:"瑞典克朗",pos:"after",value:"kr"},{name:"瑞士法郎",pos:"before",value:"CHF"},{name:"塞尔维亚第纳尔",pos:"before",value:"din"},{name:"塞拉利昂利昂",pos:"before",value:"SLL"},{name:"塞舌尔卢比",pos:"before",value:"SCR"},{name:"沙特里亚尔",pos:"before",value:"Rial"},{name:"圣多美多布拉",pos:"before",value:"Db"},{name:"圣赫勒拿群岛磅",pos:"before",value:"￡"},{name:"斯里兰卡卢比",pos:"before",value:"Rs"},{name:"斯威士兰里兰吉尼",pos:"before",value:"SZL"},{name:"苏丹镑",pos:"before",value:"SDG"},{name:"苏里南元",pos:"before",value:"$"},{name:"所罗门群岛元",pos:"before",value:"$"},{name:"索马里先令",pos:"before",value:"SOS"},{name:"塔吉克斯坦索莫尼",pos:"before",value:"Som"},{name:"太平洋法郎",pos:"after",value:"FCFP"},{name:"泰国铢",pos:"before",value:"?"},{name:"坦桑尼亚先令",pos:"before",value:"TSh"},{name:"汤加潘加",pos:"before",value:"T$"},{name:"特立尼达和多巴哥元",pos:"before",value:"$"},{name:"突尼斯第纳尔",pos:"before",value:"din"},{name:"土耳其里拉",pos:"before",value:"?"},{name:"瓦努阿图瓦图",pos:"before",value:"VUV"},{name:"危地马拉格查尔",pos:"before",value:"Q"},{name:"委内瑞拉博利瓦",pos:"before",value:"Bs"},{name:"文莱元",pos:"before",value:"$"},{name:"乌干达先令",pos:"before",value:"UGX"},{name:"乌克兰格里夫尼亚",pos:"before",value:"грн."},{name:"乌拉圭比索",pos:"before",value:"$"},{name:"乌兹别克斯坦苏姆",pos:"before",value:"so?m"},{name:"西萨摩亚塔拉",pos:"before",value:"WST"},{name:"新加坡元",pos:"before",value:"$"},{name:"新台币",pos:"before",value:"NT$"},{name:"新西兰元",pos:"before",value:"$"},{name:"匈牙利福林",pos:"before",value:"Ft"},{name:"叙利亚镑",pos:"before",value:"￡"},{name:"牙买加元",pos:"before",value:"$"},{name:"亚美尼亚德拉姆",pos:"before",value:"Dram"},{name:"也门里亚尔",pos:"before",value:"Rial"},{name:"伊拉克第纳尔",pos:"before",value:"din"},{name:"伊朗里亚尔",pos:"before",value:"Rial"},{name:"以色列新谢克尔",pos:"before",value:"?"},{name:"印度卢比",pos:"before",value:"?"},{name:"印度尼西亚卢比",pos:"before",value:"Rp"},{name:"约旦第纳尔",pos:"before",value:"din"},{name:"越南盾",pos:"after",value:"?"},{name:"赞比亚克瓦查",pos:"before",value:"ZMW"},{name:"直布罗陀镑",pos:"before",value:"￡"},{name:"智利比索",pos:"before",value:"$"},{name:"中非金融合作法郎",pos:"before",value:"FCFA"}],dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"1930年8月5日",value:'yyyy"年"M"月"d"日"'},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"8月5日",value:'M"月"d"日"'},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"下午01:30",value:"AM/PM hh:mm"},{name:"下午1:30",value:"AM/PM h:mm"},{name:"下午1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 下午01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],createDialog:function(e){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-moreFormat-dialog").remove();var r="",t="";if("morecurrency"==e){r="货币格式";for(var i="",a=0;a<jfgrid.moreFormat.moneyFmtList.length;a++){var n=jfgrid.moreFormat.moneyFmtList[a].name,o=jfgrid.moreFormat.moneyFmtList[a].pos;i+='<div class="listItem"><div class="name">'+n+'</div><div class="value">'+jfgrid.moreFormat.moneyFmtList[a].value+'</div><input type="hidden" value="'+o+'"/></div>'}t='<div class="box" id="morecurrency"><div class="decimal"><label>小数位数：</label><input type="number" class="formulaInputFocus" value="2" min="0" max="9"/></div><div class="listbox">'+i+"</div></div>"}else if("moredatetime"==e){r="日期与时间格式";for(i="",a=0;a<jfgrid.moreFormat.dateFmtList.length;a++){i+='<div class="listItem"><div class="name">'+(n=jfgrid.moreFormat.dateFmtList[a].name)+'</div><div class="value">'+jfgrid.moreFormat.dateFmtList[a].value+"</div></div>"}t='<div class="box" id="moredatetime"><div class="listbox">'+i+"</div></div>"}else if("moredigit"==e){r="数字格式";for(i="",a=0;a<jfgrid.moreFormat.numFmtList.length;a++){i+='<div class="listItem"><div class="name">'+(n=jfgrid.moreFormat.numFmtList[a].name)+'</div><div class="value">'+jfgrid.moreFormat.numFmtList[a].value+"</div></div>"}t='<div class="box" id="moredigit"><div class="listbox">'+i+"</div></div>"}$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-moreFormat-dialog",addclass:"jfgrid-moreFormat-dialog",title:r,content:t,botton:'<button id="jfgrid-moreFormat-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default jfgrid-model-close-btn">取消</button>',style:"z-index:100003"}));var l=$("#jfgrid-moreFormat-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),d=l.outerHeight(),f=l.outerWidth(),s=$(window).width(),g=$(window).height(),c=$(document).scrollLeft(),u=$(document).scrollTop();$("#jfgrid-moreFormat-dialog").css({left:(s+c-f)/2,top:(g+u-d)/3}).show(),$("#jfgrid-moreFormat-dialog .listbox .listItem").eq(0).addClass("on")},init:function(){$(document).on("click","#jfgrid-moreFormat-dialog .listbox .listItem",function(){$(this).addClass("on").siblings().removeClass("on")}),$(document).off("click.moreFormatConfirm").on("click.moreFormatConfirm","#jfgrid-moreFormat-dialog #jfgrid-moreFormat-dialog-confirm",function(){$("#jfgrid-moreFormat-dialog").hide(),$("#jfgrid-modal-dialog-mask").hide();var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=$("#jfgrid-moreFormat-dialog .listbox .listItem.on .value").text(),t=$(this).parents("#jfgrid-moreFormat-dialog").find(".box").attr("id");if("morecurrency"==t){if(-1!=r.indexOf("?"))return;var i=parseInt($("#jfgrid-moreFormat-dialog .decimal input").val().trim());if("NaN"==i.toString()||i<0||9<i)return void(jfgrid.isEditMode()?alert("小数位数必须在0-9之间！"):jfgrid.tooltip.info("小数位数必须在0-9之间！",""));var a="";if(0<i){for(var n=1;n<=i;n++)a+="0";a="0."+a}else a="#";var o=$("#jfgrid-moreFormat-dialog .listbox .listItem.on input:hidden").val();"before"==o?a='"'+r+'" '+a:"after"==o&&(a=a+' "'+r+'"'),jfgrid.menuButton.updateFormat(e,"ct",a)}else("moredatetime"==t||"moredigit"==t)&&jfgrid.menuButton.updateFormat(e,"ct",r)})}},jfgrid.searchReplace={createDialog:function(e){$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-search-replace").remove();$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-search-replace",addclass:"jfgrid-search-replace",title:"",content:'<div class="tabBox"><span id="searchTab">查找</span><span id="replaceTab">替换</span></div><div class="ctBox"><div class="inputBox"><div class="textboxs" id="searchInput">查找内容：<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="textboxs" id="replaceInput">替换内容：<input class="formulaInputFocus" spellcheck="false" value=""/></div><div class="checkboxs"><div id="regCheck"><input type="checkbox"/><span>正则表达式匹配</span></div><div id="wordCheck"><input type="checkbox"/><span>整词匹配</span></div><div id="caseCheck"><input type="checkbox"/><span>区分大小写匹配</span></div></div></div><div class="btnBox"><button id="replaceAllBtn" class="btn btn-default">全部替换</button><button id="replaceBtn" class="btn btn-default">替换</button><button id="searchAllBtn" class="btn btn-default">查找全部</button><button id="searchNextBtn" class="btn btn-default">查找下一个</button></div></div>',botton:'<button class="btn btn-default jfgrid-model-close-btn">关闭</button>',style:"z-index:100003"}));var r=$("#jfgrid-search-replace").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),t=r.outerHeight(),i=r.outerWidth(),a=$(window).width(),n=$(window).height(),o=$(document).scrollLeft(),l=$(document).scrollTop();$("#jfgrid-search-replace").css({left:(a+o-i)/2,top:(n+l-t)/3}).show(),"0"==e?($("#jfgrid-search-replace #searchTab").addClass("on").siblings().removeClass("on"),$("#jfgrid-search-replace #replaceInput").hide(),$("#jfgrid-search-replace #replaceAllBtn").hide(),$("#jfgrid-search-replace #replaceBtn").hide()):"1"==e&&($("#jfgrid-search-replace #replaceTab").addClass("on").siblings().removeClass("on"),$("#jfgrid-search-replace #replaceInput").show(),$("#jfgrid-search-replace #replaceAllBtn").show(),$("#jfgrid-search-replace #replaceBtn").show())},init:function(){$(document).off("click.SRtabBoxspan").on("click.SRtabBoxspan","#jfgrid-search-replace .tabBox span",function(){$(this).addClass("on").siblings().removeClass("on");var e=$(this).attr("id");"searchTab"==e?($("#jfgrid-search-replace #replaceInput").hide(),$("#jfgrid-search-replace #replaceAllBtn").hide(),$("#jfgrid-search-replace #replaceBtn").hide(),$("#jfgrid-search-replace #searchInput input").focus()):"replaceTab"==e&&($("#jfgrid-search-replace #replaceInput").show(),$("#jfgrid-search-replace #replaceAllBtn").show(),$("#jfgrid-search-replace #replaceBtn").show(),$("#jfgrid-search-replace #replaceInput input").focus())}),$(document).off("keyup.SRsearchInput").on("keyup.SRsearchInput","#jfgrid-search-replace #searchInput input",function(e){e.keyCode==keycode.ENTER&&jfgrid.searchReplace.searchNext()}),$(document).off("click.SRsearchNextBtn").on("click.SRsearchNextBtn","#jfgrid-search-replace #searchNextBtn",function(){jfgrid.searchReplace.searchNext()}),$(document).off("click.SRsearchAllBtn").on("click.SRsearchAllBtn","#jfgrid-search-replace #searchAllBtn",function(){jfgrid.searchReplace.searchAll()}),$(document).off("click.SRsearchAllboxItem").on("click.SRsearchAllboxItem","#jfgrid-search-replace #searchAllbox .boxItem",function(){$(this).addClass("on").siblings().removeClass("on");var e=$(this).attr("data-row"),r=$(this).attr("data-col"),t=$(this).attr("data-sheetIndex");t!=jfgrid.currentSheetIndex&&jfgrid.sheetmanage.changeSheetExec(t),jfgird_select_save=[{row:[e,e],column:[r,r]}],jfgrid.selectHightlightShow();var i=$("#jfgrid-cell-main").scrollLeft(),a=$("#jfgrid-cell-main").scrollTop(),n=$("#jfgrid-cell-main").height(),o=$("#jfgrid-cell-main").width(),l=visibledatarow[e],d=e-1==-1?0:visibledatarow[e-1],f=visibledatacolumn[r],s=r-1==-1?0:visibledatacolumn[r-1];0<f-i-o+20?$("#jfgrid-scrollbar-x").scrollLeft(f-o+20):s-i-20<0&&$("#jfgrid-scrollbar-x").scrollLeft(s-20),0<l-a-n+20?$("#jfgrid-scrollbar-y").scrollTop(l-n+20):d-a-20<0&&$("#jfgrid-scrollbar-y").scrollTop(d-20)}),$(document).off("click.SRreplaceBtn").on("click.SRreplaceBtn","#jfgrid-search-replace #replaceBtn",function(){jfgrid.searchReplace.replace()}),$(document).off("click.SRreplaceAllBtn").on("click.SRreplaceAllBtn","#jfgrid-search-replace #replaceAllBtn",function(){jfgrid.searchReplace.replaceAll()})},searchNext:function(){var e,r=$("#jfgrid-search-replace #searchInput input").val();if(""!=r&&null!=r){e=0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]?[{row:[0,jfgrid.flowdata.length-1],column:[0,jfgrid.flowdata[0].length-1]}]:$.extend(!0,[],jfgird_select_save);var t=jfgrid.searchReplace.getSearchIndexArr(r,e);if(0!=t.length){var i=0;if(0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]){if(0==jfgird_select_save.length)i=0;else for(var a=0;a<t.length;a++)if(t[a].r==jfgird_select_save[0].row[0]&&t[a].c==jfgird_select_save[0].column[0]){i=a==t.length-1?0:a+1;break}jfgird_select_save=[{row:[t[i].r,t[i].r],column:[t[i].c,t[i].c]}]}else{for(var n=e[e.length-1].row_focus,o=e[e.length-1].column_focus,a=0;a<t.length;a++)if(t[a].r==n&&t[a].c==o){i=a==t.length-1?0:a+1;break}for(var l=0;l<e.length;l++){var d=e[l].row[0],f=e[l].row[1],s=e[l].column[0],g=e[l].column[1];if(t[i].r>=d&&t[i].r<=f&&t[i].c>=s&&t[i].c<=g){var c=e[l];c.row_focus=t[i].r,c.column_focus=t[i].c,e.splice(l,1),e.push(c);break}}jfgird_select_save=e}jfgrid.selectHightlightShow();var u=$("#jfgrid-cell-main").scrollLeft(),m=$("#jfgrid-cell-main").scrollTop(),h=$("#jfgrid-cell-main").height(),j=$("#jfgrid-cell-main").width(),p=visibledatarow[t[i].r],v=t[i].r-1==-1?0:visibledatarow[t[i].r-1],b=visibledatacolumn[t[i].c],_=t[i].c-1==-1?0:visibledatacolumn[t[i].c-1];0<b-u-j+20?$("#jfgrid-scrollbar-x").scrollLeft(b-j+20):_-u-20<0&&$("#jfgrid-scrollbar-x").scrollLeft(_-20),0<p-m-h+20?$("#jfgrid-scrollbar-y").scrollTop(p-h+20):v-m-20<0&&$("#jfgrid-scrollbar-y").scrollTop(v-20),$("#searchAllbox").is(":visible")&&$("#jfgrid-search-replace #searchAllbox .boxItem").removeClass("on")}else jfgrid.isEditMode()?alert("没有查找到该内容"):jfgrid.tooltip.info("没有查找到该内容","")}},searchAll:function(){$("#jfgrid-search-replace #searchAllbox").remove();var e,r=$("#jfgrid-search-replace #searchInput input").val();if(""!=r&&null!=r){e=0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]?[{row:[0,jfgrid.flowdata.length-1],column:[0,jfgrid.flowdata[0].length-1]}]:$.extend(!0,[],jfgird_select_save);var t=jfgrid.searchReplace.getSearchIndexArr(r,e);if(0!=t.length){for(var i="",a=0;a<t.length;a++){var n=jfgrid.mask.valueShowEs(t[a].r,t[a].c,jfgrid.flowdata).toString();-1<n.indexOf("</")&&-1<n.indexOf(">")?i+='<div class="boxItem" data-row="'+t[a].r+'" data-col="'+t[a].c+'" data-sheetIndex="'+jfgrid.currentSheetIndex+'"><span>'+jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"</span><span>"+jfgrid.jfgridchatatABC(t[a].c)+(t[a].r+1)+"</span><span>"+n+"</span></div>":i+='<div class="boxItem" data-row="'+t[a].r+'" data-col="'+t[a].c+'" data-sheetIndex="'+jfgrid.currentSheetIndex+'"><span>'+jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"</span><span>"+jfgrid.jfgridchatatABC(t[a].c)+(t[a].r+1)+'</span><span title="'+n+'">'+n+"</span></div>"}$('<div id="searchAllbox"><div class="boxTitle"><span>工作表</span><span>单元格</span><span>值</span></div><div class="boxMain">'+i+"</div></div>").appendTo($("#jfgrid-search-replace")),$("#jfgrid-search-replace #searchAllbox .boxItem").eq(0).addClass("on").siblings().removeClass("on"),jfgird_select_save=[{row:[t[0].r,t[0].r],column:[t[0].c,t[0].c]}],jfgrid.selectHightlightShow()}else jfgrid.isEditMode()?alert("没有查找到该内容"):jfgrid.tooltip.info("没有查找到该内容","")}},getSearchIndexArr:function(e,r){var t=[],i={},a=!1;$("#jfgrid-search-replace #regCheck input[type='checkbox']").is(":checked")&&(a=!0);var n=!1;$("#jfgrid-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(n=!0);var o=!1;$("#jfgrid-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(o=!0);for(var l=0;l<r.length;l++)for(var d=r[l].row[0],f=r[l].row[1],s=r[l].column[0],g=r[l].column[1],c=d;c<=f;c++)for(var u,m=s;m<=g;m++){null!=jfgrid.flowdata[c][m]&&(0==(u=jfgrid.mask.valueShowEs(c,m,jfgrid.flowdata))&&(u=u.toString()),null!=u&&""!=u&&(u=u.toString(),n?o?e==u&&(c+"_"+m in i||(i[c+"_"+m]=0,t.push({r:c,c:m}))):e.toLowerCase()==u.toLowerCase()&&(c+"_"+m in i||(i[c+"_"+m]=0,t.push({r:c,c:m}))):a?(o?new RegExp(jfgrid.func_methods.getRegExpStr(e),"g"):new RegExp(jfgrid.func_methods.getRegExpStr(e),"ig")).test(u)&&(c+"_"+m in i||(i[c+"_"+m]=0,t.push({r:c,c:m}))):o?new RegExp(jfgrid.func_methods.getRegExpStr(e),"g").test(u)&&(c+"_"+m in i||(i[c+"_"+m]=0,t.push({r:c,c:m}))):new RegExp(jfgrid.func_methods.getRegExpStr(e),"ig").test(u)&&(c+"_"+m in i||(i[c+"_"+m]=0,t.push({r:c,c:m})))))}return t},replace:function(){var e,r=$("#jfgrid-search-replace #searchInput input").val();if(""!=r&&null!=r){e=0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]?[{row:[0,jfgrid.flowdata.length-1],column:[0,jfgrid.flowdata[0].length-1]}]:$.extend(!0,[],jfgird_select_save);var t=jfgrid.searchReplace.getSearchIndexArr(r,e);if(0!=t.length){for(var i=null,a=jfgird_select_save[jfgird_select_save.length-1].row_focus,n=jfgird_select_save[jfgird_select_save.length-1].column_focus,o=0;o<t.length;o++)if(t[o].r==a&&t[o].c==n){i=o;break}if(null==i){if(0==t.length)return void(jfgrid.isEditMode()?alert("找不到匹配项"):jfgrid.tooltip.info("找不到匹配项",""));i=0}$("#jfgrid-search-replace #regCheck input[type='checkbox']").is(":checked")&&0;var l=!1;$("#jfgrid-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(l=!0);var d=!1;$("#jfgrid-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(d=!0);var f,s,g,c,u=$("#jfgrid-search-replace #replaceInput input").val(),m=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);c=l?(s=t[i].r,g=t[i].c,u):(f=d?new RegExp(jfgrid.func_methods.getRegExpStr(r),"g"):new RegExp(jfgrid.func_methods.getRegExpStr(r),"ig"),s=t[i].r,g=t[i].c,jfgrid.mask.valueShowEs(s,g,m).toString().replace(f,u)),jfgrid.setcellvalue(s,g,m,c),jfgird_select_save=[{row:[s,s],column:[g,g]}],$("#jfgrid-search-replace #searchAllbox").is(":visible")&&$("#jfgrid-search-replace #searchAllbox").hide(),jfgrid.jfrefreshgrid(m,jfgird_select_save),jfgrid.selectHightlightShow();var h=$("#jfgrid-cell-main").scrollLeft(),j=$("#jfgrid-cell-main").scrollTop(),p=$("#jfgrid-cell-main").height(),v=$("#jfgrid-cell-main").width(),b=visibledatarow[s],_=s-1==-1?0:visibledatarow[s-1],w=visibledatacolumn[g],y=g-1==-1?0:visibledatacolumn[g-1];0<w-h-v+20?$("#jfgrid-scrollbar-x").scrollLeft(w-v+20):y-h-20<0&&$("#jfgrid-scrollbar-x").scrollLeft(y-20),0<b-j-p+20?$("#jfgrid-scrollbar-y").scrollTop(b-p+20):_-j-20<0&&$("#jfgrid-scrollbar-y").scrollTop(_-20)}else jfgrid.isEditMode()?alert("没有可替换的内容"):jfgrid.tooltip.info("没有可替换的内容","")}else jfgrid.isEditMode()?alert("请输入查找内容"):jfgrid.tooltip.info("请输入查找内容","")},replaceAll:function(){var e=$("#jfgrid-search-replace #searchInput input").val();if(""!=e&&null!=e){l=0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]?[{row:[0,jfgrid.flowdata.length-1],column:[0,jfgrid.flowdata[0].length-1]}]:$.extend(!0,[],jfgird_select_save);var r=jfgrid.searchReplace.getSearchIndexArr(e,l);if(0!=r.length){$("#jfgrid-search-replace #regCheck input[type='checkbox']").is(":checked")&&0;var t=!1;$("#jfgrid-search-replace #wordCheck input[type='checkbox']").is(":checked")&&(t=!0);var i=!1;$("#jfgrid-search-replace #caseCheck input[type='checkbox']").is(":checked")&&(i=!0);var a,n=$("#jfgrid-search-replace #replaceInput input").val(),o=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),l=[];if(t)for(var d=0;d<r.length;d++){var f=r[d].r,s=r[d].c,g=n;jfgrid.setcellvalue(f,s,o,g),l.push({row:[f,f],column:[s,s]})}else{a=i?new RegExp(jfgrid.func_methods.getRegExpStr(e),"g"):new RegExp(jfgrid.func_methods.getRegExpStr(e),"ig");for(d=0;d<r.length;d++){f=r[d].r,s=r[d].c,g=jfgrid.mask.valueShowEs(f,s,o).toString().replace(a,n);jfgrid.setcellvalue(f,s,o,g),l.push({row:[f,f],column:[s,s]})}}$("#jfgrid-search-replace #searchAllbox").is(":visible")&&$("#jfgrid-search-replace #searchAllbox").hide(),jfgrid.jfrefreshgrid(o,l),jfgird_select_save=$.extend(!0,[],l),jfgrid.selectHightlightShow(),jfgrid.isEditMode()?alert("已经帮您搜索并进行了"+r.length+"处替换"):jfgrid.tooltip.info("已经帮您搜索并进行了"+r.length+"处替换","")}else jfgrid.isEditMode()?alert("没有可替换的内容"):jfgrid.tooltip.info("没有可替换的内容","")}else jfgrid.isEditMode()?alert("请输入查找内容"):jfgrid.tooltip.info("请输入查找内容","")}},jfgrid.splitColumn={createDialog:function(){$("#jfgrid-modal-dialog-mask").show(),$("#jfgrid-splitColumn-dialog").remove();$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-splitColumn-dialog",addclass:"jfgrid-splitColumn-dialog",title:"文本分列",content:'<div class="box"><div class="boxTitle">分割符号</div><div class="boxMain"><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_01" type="checkbox"/><label for="splitColumn_type_01">Tab 键</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_02" type="checkbox"/><label for="splitColumn_type_02">分号</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_03" type="checkbox"/><label for="splitColumn_type_03">逗号</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_04" type="checkbox"/><label for="splitColumn_type_04">空格</label></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_05" type="checkbox"/><label for="splitColumn_type_05">其它</label><input type="text" class="formulaInputFocus" maxlength="1"/></div></div><div style="height: 22px;line-height: 22px;"><input id="splitColumn_type_06" type="checkbox"/><label for="splitColumn_type_06">连续分隔符号视为单个处理</label></div><div class="boxTitle" style="margin-top: 10px;">数据预览</div><div class="boxMain" id="splitColumnData"></div></div>',botton:'<button id="jfgrid-splitColumn-dialog-confirm" class="btn btn-primary">确定</button><button class="btn btn-default jfgrid-model-close-btn">关闭</button>',style:"z-index:100003"}));var e=$("#jfgrid-splitColumn-dialog").find(".jfgrid-modal-dialog-content").css("min-width",400).end(),r=e.outerHeight(),t=e.outerWidth(),i=$(window).width(),a=$(window).height(),n=$(document).scrollLeft(),o=$(document).scrollTop();$("#jfgrid-splitColumn-dialog").css({left:(i+n-t)/2,top:(a+o-r)/3}).show();var l=jfgrid.splitColumn.getDataArr();jfgrid.splitColumn.dataPreview(l)},init:function(){$(document).off("change.SPCinpcheckbox").on("change.SPCcheckbox","#jfgrid-splitColumn-dialog .box input[type='checkbox']",function(){var e=jfgrid.splitColumn.getRegStr(),r=jfgrid.splitColumn.getDataArr(e);jfgrid.splitColumn.dataPreview(r)}),$(document).off("keyup.SPCinptext").on("keyup.SPCinptext","#jfgrid-splitColumn-dialog .box input[type='text']",function(){var e,r;$(this).siblings("input[type='checkbox']").is(":checked")&&(e=jfgrid.splitColumn.getRegStr(),r=jfgrid.splitColumn.getDataArr(e),jfgrid.splitColumn.dataPreview(r))}),$(document).off("click.SPCconfirm").on("click.SPCconfirm","#jfgrid-splitColumn-dialog #jfgrid-splitColumn-dialog-confirm",function(){$("#jfgrid-modal-dialog-mask").hide(),$("#jfgrid-splitColumn-dialog").hide();var e=jfgrid.splitColumn.getRegStr(),r=jfgrid.splitColumn.getDataArr(e),t=jfgird_select_save[0].row[0],i=jfgird_select_save[0].column[0];if(1!=r[0].length){for(var a=!1,n=0;n<r.length;n++)for(var o=1;o<r[0].length;o++){var l=jfgrid.flowdata[t+n][i+o];if(null!=l&&null!=l.v){a=!0;break}}a?jfgrid.tooltip.confirm("提示","此处已有数据，是否替换它？",function(){jfgrid.splitColumn.update(t,i,r)}):jfgrid.splitColumn.update(t,i,r)}})},update:function(e,r,t){for(var i=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),a=0;a<t.length;a++)for(var n=0;n<t[0].length;n++){var o=t[a][n];jfgrid.setcellvalue(e+a,r+n,i,o)}var l=jfgird_select_save[0].row[0],d=jfgird_select_save[0].column[0],f=[{row:[l,l+t.length-1],column:[d,d+t[0].length-1]}];jfgrid.jfrefreshgrid(i,f),jfgrid.selectHightlightShow()},dataPreview:function(e){$("#jfgrid-splitColumn-dialog #splitColumnData").empty();for(var r="",t=0;t<e.length;t++){for(var i="",a=0;a<e[0].length;a++)i+="<td>"+e[t][a]+"</td>";r+="<tr>"+i+"</tr>"}var n="<table>"+r+"</table>";$("#jfgrid-splitColumn-dialog #splitColumnData").append(n)},getRegStr:function(){var a="",n=0;return $("#jfgrid-splitColumn-dialog .box input[type='checkbox']:checked").each(function(e,r){var t,i=$(r).attr("id");"splitColumn_type_01"==i?(a+="\\t",n++):"splitColumn_type_02"==i?(0<n&&(a+="|"),a+=";",n++):"splitColumn_type_03"==i?(0<n&&(a+="|"),a+=",",n++):"splitColumn_type_04"==i?(0<n&&(a+="|"),a+="\\s",n++):"splitColumn_type_05"==i?""!=(t=$(r).siblings("input[type='text']").val().trim())&&(0<n&&(a+="|"),a+=t):"splitColumn_type_06"==i&&(a="["+a+"]+")}),a},getDataArr:function(e){var r=[],t=jfgird_select_save[0].row[0],i=jfgird_select_save[0].row[1],a=jfgird_select_save[0].column[0];if(null!=e&&""!=e){for(var n=new RegExp(e,"g"),o=[],l=t;l<=i;l++){var d=[];d=(m=null!=(u=jfgrid.flowdata[l][a])&&null!=u.m?u.m:jfgrid.getcellvalue(l,a,jfgrid.flowdata)).toString().split(n),o.push(d)}for(var f=o.length,s=0,g=0;g<f;g++)o[g].length>s&&(s=o[g].length);r=jfgrid.splitColumn.getNullData(f,s);for(g=0;g<r.length;g++)for(var c=0;c<r[0].length;c++)null!=o[g][c]&&(r[g][c]=o[g][c])}else for(l=t;l<=i;l++){var u,m,d=[];m=null!=(u=jfgrid.flowdata[l][a])&&null!=u.m?u.m:jfgrid.getcellvalue(l,a,jfgrid.flowdata),d.push(m),r.push(d)}return r},getNullData:function(e,r){for(var t=[],i=0;i<e;i++){for(var a=[],n=0;n<r;n++)a.push("");t.push(a)}return t}},jfgrid.postil={defaultWidth:144,defaultHeight:84,currentObj:null,currentWinW:null,currentWinH:null,resize:null,resizeXY:null,move:!1,moveXY:null,init:function(){$("#jfgrid-postil-showBoxs").off("mousedown.showPs").on("mousedown.showPs",".jfgrid-postil-show",function(e){jfgrid.postil.currentObj=$(this).find(".jfgrid-postil-show-main"),$(this).hasClass("jfgrid-postil-show-active")||(jfgrid.postil.removeActivePs(),$(this).addClass("jfgrid-postil-show-active"),$(this).find(".jfgrid-postil-dialog-resize").show(),$(this).find(".arrowCanvas").css("z-index",200),$(this).find(".jfgrid-postil-show-main").css("z-index",200)),e.stopPropagation()}),$("#jfgrid-postil-showBoxs").off("mouseup.showPs").on("mouseup.showPs",".jfgrid-postil-show",function(e){"3"==e.which&&e.stopPropagation()}),$("#jfgrid-postil-showBoxs").off("mousedown.resize").on("mousedown.resize",".jfgrid-postil-show .jfgrid-postil-dialog-resize .jfgrid-postil-dialog-resize-item",function(e){jfgrid.postil.currentObj=$(this).closest(".jfgrid-postil-show-main"),jfgrid.postil.currentWinW=$("#jfgrid-cell-main")[0].scrollWidth,jfgrid.postil.currentWinH=$("#jfgrid-cell-main")[0].scrollHeight,jfgrid.postil.resize=$(this).data("type");var r=$("#jfgrid-cell-main").scrollTop(),t=$("#jfgrid-cell-main").scrollLeft(),i=jfgrid.mouseposition(e.pageX,e.pageY),a=i[0]+t,n=i[1]+r,o=jfgrid.postil.currentObj.position(),l=jfgrid.postil.currentObj.width(),d=jfgrid.postil.currentObj.height();jfgrid.postil.resizeXY=[a,n,l,d,o.left+t,o.top+r,t,r],jfgrid.setjfgird_scroll_status(!0),$(this).closest(".jfgrid-postil-show").hasClass("jfgrid-postil-show-active")||(jfgrid.postil.removeActivePs(),$(this).closest(".jfgrid-postil-show").addClass("jfgrid-postil-show-active"),$(this).closest(".jfgrid-postil-show").find(".jfgrid-postil-dialog-resize").show(),$(this).closest(".jfgrid-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".jfgrid-postil-show").find(".jfgrid-postil-show-main").css("z-index",200)),e.stopPropagation()}),$("#jfgrid-postil-showBoxs").off("mousedown.move").on("mousedown.move",".jfgrid-postil-show .jfgrid-postil-dialog-move .jfgrid-postil-dialog-move-item",function(e){jfgrid.postil.currentObj=$(this).closest(".jfgrid-postil-show-main"),jfgrid.postil.currentWinW=$("#jfgrid-cell-main")[0].scrollWidth,jfgrid.postil.currentWinH=$("#jfgrid-cell-main")[0].scrollHeight,jfgrid.postil.move=!0;var r=$("#jfgrid-cell-main").scrollTop(),t=$("#jfgrid-cell-main").scrollLeft(),i=jfgrid.postil.currentObj.offset(),a=jfgrid.postil.currentObj.position();jfgrid.postil.moveXY=[e.pageX-i.left,e.pageY-i.top,a.left,a.top,t,r],jfgrid.setjfgird_scroll_status(!0),$(this).closest(".jfgrid-postil-show").hasClass("jfgrid-postil-show-active")||(jfgrid.postil.removeActivePs(),$(this).closest(".jfgrid-postil-show").addClass("jfgrid-postil-show-active"),$(this).closest(".jfgrid-postil-show").find(".jfgrid-postil-dialog-resize").show(),$(this).closest(".jfgrid-postil-show").find(".arrowCanvas").css("z-index",200),$(this).closest(".jfgrid-postil-show").find(".jfgrid-postil-show-main").css("z-index",200)),e.stopPropagation()})},overshow:function(e){var r,t,i,a,n,o,l,d,f,s,g,c,u,m,h,j;$("#jfgrid-postil-overshow").remove(),0!=$(e.target).closest("#jfgrid-cell-main").length&&(r=jfgrid.mouseposition(e.pageX,e.pageY),t=$("#jfgrid-cell-main").scrollLeft(),i=$("#jfgrid-cell-main").scrollTop(),a=r[0]+t,n=r[1]+i,null!=jfgrid.freezen.freezenverticaldata&&r[0]<jfgrid.freezen.freezenverticaldata[0]-jfgrid.freezen.freezenverticaldata[2]||null!=jfgrid.freezen.freezenhorizontaldata&&r[1]<jfgrid.freezen.freezenhorizontaldata[0]-jfgrid.freezen.freezenhorizontaldata[2]||(o=jfgrid.rowLocation(n)[2],l=jfgrid.colLocation(a)[2],null!=jfgrid.flowdata[o]&&null!=jfgrid.flowdata[o][l]&&null!=jfgrid.flowdata[o][l].ps&&((d=jfgrid.flowdata[o][l].ps).isshow||0<$("#jfgrid-postil-show_"+o+"_"+l).length||(f=null==d.value?"":d.value,c=(s=visibledatacolumn[l])+18,(u=(g=0==o?0:visibledatarow[o-1])-18)<0&&(u=2),h='<div id="jfgrid-postil-overshow"><canvas class="arrowCanvas" width="'+(m=jfgrid.postil.getArrowCanvasSize(c,u,s,g))[2]+'" height="'+m[3]+'" style="position:absolute;left:'+m[0]+"px;top:"+m[1]+'px;z-index:100;"></canvas><div style="width:132px;min-height:72px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:'+c+"px;top:"+u+'px;z-index:100;">'+f+"</div></div>",$(h).appendTo($("#jfgrid-cell-main")),j=$("#jfgrid-postil-overshow .arrowCanvas").get(0).getContext("2d"),jfgrid.postil.drawArrow(j,m[4],m[5],m[6],m[7])))))},getArrowCanvasSize:function(e,r,t,i){var a=t-5;e<t&&(a=e-5);var n=i-5;r<i&&(n=r-5);var o=Math.abs(e-t)+10,l=Math.abs(r-i)+10,d=o-5,f=5;e<t&&(f=o-(d=5));var s=l-5,g=5;return r<i&&(g=l-(s=5)),[a,n,o,l,d,s,f,g]},drawArrow:function(e,r,t,i,a,n,o,l,d){n="undefined"==jfgrid.getObjType(n)?30:n,o="undefined"==jfgrid.getObjType(o)?6:o,l="undefined"==jfgrid.getObjType(l)?1:l,d="undefined"==jfgrid.getObjType(d)?"#000":d;var f=180*Math.atan2(t-a,r-i)/Math.PI,s=(f+n)*Math.PI/180,g=(f-n)*Math.PI/180,c=o*Math.cos(s),u=o*Math.sin(s),m=o*Math.cos(g),h=o*Math.sin(g);e.save(),e.beginPath();var j=r-c,p=t-u;e.moveTo(j,p),e.moveTo(r,t),e.lineTo(i,a),e.lineWidth=l,e.strokeStyle=d,e.stroke(),j=i+c,p=a+u,e.moveTo(j,p),e.lineTo(i,a),j=i+m,p=a+h,e.lineTo(j,p),e.fillStyle=d,e.fill(),e.restore()},buildAllPs:function(e){$("#jfgrid-cell-main #jfgrid-postil-showBoxs").empty();for(var r=0;r<e.length;r++)for(var t,i=0;i<e[0].length;i++){null!=e[r][i]&&null!=e[r][i].ps&&(t=e[r][i].ps,jfgrid.postil.buildPs(r,i,t))}jfgrid.postil.init()},buildPs:function(e,r,t){var i,a,n,o,l,d,f,s,g,c,u;0<$("#jfgrid-postil-show_"+e+"_"+r).length&&$("#jfgrid-postil-show_"+e+"_"+r).remove(),null!=t&&null!=t.isshow&&t.isshow&&(visibledatarow[e],i=e-1==-1?0:visibledatarow[e-1],a=visibledatacolumn[r],r-1==-1||visibledatacolumn[r-1],(n=jfgrid.menuButton.mergeborer(jfgrid.flowdata,e,r))&&(n.row[1],i=n.row[0],a=n.column[1],n.column[0]),o=null==t.left?a+18:t.left,l=null==t.top?i-18:t.top,d=null==t.width?jfgrid.postil.defaultWidth:t.width,f=null==t.height?jfgrid.postil.defaultHeight:t.height,s=null==t.value?"":t.value,l<0&&(l=2),c='<div id="jfgrid-postil-show_'+e+"_"+r+'" class="jfgrid-postil-show"><canvas class="arrowCanvas" width="'+(g=jfgrid.postil.getArrowCanvasSize(o,l,a,i))[2]+'" height="'+g[3]+'" style="position:absolute;left:'+g[0]+"px;top:"+g[1]+'px;z-index:100;"></canvas><div class="jfgrid-postil-show-main" style="width:'+d+"px;height:"+f+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+o+"px;top:"+l+'px;box-sizing:border-box;z-index:100;"><div class="jfgrid-postil-dialog-move"><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-t" data-type="t"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-r" data-type="r"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-b" data-type="b"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-l" data-type="l"></div></div><div class="jfgrid-postil-dialog-resize" style="display:none;"><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lt" data-type="lt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mt" data-type="mt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lm" data-type="lm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rm" data-type="rm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rt" data-type="rt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lb" data-type="lb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mb" data-type="mb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(d-12)+"px;height:"+(f-12)+'px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true">'+s+"</div></div></div></div>",$(c).appendTo($("#jfgrid-cell-main #jfgrid-postil-showBoxs")),u=$("#jfgrid-postil-show_"+e+"_"+r+" .arrowCanvas").get(0).getContext("2d"),jfgrid.postil.drawArrow(u,g[4],g[5],g[6],g[7]))},newPs:function(e,r){var t=visibledatacolumn[r],i=0==e?0:visibledatarow[e-1],a=t+18,n=i-18;n<0&&(n=2);var o=jfgrid.postil.getArrowCanvasSize(a,n,t,i),l='<div id="jfgrid-postil-show_'+e+"_"+r+'" class="jfgrid-postil-show jfgrid-postil-show-active"><canvas class="arrowCanvas" width="'+o[2]+'" height="'+o[3]+'" style="position:absolute;left:'+o[0]+"px;top:"+o[1]+'px;z-index:100;"></canvas><div class="jfgrid-postil-show-main" style="width:144px;height:84px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:'+a+"px;top:"+n+'px;box-sizing:border-box;z-index:100;"><div class="jfgrid-postil-dialog-move"><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-t" data-type="t"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-r" data-type="r"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-b" data-type="b"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-l" data-type="l"></div></div><div class="jfgrid-postil-dialog-resize"><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lt" data-type="lt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mt" data-type="mt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lm" data-type="lm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rm" data-type="rm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rt" data-type="rt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lb" data-type="lb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mb" data-type="mb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:132px;height:72px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true"></div></div></div></div>';$(l).appendTo($("#jfgrid-cell-main #jfgrid-postil-showBoxs"));var d=$("#jfgrid-postil-show_"+e+"_"+r+" .arrowCanvas").get(0).getContext("2d");jfgrid.postil.drawArrow(d,o[4],o[5],o[6],o[7]),$("#jfgrid-postil-show_"+e+"_"+r+" .formulaInputFocus").focus(),jfgrid.postil.init();var f=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),s=[];null==f[e][r]&&(f[e][r]={}),f[e][r].ps={left:null,top:null,width:null,height:null,value:"",isshow:!1},s.push(e+"_"+r),jfgrid.postil.ref(f,s)},editPs:function(e,r){var t,i,a,n,o,l,d,f,s,g,c,u;0<$("#jfgrid-postil-show_"+e+"_"+r).length?($("#jfgrid-postil-show_"+e+"_"+r).show(),$("#jfgrid-postil-show_"+e+"_"+r).addClass("jfgrid-postil-show-active"),$("#jfgrid-postil-show_"+e+"_"+r).find(".jfgrid-postil-dialog-resize").show()):(t=jfgrid.flowdata[e][r].ps,visibledatarow[e],i=e-1==-1?0:visibledatarow[e-1],a=visibledatacolumn[r],r-1==-1||visibledatacolumn[r-1],(n=jfgrid.menuButton.mergeborer(jfgrid.flowdata,e,r))&&(n.row[1],i=n.row[0],a=n.column[1],n.column[0]),o=null==t.left?a+18:t.left,l=null==t.top?i-18:t.top,d=null==t.width?jfgrid.postil.defaultWidth:t.width,f=null==t.height?jfgrid.postil.defaultHeight:t.height,s=null==t.value?"":t.value,l<0&&(l=2),c='<div id="jfgrid-postil-show_'+e+"_"+r+'" class="jfgrid-postil-show jfgrid-postil-show-active"><canvas class="arrowCanvas" width="'+(g=jfgrid.postil.getArrowCanvasSize(o,l,a,i))[2]+'" height="'+g[3]+'" style="position:absolute;left:'+g[0]+"px;top:"+g[1]+'px;z-index:100;"></canvas><div class="jfgrid-postil-show-main" style="width:'+d+"px;height:"+f+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+o+"px;top:"+l+'px;box-sizing:border-box;z-index:100;"><div class="jfgrid-postil-dialog-move"><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-t" data-type="t"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-r" data-type="r"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-b" data-type="b"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-l" data-type="l"></div></div><div class="jfgrid-postil-dialog-resize"><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lt" data-type="lt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mt" data-type="mt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lm" data-type="lm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rm" data-type="rm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rt" data-type="rt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lb" data-type="lb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mb" data-type="mb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(d-12)+"px;height:"+(f-12)+'px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true">'+s+"</div></div></div></div>",$(c).appendTo($("#jfgrid-cell-main #jfgrid-postil-showBoxs")),u=$("#jfgrid-postil-show_"+e+"_"+r+" .arrowCanvas").get(0).getContext("2d"),jfgrid.postil.drawArrow(u,g[4],g[5],g[6],g[7])),$("#jfgrid-postil-show_"+e+"_"+r+" .formulaInputFocus").focus(),jfgrid.jfgridRangeLast($("#jfgrid-postil-show_"+e+"_"+r+" .formulaInputFocus").get(0)),jfgrid.postil.init()},delPs:function(e,r){0<$("#jfgrid-postil-show_"+e+"_"+r).length&&$("#jfgrid-postil-show_"+e+"_"+r).remove();var t=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),i=[];delete t[e][r].ps,i.push(e+"_"+r),jfgrid.postil.ref(t,i)},showHidePs:function(e,r){var t,i,a,n,o,l,d,f,s,g,c,u=jfgrid.flowdata[e][r].ps,m=u.isshow,h=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),j=[];m?(h[e][r].ps.isshow=!1,$("#jfgrid-postil-show_"+e+"_"+r).remove()):(h[e][r].ps.isshow=!0,visibledatarow[e],t=e-1==-1?0:visibledatarow[e-1],i=visibledatacolumn[r],r-1==-1||visibledatacolumn[r-1],(a=jfgrid.menuButton.mergeborer(jfgrid.flowdata,e,r))&&(a.row[1],t=a.row[0],i=a.column[1],a.column[0]),n=null==u.left?i+18:u.left,o=null==u.top?t-18:u.top,l=null==u.width?jfgrid.postil.defaultWidth:u.width,d=null==u.height?jfgrid.postil.defaultHeight:u.height,f=null==u.value?"":u.value,o<0&&(o=2),g='<div id="jfgrid-postil-show_'+e+"_"+r+'" class="jfgrid-postil-show"><canvas class="arrowCanvas" width="'+(s=jfgrid.postil.getArrowCanvasSize(n,o,i,t))[2]+'" height="'+s[3]+'" style="position:absolute;left:'+s[0]+"px;top:"+s[1]+'px;z-index:100;"></canvas><div class="jfgrid-postil-show-main" style="width:'+l+"px;height:"+d+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+n+"px;top:"+o+'px;box-sizing:border-box;z-index:100;"><div class="jfgrid-postil-dialog-move"><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-t" data-type="t"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-r" data-type="r"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-b" data-type="b"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-l" data-type="l"></div></div><div class="jfgrid-postil-dialog-resize" style="display:none;"><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lt" data-type="lt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mt" data-type="mt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lm" data-type="lm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rm" data-type="rm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rt" data-type="rt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lb" data-type="lb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mb" data-type="mb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(l-12)+"px;height:"+(d-12)+'px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true">'+f+"</div></div></div></div>",$(g).appendTo($("#jfgrid-cell-main #jfgrid-postil-showBoxs")),c=$("#jfgrid-postil-show_"+e+"_"+r+" .arrowCanvas").get(0).getContext("2d"),jfgrid.postil.drawArrow(c,s[4],s[5],s[6],s[7]),jfgrid.postil.init()),j.push(e+"_"+r),jfgrid.postil.ref(h,j)},showHideAllPs:function(){for(var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=!0,t=[],i=0;i<e.length;i++)for(var a=0;a<e[0].length;a++)null!=e[i]&&null!=e[i][a]&&null!=e[i][a].ps&&(t.push(i+"_"+a),e[i][a].ps.isshow||(r=!1));if(0<t.length){var n=[];if(r){$("#jfgrid-cell-main #jfgrid-postil-showBoxs").empty();for(var o=0;o<t.length;o++){var l=t[o].split("_")[0],d=t[o].split("_")[1];(f=e[l][d].ps).isshow&&(e[l][d].ps.isshow=!1,n.push(t[o]))}}else for(o=0;o<t.length;o++){var f,s,g,c,u,m,h,j,p,v,b,_,l=t[o].split("_")[0],d=t[o].split("_")[1];(f=e[l][d].ps).isshow||(visibledatarow[l],s=l-1==-1?0:visibledatarow[l-1],g=visibledatacolumn[d],d-1==-1||visibledatacolumn[d-1],(c=jfgrid.menuButton.mergeborer(jfgrid.flowdata,l,d))&&(c.row[1],s=c.row[0],g=c.column[1],c.column[0]),u=null==f.left?g+18:f.left,m=null==f.top?s-18:f.top,h=null==f.width?jfgrid.postil.defaultWidth:f.width,j=null==f.height?jfgrid.postil.defaultHeight:f.height,p=null==f.value?"":f.value,m<0&&(m=2),b='<div id="jfgrid-postil-show_'+l+"_"+d+'" class="jfgrid-postil-show"><canvas class="arrowCanvas" width="'+(v=jfgrid.postil.getArrowCanvasSize(u,m,g,s))[2]+'" height="'+v[3]+'" style="position:absolute;left:'+v[0]+"px;top:"+v[1]+'px;z-index:100;"></canvas><div class="jfgrid-postil-show-main" style="width:'+h+"px;height:"+j+"px;color:#000;padding:5px;border:1px solid #000;background-color:rgb(255,255,225);position:absolute;left:"+u+"px;top:"+m+'px;box-sizing:border-box;z-index:100;"><div class="jfgrid-postil-dialog-move"><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-t" data-type="t"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-r" data-type="r"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-b" data-type="b"></div><div class="jfgrid-postil-dialog-move-item jfgrid-postil-dialog-move-item-l" data-type="l"></div></div><div class="jfgrid-postil-dialog-resize" style="display:none;"><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lt" data-type="lt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mt" data-type="mt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lm" data-type="lm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rm" data-type="rm"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rt" data-type="rt"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-lb" data-type="lb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-mb" data-type="mb"></div><div class="jfgrid-postil-dialog-resize-item jfgrid-postil-dialog-resize-item-rb" data-type="rb"></div></div><div style="width:100%;height:100%;overflow:hidden;"><div class="formulaInputFocus" style="width:'+(h-12)+"px;height:"+(j-12)+'px;line-height:18px;word-break:break-all;" spellcheck="false" contenteditable="true">'+p+"</div></div></div></div>",$(b).appendTo($("#jfgrid-cell-main #jfgrid-postil-showBoxs")),_=$("#jfgrid-postil-show_"+l+"_"+d+" .arrowCanvas").get(0).getContext("2d"),jfgrid.postil.drawArrow(_,v[4],v[5],v[6],v[7]),e[l][d].ps.isshow=!0,n.push(t[o]))}}jfgrid.postil.ref(e,n),jfgrid.postil.init()},removeActivePs:function(){var e,r,t,i,a,n;0<$("#jfgrid-postil-showBoxs .jfgrid-postil-show-active").length&&(e=$("#jfgrid-postil-showBoxs .jfgrid-postil-show-active").attr("id"),$("#"+e).removeClass("jfgrid-postil-show-active"),$("#"+e).find(".jfgrid-postil-dialog-resize").hide(),$("#"+e).find(".arrowCanvas").css("z-index",100),$("#"+e).find(".jfgrid-postil-show-main").css("z-index",100),r=e.split("jfgrid-postil-show_")[1].split("_")[0],t=e.split("jfgrid-postil-show_")[1].split("_")[1],i=$("#"+e).find(".formulaInputFocus").text(),n=[],(a=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata))[r][t].ps.value=i,n.push(r+"_"+t),jfgrid.postil.ref(a,n),a[r][t].ps.isshow||$("#"+e).remove())},ref:function(e,r){if(clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:"postil",data:jfgrid.flowdata,curdata:e,sheetIndex:jfgrid.currentSheetIndex,rc:r})),jfgrid.flowdata=e,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].data=jfgrid.flowdata,jfgrid.formula.execFunctionGroupData=jfgrid.flowdata,jfgrid.server.allowUpdate)for(var t=0;t<r.length;t++){var i=r[t].split("_")[0],a=r[t].split("_")[1];jfgrid.server.saveParam("v",jfgrid.currentSheetIndex,jfgrid.flowdata[i][a],{r:i,c:a})}setTimeout(function(){jfgrid.jfgridrefreshgrid()},1)},positionSync:function(){$("#jfgrid-postil-showBoxs .jfgrid-postil-show").each(function(e,r){var t=$(r).attr("id"),i=t.split("jfgrid-postil-show_")[1].split("_")[0],a=t.split("jfgrid-postil-show_")[1].split("_")[1];jfgrid.postil.buildPs(i,a,jfgrid.flowdata[i][a].ps)})}},jfgrid.hasChinaword=function(e){return!!/[\u4E00-\u9FA5]|[\uFE30-\uFFA0]/gi.exec(e)},jfgrid.getdatabyselectionD=function(e,r){if(null==r||null==r.row||0==r.row.length)return[];for(var t=jfgrid.dynamicArray_compute(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].dynamicArray),i=[],a=r.row[0];a<=r.row[1];a++)if(null!=e[a]&&(null==config.rowhidden||null==config.rowhidden[a])){for(var n=[],o=r.column[0];o<=r.column[1];o++){var l=a+"_"+o in t?t[a+"_"+o]:e[a][o];n.push(l)}i.push(n)}return i},jfgrid.getdatabyselection=function(e,r){if(null==e||null==e.row||0==e.row.length)return[];var t,i;i=null!=r&&r!=jfgrid.currentSheetIndex?(t=jfgridfile[jfgrid.sheetmanage.getSheetIndex(r)].data,jfgridfile[jfgrid.sheetmanage.getSheetIndex(r)].config):(t=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),config);for(var a=[],n=e.row[0];n<=e.row[1];n++)if(null!=t[n]&&(null==i.rowhidden||null==i.rowhidden[n])){for(var o=[],l=e.column[0];l<=e.column[1];l++)o.push(t[n][l]);a.push(o)}return a},jfgrid.rowlenByRange=function(e,r,t,i){var a=$.extend(!0,{},i);null==a.rowlen&&(a.rowlen={});for(var n=$("#jfgridTableContent").get(0).getContext("2d"),o=r;o<=t;o++)if(null==a.rowhidden||null==a.rowhidden[o]){var l=defaultrowlen;null!=a.rowlen[o]&&(l=a.rowlen[o]);for(var d=0;d<e[o].length;d++)if(null!=e[o][d]&&null!=e[o][d].v&&null!=e[o][d].tb&&"2"==e[o][d].tb){var f=jfgridfontformat(e[o][d]);n.font=f;var s,g=jfgrid.menuButton.getTextSize("田",f)[1],c=jfgrid.getcellvalue(o,d,e).toString(),u=n.measureText(c).width,m=jfgrid.colLocationByIndex(d)[1]-jfgrid.colLocationByIndex(d)[0]-8;if(m<u){for(var h=[],j=1;j<=c.length;j++){var p=c.substring(h.join("").length,j),v=n.measureText(p).width;m<v?(h.push(c.substring(h.join("").length,j-1)),j-=2):v<=m&&j==c.length&&h.push(p)}s=g*h.length}else s=g;l<s&&(l=s)}else{null!=e[o][d]&&null!=e[o][d].v&&null!=e[o][d].tr?(f=jfgridfontformat(e[o][d]),n.font=f,g=jfgrid.menuButton.getTextSize("田",f)[1],c=jfgrid.getcellvalue(o,d,e).toString(),u=n.measureText(c).width,"0"==e[o][d].tr?s=g:"1"==e[o][d].tr||"2"==e[o][d].tr?s=.707*(u+g)+4:"3"==e[o][d].tr?s=c.length*g+4:"4"!=e[o][d].tr&&"5"!=e[o][d].tr||(s=u+4),l<(s=Math.round(s))&&(l=s)):(f=jfgridfontformat(e[o][d]),l<(g=jfgrid.menuButton.getTextSize("田",f)[1])&&(l=g))}l!=defaultrowlen&&(a.rowlen[o]=l)}return a},jfgrid.computeRowlenArr=function(e,r){for(var t=[],i=0,a=0;a<e;a++){var n=defaultrowlen;null!=r.rowlen&&null!=r.rowlen[a]&&(n=r.rowlen[a]),null==r.rowhidden||null==r.rowhidden[a]?(i+=n+1,t.push(i)):(n=r.rowhidden[a],t.push(i))}return t},jfgrid.getdatabyselectionNoCopy=function(e){if(null==e||null==e.row||0==e.row.length)return[];for(var r=[],t=e.row[0];t<=e.row[1];t++){var i=[];if(null==config.rowhidden||null==config.rowhidden[t]){for(var a=e.column[0];a<=e.column[1];a++){var n="";null!=jfgrid.flowdata[t]&&null!=jfgrid.flowdata[t][a]&&(n=jfgrid.flowdata[t][a]),i.push(n)}r.push(i)}}return r},jfgrid.datagridgrowth=function(e,r,t,i){if(r<=0&&t<=0)return e;r<=0&&(r=0),t<=0&&(t=0);for(var a=0,a=0==e.length?(e=[],0):e[0].length,n=[],o=0;o<t;o++)n.push(null);for(var l=[],d=0;d<a+t;d++)l.push(null);for(d=0;d<e.length;d++)e[d]=[].concat(e[d].concat(n));for(d=0;d<r;d++)e.push([].concat(l));return i&&(jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,e.length,{k:"row"}),jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,e[0].length,{k:"column"})),e},jfgrid.cleargridelement=function(e){$("#jfgrid-cols-h-hover").hide(),$("#jfgrid-rightclick-menu").hide(),$("#jfgrid-cell-selected-boxs .jfgrid-cell-selected").hide(),$("#jfgrid-cols-h-selected .jfgrid-cols-h-selected").hide(),$("#jfgrid-rows-h-selected .jfgrid-rows-h-selected").hide(),$("#jfgrid-cell-selected-focus").hide(),$("#jfgrid-rows-h-hover").hide(),$("#jfgrid-selection-copy .jfgrid-selection-copy").hide(),$("#jfgrid-cols-menu-btn").hide(),$("#jfgrid-row-count-show, #jfgrid-column-count-show").hide(),e||jfgrid.selection.clearcopy(e),$("#jfgrid-dropCell-icon").is(":visible")&&e&&$("#jfgrid-dropCell-icon").remove(),jfgrid.menuButton.jfgridPaintModelOn&&!e&&jfgrid.menuButton.cancelPaintModel()},jfgrid.orderbydata=function(e,a,r){null==r&&(r=!0);return r?e.sort(function(e,r){var t=e[a],i=r[a];return"object"==jfgrid.getObjType(e[a])&&(t=e[a].v),"object"==jfgrid.getObjType(r[a])&&(i=r[a].v),jfgrid.func_methods.isRealNull(t)?1:jfgrid.func_methods.isRealNull(i)?-1:jfgrid.datecontroll.isdatetime(t)&&jfgrid.datecontroll.isdatetime(i)?jfgrid.datecontroll.diff(t,i):jfgrid.func_methods.isRealNum(t)&&jfgrid.func_methods.isRealNum(i)?numeral(t).value()-numeral(i).value():jfgrid.func_methods.isRealNum(t)||jfgrid.func_methods.isRealNum(i)?jfgrid.func_methods.isRealNum(t)?jfgrid.func_methods.isRealNum(i)?void 0:-1:1:t.localeCompare(i,"zh")}):e.sort(function(e,r){var t=e[a],i=r[a];return"object"==jfgrid.getObjType(e[a])&&(t=e[a].v),"object"==jfgrid.getObjType(r[a])&&(i=r[a].v),jfgrid.func_methods.isRealNull(t)?1:jfgrid.func_methods.isRealNull(i)?-1:jfgrid.datecontroll.isdatetime(t)&&jfgrid.datecontroll.isdatetime(i)?jfgrid.datecontroll.diff(i,t):jfgrid.func_methods.isRealNum(t)&&jfgrid.func_methods.isRealNum(i)?numeral(i).value()-numeral(t).value():jfgrid.func_methods.isRealNum(t)||jfgrid.func_methods.isRealNum(i)?jfgrid.func_methods.isRealNum(t)?jfgrid.func_methods.isRealNum(i)?void 0:1:-1:i.localeCompare(t,"zh")})},jfgrid.orderbydata1D=function(e,r){null==r&&(r=!0);return r?e.sort(function(e,r){var t=e,i=r;return"object"==jfgrid.getObjType(e)&&(t=e.v),"object"==jfgrid.getObjType(r)&&(i=r.v),null==t&&(t=""),null==i&&(i=""),jfgrid.datecontroll.isdatetime(t)&&jfgrid.datecontroll.isdatetime(i)?jfgrid.datecontroll.diff(t,i):jfgrid.func_methods.isRealNum(t)&&jfgrid.func_methods.isRealNum(i)?numeral(t).value()-numeral(i).value():jfgrid.func_methods.isRealNum(t)||jfgrid.func_methods.isRealNum(i)?jfgrid.func_methods.isRealNum(t)?jfgrid.func_methods.isRealNum(i)?void 0:-1:1:t.localeCompare(i,"zh")}):e.sort(function(e,r){var t=e,i=r;return"object"==jfgrid.getObjType(e)&&(t=e.v),"object"==jfgrid.getObjType(r)&&(i=r.v),null==t&&(t=""),null==i&&(i=""),jfgrid.datecontroll.isdatetime(t)&&jfgrid.datecontroll.isdatetime(i)?jfgrid.datecontroll.diff(i,t):jfgrid.func_methods.isRealNum(t)&&jfgrid.func_methods.isRealNum(i)?numeral(i).value()-numeral(t).value():jfgrid.func_methods.isRealNum(t)||jfgrid.func_methods.isRealNum(i)?jfgrid.func_methods.isRealNum(t)?jfgrid.func_methods.isRealNum(i)?void 0:1:-1:i.localeCompare(t,"zh")})},jfgrid.sortSelection=function(e){if(1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","");else{null==e&&(e=!0);for(var r,t,i=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),a=jfgird_select_save[0].row[0],n=jfgird_select_save[0].row[1],o=jfgird_select_save[0].column[0],l=jfgird_select_save[0].column[1],d=a;d<=n;d++)if(null!=i[d]&&null!=i[d][o]){var f=i[d][o];if(null!=f.mc||jfgrid.func_methods.isRealNull(f.v))continue;if(null==r&&/[\u4e00-\u9fa5]+/g.test(f.v)){t=r=d+1;continue}null==r&&(r=d),t=d}if(!(null==r||n<r)){for(var s=!1,g=[],d=r;d<=t;d++){for(var c=[],u=o;u<=l;u++){if(null!=i[d][u]&&null!=i[d][u].mc){s=!0;break}c.push(i[d][u])}g.push(c)}if(s)jfgrid.isEditMode()?alert("选区有合并单元格，无法执行此操作！"):jfgrid.tooltip.info("选区有合并单元格，无法执行此操作！","");else{g=jfgrid.orderbydata(g,0,e);for(var m,d=r;d<=t;d++)for(u=o;u<=l;u++)i[d][u]=g[d-r][u-o];null!=config.rowlen?(m=$.extend(!0,{},config),m=jfgrid.rowlenByRange(i,r,t,m),jfgrid.jfrefreshgrid(i,[{row:[r,t],column:[o,l]}],m,null,!0)):jfgrid.jfrefreshgrid(i,[{row:[r,t],column:[o,l]}])}}}},jfgrid.sortColumnSeletion=function(e,r){null==r&&(r=!0);for(var t,i,a=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),n=a.length-1,o=a[0].length-1,l=0;l<=n;l++)null!=a[l][e]&&null!=a[l][e].mc||(null==a[l][e]||jfgrid.func_methods.isRealNull(a[l][e].v)||!/[\u4e00-\u9fa5]+/g.test(a[l][e].v)||null!=t?(null==t&&(t=l),null==a[l][e]||jfgrid.func_methods.isRealNull(a[l][e].v)||(i=l)):i=t=l+1);if(!(null==t||n<t)){for(var d=!1,f=[],l=t;l<=i;l++){for(var s=[],g=0;g<=o;g++){if(null!=a[l][g]&&null!=a[l][g].mc){d=!0;break}s.push(a[l][g])}f.push(s)}if(d)jfgrid.isEditMode()?alert("列排序会扩展至整个表格选区，选区有合并单元格，无法执行此操作，请选择功能栏排序功能！"):jfgrid.tooltip.info("列排序会扩展至整个表格选区，选区有合并单元格，无法执行此操作，请选择功能栏排序功能！","");else{f=jfgrid.orderbydata(f,e,r);for(var c,l=t;l<=i;l++)for(g=0;g<=o;g++)a[l][g]=f[l-t][+g];null!=config.rowlen?(c=$.extend(!0,{},config),c=jfgrid.rowlenByRange(a,t,i,c),jfgrid.jfrefreshgrid(a,[{row:[t,i],column:[0,o]}],c,null,!0)):jfgrid.jfrefreshgrid(a,[{row:[t,i],column:[0,o]}])}}};var jfgridfile=null,container=null,defaultcolumnNum=60,defaultrowNum=84,fullscreenmode=!0;jfgrid.getjfgridfile=function(){return jfgridfile},jfgrid.setjfgridfile=function(e){jfgridfile=e},jfgrid.getconfig=function(){return config},jfgrid.setconfig=function(e){config=e,null!=jfgridfile&&(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=e)},jfgrid.getvisibledatarow=function(){return visibledatarow},jfgrid.setvisibledatarow=function(e){visibledatarow=e,null!=jfgridfile&&(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].visibledatarow=e)},jfgrid.getvisibledatacolumn=function(){return visibledatacolumn},jfgrid.setvisibledatacolumn=function(e){visibledatacolumn=e,null!=jfgridfile&&(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].visibledatacolumn=e)},jfgrid.sheetmanage={generateRandomSheetIndex:function(e){null==e&&(e="Sheet");for(var r=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="",i=0;i<12;i++)t+=r[Math.round(Math.random()*(r.length-1))];return e+"_"+t+"_"+(new Date).getTime()},generateRandomSheetName:function(e,r){for(var t,i=e.length,a=0;a<e.length;a++){!(-1<e[a].name.indexOf("Sheet")||-1<e[a].name.indexOf("数据透视表"))||"NaN"!=(t=parseFloat(e[a].name.replace("Sheet","").replace("数据透视表","")))&&Math.ceil(t)>i&&(i=Math.ceil(t))}return r?"数据透视表"+(i+1):"Sheet"+(i+1)},generateCopySheetName:function(e,r){var t="";if(-1<r.toString().indexOf("(副本")){for(var i=r.toString().indexOf("(副本"),a=r.toString().substring(0,i)+"(副本",n=null,o=0;o<e.length;o++){-1<(d=(l=e[o].name.toString()).indexOf(a))&&(f=l.indexOf(")",d+a.length),s=l.substring(d+a.length,f),jfgrid.func_methods.isRealNum(s)&&(null==n||parseInt(s)>n)&&(n=parseInt(s)))}t=null==n?a+"2)":a+ ++n+")"}else{for(var l,d,f,s,n=null,g=!1,a=r+"(副本",o=0;o<e.length;o++){-1<(d=(l=e[o].name.toString()).indexOf(a))&&(g=!0,f=l.indexOf(")",d+a.length),s=l.substring(d+a.length,f),jfgrid.func_methods.isRealNum(s)&&(null==n||parseInt(s)>n)&&(n=parseInt(s)))}t=g?null==n?r+"(副本2)":r+"(副本"+ ++n+")":r+"(副本)"}return t},getSheetByIndex:function(e){null==e&&(e=jfgrid.currentSheetIndex);var r=this.getSheetIndex(e);return jfgridfile[r]},getCurSheetnoset:function(){for(var e=0,r=0;r<jfgridfile.length;r++)if(1==jfgridfile[r].status){e=jfgridfile[r].index;break}return e},getCurSheet:function(){jfgrid.currentSheetIndex=jfgridfile[0].index;for(var e=0;e<jfgridfile.length;e++)if(1==jfgridfile[e].status){jfgrid.currentSheetIndex=jfgridfile[e].index;break}return jfgrid.currentSheetIndex},addNewSheet:function(e,r){var t,i,a,n,o;jfgrid.isEditMode()||(t=jfgridfile.length,i=jfgrid.sheetmanage.generateRandomSheetIndex(),a=jfgrid.sheetmanage.generateRandomSheetName(jfgrid.getjfgridfile(),r),$("#jfgrid-sheet-container-c").append(jfgrid.replaceHtml(sheetHTML,{index:i,active:"",name:a,style:"",colorset:""})),n={name:a,color:"",status:"0",order:t,index:i,celldata:[],row:defaultrowNum,column:defaultcolumnNum,config:{},pivotTable:null,isPivotTable:!!r},jfgridfile.push(n),$("#jfgrid-sheet-area div.jfgrid-sheets-item").removeClass("jfgrid-sheets-item-active"),$("#jfgrid-sheets-item"+i).addClass("jfgrid-sheets-item-active"),$("#jfgrid-cell-main").append('<div id="jfgrid-datavisual-selection-set-'+i+'" class="jfgrid-datavisual-selection-set"></div>'),jfgrid.cleargridelement(e),jfgrid.server.saveParam("sha",null,$.extend(!0,{},n)),clearjfundo&&(o={type:"addSheet"},jfgrid.jfundo=[],o.sheetconfig=$.extend(!0,{},n),o.index=i,o.currentSheetIndex=jfgrid.currentSheetIndex,jfgrid.jfredo.push(o)),this.changeSheetExec(i,r,!0))},setSheetHide:function(e){jfgridfile[this.getSheetIndex(e)].hide=1;var r=$("#jfgrid-sheets-item"+e);r.hide(),$("#jfgrid-sheet-area div.jfgrid-sheets-item").removeClass("jfgrid-sheets-item-active");var t=r.nextAll(":visible"),t=0<r.nextAll(":visible").length?t.eq(0).data("index"):r.prevAll(":visible").eq(0).data("index");$("#jfgrid-sheets-item"+t).addClass("jfgrid-sheets-item-active"),this.changeSheetExec(t),jfgrid.server.saveParam("sh",r.data("index"),1,{op:"hide",cur:t})},setSheetShow:function(e){jfgridfile[this.getSheetIndex(e)].hide=0,this.changeSheetExec(e),jfgrid.server.saveParam("sh",e,0,{op:"show",cur:null})},sheetMaxIndex:0,ordersheet:function(t){return function(e,r){return e[t]-r[t]}},getCurrentOrder:function(){var i={};return $("#jfgrid-sheet-area div.jfgrid-sheets-item").each(function(e){for(var r=$(this).data("index"),t=0;t<jfgridfile.length;t++)if(jfgridfile[t].index==r){i[r.toString()]=e;break}}),i},reOrderAllSheet:function(){var i={};$("#jfgrid-sheet-area div.jfgrid-sheets-item").each(function(e){for(var r=$(this).data("index"),t=0;t<jfgridfile.length;t++)if(jfgridfile[t].index==r){jfgridfile[t].order=e,i[r.toString()]=e;break}}),jfgrid.server.saveParam("shr",null,i)},createSheet:function(){var e=[];jfgridfile.sort(this.ordersheet("order"));for(var r=0;r<jfgridfile.length;r++){var t="",i=jfgridfile[r].index,a="";null!=jfgridfile[r].color&&(a='<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+jfgridfile[r].color+';"></div>'),jfgrid.currentSheetIndex==i?e.push(jfgrid.replaceHtml(sheetHTML,{index:i,active:"jfgrid-sheets-item-active",name:jfgridfile[r].name,style:"",colorset:a})):(1==jfgridfile[r].hide?e.push(jfgrid.replaceHtml(sheetHTML,{index:i,active:"",name:jfgridfile[r].name,style:"display:none;",colorset:a})):e.push(jfgrid.replaceHtml(sheetHTML,{index:i,active:"",name:jfgridfile[r].name,style:"",colorset:a})),t="style='display:none;'"),$("#jfgrid-cell-main").append("<div "+t+' id="jfgrid-datavisual-selection-set-'+i+'" class="jfgrid-datavisual-selection-set"></div>')}$("#jfgrid-sheet-container-c").append(e.join("")),this.locationSheet()},locationSheet:function(){var e=$("#jfgrid-sheet-container-c"),r=$("#"+container).width(),t=($("#jfgrid-sheet-container-c > div.jfgrid-sheets-item-active").eq(0),0),i=0;$("#jfgrid-sheet-container-c > div.jfgrid-sheets-item:visible").each(function(){$(this).hasClass("jfgrid-sheets-item-active")&&(t=i),i+=$(this).outerWidth()}),setTimeout(function(){e.scrollLeft(t-10),.7*r<=i&&($("#jfgrid-sheet-area .jfgrid-sheets-scroll").css("display","inline-block"),$("#jfgrid-sheet-container .docs-sheet-fade-left").show())},1)},copySheet:function(e,r){var t,i,a,n,o,l,d;jfgrid.isEditMode()||(t=jfgridfile.length,i=jfgrid.sheetmanage.generateRandomSheetIndex(),a=this.getSheetIndex(e),(n=$.extend(!0,{},jfgridfile[a])).order=t,n.index=i,n.name=this.generateCopySheetName(jfgridfile,n.name),o="",null!=n.color&&(o='<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+n.color+';"></div>'),l=$("#jfgrid-sheets-item"+e),$("#jfgrid-sheet-container-c").append(jfgrid.replaceHtml(sheetHTML,{index:n.index,active:"",name:n.name,order:n.order,style:"",colorset:o})),$("#jfgrid-sheets-item"+n.index).insertAfter(l),jfgridfile.splice(e+1,0,n),$("#jfgrid-sheet-area div.jfgrid-sheets-item").removeClass("jfgrid-sheets-item-active"),$("#jfgrid-sheets-item"+i).addClass("jfgrid-sheets-item-active"),$("#jfgrid-cell-main").append('<div id="jfgrid-datavisual-selection-set-'+i+'" class="jfgrid-datavisual-selection-set"></div>'),jfgrid.cleargridelement(r),jfgrid.server.saveParam("shc",i,{copyindex:e,name:n.name}),this.changeSheetExec(i),this.reOrderAllSheet(),clearjfundo?jfgrid.jfredo.push({type:"copySheet",copyindex:e,index:n.index,sheetIndex:n.index}):0<jfgrid.jfredo.length&&("copySheet"==(d=jfgrid.jfredo[jfgrid.jfredo.length-1]).type&&(d.index=n.index,d.sheetIndex=n.index)))},hasSheet:function(e){return null!=e&&null!=(e=this.getSheetIndex(e))},createSheetbydata:function(e,r){var t="";null!=e.color&&(t='<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e.color+';"></div>'),$("#jfgrid-sheet-container-c").append(jfgrid.replaceHtml(sheetHTML,{index:e.index,active:"",name:e.name,order:e.order,style:"",colorset:t}));var i=e.order;i>=jfgridfile.length?(i=jfgridfile.length-1,$("#jfgrid-sheets-item"+e.index).insertAfter($("#jfgrid-sheets-item"+jfgridfile[i].index))):$("#jfgrid-sheets-item"+e.index).insertBefore($("#jfgrid-sheets-item"+jfgridfile[i].index)),jfgridfile.push(e),$("#jfgrid-sheet-area div.jfgrid-sheets-item").removeClass("jfgrid-sheets-item-active"),$("#jfgrid-sheets-item"+e.index).addClass("jfgrid-sheets-item-active"),$("#jfgrid-cell-main").append('<div id="jfgrid-datavisual-selection-set-'+e.index+'" class="jfgrid-datavisual-selection-set"></div>'),jfgrid.cleargridelement(),null!=r?(jfgrid.server.saveParam("shre",null,{reIndex:e.index}),e.hide=0,jfgrid.server.saveParam("sh",e.index,0,{op:"show",cur:null})):jfgrid.server.saveParam("sha",null,e),this.changeSheetExec(e.index,e.isPivotTable,!0),this.reOrderAllSheet()},deleteSheet:function(e){var r=this.getSheetIndex(e);this.setSheetHide(e),$("#jfgrid-sheets-item"+e).remove(),$("#jfgrid-datavisual-selection-set-"+e).remove();var t=jfgridfile.splice(r,1);this.reOrderAllSheet(),jfgrid.server.saveParam("shd",null,{deleIndex:e}),clearjfundo&&(t[0].type="deleteSheet",jfgrid.jfredo.push(t[0]))},nulldata:null,getGridData:function(e){for(var r=[],t=0;t<e.length;t++)for(var i=0;i<e[0].length;i++)null!=e[t][i]&&r.push({r:t,c:i,v:e[t][i]});return r},buildGridData:function(e){var r=null==e.row?defaultrowNum:e.row,t=null==e.column?defaultcolumnNum:e.column,i=jfgrid.datagridgrowth([],r,t),a=e.celldata;if(null!=a)for(var n=0;n<a.length;n++){var o=a[n],l=o.r,d=o.c,f=o.v;l>=i.length&&(i=jfgrid.datagridgrowth(i,l-i.length+1,0)),d>=i[0].length&&(i=jfgrid.datagridgrowth(i,0,d-i[0].length+1)),jfgrid.setcellvalue(l,d,i,f)}return jfgridConfigsetting.autoFormatw=!1,jfgridConfigsetting.accuracy=void 0,i},cutGridData:function(e){for(var r=0,t=e.length-1;0<=t;t--){for(var i=!0,a=0;a<e[0].length;a++){var n=jfgrid.getcellvalue(t,a);if(null!=n&&0<$.trim(n).length){i=!1;break}}if(!i)break;r=t}return e.slice(0,r)},addGridData:function(e,r,t){var i=jfgrid.datagridgrowth([],r,t);if(null!=e)for(var a=0;a<e.length;a++){var n=e[a],o=n.r,l=n.c,d=n.v;o>=i.length&&(i=jfgrid.datagridgrowth(i,o-i.length+1,0)),l>=i[0].length&&(i=jfgrid.datagridgrowth(i,0,l-i[0].length+1)),jfgrid.setcellvalue(o,l,i,d)}return i},initialjfFile:function(menu,title){var _this=this;this.getCurSheet();var file=jfgridfile[_this.getSheetIndex(jfgrid.currentSheetIndex)];this.nulldata=jfgrid.datagridgrowth([],defaultrowNum,defaultcolumnNum);var data=_this.buildGridData(file);jfgird_select_save=file.jfgird_select_save,null!=jfgird_select_save&&0!=jfgird_select_save.length||(jfgird_select_save=null!=data[0]&&null!=data[0][0]&&null!=data[0][0].mc?[{row:[0,data[0][0].mc.rs-1],column:[0,data[0][0].mc.cs-1]}]:[{row:[0,0],column:[0,0]}]),jfgrid_selection_range=null==file.jfgrid_selection_range?[]:file.jfgrid_selection_range,config=null==file.config?{}:file.config;var r2=jfgird_select_save[0].row[1],c2=jfgird_select_save[0].column[1];if(1<jfgird_select_save.length)for(var i=0;i<jfgird_select_save.length;i++)jfgird_select_save[i].row[1]>r2&&(r2=jfgird_select_save[i].row[1]),jfgird_select_save[i].column[1]>c2&&(c2=jfgird_select_save[i].column[1]);file.data=data;var rowheight=data.length;rowheight-1<r2&&(rowheight=r2+1);var colwidth=data[0].length;colwidth-1<c2&&(colwidth=c2+1),jfgrid.jfgridcreatedom(colwidth,rowheight,data,menu,title),setTimeout(function(){jfgrid.tooltip.createHoverTip("#jfgrid_info_detail",".jfgrid_info_detail_title, .jfgrid_info_detail_input, .jfgrid_info_detail_update"),jfgrid.tooltip.createHoverTip("#jfgrid-wa-editor",".jfgrid-toolbar-menu-button, .jfgrid-toolbar-button, .jfgrid-toolbar-combo-button"),jfgridTableContentHW=[$("#jfgrid-cell-main").width()+rowHeaderWidth-cellMainSrollBarSize,$("#jfgrid-cell-main").height()+columeHeaderHeight-cellMainSrollBarSize],$("#jfgridTableContent, #jfgridTableContentF").attr({width:Math.ceil(jfgridTableContentHW[0]*devicePixelRatio),height:Math.ceil(jfgridTableContentHW[1]*devicePixelRatio)}).css({width:jfgridTableContentHW[0],height:jfgridTableContentHW[1]}).get(0).getContext("2d");var key=jfgrid.server.gridKey,cahce_key=key+"__qkcache",ini=function(){file.load="1",_this.createSheet();for(var sheetindexset=_this.checkLoadSheetIndex(file),sheetindex=[],i=0;i<sheetindexset.length;i++){var item=sheetindexset[i];item!=file.index&&sheetindex.push(item)}var execF=function(){_this.storeSheetParam(),_this.restoreselect(),jfgrid.sheetmanage.CacheNotLoadControll=[],jfgrid.sheetmanage.restoreCache(),jfgrid.formula.execFunctionGroup(),jfgrid.sheetmanage.restoreSheetAll(jfgrid.currentSheetIndex),jfgrid.jfgridrefreshgrid(0,0),$("#jfgrid_info_detail_save").html("已恢复本地缓存"),file.isPivotTable?(jfgridcurrentisPivotTable=!0,jfgrid.pivotTable.changePivotTable(jfgrid.currentSheetIndex)):(jfgridcurrentisPivotTable=!1,$("#jfgrid-modal-dialog-slider-pivot").hide(),jfgrid.jfgridsizeauto()),"function"==typeof jfgrid.jfgridConfigsetting.beforeCreateDom&&jfgrid.jfgridConfigsetting.beforeCreateDom(jfgrid),jfgridConfigsetting.pointEdit?setTimeout(function(){$("#jfgridloadingdata").remove()},0):setTimeout(function(){$("#jfgridloadingdata").fadeOut().remove()},500)},loadSheetUrl=jfgrid.server.loadSheetUrl;0==sheetindex.length||""==loadSheetUrl?execF():$.post(loadSheetUrl,{gridKey:jfgrid.server.gridKey,index:sheetindex.join(",")},function(d){var dataset=eval("("+d+")"),otherfile;for(var item in dataset){item!=file.index&&(otherfile=jfgridfile[_this.getSheetIndex(item)],null!=otherfile.load&&"0"!=otherfile.load||(otherfile.celldata=dataset[item.toString()],otherfile.data=_this.buildGridData(otherfile),otherfile.load="1"))}execF()})};try{localforage.getItem(cahce_key).then(function(e){null!=e&&(jfgrid.sheetmanage.CacheNotLoadControll=e),jfgrid.server.clearcachelocaldata(function(){ini()})})}catch(e){ini()}},1)},storeSheetParam:function(){var e=this.getSheetIndex(jfgrid.currentSheetIndex),r=jfgridfile[e];r.visibledatarow=visibledatarow,r.visibledatacolumn=visibledatacolumn,r.rowsplit=rowsplit,r.ch_width=ch_width,r.rh_height=rh_height,r.jfgird_select_save=$.extend(!0,[],jfgird_select_save),r.jfgrid_selection_range=$.extend(!0,[],jfgrid_selection_range),r.scrollLeft=$("#jfgrid-cell-main").scrollLeft(),r.scrollTop=$("#jfgrid-cell-main").scrollTop()},setSheetParam:function(e){var r=this.getSheetIndex(jfgrid.currentSheetIndex),t=jfgridfile[r];jfgrid.flowdata=t.data,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata),jfgrid.postil.buildAllPs(jfgrid.flowdata),config=t.config,jfgird_select_save=null==t.jfgird_select_save?[]:t.jfgird_select_save,jfgrid_selection_range=null==t.jfgrid_selection_range?[]:t.jfgrid_selection_range,null==t.freezen?(jfgrid.freezen.freezenhorizontaldata=null,jfgrid.freezen.freezenverticaldata=null):(jfgrid.freezen.freezenhorizontaldata=null==t.freezen.horizontal?null:t.freezen.horizontal.freezenhorizontaldata,jfgrid.freezen.freezenverticaldata=null==t.freezen.vertical?null:t.freezen.vertical.freezenverticaldata),jfgrid.createFilterOptions(t.filter_select,t.filter),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length)},restoreselect:function(){var e=this.getSheetIndex(jfgrid.currentSheetIndex),r=jfgridfile[e];jfgrid.selectHightlightShow(),jfgrid.selectionCopyShow(),null!=r.scrollLeft&&0<r.scrollLeft?$("#jfgrid-scrollbar-x").scrollLeft(r.scrollLeft):$("#jfgrid-scrollbar-x").scrollLeft(0),null!=r.scrollTop&&0<r.scrollTop?$("#jfgrid-scrollbar-y").scrollTop(r.scrollTop):$("#jfgrid-scrollbar-y").scrollTop(0)},storeSheetParamALL:function(){this.storeSheetParam();var e=this.getSheetIndex(jfgrid.currentSheetIndex);jfgridfile[e].data=jfgrid.flowdata,jfgridfile[e].config=$.extend(!0,{},config)},changeSheet:function(index,isPivotInitial,isNewSheet){var file,data,cfg,_this,load,loadSheetUrl,data,sheetindex;jfgrid.isEditMode()||(jfgrid.server.allowUpdate&&($("#jfgrid-cell-main #jfgrid-multipleRange-show").empty(),jfgrid.server.multipleIndex=0),$("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex+", #jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).hide(),$("#jfgrid-filter-selected-sheet"+index+", #jfgrid-filter-options-sheet"+index).show(),this.storeSheetParamALL(),this.setCurSheet(index),file=jfgridfile[this.getSheetIndex(index)],data=file.data,cfg=file.config,file.isPivotTable?(jfgridcurrentisPivotTable=!0,isPivotInitial||jfgrid.pivotTable.changePivotTable(index)):(jfgridcurrentisPivotTable=!1,$("#jfgrid-modal-dialog-slider-pivot").hide(),jfgrid.jfgridsizeauto()),_this=this,load=file.load,null!=load?(_this.setSheetParam(!0),_this.showSheet(),setTimeout(function(){jfgrid.formula.execFunctionGroup(),jfgrid.jfgridrefreshgrid(),jfgrid.server.saveParam("shs",null,jfgrid.currentSheetIndex)},1)):(loadSheetUrl=jfgrid.server.loadSheetUrl,""==loadSheetUrl||jfgridcurrentisPivotTable||isNewSheet?(data=_this.buildGridData(file),file.data=data,file.load="1",_this.setSheetParam(),_this.showSheet(),setTimeout(function(){jfgrid.sheetmanage.restoreCache(),jfgrid.formula.execFunctionGroup(),jfgrid.sheetmanage.restoreSheetAll(jfgrid.currentSheetIndex),jfgrid.jfgridrefreshgrid()},1),jfgrid.server.saveParam("shs",null,jfgrid.currentSheetIndex)):($("#jfgrid-grid-window-1").append('<div id="jfgridloadingdata" style="width:100%;text-align:center;position:absolute;top:0px;height:100%;font-size: 16px;z-index:1000000000;background:#fff;"><div style="position:relative;top:45%;width:100%;"> <div class="jfgridLoaderGif"></div> <span>正在准备！请稍后</span></div></div>'),sheetindex=this.checkLoadSheetIndex(file),$.post(loadSheetUrl,{gridKey:jfgrid.server.gridKey,index:sheetindex.join(",")},function(d){var dataset=eval("("+d+")");file.celldata=dataset[index.toString()];var data=_this.buildGridData(file),otherfile;for(var item in setTimeout(function(){$("#jfgridloadingdata").fadeOut().remove()},500),dataset){item!=index&&(otherfile=jfgridfile[_this.getSheetIndex(item)],null!=otherfile.load&&"0"!=otherfile.load||(otherfile.celldata=dataset[item.toString()],otherfile.data=_this.buildGridData(otherfile),otherfile.load="1"))}file.data=data,file.load="1",_this.setSheetParam(),_this.showSheet(),setTimeout(function(){jfgrid.sheetmanage.restoreCache(),jfgrid.formula.execFunctionGroup(),jfgrid.sheetmanage.restoreSheetAll(jfgrid.currentSheetIndex),jfgrid.jfgridrefreshgrid()},1),jfgrid.server.saveParam("shs",null,jfgrid.currentSheetIndex)}))),$("#jfgrid-cell-main .jfgrid-datavisual-selection-set").hide(),$("#jfgrid-datavisual-selection-set-"+index).show(),window.generator&&generator.renderChartShow(index),jfgrid.freezen.initialFreezen(index),this.restoreselect())},checkLoadSheetIndex:function(e){var r=e.calcChain,t=e.chart,i=e.pivotTable,a=[],n={};if(a.push(e.index),n[e.index.toString()]=1,null!=r)for(var o=0;o<r.length;o++){null!=(l=r[o].index)&&null==n[l.toString()]&&(a.push(l),n[l.toString()]=1)}if(null!=t)for(var l,o=0;o<t.length;o++){null!=(l=t[o].dataSheetIndex)&&null==n[l.toString()]&&(a.push(l),n[l.toString()]=1)}return null!=i&&null!=(l=i.pivotDataSheetIndex)&&null==n[l.toString()]&&(a.push(l),n[l.toString()]=1),a},showSheet:function(){$("#jfgrid-cell-flow_0").css({width:ch_width,top:"-1px"}),$("#jfgrid-sheettable_0").css({width:ch_width-1,height:rh_height}),$("#jfgridrowHeader_0").css("height",rh_height),$("#jfgrid-cols-h-cells_0").css("width",ch_width),$("#jfgrid-scrollbar-x div").width(ch_width),$("#jfgrid-scrollbar-y div").height(rh_height-30)},setCurSheet:function(e){for(var r=0;r<jfgridfile.length;r++)jfgridfile[r].index==e?jfgridfile[r].status=1:jfgridfile[r].status=0;jfgrid.currentSheetIndex=e},getSheetIndex:function(e){for(var r=0;r<jfgridfile.length;r++)if(jfgridfile[r].index==e)return r;return null},changeSheetExec:function(e,r,t){var i=$("#jfgrid-sheets-item"+e);window.jfgrid_getcelldata_cache=null,$("#jfgrid-sheet-area div.jfgrid-sheets-item").removeClass("jfgrid-sheets-item-active"),i.addClass("jfgrid-sheets-item-active").show(),jfgrid.cleargridelement(),this.changeSheet(e,r,t),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide(),jfgrid.formula.rangestart&&jfgrid.formula.createRangeHightlight();var a=$("#jfgrid-sheet-container-c");a.scrollLeft(i.offset().left);var n=a.width(),o=a[0].scrollWidth,l=a.scrollLeft();l<=0?$("#jfgrid-sheet-container .docs-sheet-fade-left").hide():$("#jfgrid-sheet-container .docs-sheet-fade-left").show(),o<=n+l?$("#jfgrid-sheet-container .docs-sheet-fade-right").hide():$("#jfgrid-sheet-container .docs-sheet-fade-right").show()},delChart:function(e,r){var t=this.getSheetIndex(r),i=jfgridfile[t];if(null==i.chart)i.chart=[];else for(var a=0;a<i.chart.length;a++)if(i.chart[a].chart_id==e){jfgridfile[t].chart.splice(a,1);break}},saveChart:function(e){var r=this.getSheetIndex(e.sheetIndex),t=jfgridfile[r];if(null==t.chart)t.chart=[],t.chart.push(e);else{for(var i=0;i<t.chart.length;i++)if(t.chart[i].chart_id==e.chart_id){var a=$.extend(!0,{},t.chart[i]);return void(t.chart[i]=$.extend(!0,{},a,e))}t.chart.push(e)}},getChart:function(e,r){var t=getSheetIndex(e),i=jfgridfile[t];if(null==i.chart)return null;for(var a=0;a<i.chart.length;a++)if(i.chart[a].chart_id==r)return i.chart[a];return null},restoreChart:function(e){if(-1==jfgrid.chartparam.jfgrid_chartIns_index)for(var r=jfgrid.chartparam.jfgrid_chartIns_index=0;r<jfgridfile.length;r++){var t=jfgridfile[r].chart;null!=t&&(jfgrid.chartparam.jfgrid_chartIns_index+=t.length)}var i=this.getSheetIndex(e),a=jfgridfile[i];if(null!=a.chart)for(r=0;r<a.chart.length;r++){var n,o,l,d,f,s=a.chart[r];null!=s.sheetIndex&&null!=s.dataSheetIndex&&null!=s.row&&null!=s.column&&0==$("#"+s.chart_id).length&&((l=o=n=null)!=s.chart_id?(o=s.chart_id,d=parseInt(o),isNaN(d)?d=jfgrid.chartparam.jfgrid_chartIns_index++:d>jfgrid.chartparam.jfgrid_chartIns_index&&(jfgrid.chartparam.jfgrid_chartIns_index=d),n=jfgrid.jfcolor[d],l=o+"_selection"):(n=jfgrid.jfcolor[jfgrid.chartparam.jfgrid_chartIns_index],l=(o="jfgrid-datav-chart-"+jfgrid.chartparam.jfgrid_chartIns_index++)+"_selection",s.chart_id=o),f=null==(f=s.chartTheme)?"default0000":f,jfgrid.insertChartTosheet(s.sheetIndex,s.dataSheetIndex,s.option,s.chartType,s.selfOption,s.defaultOption,s.row,s.column,n,o,l,s.chartStyle,s.rangeConfigCheck,s.rangeRowCheck,s.rangeColCheck,s.chartMarkConfig,s.chartTitleConfig,s.winWidth,s.winHeight,s.scrollLeft,s.scrollTop,f,s.myWidth,s.myHeight,null!=s.myLeft?parseFloat(s.myLeft):null,null!=s.myTop?parseFloat(s.myTop):null,s.myindexrank,!0))}},getRangetxt:function(e,r,t){var i="";null==t&&(t=jfgrid.currentSheetIndex),e!=t&&(i=jfgridfile[this.getSheetIndex(e)].name+"!");var a=r.row[0],n=r.row[1],o=r.column[0],l=r.column[1];return null==a&&null==n?i+jfgrid.jfgridchatatABC(o)+":"+jfgrid.jfgridchatatABC(l):null==o&&null==l?i+(a+1)+":"+(n+1):o==l&&a==n?i+jfgrid.jfgridchatatABC(o)+(a+1):i+jfgrid.jfgridchatatABC(o)+(a+1)+":"+jfgrid.jfgridchatatABC(l)+(n+1)},getSheetName:function(e){return null==e&&(e=jfgrid.currentSheetIndex),jfgridfile[this.getSheetIndex(e)].name},getSheetMerge:function(){return null==config.merge?null:config.merge},getSheetData:function(e){return null==e&&(e=jfgrid.currentSheetIndex),jfgridfile[this.getSheetIndex(e)].data},getSheetConfig:function(e){return null==e&&(e=jfgrid.currentSheetIndex),null==jfgridfile[this.getSheetIndex(e)].config&&(jfgridfile[this.getSheetIndex(e)].config={}),jfgridfile[this.getSheetIndex(e)].config},restoreFilter:function(e){var i,r=this.getSheetIndex(e),a=jfgridfile[r];0<$("#jfgrid-filter-selected-sheet"+e).length||null==a.filter_select||"{}"==JSON.stringify(a.filter_select)?null!=a.config&&null!=a.config.rowhidden&&(a.config.rowhidden={},config=a.config,jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length)):("object"!=jfgrid.getObjType(a.filter_select)&&(a.filter_select=JSON.parse(a.filter_select)),null!=a.filter_select&&null!=a.filter_select.row&&null!=a.filter_select.column&&(jfgrid.createFilterOptions(a.filter_select),"object"!=jfgrid.getObjType(a.filter)&&null!=a.filter&&"string"==jfgrid.getObjType(a.filter)&&(a.filter=JSON.parse(a.filter)),i={},null!=a.config&&null!=a.config.rowhidden&&(i=a.config.rowhidden),$("#jfgrid-filter-options-sheet"+e+" .jfgrid-filter-options").each(function(e){if(null==a.filter)return!1;var r=$(this),t=a.filter[e];if(null==t)return!0;"object"!=jfgrid.getObjType(t)&&(t=JSON.parse(t)),jfgrid.labelFilterOptionState(r,t.optionstate,t.rowhidden,t.caljs,!1,t.st_r,t.ed_r,t.cindex,t.st_c,t.ed_c),i=$.extend(!0,i,t.rowhidden)}),null==a.config&&(a.config={}),a.config.rowhidden=i,config=a.config,jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length)))},restorePivot:function(e){var r=this.getSheetIndex(e);jfgridfile[r].isPivotTable&&(jfgrid.pivotTable.getCellData(e),jfgrid.pivotTable.initialPivotManage(!0),jfgrid.pivotTable.refreshPivotTable())},restoreSheetAll:function(e){this.restorePivot(e),this.restoreFilter(e),this.restoreFreezen(e)},restoreFreezen:function(e){jfgrid.freezen.initialFreezen(e)},restoreCache:function(){jfgrid.server.gridKey;var e=this.CacheNotLoadControll;if(this.CacheNotLoadControll=[],0!=e.length)for(var r=0;r<e.length;r++){var t=e[r];this.execCache(t)}},CacheNotLoadControll:[],execCache:function(item){var type=item.t,index=item.i,value=item.v,_this=this,file=jfgridfile[_this.getSheetIndex(index)];if("sha"==type)jfgridfile.push(value);else if("shc"==type){var copyjson=$.extend(!0,{},jfgridfile[_this.getSheetIndex(value.copyindex)]);copyjson.index=index,jfgridfile.push(copyjson)}else if("shd"==type)jfgridfile.splice(value.deleIndex,1);else if("shr"==type)for(var pos in value)jfgridfile[_this.getSheetIndex(pos)].order=value[pos];if(null!=file&&"1"==file.load||type in{sha:0,shc:0,shd:0,shr:0})if("v"==type){var r=item.r,c=item.c,v=item.v,data=_this.getSheetData(index);file.data[r][c]=v}else if("fc"==type){var op=item.op,pos=item.pos;"object"!=jfgrid.getObjType(value)&&(value=eval("("+value+")"));var r=value.r,c=value.c,func=value.func;"del"==op?jfgrid.formula.delFunctionGroup(r,c,index):jfgrid.formula.insertUpdateFunctionGroup(r,c,func,index)}else if("cg"==type){var v=value,k=item.k,config1=_this.getSheetConfig(index);for(var key in k in config1||(config1[k]={}),v)config1[k][key]=v[key];config=config1}else if("f"==type){var v=value,op=item.op,pos=item.pos,filter=file.filter;null==filter&&(filter={}),"upOrAdd"==op?filter[pos]=v:"del"==op&&delete filter[pos]}else if("fsc"==type)file.filter=null,file.filter_select=null;else if("fsr"==type){var v=value;file.filter=v.filter,file.filter_select=v.filter_select}else if("sh"==type){var op=item.op,cur=item.cur,v=value;if("hide"==op)file.status=0,jfgridfile[_this.getSheetIndex(cur)].status=1;else if("show"==op){for(var i=0;i<jfgridfile.length;i++)jfgridfile[i].status=0;file.status=1}}else if("all"==type){var k=item.k,s=item.s;s&&"object"!=jfgrid.getObjType(value)?file[k]=JSON.stringify(value):file[k]=value}else if("c"==type){var op=item.op,cid=item.cid;if("add"==op)file.chart.push(value);else if("xy"==op||"wh"==op||"update"==op){for(var i=0;i<file.chart.length;i++)if(file.chart[i].chart_id==cid){for(var item in file.chart[i])for(var vitem in value)item==vitem&&(file.chart[i][item]=value[vitem]);return}}else if("del"==op)for(var i=0;i<file.chart.length;i++)if(file.chart[i].chart_id==cid)return void file.chart.splice(i,1)}else if("drc"==type){var rc=item.rc,index=value.index,len=value.len,celldata=file.celldata;if("r"==rc){for(var i=0;0==celldata.length;i++){var cell=celldata[i];cell.r>=index&&cell.r<index+len?delete cell:cell.r>=index+len&&(cell.r-=len)}file.row-=len}else{for(var i=0;0==celldata.length;i++){var cell=celldata[i];cell.c>=index&&cell.c<index+len?delete cell:cell.c>=index+len&&(cell.c-=len)}file.column-=len}for(var ret=[],i=0,mtype,mst,med;i<celldata.length;i++)null!=celldata[i]&&ret.push(celldata[i]);file.celldata=ret,mtype="r"==rc?"row":"column",mst=index,med=index+len-1,jfgrid.jfgriddeletetable(mtype,mst,med,!0)}else if("arc"==type){var rc=item.rc,index=value.index,len=value.len,celldata=file.celldata,mtype;if("r"==rc){for(var i=0;i<celldata.length;i++){var cell=celldata[i];cell.r>index&&(cell.r+=len)}file.row+=len}else{for(var i=0;i<celldata.length;i++){var cell=celldata[i];cell.c>index&&(cell.c+=len)}file.column+=len}mtype="r"==rc?"row":"column",jfgrid.jfgridextendtable(mtype,index,len,!0)}else"na"==type?jfgrid.server.saveParam("na",null,value):"thumb"==type&&setTimeout(function(){_this.imageRequest()},2e3);else _this.CacheNotLoadControll.push(item)}};var common_extend=function(e,r){var t={};for(var i in e)t[i]=e[i];for(var i in r)t[i]=r[i];return t};jfgrid.create=function(setting){var extendsetting=common_extend(defaultSetting,setting);jfgrid.rptSetting=setting;var loadurl=extendsetting.loadUrl,menu=extendsetting.menu,title=extendsetting.title;container=extendsetting.container,jfgridfile=extendsetting.data,defaultcolumnNum=extendsetting.column,defaultrowNum=extendsetting.row,fullscreenmode=extendsetting.fullscreenmode,jfgrid.server.gridKey=extendsetting.gridKey,jfgrid.server.loadUrl=extendsetting.loadUrl,jfgrid.server.updateUrl=extendsetting.updateUrl,jfgrid.server.updateImageUrl=extendsetting.updateImageUrl,jfgrid.server.title=extendsetting.title,jfgrid.server.loadSheetUrl=extendsetting.loadSheetUrl,jfgrid.server.allowUpdate=extendsetting.allowUpdate,jfgridConfigsetting.autoFormatw=extendsetting.autoFormatw,jfgridConfigsetting.accuracy=extendsetting.accuracy,jfgridConfigsetting.total=jfgridfile[0].total,jfgridConfigsetting.allowCopy=extendsetting.allowCopy,jfgridConfigsetting.showtoolbar=extendsetting.showtoolbar,jfgridConfigsetting.showinfobar=extendsetting.showinfobar,jfgridConfigsetting.showsheetbar=extendsetting.showsheetbar,jfgridConfigsetting.showstatisticBar=extendsetting.showstatisticBar,jfgridConfigsetting.pointEdit=extendsetting.pointEdit,jfgridConfigsetting.pointEditUpdate=extendsetting.pointEditUpdate,jfgridConfigsetting.pointEditZoom=extendsetting.pointEditZoom,jfgridConfigsetting.userInfo=extendsetting.userInfo,jfgridConfigsetting.userMenuItem=extendsetting.userMenuItem,jfgridConfigsetting.myFolderUrl=extendsetting.myFolderUrl,jfgridConfigsetting.functionButton=extendsetting.functionButton,jfgridConfigsetting.showConfigWindowResize=extendsetting.showConfigWindowResize,jfgridConfigsetting.enableAddRow=extendsetting.enableAddRow,jfgridConfigsetting.enableAddCol=extendsetting.enableAddCol,jfgridConfigsetting.enablePage=extendsetting.enablePage,jfgridConfigsetting.pageInfo=extendsetting.pageInfo,jfgridConfigsetting.editMode=extendsetting.editMode,jfgridConfigsetting.chartConfigChange=extendsetting.chartConfigChange,jfgridConfigsetting.beforeCreateDom=extendsetting.beforeCreateDom,jfgridConfigsetting.fireMousedown=extendsetting.fireMousedown,devicePixelRatio=extendsetting.devicePixelRatio,null==devicePixelRatio&&(devicePixelRatio=1),devicePixelRatio=Math.ceil(devicePixelRatio),$("#"+container).append('<div id="jfgridloadingdata" style="width:100%;text-align:center;position:absolute;top:0px;height:100%;font-size: 16px;z-index:1000000000;background:#fff;"><div style="position:relative;top:45%;width:100%;"> <div class="jfgridLoaderGif"> </div> <span>正在准备！请稍后</span></div></div>'),jfgridConfigsetting.pointEdit&&($("#"+container).attr("tabindex",0).focus(),$("#jfgridloadingdata .jfgridLoaderGif").css({width:"4em",height:"4em"}));var data=[];return""==loadurl?(jfgrid.sheetmanage.initialjfFile(menu,title),jfgrid.jfgridsizeauto(),jfgrid.jfgridHandler(),jfgrid.chartInitial()):$.post(loadurl,{gridKey:jfgrid.server.gridKey},function(d){var data=eval("("+d+")");jfgridfile=data,jfgrid.sheetmanage.initialjfFile(menu,title),jfgrid.jfgridsizeauto(),jfgrid.jfgridHandler(),jfgrid.chartInitial(),jfgrid.server.allowUpdate&&jfgrid.server.openWebSocket()}),jfgrid};var gridW=0,gridH=0,cellmainHeight=0,cellmainWidth=0;jfgrid.jfgridsizeauto=function(){jfgridConfigsetting.showinfobar?(infobarHeight=30,$("#jfgrid_info_detail").show()):(infobarHeight=0,$("#jfgrid_info_detail").hide()),toolbarHeight=jfgridConfigsetting.showtoolbar?($("#"+container).find(".jfgrid-wa-editor, .jfgrid-share-logo").show(),35):($("#"+container).find(".jfgrid-wa-editor, .jfgrid-share-logo").hide(),0),sheetBarHeight=jfgridConfigsetting.showsheetbar?($("#"+container).find("#jfgrid-sheet-area").show(),27):($("#"+container).find("#jfgrid-sheet-area").hide(),0),statisticBarHeight=jfgridConfigsetting.showstatisticBar?($("#"+container).find(".jfgrid-stat-area").show(),23):($("#"+container).find(".jfgrid-stat-area").hide(),0),jfgridConfigsetting.pointEdit&&(cellMainSrollBarSize=0),$("#"+container).find(".jfgrid-grid-container").css("top",toolbarHeight+infobarHeight+calculatebarHeight),gridW=$("#"+container).width(),gridH=$("#"+container).height(),jfgridConfigsetting.showConfigWindowResize&&($("#jfgrid-modal-dialog-slider-pivot").is(":visible")?gridW-=$("#jfgrid-modal-dialog-slider-pivot").outerWidth():$("#jfgrid-data-visualization").is(":visible")?gridW-=$("#jfgrid-data-visualization").outerWidth():$("#jfgrid-modal-dialog-slider-alternateformat").is(":visible")&&(gridW-=$("#jfgrid-modal-dialog-slider-alternateformat").outerWidth())),$("#"+container).find(".jfgrid").height(gridH-2).width(gridW-2),cellmainHeight=gridH-(infobarHeight+toolbarHeight+calculatebarHeight+columeHeaderHeight+sheetBarHeight+statisticBarHeight),cellmainWidth=gridW-rowHeaderWidth,$("#jfgrid-cols-h-c, #jfgrid-cell-main, #jfgrid-scrollbar-x").width(cellmainWidth),$("#jfgrid-cell-main").height(cellmainHeight),$("#jfgrid-rows-h").height(cellmainHeight-cellMainSrollBarSize),$("#jfgrid-scrollbar-y").height(cellmainHeight+6),$("#jfgrid-scrollbar-x").height(cellMainSrollBarSize),$("#jfgrid-scrollbar-y").width(cellMainSrollBarSize),jfgridTableContentHW=[cellmainWidth+rowHeaderWidth-cellMainSrollBarSize,cellmainHeight+columeHeaderHeight-cellMainSrollBarSize],$("#jfgridTableContent, #jfgridTableContentF").attr({width:Math.ceil(jfgridTableContentHW[0]*devicePixelRatio),height:Math.ceil(jfgridTableContentHW[1]*devicePixelRatio)}).css({width:jfgridTableContentHW[0],height:jfgridTableContentHW[1]}),$("#"+container).find("#jfgrid-grid-window-1").css("bottom",sheetBarHeight),$("#"+container).find(".jfgrid-grid-window").css("bottom",statisticBarHeight);var e=$("#jfgrid-grid-window-1").width();$("#jfgrid-freezebar-horizontal").find(".jfgrid-freezebar-horizontal-handle").css({width:e-10}).end().find(".jfgrid-freezebar-horizontal-drop").css({width:e-10});var r=$("#jfgrid-grid-window-1").height();$("#jfgrid-freezebar-vertical").find(".jfgrid-freezebar-vertical-handle").css({height:r-10}).end().find(".jfgrid-freezebar-vertical-drop").css({height:r-10}),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid($("#jfgrid-cell-main").scrollLeft(),$("#jfgrid-cell-main").scrollTop());var t=!1,i=0,a='<div id="jfgrid-icon-morebtn-div" class="jfgrid-wa-editor" style="position:absolute;top:'+(infobarHeight+toolbarHeight+2+$("#"+container).offset().top+$("body").scrollTop())+'px; right:0px;z-index:1003;padding-left:0px;display:none;height:auto;white-space:initial;"></div>';0==$("#jfgrid-icon-morebtn-div").length&&$("body").append(a),$("#jfgrid-icon-morebtn-div").hide(),$("#jfgrid-icon-morebtn-div > div").appendTo($("#jfgrid-wa-editor")),$("#jfgrid-icon-morebtn").prev().remove().end().remove(),$("#jfgrid-wa-editor > div").each(function(){var e=$(this);i+=e.outerWidth(),!t&&gridW-120<i&&(t=!0),t&&$("#jfgrid-icon-morebtn-div").append($(this))}),t&&($("#jfgrid-wa-editor").append('<div class="jfgrid-toolbar-separator jfgrid-inline-block" style="user-select: none;"> </div><div class="jfgrid-toolbar-button jfgrid-inline-block" data-tips="更多按钮" id="jfgrid-icon-morebtn" role="button" style="user-select: none;"> <div class="jfgrid-toolbar-button-outer-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-button-inner-box jfgrid-inline-block" style="user-select: none;"> <div class="jfgrid-toolbar-menu-button-caption jfgrid-inline-block" style="user-select: none;color:#0188fb;"><i class="fa fa-list-ul"></i> 更多... </div> </div> </div> </div>'),$("#jfgrid-icon-morebtn").click(function(){var e=$(window).width()-$("#jfgrid-icon-morebtn").offset().left-$("#jfgrid-icon-morebtn").width()+$("body").scrollLeft();$("#jfgrid-icon-morebtn-div").toggle().css("right",e<0?0:e),-1<$(this).find(".jfgrid-toolbar-menu-button-caption").text().indexOf("更多")?$(this).find(".jfgrid-toolbar-menu-button-caption").html('<i class="fa fa-list-ul"></i> 收起... '):$(this).find(".jfgrid-toolbar-menu-button-caption").html('<i class="fa fa-list-ul"></i> 更多... ')}),$("#jfgrid-icon-morebtn-div .jfgrid-toolbar-menu-button").css("margin-right",-1),$("#jfgrid-icon-morebtn-div .jfgrid-toolbar-button-split-left").css("margin-right",-3)),$("#"+container+" .jfgrid-wa-editor .jfgrid-toolbar-button-split-left").off("hover").hover(function(){$(this).next(".jfgrid-toolbar-button-split-right").addClass("jfgrid-toolbar-button-split-right-hover")},function(){$(this).next(".jfgrid-toolbar-button-split-right").removeClass("jfgrid-toolbar-button-split-right-hover")}),$("#"+container+" .jfgrid-wa-editor .jfgrid-toolbar-button-split-right").off("hover").hover(function(){$(this).prev(".jfgrid-toolbar-button-split-left").addClass("jfgrid-toolbar-button-hover")},function(){$(this).prev(".jfgrid-toolbar-button-split-left").removeClass("jfgrid-toolbar-button-hover")})},jfgrid.filterseletedbyindex=function(e,r,t,i){var a=visibledatarow[r],n=e-1==-1?0:visibledatarow[e-1],o=visibledatacolumn[i],l=t-1==-1?0:visibledatacolumn[t-1];$("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex).css({left:l,width:o-l-1,top:n,height:a-n-1}),$option=$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).find(".jfgrid-filter-options");for(var d=t;d<=i;d++)$option.eq(d-t).css({left:visibledatacolumn[d]-20,top:visibledatarow[e-1]})},jfgrid.seletedHighlistByindex=function(e,r,t,i,a){var n=visibledatarow[t],o=r-1==-1?0:visibledatarow[r-1],l=visibledatacolumn[a],d=i-1==-1?0:visibledatacolumn[i-1];$("#"+e).css({left:d,width:l-d-1,top:o,height:n-o-1})},jfgrid.selectHightlightShow=function(){if($("#jfgrid-cell-selected-boxs").show(),$("#jfgrid-cell-selected-boxs #jfgrid-cell-selected").siblings(".jfgrid-cell-selected").remove(),0<jfgird_select_save.length){for(var e=0;e<jfgird_select_save.length;e++){var r,t,i=jfgird_select_save[e].row[0],a=jfgird_select_save[e].row[1],n=jfgird_select_save[e].column[0],o=jfgird_select_save[e].column[1];r=null==jfgird_select_save[e].row_focus?i:jfgird_select_save[e].row_focus,t=null==jfgird_select_save[e].column_focus?n:jfgird_select_save[e].column_focus;var l=visibledatarow[a],d=i-1==-1?0:visibledatarow[i-1],f=visibledatacolumn[o],s=n-1==-1?0:visibledatacolumn[n-1],g=visibledatarow[r],c=r-1==-1?0:visibledatarow[r-1],u=visibledatacolumn[t],m=t-1==-1?0:visibledatacolumn[t-1],h=jfgrid.menuButton.mergeborer(jfgrid.flowdata,r,t);h&&(g=h.row[1],c=h.row[0],u=h.column[1],m=h.column[0]),jfgird_select_save[e].row=[i,a],jfgird_select_save[e].column=[n,o],jfgird_select_save[e].row_focus=r,jfgird_select_save[e].column_focus=t,jfgird_select_save[e].left=m,jfgird_select_save[e].width=u-m-1,jfgird_select_save[e].top=c,jfgird_select_save[e].height=g-c-1,jfgird_select_save[e].left_move=s,jfgird_select_save[e].width_move=f-s-1,jfgird_select_save[e].top_move=d,jfgird_select_save[e].height_move=l-d-1,0==e?1==jfgird_select_save.length?mobilecheck?$("#jfgrid-cell-selected-boxs #jfgrid-cell-selected").css({left:jfgird_select_save[e].left_move,width:jfgird_select_save[e].width_move,top:jfgird_select_save[e].top_move,height:jfgird_select_save[e].height_move,display:"block",border:"1px solid #0188fb"}).find(".jfgrid-cs-draghandle").css("display","block").end().find(".jfgrid-cs-fillhandle").css("display","none").end().find(".jfgrid-cs-touchhandle").css("display","block"):$("#jfgrid-cell-selected-boxs #jfgrid-cell-selected").css({left:jfgird_select_save[e].left_move,width:jfgird_select_save[e].width_move,top:jfgird_select_save[e].top_move,height:jfgird_select_save[e].height_move,display:"block",border:"1px solid #0188fb"}).find(".jfgrid-cs-draghandle").css("display","block").end().find(".jfgrid-cs-fillhandle").css("display","block").end().find(".jfgrid-cs-touchhandle").css("display","none"):$("#jfgrid-cell-selected-boxs #jfgrid-cell-selected").css({left:jfgird_select_save[e].left_move,width:jfgird_select_save[e].width_move,top:jfgird_select_save[e].top_move,height:jfgird_select_save[e].height_move,display:"block",border:"1px solid rgba(1, 136, 251, 0.15)"}).find(".jfgrid-cs-draghandle").css("display","none").end().find(".jfgrid-cs-fillhandle").css("display","none"):$("#jfgrid-cell-selected-boxs").append('<div class="jfgrid-cell-selected" style="left: '+jfgird_select_save[e].left_move+"px; width: "+jfgird_select_save[e].width_move+"px; top: "+jfgird_select_save[e].top_move+"px; height: "+jfgird_select_save[e].height_move+'px; border: 1px solid rgba(1, 136, 251, 0.15); display: block;"></div>'),e==jfgird_select_save.length-1&&($("#jfgrid-cell-selected-focus").css({left:jfgird_select_save[e].left,width:jfgird_select_save[e].width,top:jfgird_select_save[e].top,height:jfgird_select_save[e].height,display:"block"}),jfgrid.jfgrid_count_show(jfgird_select_save[e].left_move,jfgird_select_save[e].top_move,jfgird_select_save[e].width_move,jfgird_select_save[e].height_move,[i,a],[n,o]),jfgrid.formula.fucntionboxshow(r,t))}jfgrid.selectTitlesShow(jfgird_select_save),$("#jfgrid-helpbox-cell").text(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,jfgird_select_save[jfgird_select_save.length-1])),1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]&&jfgrid.dynamicArray_hightShow(jfgird_select_save[0].row[0],jfgird_select_save[0].column[0])}jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgird_select_save=jfgird_select_save},jfgrid.selectTitlesShow=function(e){for(var r=$.extend(!0,[],e),t={},i={},a=0;a<r.length;a++)var n=r[a].row[0],o=r[a].row[1],l=r[a].column[0],d=r[a].column[1],t=jfgrid.selectTitlesMap(t,n,o),i=jfgrid.selectTitlesMap(i,l,d);$("#jfgrid-rows-h-selected").empty();for(var f=jfgrid.selectTitlesRange(t),a=0;a<f.length;a++){var n=f[a][0],o=f[a][f[a].length-1],s=jfgrid.rowLocationByIndex(o)[1],g=jfgrid.rowLocationByIndex(n)[0];$("#jfgrid-rows-h-selected").append('<div class="jfgrid-rows-h-selected" style="top: '+g+"px; height: "+(s-g-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}$("#jfgrid-cols-h-selected").empty();for(var c=jfgrid.selectTitlesRange(i),u=0;u<c.length;u++){var l=c[u][0],d=c[u][c[u].length-1],m=jfgrid.colLocationByIndex(d)[1],h=jfgrid.colLocationByIndex(l)[0];$("#jfgrid-cols-h-selected").append('<div class="jfgrid-cols-h-selected" style="left: '+h+"px; width: "+(m-h-1)+'px; display: block; background-color: rgba(76, 76, 76, 0.1);"></div>')}},jfgrid.selectTitlesMap=function(e,r,t){for(var i=$.extend(!0,{},e),a=r;a<=t;a++)a in i||(i[a]=0);return i},jfgrid.selectTitlesRange=function(e){var r=[];for(var t in e)r.push(t);r.sort(function(e,r){return e-r});var i=[],a=[];if(1<r.length)for(var n=1;n<r.length;n++)r[n]-r[n-1]==1?(a.push(r[n-1]),n==r.length-1&&(a.push(r[n]),i.push(a))):1==n?n==r.length-1?(a.push(r[n-1]),i.push(a),i.push([r[n]])):i.push(r[0]):n==r.length-1?(a.push(r[n-1]),i.push(a),i.push([r[n]])):(a.push(r[n-1]),i.push(a),a=[]);else i.push([r[0]]);return i},jfgrid.selectIsOverlap=function(){for(var e=!1,r={},t=0;t<jfgird_select_save.length;t++)for(var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1],l=i;l<=a;l++)for(var d=n;d<=o;d++){if(l+"_"+d in r){e=!0;break}r[l+"_"+d]=0}return e},jfgrid.selectionCopyShow=function(e){if($("#jfgrid-selection-copy").empty(),null==e&&(e=jfgrid_selection_range),0<e.length)for(var r=0;r<e.length;r++){var t=e[r].row[0],i=e[r].row[1],a=e[r].column[0],n=e[r].column[1],o=visibledatarow[i],l=t-1==-1?0:visibledatarow[t-1],d=visibledatacolumn[n],f=a-1==-1?0:visibledatacolumn[a-1],s='<div class="jfgrid-selection-copy" style="display: block; left: '+f+"px; width: "+(d-f-1)+"px; top: "+l+"px; height: "+(o-l-1)+'px;"><div class="jfgrid-selection-copy-top jfgrid-copy"></div><div class="jfgrid-selection-copy-right jfgrid-copy"></div><div class="jfgrid-selection-copy-bottom jfgrid-copy"></div><div class="jfgrid-selection-copy-left jfgrid-copy"></div><div class="jfgrid-selection-copy-hc"></div></div>';$("#jfgrid-selection-copy").append(s)}},jfgrid.hasPartMC=function(e,r,t,i,a){var n=!1;for(x in config.merge){var o=e.merge[x];if(r<o.r){if(t>=o.r&&t<o.r+o.rs-1){if(i>=o.c&&i<=o.c+o.cs-1){n=!0;break}if(a>=o.c&&a<=o.c+o.cs-1){n=!0;break}if(i<o.c&&a>o.c+o.cs-1){n=!0;break}}else if(t>=o.r&&t==o.r+o.rs-1){if(i>o.c&&i<o.c+o.cs-1){n=!0;break}if(a>o.c&&a<o.c+o.cs-1){n=!0;break}if(i==o.c&&a<o.c+o.cs-1){n=!0;break}if(i>o.c&&a==o.c+o.cs-1){n=!0;break}}else if(t>o.r+o.rs-1){if(i>o.c&&i<=o.c+o.cs-1){n=!0;break}if(a>=o.c&&a<o.c+o.cs-1){n=!0;break}if(i==o.c&&a<o.c+o.cs-1){n=!0;break}if(i>o.c&&a==o.c+o.cs-1){n=!0;break}}}else if(r==o.r){if(t<o.r+o.rs-1){if(i>=o.c&&i<=o.c+o.cs-1){n=!0;break}if(a>=o.c&&a<=o.c+o.cs-1){n=!0;break}if(i<o.c&&a>o.c+o.cs-1){n=!0;break}}else if(t>=o.r+o.rs-1){if(i>o.c&&i<=o.c+o.cs-1){n=!0;break}if(a>=o.c&&a<o.c+o.cs-1){n=!0;break}if(i==o.c&&a<o.c+o.cs-1){n=!0;break}if(i>o.c&&a==o.c+o.cs-1){n=!0;break}}}else if(r<=o.r+o.rs-1){if(i>=o.c&&i<=o.c+o.cs-1){n=!0;break}if(a>=o.c&&a<=o.c+o.cs-1){n=!0;break}if(i<o.c&&a>o.c+o.cs-1){n=!0;break}}}return n},jfgrid.dynamicArray_rangeIsAllNull=function(e,r){for(var t=e.row[0],i=e.row[1],a=e.column[0],n=e.column[1],o=!0,l=t;l<=i;l++)for(var d=a;d<=n;d++)if((l!=t||d!=a)&&null!=r[l][d]&&null!=r[l][d].v&&""!=r[l][d].v.toString()){o=!1;break}return o},jfgrid.dynamicArray_spillEditCompute=function(e,r,t){var i=e[r+"_"+t].r,a=e[r+"_"+t].c;for(x in e)x==i+"_"+a?e[x].v="#SPILL!":e[x].r==i&&e[x].c==a&&delete e[x];return e},jfgrid.dynamicArray_hightShow=function(e,r){var t=null==jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].dynamicArray?[]:jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].dynamicArray,i=jfgrid.dynamicArray_compute(t);if(e+"_"+r in i&&"#SPILL!"!=i[e+"_"+r].v){for(var a,n,o=i[e+"_"+r].r,l=i[e+"_"+r].c,d=jfgrid.flowdata[o][l].f,f=0;f<t.length;f++)t[f].f==d&&(a=t[f].data.length,n="array"==jfgrid.getObjType(t[f].data[0])?t[f].data[0].length:1);var s=l+n-1,g=visibledatarow[o+a-1],c=o-1==-1?0:visibledatarow[o-1],u=visibledatacolumn[s],m=l-1==-1?0:visibledatacolumn[l-1];$("#jfgrid-dynamicArray-hightShow").css({left:m,width:u-m-1,top:c,height:g-c-1,display:"block"})}else $("#jfgrid-dynamicArray-hightShow").hide()},jfgrid.dynamicArray_compute=function(e){var r={};if("array"==jfgrid.getObjType(e))for(var t=0;t<e.length;t++){var i=e[t].r,a=e[t].c,n=e[t].f;if(null!=jfgrid.flowdata[i][a]&&null!=jfgrid.flowdata[i][a].f&&jfgrid.flowdata[i][a].f==n){i+"_"+a in r&&(r=jfgrid.dynamicArray_spillEditCompute(r,i,a));var o=e[t].data,l=o.length,d=1;if("array"==jfgrid.getObjType(o[0])&&(d=o[0].length),jfgrid.dynamicArray_rangeIsAllNull({row:[i,i+l-1],column:[a,a+d-1]},jfgrid.flowdata))for(var f=0;f<l;f++)for(var s=0;s<d;s++){var g=i+f,c=a+s;"array"==jfgrid.getObjType(o[0])?r[g+"_"+c]={v:o[f][s],r:i,c:a}:r[g+"_"+c]={v:o[f],r:i,c:a}}else r[i+"_"+a]={v:"#SPILL!",r:i,c:a}}}return r},jfgrid.rowHasMerge=function(e,r,t){for(var i=!1,a=r;a<=t;a++){var n=jfgrid.flowdata[e][a];if("object"==jfgrid.getObjType(n)&&"mc"in n){i=!0;break}}return i},jfgrid.colHasMerge=function(e,r,t){for(var i=!1,a=r;a<=t;a++){var n=jfgrid.flowdata[a][e];if("object"==jfgrid.getObjType(n)&&"mc"in n){i=!0;break}}return i},jfgrid.getRowMerge=function(e,r,t){var i=jfgrid.flowdata.length-1,a=null;if(0<e)for(var n=e;0<=n;n--){for(var o=r;o<=t;o++){var l=jfgrid.flowdata[n][o];"object"==jfgrid.getObjType(l)&&"mc"in l&&(f=config.merge[l.mc.r+"_"+l.mc.c],(null==a||f.r<a)&&(a=f.r))}if(!(jfgrid.rowHasMerge(a-1,r,t)&&0<a))break;n=a-1}else a=0;var d=null;if(e<i)for(n=e;n<=i;n++){for(o=r;o<=t;o++){var f,l=jfgrid.flowdata[n][o];"object"==jfgrid.getObjType(l)&&"mc"in l&&(f=config.merge[l.mc.r+"_"+l.mc.c],(null==d||f.r+f.rs-1>d)&&(d=f.r+f.rs-1))}if(!(jfgrid.rowHasMerge(d+1,r,t)&&d<i))break;n=d+1}else d=i;return[a,d]},jfgrid.getColMerge=function(e,r,t){var i=jfgrid.flowdata[0].length-1,a=null;if(0<e)for(var n=e;0<=n;n--){for(var o=r;o<=t;o++){var l=jfgrid.flowdata[o][n];"object"==jfgrid.getObjType(l)&&"mc"in l&&(f=config.merge[l.mc.r+"_"+l.mc.c],(null==a||f.c<a)&&(a=f.c))}if(!(jfgrid.colHasMerge(a-1,r,t)&&0<a))break;n=a-1}else a=0;var d=null;if(e<i)for(n=e;n<=i;n++){for(o=r;o<=t;o++){var f,l=jfgrid.flowdata[o][n];"object"==jfgrid.getObjType(l)&&"mc"in l&&(f=config.merge[l.mc.r+"_"+l.mc.c],(null==d||f.c+f.cs-1>d)&&(d=f.c+f.cs-1))}if(!(jfgrid.colHasMerge(d+1,r,t)&&d<i))break;n=d+1}else d=i;return[a,d]},jfgrid.getNextIndex=function(e,r,t,i){var a=null;if("down"==e)for(var n=jfgrid.flowdata[t][r],o=("object"!=jfgrid.getObjType(n)||!jfgrid.func_methods.isRealNull(n.v))&&!jfgrid.func_methods.isRealNull(n),l=[],d=0,f=t+1;f<=i;f++){var s=jfgrid.flowdata[f][r];if("object"==jfgrid.getObjType(s)&&jfgrid.func_methods.isRealNull(s.v)||jfgrid.func_methods.isRealNull(s)?l.push(!1):l.push(!0),1==l.length&&o&&0==l[d]){a=t+d+1;break}if(1<l.length){if(o&&0==l[d]){a=t+d+1;break}if(!o){if(0==l[d]&&1==l[d-1]){a=t+d+1;break}if(1==l[d]&&0==l[d-1]){a=t+d;break}}}f==i&&(a=i),d++}else if("up"==e){n=jfgrid.flowdata[i][r];o=("object"!=jfgrid.getObjType(n)||!jfgrid.func_methods.isRealNull(n.v))&&!jfgrid.func_methods.isRealNull(n);for(l=[],d=0,f=i-1;t<=f;f--){s=jfgrid.flowdata[f][r];if("object"==jfgrid.getObjType(s)&&jfgrid.func_methods.isRealNull(s.v)||jfgrid.func_methods.isRealNull(s)?l.push(!1):l.push(!0),1==l.length&&o&&0==l[d]){a=i-(d+1);break}if(1<l.length){if(o&&0==l[d]){a=i-(d+1);break}if(!o){if(0==l[d]&&1==l[d-1]){a=i-(d+1);break}if(1==l[d]&&0==l[d-1]){a=i-d;break}}}f==t&&(a=t),d++}}else if("right"==e){n=jfgrid.flowdata[r][t];o=("object"!=jfgrid.getObjType(n)||!jfgrid.func_methods.isRealNull(n.v))&&!jfgrid.func_methods.isRealNull(n);for(var l=[],d=0,g=t+1;g<=i;g++){s=jfgrid.flowdata[r][g];if("object"==jfgrid.getObjType(s)&&jfgrid.func_methods.isRealNull(s.v)||jfgrid.func_methods.isRealNull(s)?l.push(!1):l.push(!0),1==l.length&&o&&0==l[d]){a=t+d+1;break}if(1<l.length){if(o&&0==l[d]){a=t+d+1;break}if(!o){if(0==l[d]&&1==l[d-1]){a=t+d+1;break}if(1==l[d]&&0==l[d-1]){a=t+d;break}}}g==i&&(a=i),d++}}else if("left"==e){n=jfgrid.flowdata[r][i];o=("object"!=jfgrid.getObjType(n)||!jfgrid.func_methods.isRealNull(n.v))&&!jfgrid.func_methods.isRealNull(n);for(l=[],d=0,g=i-1;t<=g;g--){s=jfgrid.flowdata[r][g];if("object"==jfgrid.getObjType(s)&&jfgrid.func_methods.isRealNull(s.v)||jfgrid.func_methods.isRealNull(s)?l.push(!1):l.push(!0),1==l.length&&o&&0==l[d]){a=i-(d+1);break}if(1<l.length){if(o&&0==l[d]){a=i-(d+1);break}if(!o){if(0==l[d]&&1==l[d-1]){a=i-(d+1);break}if(1==l[d]&&0==l[d-1]){a=i-d;break}}}g==t&&(a=t),d++}}return a},jfgrid.getBorderInfoCompute=function(e){var r,t,i={};t=null==e?(r=config,jfgrid.flowdata):(r=jfgridfile[jfgrid.sheetmanage.getSheetIndex(e)].config,jfgridfile[jfgrid.sheetmanage.getSheetIndex(e)].data);var a=r.borderInfo;if(null!=a&&0<a.length)for(var n=0;n<a.length;n++){var o=a[n].rangeType;if("range"==o)for(var l=a[n].borderType,d=a[n].color,f=a[n].style,s=a[n].range,g=0;g<s.length;g++){var c=s[g].row[0],u=s[g].row[1],m=s[g].column[0],h=s[g].column[1];if("border-left"==l)for(var j=c;j<=u;j++){null!=r.rowhidden&&null!=r.rowhidden[j]||(null==i[j+"_"+m]&&(i[j+"_"+m]={}),i[j+"_"+m].l={color:d,style:f},0<=(_=m-1)&&i[j+"_"+_]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][_])&&null!=t[j][_].mc?(w=t[j][_],(b=r.merge[w.mc.r+"_"+w.mc.c]).c+b.cs-1==_&&(i[j+"_"+_].r={color:d,style:f})):i[j+"_"+_].r={color:d,style:f}))}else if("border-right"==l)for(j=c;j<=u;j++){null!=r.rowhidden&&null!=r.rowhidden[j]||(null==i[j+"_"+h]&&(i[j+"_"+h]={}),i[j+"_"+h].r={color:d,style:f},(x=h+1)<t[0].length&&i[j+"_"+x]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][x])&&null!=t[j][x].mc?(C=t[j][x],(b=r.merge[C.mc.r+"_"+C.mc.c]).c==x&&(i[j+"_"+x].l={color:d,style:f})):i[j+"_"+x].l={color:d,style:f}))}else if("border-top"==l){if(null!=r.rowhidden&&null!=r.rowhidden[c])continue;for(var p=m;p<=h;p++){null==i[c+"_"+p]&&(i[c+"_"+p]={}),i[c+"_"+p].t={color:d,style:f},0<=(T=c-1)&&i[T+"_"+p]&&(null!=t[T]&&"object"==jfgrid.getObjType(t[T][p])&&null!=t[T][p].mc?(I=t[T][p],(b=r.merge[I.mc.r+"_"+I.mc.c]).r+b.rs-1==T&&(i[T+"_"+p].b={color:d,style:f})):i[T+"_"+p].b={color:d,style:f})}}else if("border-bottom"==l){if(null!=r.rowhidden&&null!=r.rowhidden[u])continue;for(p=m;p<=h;p++){null==i[u+"_"+p]&&(i[u+"_"+p]={}),i[u+"_"+p].b={color:d,style:f},(R=u+1)<t.length&&i[R+"_"+p]&&(null!=t[R]&&"object"==jfgrid.getObjType(t[R][p])&&null!=t[R][p].mc?(k=t[R][p],(b=r.merge[k.mc.r+"_"+k.mc.c]).r==R&&(i[R+"_"+p].t={color:d,style:f})):i[R+"_"+p].t={color:d,style:f})}}else if("border-all"==l){for(j=c;j<=u;j++)if(null==r.rowhidden||null==r.rowhidden[j])for(p=m;p<=h;p++){null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],(b=r.merge[v.mc.r+"_"+v.mc.c]).r==j&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].t={color:d,style:f}),b.r+b.rs-1==j&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].b={color:d,style:f}),b.c==p&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f}),b.c+b.cs-1==p&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f})):(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},i[j+"_"+p].r={color:d,style:f},i[j+"_"+p].t={color:d,style:f},i[j+"_"+p].b={color:d,style:f}),j==c&&0<=(T=c-1)&&i[T+"_"+p]&&(null!=t[T]&&"object"==jfgrid.getObjType(t[T][p])&&null!=t[T][p].mc?(I=t[T][p],(b=r.merge[I.mc.r+"_"+I.mc.c]).r+b.rs-1==T&&(i[T+"_"+p].b={color:d,style:f})):i[T+"_"+p].b={color:d,style:f}),j==u&&(R=u+1)<t.length&&i[R+"_"+p]&&(null!=t[R]&&"object"==jfgrid.getObjType(t[R][p])&&null!=t[R][p].mc?(k=t[R][p],(b=r.merge[k.mc.r+"_"+k.mc.c]).r==R&&(i[R+"_"+p].t={color:d,style:f})):i[R+"_"+p].t={color:d,style:f}),p==m&&0<=(_=m-1)&&i[j+"_"+_]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][_])&&null!=t[j][_].mc?(w=t[j][_],(b=r.merge[w.mc.r+"_"+w.mc.c]).c+b.cs-1==_&&(i[j+"_"+_].r={color:d,style:f})):i[j+"_"+_].r={color:d,style:f}),p==h&&(x=h+1)<t[0].length&&i[j+"_"+x]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][x])&&null!=t[j][x].mc?(C=t[j][x],(b=r.merge[C.mc.r+"_"+C.mc.c]).c==x&&(i[j+"_"+x].l={color:d,style:f})):i[j+"_"+x].l={color:d,style:f})}}else if("border-outside"==l){for(j=c;j<=u;j++)if(null==r.rowhidden||null==r.rowhidden[j])for(p=m;p<=h;p++){j!=c&&j!=u&&p!=m&&p!=h||(j==c&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].t={color:d,style:f},0<=(T=c-1)&&i[T+"_"+p]&&(null!=t[T]&&"object"==jfgrid.getObjType(t[T][p])&&null!=t[T][p].mc?(I=t[T][p],(b=r.merge[I.mc.r+"_"+I.mc.c]).r+b.rs-1==T&&(i[T+"_"+p].b={color:d,style:f})):i[T+"_"+p].b={color:d,style:f})),j==u&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].b={color:d,style:f},(R=u+1)<t.length&&i[R+"_"+p]&&(null!=t[R]&&"object"==jfgrid.getObjType(t[R][p])&&null!=t[R][p].mc?(k=t[R][p],(b=r.merge[k.mc.r+"_"+k.mc.c]).r==R&&(i[R+"_"+p].t={color:d,style:f})):i[R+"_"+p].t={color:d,style:f})),p==m&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},0<=(_=m-1)&&i[j+"_"+_]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][_])&&null!=t[j][_].mc?(w=t[j][_],(b=r.merge[w.mc.r+"_"+w.mc.c]).c+b.cs-1==_&&(i[j+"_"+_].r={color:d,style:f})):i[j+"_"+_].r={color:d,style:f})),p==h&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f},(x=h+1)<t[0].length&&i[j+"_"+x]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][x])&&null!=t[j][x].mc?(C=t[j][x],(b=r.merge[C.mc.r+"_"+C.mc.c]).c==x&&(i[j+"_"+x].l={color:d,style:f})):i[j+"_"+x].l={color:d,style:f})))}}else if("border-inside"==l){for(j=c;j<=u;j++)if(null==r.rowhidden||null==r.rowhidden[j])for(p=m;p<=h;p++){j==c&&p==m?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc||(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f},i[j+"_"+p].b={color:d,style:f}):j==u&&p==m?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc||(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f},i[j+"_"+p].t={color:d,style:f}):j==c&&p==h?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc||(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},i[j+"_"+p].b={color:d,style:f}):j==u&&p==h?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc||(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},i[j+"_"+p].t={color:d,style:f}):j==c?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],(b=r.merge[v.mc.r+"_"+v.mc.c]).c==p?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f}):b.c+b.cs-1==p&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f})):(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},i[j+"_"+p].r={color:d,style:f},i[j+"_"+p].b={color:d,style:f}):j==u?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],(b=r.merge[v.mc.r+"_"+v.mc.c]).c==p?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f}):b.c+b.cs-1==p&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f})):(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},i[j+"_"+p].r={color:d,style:f},i[j+"_"+p].t={color:d,style:f}):p==m?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],(b=r.merge[v.mc.r+"_"+v.mc.c]).r==j?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].t={color:d,style:f}):b.r+b.rs-1==j&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].b={color:d,style:f})):(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f},i[j+"_"+p].t={color:d,style:f},i[j+"_"+p].b={color:d,style:f}):p==h?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],(b=r.merge[v.mc.r+"_"+v.mc.c]).r==j?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].t={color:d,style:f}):b.r+b.rs-1==j&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].b={color:d,style:f})):(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},i[j+"_"+p].t={color:d,style:f},i[j+"_"+p].b={color:d,style:f}):null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],(b=r.merge[v.mc.r+"_"+v.mc.c]).r==j?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].t={color:d,style:f}):b.r+b.rs-1==j&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].b={color:d,style:f}),b.c==p?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f}):b.c+b.cs-1==p&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f})):(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},i[j+"_"+p].r={color:d,style:f},i[j+"_"+p].t={color:d,style:f},i[j+"_"+p].b={color:d,style:f})}}else if("border-horizontal"==l){for(j=c;j<=u;j++)if(null==r.rowhidden||null==r.rowhidden[j])for(p=m;p<=h;p++){j==c?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc||(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].b={color:d,style:f}):j==u?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc||(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].t={color:d,style:f}):null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],(b=r.merge[v.mc.r+"_"+v.mc.c]).r==j?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].t={color:d,style:f}):b.r+b.rs-1==j&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].b={color:d,style:f})):(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].t={color:d,style:f},i[j+"_"+p].b={color:d,style:f})}}else if("border-vertical"==l){for(j=c;j<=u;j++)if(null==r.rowhidden||null==r.rowhidden[j])for(p=m;p<=h;p++){p==m?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc||(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f}):p==h?null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc||(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f}):null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],(b=r.merge[v.mc.r+"_"+v.mc.c]).c==p?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f}):b.c+b.cs-1==p&&(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].r={color:d,style:f})):(null==i[j+"_"+p]&&(i[j+"_"+p]={}),i[j+"_"+p].l={color:d,style:f},i[j+"_"+p].r={color:d,style:f})}}else if("border-none"==l)for(j=c;j<=u;j++)if(null==r.rowhidden||null==r.rowhidden[j])for(p=m;p<=h;p++){null!=i[j+"_"+p]&&delete i[j+"_"+p],j==c&&0<=(T=c-1)&&i[T+"_"+p]&&delete i[T+"_"+p].b,j==u&&(R=u+1)<t.length&&i[R+"_"+p]&&delete i[R+"_"+p].t,p==m&&0<=(_=m-1)&&i[j+"_"+_]&&delete i[j+"_"+_].r,p==h&&(x=h+1)<t[0].length&&i[j+"_"+x]&&delete i[j+"_"+x].l}}else if("cell"==o){var v,b,_,w,y,x,C,T,I,$,R,k,S=a[n].value,j=S.row_index,p=S.col_index;if(null!=r.rowhidden&&null!=r.rowhidden[j])continue;null!=S.l||null!=S.r||null!=S.t||null!=S.b?(null==i[j+"_"+p]&&(i[j+"_"+p]={}),null!=t[j]&&"object"==jfgrid.getObjType(t[j][p])&&null!=t[j][p].mc?(v=t[j][p],b=r.merge[v.mc.r+"_"+v.mc.c],null!=S.l&&p==b.c?(i[j+"_"+p].l={color:S.l.color,style:S.l.style},0<=(_=p-1)&&i[j+"_"+_]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][_])&&null!=t[j][_].mc?(w=t[j][_],(y=r.merge[w.mc.r+"_"+w.mc.c]).c+y.cs-1==_&&(i[j+"_"+_].r={color:S.l.color,style:S.l.style})):i[j+"_"+_].r={color:S.l.color,style:S.l.style})):i[j+"_"+p].l=null,null!=S.r&&p==b.c+b.cs-1?(i[j+"_"+p].r={color:S.r.color,style:S.r.style},(x=p+1)<t[0].length&&i[j+"_"+x]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][x])&&null!=t[j][x].mc?(C=t[j][x],r.merge[C.mc.r+"_"+C.mc.c].c==x&&(i[j+"_"+x].l={color:S.r.color,style:S.r.style})):i[j+"_"+x].l={color:S.r.color,style:S.r.style})):i[j+"_"+p].r=null,null!=S.t&&j==b.r?(i[j+"_"+p].t={color:S.t.color,style:S.t.style},0<=(T=j-1)&&i[T+"_"+p]&&(null!=t[T]&&"object"==jfgrid.getObjType(t[T][p])&&null!=t[T][p].mc?(I=t[T][p],($=r.merge[I.mc.r+"_"+I.mc.c]).r+$.rs-1==T&&(i[T+"_"+p].b={color:S.t.color,style:S.t.style})):i[T+"_"+p].b={color:S.t.color,style:S.t.style})):i[j+"_"+p].t=null,null!=S.b&&j==b.r+b.rs-1?(i[j+"_"+p].b={color:S.b.color,style:S.b.style},(R=j+1)<t.length&&i[R+"_"+p]&&(null!=t[R]&&"object"==jfgrid.getObjType(t[R][p])&&null!=t[R][p].mc?(k=t[R][p],r.merge[k.mc.r+"_"+k.mc.c].r==R&&(i[R+"_"+p].t={color:S.b.color,style:S.b.style})):i[R+"_"+p].t={color:S.b.color,style:S.b.style})):i[j+"_"+p].b=null):(null!=S.l?(i[j+"_"+p].l={color:S.l.color,style:S.l.style},0<=(_=p-1)&&i[j+"_"+_]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][_])&&null!=t[j][_].mc?(w=t[j][_],(y=r.merge[w.mc.r+"_"+w.mc.c]).c+y.cs-1==_&&(i[j+"_"+_].r={color:S.l.color,style:S.l.style})):i[j+"_"+_].r={color:S.l.color,style:S.l.style})):i[j+"_"+p].l=null,null!=S.r?(i[j+"_"+p].r={color:S.r.color,style:S.r.style},(x=p+1)<t[0].length&&i[j+"_"+x]&&(null!=t[j]&&"object"==jfgrid.getObjType(t[j][x])&&null!=t[j][x].mc?(C=t[j][x],r.merge[C.mc.r+"_"+C.mc.c].c==x&&(i[j+"_"+x].l={color:S.r.color,style:S.r.style})):i[j+"_"+x].l={color:S.r.color,style:S.r.style})):i[j+"_"+p].r=null,null!=S.t?(i[j+"_"+p].t={color:S.t.color,style:S.t.style},0<=(T=j-1)&&i[T+"_"+p]&&(null!=t[T]&&"object"==jfgrid.getObjType(t[T][p])&&null!=t[T][p].mc?(I=t[T][p],($=r.merge[I.mc.r+"_"+I.mc.c]).r+$.rs-1==T&&(i[T+"_"+p].b={color:S.t.color,style:S.t.style})):i[T+"_"+p].b={color:S.t.color,style:S.t.style})):i[j+"_"+p].t=null,null!=S.b?(i[j+"_"+p].b={color:S.b.color,style:S.b.style},(R=j+1)<t.length&&i[R+"_"+p]&&(null!=t[R]&&"object"==jfgrid.getObjType(t[R][p])&&null!=t[R][p].mc?(k=t[R][p],r.merge[k.mc.r+"_"+k.mc.c].r==R&&(i[R+"_"+p].t={color:S.b.color,style:S.b.style})):i[R+"_"+p].t={color:S.b.color,style:S.b.style})):i[j+"_"+p].b=null)):delete i[j+"_"+p]}}return i};var jfgridbinary_search=function(e,r){for(var t=0,i=e.length-1;t<=i;){var a=parseInt((i+t)/2);if(r<e[a]&&(0==a||r>=e[a-1]))return a;if(r>=e[a])t=a+1;else{if(!(r<e[a]))return-1;i=a-1}}},jfgridorder_search=function(e,r){for(var t=0,i=0,a=-1,n=e.length-1;t<e.length&&0<=n&&t<=n;){if(i=e[n],(0==n?0:e[n-1])<=r&&r<i){a=n;break}if(i=e[t],(0==t?0:e[t-1])<=r&&r<i){a=t;break}t++,n--}return a},jfgrid_searcharray=function(e,r){if(jfgridConfigsetting.pointEdit){e=$.extend(!0,[],e);for(var t=0;t<e.length;t++)e[t]=e[t]*jfgridConfigsetting.pointEditZoom}var i=e.length-1;return i=(e.length<40||r<=e[20]||r>=e[i-20]?jfgridorder_search:jfgridbinary_search)(e,r)};jfgrid.jfgridHandler=function(){jfgrid.jfgridscrollevent=function(e){var r=$("#jfgrid-cell-main"),t=$("#jfgrid-scrollbar-x").scrollLeft(),i=$("#jfgrid-scrollbar-y").scrollTop();return null!=jfgrid.freezen.freezenhorizontaldata&&i<jfgrid.freezen.freezenhorizontaldata[2]?(i=jfgrid.freezen.freezenhorizontaldata[2],void $("#jfgrid-scrollbar-y").scrollTop(i)):null!=jfgrid.freezen.freezenverticaldata&&t<jfgrid.freezen.freezenverticaldata[2]?(t=jfgrid.freezen.freezenverticaldata[2],void $("#jfgrid-scrollbar-x").scrollLeft(t)):($("#jfgrid-cols-h-c").scrollLeft(t),$("#jfgrid-rows-h").scrollTop(i),jfgridautoscrollp=[t,i],r.scrollLeft(t).scrollTop(i),$("#jfgrid-input-box-index").css({left:$("#jfgrid-input-box").css("left"),top:parseInt($("#jfgrid-input-box").css("top"))-20+"px","z-index":$("#jfgrid-input-box").css("z-index")}).show(),jfgrid.jfgridrefreshgrid(t,i),$("#jfgrid-bottom-controll-row").css("left",t+10),void(null==jfgrid.freezen.freezenhorizontaldata&&null==jfgrid.freezen.freezenverticaldata||jfgrid.freezen.scrollAdapt()))},$("#jfgrid-cell-main").scroll(function(){}).mousewheel(function(e,r){e.preventDefault()}),$("#jfgrid-grid-window-1").mousewheel(function(e,r){var t=$("#jfgrid-scrollbar-x").scrollLeft(),i=$("#jfgrid-scrollbar-y").scrollTop(),a=visibledatacolumn,n=visibledatarow;null!=jfgrid.freezen.freezenhorizontaldata&&(n=jfgrid.freezen.freezenhorizontaldata[3]),null!=jfgrid.freezen.freezenverticaldata&&(a=jfgrid.freezen.freezenverticaldata[3]),a=jfgrid.ArrayUnique(a),n=jfgrid.ArrayUnique(n);var o,l,d=jfgrid_searcharray(a,t),f=jfgrid_searcharray(n,i),s=0,g=0;0!=e.deltaX&&(e.deltaX<0?(o=d+3)>=a.length&&(o=a.length-1):(o=d-3)<0&&(o=0),s=0==o?0:a[o-1],$("#jfgrid-scrollbar-x").scrollLeft(s)),0!=e.deltaY&&(e.deltaY<0?(l=f+3)>=n.length&&(l=n.length-1):(l=f-3)<0&&(l=0),g=0==l?0:n[l-1],$("#jfgrid-scrollbar-y").scrollTop(g))}),$("#jfgrid-scrollbar-x").scroll(function(){setTimeout(function(){jfgrid.jfgridscrollevent(!0)},10)}).mousewheel(function(e,r){e.preventDefault()}),$("#jfgrid-scrollbar-y").scroll(function(){setTimeout(function(){jfgrid.jfgridscrollevent(!0)},10)}).mousewheel(function(e,r){e.preventDefault()}),$(window).resize(function(){iscopyself=!1,document.getElementById("jfgrid")&&jfgrid.jfgridsizeauto()}),jfgrid.ArrayUnique=function(e){var r=[];if(0<e.length)for(var t=0;t<e.length;t++)-1==r.indexOf(e[t])&&r.push(e[t]);return r},jfgrid.rowLocationByIndex=function(e){var r=visibledatarow[e];return[0==e?0:visibledatarow[e-1],r,e]},jfgrid.rowLocation=function(e){var r=jfgrid_searcharray(visibledatarow,e);return-1==r&&0<e?r=visibledatarow.length-1:-1==r&&e<=0&&(r=0),jfgrid.rowLocationByIndex(r)},jfgrid.colLocationByIndex=function(e){var r=visibledatacolumn[e];return[0==e?0:visibledatacolumn[e-1],r,e]},jfgrid.colLocation=function(e){var r=jfgrid_searcharray(visibledatacolumn,e);return-1==r&&0<e?r=visibledatacolumn.length-1:-1==r&&e<=0&&(r=0),jfgrid.colLocationByIndex(r)};var mouseposition=function(e,r){var t,i,a=$("#"+container).offset();return i=jfgridConfigsetting.pointEdit?(t=e-a.left-rowHeaderWidth*jfgridConfigsetting.pointEditZoom,r-a.top-(infobarHeight+toolbarHeight+calculatebarHeight+columeHeaderHeight)*jfgridConfigsetting.pointEditZoom):(t=e-a.left-rowHeaderWidth,r-a.top-infobarHeight-toolbarHeight-calculatebarHeight-columeHeaderHeight),[t,i]};jfgrid.mouseposition=mouseposition;var jfgrid_cell_selected_move=!1,jfgrid_cell_selected_move_index=[];$("#jfgrid-cell-main div.jfgrid-cs-draghandle").mousedown(function(e){var r,t,i,a,n,o,l,d,f,s,g;jfgrid.isEditMode()||($("#jfgrid-cell-selected").find(".jfgrid-cs-fillhandle").css("cursor","move").end().find(".jfgrid-cs-draghandle").css("cursor","move"),$("#jfgrid-cell-main, #jfgridTableContent, #jfgrid-sheettable_0").css("cursor","move"),jfgird_scroll_status=jfgrid_cell_selected_move=!0,t=(r=mouseposition(e.pageX,e.pageY))[0]+$("#jfgrid-cell-main").scrollLeft(),i=r[1]+$("#jfgrid-cell-main").scrollTop(),n=(a=jfgrid.rowLocation(i))[0],o=a[1],l=a[2],f=(d=jfgrid.colLocation(t))[0],s=d[1],g=d[2],jfgrid_cell_selected_move_index=[l,g],$("#jfgrid-cell-selected-move").css({left:f,width:s-f-1,top:n,height:o-n-1,display:"block"}),e.stopPropagation())});var jfgrid_cell_selected_extend=!1,jfgrid_cell_selected_extend_index=[],jfgrid_cell_selected_extend_time=null;$("#jfgrid-cell-main div.jfgrid-cs-fillhandle").mousedown(function(g){jfgrid.isEditMode()||($("#jfgrid-cell-selected").find(".jfgrid-cs-fillhandle").css("cursor","crosshair").end().find(".jfgrid-cs-draghandle").css("cursor","crosshair"),$("#jfgrid-cell-main, #jfgridTableContent, #jfgrid-sheettable_0").css("cursor","crosshair"),jfgrid_cell_selected_extend_time=setTimeout(function(){jfgird_scroll_status=jfgrid_cell_selected_extend=!0;var e=mouseposition(g.pageX,g.pageY),r=e[0]+$("#jfgrid-cell-main").scrollLeft()-5,t=e[1]+$("#jfgrid-cell-main").scrollTop()-5,i=jfgrid.rowLocation(t),a=i[0],n=i[1],o=i[2],l=jfgrid.colLocation(r),d=l[0],f=l[1],s=l[2];jfgrid_cell_selected_extend_index=[o,s],$("#jfgrid-cell-selected-extend").css({left:d,width:f-d-1,top:a,height:n-a-1,display:"block"})},100),g.stopPropagation())}).click(function(){clearTimeout(jfgrid_cell_selected_extend_time),event.stopPropagation()}).dblclick(function(){var e=jfgird_select_save[0],r=e.row[0],t=e.row[1],i=e.column[0],a=e.column[1];if(!jfgrid.pivotTable.isPivotRange(r,i)){for(var n,o=!1,l=0,d=t+1;d<jfgrid.flowdata.length;d++)if(0<=i-1&&a+1<jfgrid.flowdata[0].length){var f=jfgrid.flowdata[d][i-1],s=jfgrid.flowdata[d][a+1];if(d==t+1){if((null==f||jfgrid.func_methods.isRealNull(f.v))&&(null==s||jfgrid.func_methods.isRealNull(s.v))){o=!1;break}o=!0,l++}else{if((null==f||jfgrid.func_methods.isRealNull(f.v))&&(null==s||jfgrid.func_methods.isRealNull(s.v)))break;l++}}else if(0<=i-1){var g=jfgrid.flowdata[d][i-1];if(d==t+1){if(null==g||jfgrid.func_methods.isRealNull(g.v)){o=!1;break}o=!0,l++}else{if(null==g||jfgrid.func_methods.isRealNull(g.v))break;l++}}else if(a+1<jfgrid.flowdata[0].length){g=jfgrid.flowdata[d][a+1];if(d==t+1){if(null==g||jfgrid.func_methods.isRealNull(g.v)){o=!1;break}o=!0,l++}else{if(null==g||jfgrid.func_methods.isRealNull(g.v))break;l++}}o&&0!=l&&(jfgrid.dropCell.copyRange={row:[r,t],column:[i,a]},(n=jfgrid.dropCell.typeItemHide())[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]?jfgrid.dropCell.applyType="1":jfgrid.dropCell.applyType="0",jfgrid.dropCell.applyRange={row:[t+1,t+l],column:[i,a]},jfgrid.dropCell.direction="down",jfgird_select_save=[{row:[r,t+l],column:[i,a]}],jfgrid.dropCell.update(),jfgrid.dropCell.createIcon(),$("#jfgrid-cell-selected-move").hide(),$("#jfgrid-sheettable").css("cursor","default"),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)),event.stopPropagation()}}),$("#jfgrid-cell-main, #jfgridTableContent").mousedown(function(e){$("#jfgrid-cell-selected").find(".jfgrid-cs-fillhandle").css("cursor","default").end().find(".jfgrid-cs-draghandle").css("cursor","default"),$("#jfgrid-cell-main, #jfgridTableContent, #jfgrid-sheettable_0").css("cursor","default"),jfgrid.postil.removeActivePs();var r=mouseposition(e.pageX,e.pageY);if(!(r[0]>=cellmainWidth-cellMainSrollBarSize||r[1]>=cellmainHeight-cellMainSrollBarSize)){var t=r[0]+$("#jfgrid-cell-main").scrollLeft(),i=r[1]+$("#jfgrid-cell-main").scrollTop();null!=jfgrid.freezen.freezenverticaldata&&r[0]<jfgrid.freezen.freezenverticaldata[0]-jfgrid.freezen.freezenverticaldata[2]&&(t=r[0]+jfgrid.freezen.freezenverticaldata[2]),null!=jfgrid.freezen.freezenhorizontaldata&&r[1]<jfgrid.freezen.freezenhorizontaldata[0]-jfgrid.freezen.freezenhorizontaldata[2]&&(i=r[1]+jfgrid.freezen.freezenhorizontaldata[2]);var a=jfgrid.rowLocation(i),n=a[1],o=a[0],l=a[2],d=jfgrid.colLocation(t),f=d[1],s=d[0],g=d[2],c=l,u=g,m=jfgrid.menuButton.mergeborer(jfgrid.flowdata,l,g);if(m&&(n=m.row[1],o=m.row[0],l=m.row[2],c=m.row[3],f=m.column[1],s=m.column[0],g=m.column[2],u=m.column[3]),s<$("#jfgrid-cell-main").scrollLeft()&&$("#jfgrid-scrollbar-x").scrollLeft(s),o<$("#jfgrid-cell-main").scrollTop()&&$("#jfgrid-scrollbar-y").scrollTop(o),"3"==e.which){for(var h=!1,j=0;j<jfgird_select_save.length;j++)if(null!=jfgird_select_save[j].row&&l>=jfgird_select_save[j].row[0]&&l<=jfgird_select_save[j].row[1]&&g>=jfgird_select_save[j].column[0]&&g<=jfgird_select_save[j].column[1]){h=!0;break}if(h)return}if(null==jfgrid.flowdata[l]||null==jfgrid.flowdata[l][g]||null==jfgrid.flowdata[l][g].dd||null==jfgridConfigsetting.fireMousedown||"function"!=jfgrid.getObjType(jfgridConfigsetting.fireMousedown)){jfgird_scroll_status=!0;var p=$("#jfgrid-input-box");if(0<parseInt(p.css("top"))){if(jfgrid.formula.rangestart||jfgrid.formula.rangedrag_column_start||jfgrid.formula.rangedrag_row_start||jfgrid.formula.israngeseleciton()){var v,b,_,w,y,x=[l,c],C=[g,u],T=s,I=f-s-1,R=o,k=n-o-1;return e.shiftKey?(k=R=0,x=[],x=(v=jfgrid.formula.func_selectedrange).top>o?(R=o,k=v.top+v.height-o,v.row[1]>v.row_focus&&(v.row[1]=v.row_focus),[l,v.row[1]]):v.top==o?(R=o,k=v.top+v.height-o,[l,v.row[0]]):(R=v.top,k=n-v.top-1,v.row[0]<v.row_focus&&(v.row[0]=v.row_focus),[v.row[0],l]),I=T=0,C=[],C=v.left>s?(T=s,I=v.left+v.width-s,v.column[1]>v.column_focus&&(v.column[1]=v.column_focus),[g,v.column[1]]):v.left==s?(T=s,I=v.left+v.width-s,[g,v.column[0]]):(T=v.left,I=f-v.left-1,v.column[0]<v.column_focus&&(v.column[0]=v.column_focus),[v.column[0],g]),null!=(b=jfgrid.menuButton.mergeMoveMain(C,x,v,R,k,T,I))&&(C=b[0],x=b[1],R=b[2],k=b[3],T=b[4],I=b[5]),jfgrid.jfgrid_count_show(T,R,I,k,x,C),v.row=x,v.column=C,v.left_move=T,v.width_move=I,v.top_move=R,v.height_move=k,jfgrid.formula.func_selectedrange=v):(e.ctrlKey&&","!=$("#jfgrid-rich-text-editor").find("span").last().text()&&(0<(y=$("#jfgrid-rich-text-editor").text()+",").length&&"="==y.substr(0,1)&&(y=jfgrid.formula.functionHTMLGenerate(y),window.getSelection?(_=window.getSelection(),jfgrid.formula.functionRangeIndex=[$(_.anchorNode).parent().index(),_.anchorOffset]):(w=document.selection.createRange(),jfgrid.formula.functionRangeIndex=w),$("#jfgrid-rich-text-editor").html(y),jfgrid.formula.canceFunctionrangeSelected(),jfgrid.formula.createRangeHightlight()),jfgrid.formula.rangestart=!1,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,$("#jfgrid-functionbox-cell").html(y),jfgrid.formula.rangeHightlightselected($("#jfgrid-rich-text-editor")),jfgrid.formula.israngeseleciton()),jfgrid.formula.func_selectedrange={left:T,width:I,top:R,height:k,left_move:T,width_move:I,top_move:R,height_move:k,row:x,column:C,row_focus:l,column_focus:g}),jfgrid.formula.rangeSetValue({row:x,column:C}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,$("#jfgrid-formula-functionrange-select").css({left:T,width:I,top:R,height:k}).show(),$("#jfgrid-formula-help-c").hide(),jfgrid.jfgrid_count_show(T,R,I,k,x,C),void setTimeout(function(){var e=window.getSelection().anchorNode;$("#jfgrid-search-formula-parm").is(":visible")||$("#jfgrid-search-formula-parm-select").is(":visible")?($editor=$("#jfgrid-rich-text-editor"),jfgrid.formula.rangechangeindex=jfgrid.formula.data_parm_index):$editor=$(e).closest("div");var r=$editor.find("span[rangeindex='"+jfgrid.formula.rangechangeindex+"']");jfgrid.formula.setCaretPosition(r.get(0),0,r.html().length)},1)}jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgird_select_status=!0,$("#jfgrid-info").is(":visible")&&(jfgird_select_status=!1)}else jfgird_select_status=!0;if($("#jfgrid-multiRange-dialog").is(":visible")){jfgrid.conditionformat.selectStatus=!0,jfgird_select_status=!1,e.shiftKey?(k=R=0,x=[],x=(v=jfgrid.conditionformat.selectRange[jfgrid.conditionformat.selectRange.length-1]).top>o?(R=o,k=v.top+v.height-o,v.row[1]>v.row_focus&&(v.row[1]=v.row_focus),[l,v.row[1]]):v.top==o?(R=o,k=v.top+v.height-o,[l,v.row[0]]):(R=v.top,k=n-v.top-1,v.row[0]<v.row_focus&&(v.row[0]=v.row_focus),[v.row[0],l]),I=T=0,C=[],C=v.left>s?(T=s,I=v.left+v.width-s,v.column[1]>v.column_focus&&(v.column[1]=v.column_focus),[g,v.column[1]]):v.left==s?(T=s,I=v.left+v.width-s,[g,v.column[0]]):(T=v.left,I=f-v.left-1,v.column[0]<v.column_focus&&(v.column[0]=v.column_focus),[v.column[0],g]),null!=(b=jfgrid.menuButton.mergeMoveMain(C,x,v,R,k,T,I))&&(C=b[0],x=b[1],R=b[2],k=b[3],T=b[4],I=b[5]),v.row=x,v.column=C,v.left_move=T,v.width_move=I,v.top_move=R,v.height_move=k,jfgrid.conditionformat.selectRange[jfgrid.conditionformat.selectRange.length-1]=v):(e.ctrlKey||(jfgrid.conditionformat.selectRange=[]),jfgrid.conditionformat.selectRange.push({left:s,width:f-s-1,top:o,height:n-o-1,left_move:s,width_move:f-s-1,top_move:o,height_move:n-o-1,row:[l,c],column:[g,u],row_focus:l,column_focus:g})),jfgrid.selectionCopyShow(jfgrid.conditionformat.selectRange);var S=jfgrid.conditionformat.getTxtByRange(jfgrid.conditionformat.selectRange);$("#jfgrid-multiRange-dialog input").val(S)}else if(jfgrid.conditionformat.selectStatus=!1,jfgrid.conditionformat.selectRange=[],$("#jfgrid-singleRange-dialog").is(":visible")){jfgird_select_status=!1,jfgrid.selectionCopyShow([{row:[l,l],column:[g,g]}]);S=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:[l,l],column:[g,g]},jfgrid.currentSheetIndex);$("#jfgrid-singleRange-dialog input").val(S)}else if(jfgrid.ifFormulaGenerator.singleRangeFocus&&$("#jfgrid-ifFormulaGenerator-dialog .singRange").click(),$("#jfgrid-ifFormulaGenerator-singleRange-dialog").is(":visible")){jfgird_select_status=!1,jfgrid.formula.rangestart=!1,$("#jfgrid-formula-functionrange-select").css({left:s,width:f-s-1,top:o,height:n-o-1}).show(),$("#jfgrid-formula-help-c").hide();S=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:[l,l],column:[g,g]},jfgrid.currentSheetIndex);$("#jfgrid-ifFormulaGenerator-singleRange-dialog input").val(S)}else{if($("#jfgrid-ifFormulaGenerator-multiRange-dialog").is(":visible")){jfgird_select_status=!1,jfgrid.formula.func_selectedrange={left:s,width:f-s-1,top:o,height:n-o-1,left_move:s,width_move:f-s-1,top_move:o,height_move:n-o-1,row:[l,l],column:[g,g],row_focus:l,column_focus:g},jfgrid.formula.rangestart=!0,$("#jfgrid-formula-functionrange-select").css({left:s,width:f-s-1,top:o,height:n-o-1}).show(),$("#jfgrid-formula-help-c").hide();S=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:[l,l],column:[g,g]},jfgrid.currentSheetIndex);return $("#jfgrid-ifFormulaGenerator-multiRange-dialog input").val(S),$("#jfgrid-row-count-show").hide(),void $("#jfgrid-column-count-show").hide()}jfgird_select_status&&(e.shiftKey?(k=R=0,x=[],x=(v=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1])).top>o?(R=o,k=v.top+v.height-o,v.row[1]>v.row_focus&&(v.row[1]=v.row_focus),[l,v.row[1]]):v.top==o?(R=o,k=v.top+v.height-o,[l,v.row[0]]):(R=v.top,k=n-v.top-1,v.row[0]<v.row_focus&&(v.row[0]=v.row_focus),[v.row[0],l]),I=T=0,C=[],C=v.left>s?(T=s,I=v.left+v.width-s,v.column[1]>v.column_focus&&(v.column[1]=v.column_focus),[g,v.column[1]]):v.left==s?(T=s,I=v.left+v.width-s,[g,v.column[0]]):(T=v.left,I=f-v.left-1,v.column[0]<v.column_focus&&(v.column[0]=v.column_focus),[v.column[0],g]),null!=(b=jfgrid.menuButton.mergeMoveMain(C,x,v,R,k,T,I))&&(C=b[0],x=b[1],R=b[2],k=b[3],T=b[4],I=b[5]),v.row=x,v.column=C,v.left_move=T,v.width_move=I,v.top_move=R,v.height_move=k,jfgird_select_save[jfgird_select_save.length-1]=v,$("#jfgrid-alternateformat-rangeDialog").is(":visible")&&$("#jfgrid-alternateformat-rangeDialog input").val(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,jfgird_select_save)),jfgrid.chartparam.jfgrid_chart_data_select_state&&$("#jfgrid-datavisual-range-selection-input").val(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"!"+jfgrid.jfgridchatatABC(jfgird_select_save[0].column[0])+(jfgird_select_save[0].row[0]+1)+":"+jfgrid.jfgridchatatABC(jfgird_select_save[0].column[1])+(jfgird_select_save[0].row[1]+1)),jfgrid.pivotTable.jfgrid_pivotTable_select_state&&$("#jfgrid-pivotTable-range-selection-input").val(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"!"+jfgrid.jfgridchatatABC(jfgird_select_save[0].column[0])+(jfgird_select_save[0].row[0]+1)+":"+jfgrid.jfgridchatatABC(jfgird_select_save[0].column[1])+(jfgird_select_save[0].row[1]+1))):e.ctrlKey?jfgird_select_save.push({left:s,width:f-s-1,top:o,height:n-o-1,left_move:s,width_move:f-s-1,top_move:o,height_move:n-o-1,row:[l,c],column:[g,u],row_focus:l,column_focus:g}):((jfgird_select_save=[]).push({left:s,width:f-s-1,top:o,height:n-o-1,left_move:s,width_move:f-s-1,top_move:o,height_move:n-o-1,row:[l,c],column:[g,u],row_focus:l,column_focus:g}),jfgrid.menuButton.menuButtonFocus(jfgrid.flowdata,l,g),jfgrid.formula.fucntionboxshow(l,g)),jfgrid.selectHightlightShow(),null==jfgrid.freezen.freezenhorizontaldata&&null==jfgrid.freezen.freezenverticaldata||jfgrid.freezen.scrollAdaptOfselect(),mobilecheck||jfgridactiveCell(),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("mv",jfgrid.currentSheetIndex,jfgird_select_save)),clearTimeout(jfgrid.chartparam.jfgrid_chart_rangefocus_timeout),jfgrid.chartparam.jfgrid_chart_rangefocus&&(jfgrid.chartparam.jfgrid_chart_rangefocus=!1,$("#jfgrid-datavisual-range-button").click()),jfgrid.alternateformat.rangefocus&&(jfgrid.alternateformat.rangefocus=!1,$("#jfgrid-alternateformat-range .fa-table").click()),$("#jfgrid-row-count-show, #jfgrid-column-count-show").hide(),jfgrid.isEditMode()||window.store&&store.commit("hideAllNeedRangeShow"),$("#jfgrid-helpbox-cell").text(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,jfgird_select_save[jfgird_select_save.length-1])),jfgrid.pivotTable.pivotclick(l,g,jfgrid.currentSheetIndex),$("#"+container).attr("tabindex",0).focus()}}else jfgridConfigsetting.fireMousedown(jfgrid.flowdata[l][g].dd)}}).mouseup(function(e){if("3"==e.which){if(jfgrid.isEditMode())return;var r,t=e.pageX,i=e.pageY,a=(jfgrid.flowdata,jfgird_select_save[0]);if($("#jfgrid-cols-rows-data").show(),$("#jfgrid-cols-rows-add, #jfgrid-cols-rows-shift").hide(),null!=a.row&&0==a.row[0]&&a.row[1]==jfgrid.flowdata.length-1){jfgridRightHeadClickIs="column",$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-word").text("列"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-size").text("宽"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-left").text("左"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-right").text("右"),$("#jfgrid-cols-rows-add").show(),$("#jfgrid-cols-rows-data").show(),$("#jfgrid-cols-rows-shift").hide(),jfgrid_cols_menu_status=!0,null==(r=$.extend(!0,{},config)).columlen&&(r.columlen={});for(var n=null==r.columlen[jfgird_select_save[0].column[0]]?jfgrid.defaultcollen:r.columlen[jfgird_select_save[0].column[0]],o=!0,l=0;l<jfgird_select_save.length;l++)for(var d=(c=jfgird_select_save[l]).column[0],f=c.column[1],s=d;s<=f;s++){if((null==r.columlen[s]?jfgrid.defaultcollen:r.columlen[s])!=n){o=!1;break}}o?$("#jfgrid-cols-rows-add").find("input[type='number'].rcsize").val(n):$("#jfgrid-cols-rows-add").find("input[type='number'].rcsize").val("")}else if(null!=a.column&&0==a.column[0]&&a.column[1]==jfgrid.flowdata[0].length-1){jfgridRightHeadClickIs="row",$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-word").text("行"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-size").text("高"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-left").text("上"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-right").text("下"),$("#jfgrid-cols-rows-add").show(),$("#jfgrid-cols-rows-data").show(),$("#jfgrid-cols-rows-shift").hide(),jfgrid_cols_menu_status=!0,null==(r=$.extend(!0,{},config)).rowlen&&(r.rowlen={});for(var g=null==r.rowlen[jfgird_select_save[0].row[0]]?jfgrid.defaultrowlen:r.rowlen[jfgird_select_save[0].row[0]],o=!0,l=0;l<jfgird_select_save.length;l++)for(var c,u=(c=jfgird_select_save[l]).row[0],m=c.row[1],h=u;h<=m;h++){if((null==r.rowlen[h]?jfgrid.defaultrowlen:r.rowlen[h])!=g){o=!1;break}}o?$("#jfgrid-cols-rows-add").find("input[type='number'].rcsize").val(g):$("#jfgrid-cols-rows-add").find("input[type='number'].rcsize").val("")}showrightclickmenu($("#jfgrid-rightclick-menu"),t,i)}}).dblclick(function(e){if(!(0<parseInt($("#jfgrid-input-box").css("top")))){var r=mouseposition(e.pageX,e.pageY);if(!(r[0]>=cellmainWidth-cellMainSrollBarSize||r[1]>=cellmainHeight-cellMainSrollBarSize)){var t=$("#jfgrid-cell-main").scrollLeft(),i=$("#jfgrid-cell-main").scrollTop(),a=r[0]+t,n=r[1]+i,o=jfgrid.rowLocation(n),l=o[1],d=o[0],f=o[2],s=jfgrid.colLocation(a),g=s[1],c=s[0],u=s[2];if(jfgrid.pivotTable.isPivotRange(f,u)){if(!(null!=jfgrid.pivotTable.filter&&0!=jfgrid.pivotTable.filter.length||null!=jfgrid.pivotTable.row&&0!=jfgrid.pivotTable.row.length||null!=jfgrid.pivotTable.column&&0!=jfgrid.pivotTable.column.length||null!=jfgrid.pivotTable.values&&0!=jfgrid.pivotTable.values.length))return;if(null==jfgrid.pivotTable.values||0==jfgrid.pivotTable.values.length)return;if(0==f||0==u)return;if(null!=jfgrid.pivotTable.column&&0<jfgrid.pivotTable.column.length)if(2<=jfgrid.pivotTable.values.length&&"column"==jfgrid.pivotTable.showType){if(f<=jfgrid.pivotTable.column.length||u>=jfgrid.pivotTable.pivotDatas[0].length-jfgrid.pivotTable.values.length)return}else if(f<=jfgrid.pivotTable.column.length-1||u>=jfgrid.pivotTable.pivotDatas[0].length-1)return;if(null!=jfgrid.pivotTable.row&&0<jfgrid.pivotTable.row.length)if(2<=jfgrid.pivotTable.values.length&&"row"==jfgrid.pivotTable.showType){if(u<=jfgrid.pivotTable.row.length||f>=jfgrid.pivotTable.pivotDatas.length-jfgrid.pivotTable.values.length)return}else if(u<=jfgrid.pivotTable.row.length-1||f>=jfgrid.pivotTable.pivotDatas.length-1)return;return jfgrid.sheetmanage.addNewSheet(e),void jfgrid.pivotTable.drillDown(f,u)}var m=jfgrid.menuButton.mergeborer(jfgrid.flowdata,f,u);if(m&&(l=m.row[1],d=m.row[0],f=m.row[2],g=m.column[1],c=m.column[0],u=m.column[2]),$("#jfgrid-search-formula-parm").is(":visible")||$("#jfgrid-search-formula-parm-select").is(":visible"))$("#jfgrid-cell-selected").hide();else{if($("#jfgrid-conditionformat-dialog").is(":visible")||$("#jfgrid-administerRule-dialog").is(":visible")||$("#jfgrid-newConditionRule-dialog").is(":visible")||$("#jfgrid-editorConditionRule-dialog").is(":visible")||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;if($("#jfgrid-modal-dialog-slider-alternateformat").is(":visible")||$("#jfgrid-alternateformat-rangeDialog").is(":visible"))return;jfgrid.menuButton.jfgridPaintModelOn&&jfgrid.menuButton.cancelPaintModel(),jfgrid.jfgridupdateCell(l,d,f,g,c,u,jfgrid.flowdata)}}}}),$("#jfgrid-bottom-add-row, #jfgrid-bottom-add-row-input, #jfgrid-bottom-return-top").on("mousedown dblclick mouseup",function(e){e.stopPropagation()}),$("#jfgrid-bottom-add-row").on("click",function(e){$("#jfgrid-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus();$(this);var r=$("#jfgrid-bottom-add-row-input").val();""==r&&(r=100),isNaN(parseInt(r))?jfgrid.isEditMode()?alert("请输入数字"):jfgrid.tooltip.info("增加错误","请输入数字"):(r=parseInt(r))<1||100<r?jfgrid.isEditMode()?alert("增加范围限制在1-100"):jfgrid.tooltip.info("增加错误","增加范围限制在1-100"):jfgridextendtable("row",jfgrid.flowdata.length-1,r)}),$("#jfgrid-bottom-return-top").on("click",function(e){$("#jfgrid-scrollbar-y").scrollTop(0)});var jfgridactiveCell=function(){fullscreenmode&&setTimeout(function(){$("#jfgrid-rich-text-editor").focus().select()},50)};jfgrid.jfgridactiveCell=jfgridactiveCell,jfgrid.jfgridupdateCell=function(e,r,t,i,a,n,o,l,d){var f,s,g,c,u,m,h,j,p,v,b,_,w,y;jfgrid.isEditMode()||($("#jfgrid-dropCell-icon").is(":visible")&&$("#jfgrid-dropCell-icon").remove(),f=$(window).height(),s=$(window).width(),g=$("#"+container).offset(),c=$("#jfgrid-cell-main").scrollLeft(),u=$("#jfgrid-cell-main").scrollTop(),h=jfgridConfigsetting.pointEdit?(m=a*jfgridConfigsetting.pointEditZoom+g.left+rowHeaderWidth*jfgridConfigsetting.pointEditZoom-c,r*jfgridConfigsetting.pointEditZoom+g.top+(infobarHeight+toolbarHeight+calculatebarHeight+columeHeaderHeight)*jfgridConfigsetting.pointEditZoom-u):(m=a+g.left+rowHeaderWidth-c,r+g.top+infobarHeight+toolbarHeight+calculatebarHeight+columeHeaderHeight-u),jfgrid.pivotTable.isPivotRange(t,n)||(jfgridCellUpdate=[t,n],d||$("#jfgrid-rich-text-editor").focus().select(),jfgridConfigsetting.pointEdit?$("#jfgrid-input-box").removeAttr("style").css({"background-color":"rgb(255, 255, 255)",padding:"0px 2px","font-size":"13px","max-width":s+c-a-20-rowHeaderWidth,"max-height":f+u-r-20-15-toolbarHeight-infobarHeight-calculatebarHeight-sheetBarHeight-statisticBarHeight,"min-width":i-a+1-8,"min-height":e-r+1-4,left:m-2*jfgridConfigsetting.pointEditZoom,top:h-2*jfgridConfigsetting.pointEditZoom,right:"auto","overflow-y":"auto","box-sizing":"initial","transform-origin":"0 0",transform:"scale("+jfgridConfigsetting.pointEditZoom+")","z-index":1e3}):$("#jfgrid-input-box").removeAttr("style").css({"background-color":"rgb(255, 255, 255)",padding:"0px 2px","font-size":"13px","max-width":s+c-a-20-rowHeaderWidth,"max-height":f+u-r-20-15-toolbarHeight-infobarHeight-calculatebarHeight-sheetBarHeight-statisticBarHeight,"min-width":i-a+1-8,"min-height":e-r+1-4,left:m-2,top:h-2,right:"auto","overflow-y":"auto","box-sizing":"initial"}),null==jfgrid.freezen.freezenverticaldata&&null==jfgrid.freezen.freezenhorizontaldata||$("#jfgrid-input-box").css("z-index",10002),$("#jfgrid-input-box-index").html(jfgrid.jfgridchatatABC(n)+(t+1)).hide(),$("#jfgrid-wa-functionbox-cancel, #jfgrid-wa-functionbox-confirm").addClass("jfgrid-wa-calculate-active"),j="",null!=o[t]&&null!=o[t][n]?(p=o[t][n],l||(j=null!=p.f?jfgrid.getcellvalue(t,n,o,"f"):jfgrid.mask.valueShowEs(t,n,o)),v=jfgrid.menuButton.getStyleByCell(o,t,n),v=$("#jfgrid-input-box").get(0).style.cssText+v,$("#jfgrid-input-box").get(0).style.cssText=v,"rgba(0, 0, 0, 0)"==$("#jfgrid-input-box").get(0).style.backgroundColor&&($("#jfgrid-input-box").get(0).style.background="rgb(255,255,255)")):(b=jfgrid.alternateformat.getComputeMap(),_=jfgrid.alternateformat.checksAF(t,n,b),w=jfgrid.conditionformat.getComputeMap(),null!=(y=jfgrid.conditionformat.checksCF(t,n,w))&&null!=y.cellColor?$("#jfgrid-input-box").get(0).style.background=y.cellColor:null!=_&&($("#jfgrid-input-box").get(0).style.background=_[1])),null!=j&&""!=j.toString()||l||(j="<br/>"),$("#jfgrid-rich-text-editor").html(j),d||jfgridRangeLast($("#jfgrid-rich-text-editor")[0]),jfgrid.formula.rangetosheet=jfgrid.currentSheetIndex,jfgrid.formula.createRangeHightlight(),jfgrid.formula.rangeResizeTo=$("#jfgrid-rich-text-editor"),jfgrid.cleargridelement()))},$("#jfgrid-input-box").click(function(){jfgrid.formula.rangeHightlightselected($("#jfgrid-rich-text-editor"))}).add("#"+container).on("keydown",function(e){if(!($("#jfgrid-modal-dialog-mask").is(":visible")||$(e.target).hasClass("jfgrid-mousedown-cancel")||$(e.target).hasClass("formulaInputFocus"))){var r=e.ctrlKey,t=e.altKey,i=e.shiftKey,a=e.keyCode;if($("#jfgrid-modal-dialog-mask").is(":visible")||$(e.target).hasClass("jfgrid-mousedown-cancel")||$(e.target).hasClass("sp-input")||0<parseInt($("#jfgrid-input-box").css("top"))&&0<$(e.target).closest(".jfgrid-input-box").length&&a!=keycode.ENTER&&a!=keycode.TAB&&a!=keycode.UP&&a!=keycode.DOWN&&a!=keycode.LEFT&&a!=keycode.RIGHT){var n,o,l,d,f,s,g=$(window.getSelection().anchorNode);(g.parent().is("#jfgrid-helpbox-cell")||g.is("#jfgrid-helpbox-cell"))&&a==keycode.ENTER&&(n=$("#jfgrid-helpbox-cell").text(),jfgrid.formula.iscelldata(n)&&(o=jfgrid.formula.getcellrange(n),jfgird_select_save=[{row:o.row,column:o.column,row_focus:o.row[0],column_focus:o.column[0]}],jfgrid.selectHightlightShow(),$("#jfgrid-helpbox-cell").blur(),l=$("#jfgrid-cell-main").scrollLeft(),d=$("#jfgrid-cell-main").scrollTop(),f=$("#jfgrid-cell-main").height(),s=$("#jfgrid-cell-main").width(),p=visibledatarow[o.row[1]],v=o.row[0]-1==-1?0:visibledatarow[o.row[0]-1],b=visibledatacolumn[o.column[1]],_=o.column[0]-1==-1?0:visibledatacolumn[o.column[0]-1],0<b-l-s+20?$("#jfgrid-scrollbar-x").scrollLeft(b-s+20):_-l-20<0&&$("#jfgrid-scrollbar-x").scrollLeft(_-20),0<p-d-f+20?$("#jfgrid-scrollbar-y").scrollTop(p-f+20):v-d-20<0&&$("#jfgrid-scrollbar-y").scrollTop(v-20)))}else{var c,u=$("#jfgrid-input-box");if(a==keycode.ENTER&&0<parseInt(u.css("top")))$("#jfgrid-formula-search-c").is(":visible")&&null!=jfgrid.formula.searchFunctionCell?jfgrid.formula.searchFunctionEnter($("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item-active")):(jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgird_select_save=[{row:[jfgridCellUpdate[0],jfgridCellUpdate[0]],column:[jfgridCellUpdate[1],jfgridCellUpdate[1]],row_focus:jfgridCellUpdate[0],column_focus:jfgridCellUpdate[1]}],jfgridMoveHighlightCell("down",1,"rangeOfSelect")),$("#jfgrid-search-formula-parm").is(":visible")&&$("#jfgrid-search-formula-parm").hide(),$("#jfgrid-search-formula-parm-select").is(":visible")&&$("#jfgrid-search-formula-parm-select").hide(),e.preventDefault();else if(a==keycode.TAB){if(0<parseInt(u.css("top")))return;jfgridMoveHighlightCell("right",1,"rangeOfSelect"),e.preventDefault()}else if(a==keycode.F2){if(0<parseInt(u.css("top")))return;var m,h=(m=jfgird_select_save[jfgird_select_save.length-1]).row_focus,j=m.column_focus,p=visibledatarow[h],v=h-1==-1?0:visibledatarow[h-1],b=visibledatacolumn[j],_=j-1==-1?0:visibledatacolumn[j-1];jfgrid.jfgridupdateCell(p,v,h,b,_,j,jfgrid.flowdata),e.preventDefault()}else if(a==keycode.F4&&0<parseInt(u.css("top")))jfgrid.formula.setfreezonFuc(e),e.preventDefault();else if(a==keycode.ESC&&0<parseInt(u.css("top")))jfgrid.formula.dontupdate(),jfgridMoveHighlightCell("down",0,"rangeOfSelect"),e.preventDefault();else if(a==keycode.ENTER){if($(e.target).hasClass("formulaInputFocus")||$("#jfgrid-conditionformat-dialog").is(":visible"))return;null!=String.fromCharCode(a)&&$("#jfgrid-cell-selected").is(":visible")&&(h=(m=jfgird_select_save[jfgird_select_save.length-1]).row_focus,j=m.column_focus,p=visibledatarow[h],v=h-1==-1?0:visibledatarow[h-1],b=visibledatacolumn[j],_=j-1==-1?0:visibledatacolumn[j-1],(c=jfgrid.menuButton.mergeborer(jfgrid.flowdata,h,j))&&(p=c.row[1],v=c.row[0],h=c.row[2],b=c.column[1],_=c.column[0],j=c.column[2]),jfgrid.jfgridupdateCell(p,v,h,b,_,j,jfgrid.flowdata),e.preventDefault())}else{if(r||e.metaKey){if(i){if(jfgrid_shiftkeydown||(jfgrid.jfgrid_shiftpositon=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1]),jfgrid_shiftkeydown=!0),a==keycode.UP){if(0<parseInt(u.css("top"))||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightRange2("up","rangeOfSelect")}else if(a==keycode.DOWN){if(0<parseInt(u.css("top"))||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightRange2("down","rangeOfSelect")}else if(a==keycode.LEFT){if(0<parseInt(u.css("top"))||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightRange2("left","rangeOfSelect")}else if(a==keycode.RIGHT){if(0<parseInt(u.css("top"))||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightRange2("right","rangeOfSelect")}}else if(66==a)$("#jfgrid-icon-bold").click();else{if(67==a){if(jfgrid.menuButton.jfgridPaintModelOn&&jfgrid.menuButton.cancelPaintModel(),0==jfgird_select_save.length)return;if(null!=config.merge){for(var w=!1,y=0;y<jfgird_select_save.length;y++){var x=jfgird_select_save[y].row[0],C=jfgird_select_save[y].row[1],T=jfgird_select_save[y].column[0],I=jfgird_select_save[y].column[1];if(w=jfgrid.hasPartMC(config,x,C,T,I))break}if(w)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var R=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save;if(1<jfgird_select_save.length&&null!=R&&0<R.length){var k=!1,S=jfgrid.conditionformat.getComputeMap();e:for(y=0;y<jfgird_select_save.length&&!k;y++)for(var x=jfgird_select_save[y].row[0],C=jfgird_select_save[y].row[1],T=jfgird_select_save[y].column[0],I=jfgird_select_save[y].column[1],A=x;A<=C;A++)for(var F=T;F<=I;F++)if(null!=jfgrid.conditionformat.checksCF(A,F,S)){k=!0;continue e}if(k)return void(jfgrid.isEditMode()?alert("无法对多重选择区域执行此操作"):jfgrid.tooltip.info("无法对多重选择区域执行此操作",""))}if(1<jfgird_select_save.length){for(var N=!0,M=jfgird_select_save[0].row[0],E=jfgird_select_save[0].row[1],O=!0,z=jfgird_select_save[0].column[0],D=jfgird_select_save[0].column[1],y=1;y<jfgird_select_save.length;y++)jfgird_select_save[y].row[0]==M&&jfgird_select_save[y].row[1]==E||(N=!1),jfgird_select_save[y].column[0]==z&&jfgird_select_save[y].column[1]==D||(O=!1);if(!N&&!O||jfgrid.selectIsOverlap())return void(jfgrid.isEditMode()?alert("无法对多重选择区域执行此操作"):jfgrid.tooltip.info("无法对多重选择区域执行此操作",""))}return jfgrid.selection.copy(e),jfgrid_paste_iscut=!1,jfgridactiveCell(),void e.stopPropagation()}if(70==a)jfgrid.searchReplace.createDialog(0),jfgrid.searchReplace.init(),$("#jfgrid-search-replace #searchInput input").focus();else if(72==a)jfgrid.searchReplace.createDialog(1),jfgrid.searchReplace.init(),$("#jfgrid-search-replace #searchInput input").focus();else if(73==a)$("#jfgrid-icon-italic").click();else{if(86==a){if(jfgrid.isEditMode())return;if($(e.target).hasClass("formulaInputFocus"))return;return 1<jfgird_select_save.length?void(jfgrid.isEditMode()?alert("无法在此处粘贴此内容，请选择粘贴区域的一个单元格，然后再次尝试粘贴"):jfgrid.tooltip.info("无法在此处粘贴此内容，请选择粘贴区域的一个单元格，然后再次尝试粘贴","")):(jfgrid.selection.isPasteAction=!0,jfgridactiveCell(),void e.stopPropagation())}if(88==a){if(jfgrid.menuButton.jfgridPaintModelOn&&jfgrid.menuButton.cancelPaintModel(),0==jfgird_select_save.length)return;if(null!=config.merge){for(w=!1,y=0;y<jfgird_select_save.length;y++){x=jfgird_select_save[y].row[0],C=jfgird_select_save[y].row[1],T=jfgird_select_save[y].column[0],I=jfgird_select_save[y].column[1];if(w=jfgrid.hasPartMC(config,x,C,T,I))break}if(w)return void(jfgrid.jfgridConfigsetting.editMode?alert("无法对合并单元格执行此操作"):jfgrid.tooltip.info("无法对合并单元格执行此操作",""))}return 1<jfgird_select_save.length?void(jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","")):(jfgrid.selection.copy(e),jfgrid_paste_iscut=!0,jfgridactiveCell(),void e.stopPropagation())}if(90==a)return jfgrid.controlHistory.redo(e),jfgridactiveCell(),void e.stopPropagation();if(89==a)return jfgrid.controlHistory.undo(e),jfgridactiveCell(),void e.stopPropagation();if(a==keycode.UP){if(0<parseInt(u.css("top"))||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightCell2("up","rangeOfSelect")}else if(a==keycode.DOWN){if(0<parseInt(u.css("top"))||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightCell2("down","rangeOfSelect")}else if(a==keycode.LEFT){if(0<parseInt(u.css("top"))||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightCell2("left","rangeOfSelect")}else if(a==keycode.RIGHT){if(0<parseInt(u.css("top"))||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightCell2("right","rangeOfSelect")}else"A"==String.fromCharCode(a).toLocaleUpperCase()&&($("#jfgrid-left-top").trigger("mousedown"),$(document).trigger("mouseup"))}}return void e.preventDefault()}if(i&&(a==keycode.UP||a==keycode.DOWN||a==keycode.LEFT||a==keycode.RIGHT||t&&(53==a||101==a))){if(0<parseInt(u.css("top"))||$(e.target).hasClass("formulaInputFocus"))return;if(jfgrid_shiftkeydown||(jfgrid.jfgrid_shiftpositon=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1]),jfgrid_shiftkeydown=!0),a==keycode.UP){if($("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightRange("down",-1,"rangeOfSelect")}else if(a==keycode.DOWN){if($("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightRange("down",1,"rangeOfSelect")}else if(a==keycode.LEFT){if($("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightRange("right",-1,"rangeOfSelect")}else if(a==keycode.RIGHT){if($("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightRange("right",1,"rangeOfSelect")}else!t||53!=a&&101!=a||$("#jfgrid-icon-strikethrough").click();e.preventDefault()}else if(a==keycode.ESC)jfgrid.menuButton.jfgridPaintModelOn?jfgrid.menuButton.cancelPaintModel():(jfgrid.cleargridelement(e),e.preventDefault()),jfgrid.selectHightlightShow();else if(a==keycode.DELETE)jfgrid.chartparam.jfgridCurrentChartActive&&!jfgrid.isEditMode()?jfgrid.chartparam.jfgridCurrentChartMoveObj.find(".jfgrid-modal-controll-del").click():$("#jfgrid-delete-text").click(),e.preventDefault();else if(a==keycode.UP){if(0<parseInt(u.css("top"))||$(e.target).hasClass("formulaInputFocus")||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightCell("down",-1,"rangeOfSelect"),e.preventDefault()}else if(a==keycode.DOWN){if(0<parseInt(u.css("top"))||$(e.target).hasClass("formulaInputFocus")||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightCell("down",1,"rangeOfSelect"),e.preventDefault()}else if(a==keycode.LEFT){if(0<parseInt(u.css("top"))||$(e.target).hasClass("formulaInputFocus")||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightCell("right",-1,"rangeOfSelect"),e.preventDefault()}else if(a==keycode.RIGHT){if(0<parseInt(u.css("top"))||$(e.target).hasClass("formulaInputFocus")||$("#jfgrid-singleRange-dialog").is(":visible")||$("#jfgrid-multiRange-dialog").is(":visible"))return;jfgridMoveHighlightCell("right",1,"rangeOfSelect"),e.preventDefault()}else{(!(112<=a&&a<=123||a<=46||144==a||108==a||e.ctrlKey||e.altKey||e.shiftKey&&(37==a||38==a||39==a||40==a))||8==a||32==a||46==a||0==a||e.ctrlKey&&86==a)&&null!=String.fromCharCode(a)&&$("#jfgrid-cell-selected").is(":visible")&&a!=keycode.CAPSLOCK&&a!=keycode.WIN&&18!=a&&(h=(m=jfgird_select_save[jfgird_select_save.length-1]).row_focus,j=m.column_focus,p=visibledatarow[h],v=h-1==-1?0:visibledatarow[h-1],b=visibledatacolumn[j],_=j-1==-1?0:visibledatacolumn[j-1],(c=jfgrid.menuButton.mergeborer(jfgrid.flowdata,h,j))&&(p=c.row[1],v=c.row[0],h=c.row[2],b=c.column[1],_=c.column[0],j=c.column[2]),jfgrid.jfgridupdateCell(p,v,h,b,_,j,jfgrid.flowdata,!0),8==a&&$("#jfgrid-rich-text-editor").html("<br/>"),jfgrid.formula.functionInputHanddler($("#jfgrid-functionbox-cell"),$("#jfgrid-rich-text-editor"),a))}}jfgridactiveCell(),e.stopPropagation()}}});var jfgridMoveEndCell=function(e,r,t,i,a){null==t&&(t=!0),e=e||"down",r=r||"cell",null==a&&(a=!1);var n,o,l,d,f=jfgird_select_save[jfgird_select_save.length-1],s=null==f.row?0:f.row[0],g=null==f.column?0:f.column[0],c=null==f.row?0:f.row[0],u=null==f.column?0:f.column[0],m=null==f.row?0:f.row[1],h=null==f.column?0:f.column[1];jfgrid.formula.fucntionboxshow(s,g),"range"==r&&(n=jfgrid.jfgrid_shiftpositon.row[0],o=jfgrid.jfgrid_shiftpositon.column[0],l=jfgrid.jfgrid_shiftpositon.row[1],d=jfgrid.jfgrid_shiftpositon.column[1],"down"==e||"up"==e?l<m?s=null==f.row?0:f.row[1]:c<n?s=null==f.row?0:f.row[0]:l==m&&n==c&&(s="down"==e?null==f.row?0:f.row[1]:null==f.row?0:f.row[0]):"right"!=e&&"left"!=e||(d<h?g=null==f.column?0:f.column[1]:u<o?g=null==f.column?0:f.column[0]:d==h&&o==u&&(g="right"==e?null==f.column?0:f.column[1]:null==f.column?0:f.column[0])));var j=jfgrid.flowdata.length,p=jfgrid.flowdata[0].length,v=jfgrid.flowdata,b="",_=0;if("up"==e){if(0==s)return;for(var w=[],y=null,x=0,C=null,T=u;T<=h;T++){w=[],x=0;for(var I=s-1;0<=I;I--){var $=v[I][T];if("object"==jfgrid.getObjType($)&&jfgrid.func_methods.isRealNull($.v)||jfgrid.func_methods.isRealNull($)?w.push(!1):w.push(!0),1<w.length){if(1==w[x]&&0==w[x-1]){y=I;break}if(0==w[x]&&1==w[x-1]){y=I+1;break}}x++}null==y&&(y=0),(null==C||y<C)&&(C=y)}b="down",_=C-s}else if("down"==e){if(s==j-1)return;for(w=[],y=null,x=0,C=null,T=u;T<=h;T++){w=[],x=0;for(I=s+1;I<v.length;I++){$=v[I][T];if("object"==jfgrid.getObjType($)&&jfgrid.func_methods.isRealNull($.v)||jfgrid.func_methods.isRealNull($)?w.push(!1):w.push(!0),1<w.length){if(1==w[x]&&0==w[x-1]){y=I;break}if(0==w[x]&&1==w[x-1]){y=I-1;break}}x++}null==y&&(y=v.length-1),(null==C||C<y)&&(C=y)}b="down",_=C-s}else if("left"==e){if(0==g)return;for(w=[],y=null,x=0,C=null,I=c;I<=m;I++){w=[],x=0;for(T=g-1;0<=T;T--){$=v[I][T];if("object"==jfgrid.getObjType($)&&jfgrid.func_methods.isRealNull($.v)||jfgrid.func_methods.isRealNull($)?w.push(!1):w.push(!0),1<w.length){if(1==w[x]&&0==w[x-1]){y=T;break}if(0==w[x]&&1==w[x-1]){y=T+1;break}}x++}null==y&&(y=0),(null==C||y<C)&&(C=y)}b="right",_=C-g}else if("right"==e){if(g==p-1)return;for(w=[],y=null,x=0,C=null,I=c;I<=m;I++){w=[],x=0;for(T=g+1;T<v[0].length;T++){$=v[I][T];if("object"==jfgrid.getObjType($)&&jfgrid.func_methods.isRealNull($.v)||jfgrid.func_methods.isRealNull($)?w.push(!1):w.push(!0),1<w.length){if(1==w[x]&&0==w[x-1]){y=T;break}if(0==w[x]&&1==w[x-1]){y=T-1;break}}x++}null==y&&(y=v[0].length-1),(null==C||C<y)&&(C=y)}b="right",_=C-g}if("range"==r&&("up"==e?l<m&&_+s<l&&(_=l-s):"down"==e?c<n&&n<_+s&&(_=n-s):"left"==e?d<h&&_+g<d&&(_=d-g):"right"==e&&u<o&&o<_+g&&(_=o-g),null!=i&&Math.abs(_)>Math.abs(i)&&(_=i)),a)return _;"cell"==r?jfgridMoveHighlightCell(b,_,"rangeOfSelect",t):"range"==r&&jfgridMoveHighlightRange(b,_,"rangeOfSelect",t)};jfgrid.jfgridMoveEndCell=jfgridMoveEndCell;var jfgridMoveHighlightCell=function(e,r,t,i){null==i&&(i=!0);var a,n,o,l,d,f,s,g,c,u,m,h,j,p,v,b,_,w,y,x=jfgrid.flowdata.length,C=jfgrid.flowdata[0].length;"rangeOfSelect"==t?(n=null==(a=jfgird_select_save[jfgird_select_save.length-1]).row_focus?a.row[0]:a.row_focus,o=null==a.column_focus?a.column[0]:a.column_focus,(l=jfgrid.menuButton.mergeborer(jfgrid.flowdata,n,o))&&(d=l.row[2],f=l.row[3],s=l.column[2],g=l.column[3],0<r?"down"==e?(n=f,o=s):"right"==e&&(n=d,o=g):(n=d,o=s)),c=null==a.moveXY?n:a.moveXY.x,u=null==a.moveXY?o:a.moveXY.y,"down"==e?c=n+=r:"right"==e&&(u=o+=r),x<=n&&(c=n=x-1),n<0&&(c=n=0),C<=o&&(u=o=C-1),o<0&&(u=o=0),y=(m=jfgrid.menuButton.mergeborer(jfgrid.flowdata,n,o))?(h=m.row[1],j=m.row[0],b=m.row[2],_=m.row[3],p=m.column[1],v=m.column[0],w=m.column[2],m.column[3]):(h=visibledatarow[c],j=c-1==-1?0:visibledatarow[c-1],p=visibledatacolumn[u],v=u-1==-1?0:visibledatacolumn[u-1],_=b=c,w=u),a.row=[b,_],a.column=[w,y],a.row_focus=b,a.column_focus=w,a.moveXY={x:c,y:u},jfgrid.selectHightlightShow(),jfgrid.pivotTable.pivotclick(b,w),jfgrid.formula.fucntionboxshow(b,w),jfgrid.chartparam.jfgrid_chart_data_select_state&&$("#jfgrid-datavisual-range-selection-input").val(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"!"+jfgrid.jfgridchatatABC(a.column[0])+(a.row[0]+1)+":"+jfgrid.jfgridchatatABC(a.column[1])+(a.row[1]+1))):"rangeOfFormula"==t&&(n=null==(a=jfgrid.formula.func_selectedrange).row_focus?a.row[0]:a.row_focus,o=null==a.column_focus?a.column[0]:a.column_focus,(l=jfgrid.menuButton.mergeborer(jfgrid.flowdata,n,o))&&(d=l.row[2],f=l.row[3],s=l.column[2],g=l.column[3],0<r?"down"==e?(n=f,o=s):"right"==e&&(n=d,o=g):(n=d,o=s)),c=null==a.moveXY?n:a.moveXY.x,u=null==a.moveXY?o:a.moveXY.y,"down"==e?c=n+=r:"right"==e&&(u=o+=r),x<=n&&(c=n=x-1),n<0&&(c=n=0),C<=o&&(u=o=C-1),o<0&&(u=o=0),y=(m=jfgrid.menuButton.mergeborer(jfgrid.flowdata,n,o))?(h=m.row[1],j=m.row[0],b=m.row[2],_=m.row[3],p=m.column[1],v=m.column[0],w=m.column[2],m.column[3]):(h=visibledatarow[c],j=c-1==-1?0:visibledatarow[c-1],p=visibledatacolumn[u],v=u-1==-1?0:visibledatacolumn[u-1],_=b=c,w=u),jfgrid.formula.func_selectedrange={left:v,width:p-v-1,top:j,height:h-j-1,left_move:v,width_move:p-v-1,top_move:j,height_move:h-j-1,row:[b,_],column:[w,y],row_focus:b,column_focus:w,moveXY:{x:c,y:u}},$("#jfgrid-formula-functionrange-select").css({left:v,width:p-v-1,top:j,height:h-j-1}).show(),jfgrid.formula.rangeSetValue({row:[b,_],column:[w,y]}));var T=$("#jfgrid-cell-main").scrollLeft(),I=$("#jfgrid-cell-main").scrollTop(),R=$("#jfgrid-cell-main").height(),k=$("#jfgrid-cell-main").width(),S=0,A=0;0<p-T-k+20?(S=p-k+20,i&&$("#jfgrid-scrollbar-x").scrollLeft(S)):v-T-20<0&&(S=v-20,i&&$("#jfgrid-scrollbar-x").scrollLeft(S)),0<h-I-R+20?(A=h-R+20,i&&$("#jfgrid-scrollbar-y").scrollTop(A)):j-I-20<0&&(A=j-20,i&&$("#jfgrid-scrollbar-y").scrollTop(A)),clearTimeout(jfcountfuncTimeout),jfcountfunc()},jfgridMoveHighlightCell2=function(e,r,t){if(t=t||!0,"rangeOfSelect"==r){var i=(g=jfgird_select_save[jfgird_select_save.length-1]).row_focus,a=g.column_focus;if(null!=config.merge&&i+"_"+a in config.merge?(u=!0,c=config.merge[i+"_"+a]):u=!1,"down"==e){if(i==jfgrid.flowdata.length-1)return;i=u?jfgrid.getNextIndex("down",a,c.r+c.rs-1,jfgrid.flowdata.length-1):jfgrid.getNextIndex("down",a,i,jfgrid.flowdata.length-1)}else if("up"==e){if(0==i)return;i=u?jfgrid.getNextIndex("up",a,0,c.r):jfgrid.getNextIndex("up",a,0,i)}else if("right"==e){if(a==jfgrid.flowdata[0].length-1)return;a=u?jfgrid.getNextIndex("right",i,c.c+c.cs-1,jfgrid.flowdata[0].length-1):jfgrid.getNextIndex("right",i,a,jfgrid.flowdata[0].length-1)}else if("left"==e){if(0==a)return;a=u?jfgrid.getNextIndex("left",i,0,c.c):jfgrid.getNextIndex("left",i,0,a)}var n=[i,i],o=[a,a],l=visibledatarow[i],d=i-1==-1?0:visibledatarow[i-1],f=visibledatacolumn[a],s=a-1==-1?0:visibledatacolumn[a-1];null!=(m=jfgrid.menuButton.mergeMoveMain(o,n,g,d,l-d-1,s,f-s-1))&&(o=m[0],n=m[1]),jfgird_select_save=[{row:n,column:o}],jfgrid.selectHightlightShow(),jfgrid.pivotTable.pivotclick(i,a),jfgrid.formula.fucntionboxshow(i,a),jfgrid.chartparam.jfgrid_chart_data_select_state&&$("#jfgrid-datavisual-range-selection-input").val(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"!"+jfgrid.jfgridchatatABC(o[0])+(n[0]+1)+":"+jfgrid.jfgridchatatABC(o[1])+(n[1]+1))}else if("rangeOfFormula"==r){var g,c,u,i=(g=jfgrid.formula.func_selectedrange).row_focus,a=g.column_focus;if(null!=config.merge&&i+"_"+a in config.merge?(u=!0,c=config.merge[i+"_"+a]):u=!1,"down"==e){if(i==jfgrid.flowdata.length-1)return;i=u?jfgrid.getNextIndex("down",a,c.r+c.rs-1,jfgrid.flowdata.length-1):jfgrid.getNextIndex("down",a,i,jfgrid.flowdata.length-1)}else if("up"==e){if(0==i)return;i=u?jfgrid.getNextIndex("up",a,0,c.r):jfgrid.getNextIndex("up",a,0,i)}else if("right"==e){if(a==jfgrid.flowdata[0].length-1)return;a=u?jfgrid.getNextIndex("right",i,c.c+c.cs-1,jfgrid.flowdata[0].length-1):jfgrid.getNextIndex("right",i,a,jfgrid.flowdata[0].length-1)}else if("left"==e){if(0==a)return;a=u?jfgrid.getNextIndex("left",i,0,c.c):jfgrid.getNextIndex("left",i,0,a)}var m,n=[i,i],o=[a,a],l=visibledatarow[i],d=i-1==-1?0:visibledatarow[i-1],f=visibledatacolumn[a],h=d,j=l-d-1,p=s=a-1==-1?0:visibledatacolumn[a-1],v=f-s-1;null!=(m=jfgrid.menuButton.mergeMoveMain(o,n,g,h,j,p,v))&&(o=m[0],n=m[1],h=m[2],j=m[3],p=m[4],v=m[5]),jfgrid.formula.func_selectedrange={left:p,width:v,top:h,height:j,left_move:p,width_move:v,top_move:h,height_move:j,row:n,column:o,row_focus:i,column_focus:a},$("#jfgrid-formula-functionrange-select").css({left:p,width:v,top:h,height:j}).show(),jfgrid.formula.rangeSetValue({row:n,column:o})}var b=$("#jfgrid-cell-main").scrollLeft(),_=$("#jfgrid-cell-main").scrollTop(),w=$("#jfgrid-cell-main").height(),y=$("#jfgrid-cell-main").width(),x=0,C=0;0<f-b-y+20?(x=f-y+20,t&&$("#jfgrid-scrollbar-x").scrollLeft(x)):s-b-20<0&&(x=s-20,t&&$("#jfgrid-scrollbar-x").scrollLeft(x)),0<l-_-w+20?(C=l-w+20,t&&$("#jfgrid-scrollbar-y").scrollTop(C)):d-_-20<0&&(C=d-20,t&&$("#jfgrid-scrollbar-y").scrollTop(C)),clearTimeout(jfcountfuncTimeout),jfcountfunc()},jfgridMoveHighlightRange=function(e,r,t,i){var a,n,o,l,d,f,s,g,c,u,m,h,j,p,v,b,_,w,y,x,C,T,I,R,k,S;null==i&&(i=!0),"rangeOfSelect"==t?(n=(a=jfgird_select_save[jfgird_select_save.length-1]).row[0],o=a.row[1],l=a.column[0],d=a.column[1],f=a.row_focus,s=a.column_focus,g=jfgrid.flowdata.length,c=jfgrid.flowdata[0].length,"down"==e?(jfgrid.rowHasMerge(f,l,d)?(m=(u=jfgrid.getRowMerge(f,l,d))[0],h=u[1],n<m&&h==o?(0<r&&jfgrid.rowHasMerge(n,l,d)&&(n=jfgrid.getRowMerge(n,l,d)[1]),n+=r):h<o&&m==n?(r<0&&jfgrid.rowHasMerge(o,l,d)&&(o=jfgrid.getRowMerge(o,l,d)[0]),o+=r):0<r?o+=r:n+=r):n<f&&f==o?(0<r&&jfgrid.rowHasMerge(n,l,d)&&(n=jfgrid.getRowMerge(n,l,d)[1]),n+=r):f<o&&f==n?(r<0&&jfgrid.rowHasMerge(o,l,d)&&(o=jfgrid.getRowMerge(o,l,d)[0]),o+=r):f==n&&f==o&&(0<r?o+=r:n+=r),g<=o&&(o=g-1),o<0&&(o=0),g<=n&&(n=g-1),n<0&&(n=0)):(jfgrid.colHasMerge(s,n,o)?(p=(j=jfgrid.getColMerge(s,n,o))[0],v=j[1],l<p&&v==d?(0<r&&jfgrid.colHasMerge(l,n,o)&&(l=jfgrid.getColMerge(l,n,o)[1]),l+=r):v<d&&p==l?(r<0&&jfgrid.colHasMerge(d,n,o)&&(d=jfgrid.getColMerge(d,n,o)[0]),d+=r):0<r?d+=r:l+=r):l<s&&s==d?(0<r&&jfgrid.colHasMerge(l,n,o)&&(l=jfgrid.getColMerge(l,n,o)[1]),l+=r):s<d&&s==l?(r<0&&jfgrid.colHasMerge(d,n,o)&&(d=jfgrid.getColMerge(d,n,o)[0]),d+=r):s==l&&s==d&&(0<r?d+=r:l+=r),c<=d&&(d=c-1),d<0&&(d=0),c<=l&&(l=c-1),l<0&&(l=0)),b=[n,o],_=[l,d],w=visibledatarow[o],y=n-1==-1?0:visibledatarow[n-1],x=visibledatacolumn[d],C=l-1==-1?0:visibledatacolumn[l-1],null!=(S=jfgrid.menuButton.mergeMoveMain(_,b,a,y,w-y-1,C,x-C-1))&&(_=S[0],b=S[1]),a.row=b,a.column=_,jfgrid.selectHightlightShow(),jfgrid.chartparam.jfgrid_chart_data_select_state&&$("#jfgrid-datavisual-range-selection-input").val(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"!"+jfgrid.jfgridchatatABC(a.column[0])+(a.row[0]+1)+":"+jfgrid.jfgridchatatABC(a.column[1])+(a.row[1]+1))):"rangeOfFormula"==t&&(n=(a=jfgrid.formula.func_selectedrange).row[0],o=a.row[1],l=a.column[0],d=a.column[1],f=a.row_focus,s=a.column_focus,g=jfgrid.flowdata.length,c=jfgrid.flowdata[0].length,"down"==e?(jfgrid.rowHasMerge(f,l,d)?(m=(u=jfgrid.getRowMerge(f,l,d))[0],h=u[1],n<m&&h==o?(0<r&&jfgrid.rowHasMerge(n,l,d)&&(n=jfgrid.getRowMerge(n,l,d)[1]),n+=r):h<o&&m==n?(r<0&&jfgrid.rowHasMerge(o,l,d)&&(o=jfgrid.getRowMerge(o,l,d)[0]),o+=r):0<r?o+=r:n+=r):n<f&&f==o?(0<r&&jfgrid.rowHasMerge(n,l,d)&&(n=jfgrid.getRowMerge(n,l,d)[1]),n+=r):f<o&&f==n?(r<0&&jfgrid.rowHasMerge(o,l,d)&&(o=jfgrid.getRowMerge(o,l,d)[0]),o+=r):f==n&&f==o&&(0<r?o+=r:n+=r),g<=o&&(o=g-1),o<0&&(o=0),g<=n&&(n=g-1),n<0&&(n=0)):(jfgrid.colHasMerge(s,n,o)?(p=(j=jfgrid.getColMerge(s,n,o))[0],v=j[1],l<p&&v==d?(0<r&&jfgrid.colHasMerge(l,n,o)&&(l=jfgrid.getColMerge(l,n,o)[1]),l+=r):v<d&&p==l?(r<0&&jfgrid.colHasMerge(d,n,o)&&(d=jfgrid.getColMerge(d,n,o)[0]),d+=r):0<r?d+=r:l+=r):l<s&&s==d?(0<r&&jfgrid.colHasMerge(l,n,o)&&(l=jfgrid.getColMerge(l,n,o)[1]),l+=r):s<d&&s==l?(r<0&&jfgrid.colHasMerge(d,n,o)&&(d=jfgrid.getColMerge(d,n,o)[0]),d+=r):s==l&&s==d&&(0<r?d+=r:l+=r),c<=d&&(d=c-1),d<0&&(d=0),c<=l&&(l=c-1),l<0&&(l=0)),b=[n,o],_=[l,d],w=visibledatarow[o],y=n-1==-1?0:visibledatarow[n-1],x=visibledatacolumn[d],I=w-(T=y)-1,R=C=l-1==-1?0:visibledatacolumn[l-1],k=x-C-1,null!=(S=jfgrid.menuButton.mergeMoveMain(_,b,a,T,I,R,k))&&(_=S[0],b=S[1],T=S[2],I=S[3],R=S[4],k=S[5]),jfgrid.formula.func_selectedrange={left:R,width:k,top:T,height:I,left_move:R,width_move:k,top_move:T,height_move:I,row:b,column:_,row_focus:f,column_focus:s},$("#jfgrid-formula-functionrange-select").css({left:R,width:k,top:T,height:I}).show(),jfgrid.formula.rangeSetValue({row:b,column:_}));var A=$("#jfgrid-cell-main").scrollLeft(),F=$("#jfgrid-cell-main").scrollTop(),N=$("#jfgrid-cell-main").height(),M=$("#jfgrid-cell-main").width(),E=0,O=0;0<x-A-M+20?(E=x-M+20,i&&$("#jfgrid-scrollbar-x").scrollLeft(E)):C-A-20<0&&(E=C-20,i&&$("#jfgrid-scrollbar-x").scrollLeft(E)),0<w-F-N+20?(O=w-N+20,i&&$("#jfgrid-scrollbar-y").scrollTop(O)):y-F-20<0&&(O=y-20,i&&$("#jfgrid-scrollbar-y").scrollTop(O)),clearTimeout(jfcountfuncTimeout),jfcountfunc()},jfgridMoveHighlightRange2=function(e,r,t){if(t=t||!0,"rangeOfSelect"==r){var i=(h=jfgird_select_save[jfgird_select_save.length-1]).row_focus,a=h.column_focus,n=h.row[0],o=h.row[1],l=h.column[0],d=h.column[1];if("down"==e){if(o==jfgrid.flowdata.length-1)return;jfgrid.rowHasMerge(i,l,d)?(p=(j=jfgrid.getRowMerge(i,l,d))[0],v=j[1],n<p&&v==o?n=jfgrid.getNextIndex("down",a,n,o):o=jfgrid.getNextIndex("down",a,o,jfgrid.flowdata.length-1)):n<i&&i==o?n=jfgrid.getNextIndex("down",a,n,o):o=jfgrid.getNextIndex("down",a,o,jfgrid.flowdata.length-1)}else if("up"==e){if(0==n)return;jfgrid.rowHasMerge(i,l,d)?(p=(j=jfgrid.getRowMerge(i,l,d))[0],(v=j[1])<o&&p==n?o=jfgrid.getNextIndex("up",a,n,o):n=jfgrid.getNextIndex("up",a,0,n)):i<o&&i==n?o=jfgrid.getNextIndex("up",a,n,o):n=jfgrid.getNextIndex("up",a,0,n)}else if("right"==e){if(d==jfgrid.flowdata[0].length-1)return;jfgrid.colHasMerge(a,n,o)?(_=(b=jfgrid.getColMerge(a,n,o))[0],w=b[1],l<_&&w==d?l=jfgrid.getNextIndex("right",i,l,d):d=jfgrid.getNextIndex("right",i,d,jfgrid.flowdata[0].length-1)):l<a&&a==d?l=jfgrid.getNextIndex("right",i,l,d):d=jfgrid.getNextIndex("right",i,d,jfgrid.flowdata[0].length-1)}else if("left"==e){if(0==l)return;jfgrid.colHasMerge(a,n,o)?(_=(b=jfgrid.getColMerge(a,n,o))[0],(w=b[1])<d&&_==l?d=jfgrid.getNextIndex("left",i,l,d):l=jfgrid.getNextIndex("left",i,0,l)):a<d&&a==l?d=jfgrid.getNextIndex("left",i,l,d):l=jfgrid.getNextIndex("left",i,0,l)}var f=[n,o],s=[l,d],g=visibledatarow[o],c=n-1==-1?0:visibledatarow[n-1],u=visibledatacolumn[d],m=l-1==-1?0:visibledatacolumn[l-1];null!=(y=jfgrid.menuButton.mergeMoveMain(s,f,h,c,g-c-1,m,u-m-1))&&(s=y[0],f=y[1]),h.row=f,h.column=s,jfgrid.selectHightlightShow(),jfgrid.chartparam.jfgrid_chart_data_select_state&&$("#jfgrid-datavisual-range-selection-input").val(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"!"+jfgrid.jfgridchatatABC(h.column[0])+(h.row[0]+1)+":"+jfgrid.jfgridchatatABC(h.column[1])+(h.row[1]+1))}else if("rangeOfFormula"==r){var h,j,p,v,b,_,w,i=(h=jfgrid.formula.func_selectedrange).row_focus,a=h.column_focus,n=h.row[0],o=h.row[1],l=h.column[0],d=h.column[1];if("down"==e){if(o==jfgrid.flowdata.length-1)return;jfgrid.rowHasMerge(i,l,d)?(p=(j=jfgrid.getRowMerge(i,l,d))[0],v=j[1],n<p&&v==o?n=jfgrid.getNextIndex("down",a,n,o):o=jfgrid.getNextIndex("down",a,o,jfgrid.flowdata.length-1)):n<i&&i==o?n=jfgrid.getNextIndex("down",a,n,o):o=jfgrid.getNextIndex("down",a,o,jfgrid.flowdata.length-1)}else if("up"==e){if(0==n)return;jfgrid.rowHasMerge(i,l,d)?(p=(j=jfgrid.getRowMerge(i,l,d))[0],(v=j[1])<o&&p==n?o=jfgrid.getNextIndex("up",a,n,o):n=jfgrid.getNextIndex("up",a,0,n)):i<o&&i==n?o=jfgrid.getNextIndex("up",a,n,o):n=jfgrid.getNextIndex("up",a,0,n)}else if("right"==e){if(d==jfgrid.flowdata[0].length-1)return;jfgrid.colHasMerge(a,n,o)?(_=(b=jfgrid.getColMerge(a,n,o))[0],w=b[1],l<_&&w==d?l=jfgrid.getNextIndex("right",i,l,d):d=jfgrid.getNextIndex("right",i,d,jfgrid.flowdata[0].length-1)):l<a&&a==d?l=jfgrid.getNextIndex("right",i,l,d):d=jfgrid.getNextIndex("right",i,d,jfgrid.flowdata[0].length-1)}else if("left"==e){if(0==l)return;jfgrid.colHasMerge(a,n,o)?(_=(b=jfgrid.getColMerge(a,n,o))[0],(w=b[1])<d&&_==l?d=jfgrid.getNextIndex("left",i,l,d):l=jfgrid.getNextIndex("left",i,0,l)):a<d&&a==l?d=jfgrid.getNextIndex("left",i,l,d):l=jfgrid.getNextIndex("left",i,0,l)}var y,f=[n,o],s=[l,d],g=visibledatarow[o],c=n-1==-1?0:visibledatarow[n-1],u=visibledatacolumn[d],x=c,C=g-c-1,T=m=l-1==-1?0:visibledatacolumn[l-1],I=u-m-1;null!=(y=jfgrid.menuButton.mergeMoveMain(s,f,h,x,C,T,I))&&(s=y[0],f=y[1],x=y[2],C=y[3],T=y[4],I=y[5]),jfgrid.formula.func_selectedrange={left:T,width:I,top:x,height:C,left_move:T,width_move:I,top_move:x,height_move:C,row:f,column:s,row_focus:i,column_focus:a},$("#jfgrid-formula-functionrange-select").css({left:T,width:I,top:x,height:C}).show(),jfgrid.formula.rangeSetValue({row:f,column:s})}var R=$("#jfgrid-cell-main").scrollLeft(),k=$("#jfgrid-cell-main").scrollTop(),S=$("#jfgrid-cell-main").height(),A=$("#jfgrid-cell-main").width(),F=0,N=0;0<u-R-A+20?(F=u-A+20,t&&$("#jfgrid-scrollbar-x").scrollLeft(F)):m-R-20<0&&(F=m-20,t&&$("#jfgrid-scrollbar-x").scrollLeft(F)),0<g-k-S+20?(N=g-S+20,t&&$("#jfgrid-scrollbar-y").scrollTop(N)):c-k-20<0&&(N=c-20,t&&$("#jfgrid-scrollbar-y").scrollTop(N)),clearTimeout(jfcountfuncTimeout),jfcountfunc()};jfgrid.jfgridMoveHighlightRange2=jfgridMoveHighlightRange2;var jfgridRangeLast=function(e){var r,t,i;document.createRange?e.innerHTML!=e.innerText||""==e.innerHTML?(e.focus(),(t=window.getSelection()).selectAllChildren(e),t.collapseToEnd()):(r=e.innerText.length,(t=document.createRange()).selectNodeContents(e),t.setStart(e.childNodes[0],r),t.collapse(!0),(i=window.getSelection()).removeAllRanges(),i.addRange(t)):document.selection&&((t=document.body.createTextRange()).moveToElementText(e),t.collapse(!1),t.select())};function getCursortPosition(e){var r,t=0;return document.selection?(e.focus(),(r=document.selection.createRange()).moveStart("character",-e.value.length),t=r.text.length):!e.selectionStart&&"0"!=e.selectionStart||(t=e.selectionStart),t}jfgrid.jfgridRangeLast=jfgridRangeLast,$("#jfgrid-copy-btn, #jfgrid-cols-copy-btn, #jfgrid-paste-btn-title").click(function(e){if($(this).parent().hide(),null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save;if(1<jfgird_select_save.length&&null!=l&&0<l.length){var d=!1,f=jfgrid.conditionformat.getComputeMap();e:for(t=0;t<jfgird_select_save.length&&!d;t++)for(var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1],s=i;s<=a;s++)for(var g=n;g<=o;g++)if(null!=jfgrid.conditionformat.checksCF(s,g,f)){d=!0;continue e}if(d)return void(jfgrid.isEditMode()?alert("无法对多重选择区域执行此操作"):jfgrid.tooltip.info("无法对多重选择区域执行此操作",""))}if(1<jfgird_select_save.length){for(var c=!0,u=jfgird_select_save[0].row[0],m=jfgird_select_save[0].row[1],h=!0,j=jfgird_select_save[0].column[0],p=jfgird_select_save[0].column[1],t=1;t<jfgird_select_save.length;t++)jfgird_select_save[t].row[0]==u&&jfgird_select_save[t].row[1]==m||(c=!1),jfgird_select_save[t].column[0]==j&&jfgird_select_save[t].column[1]==p||(h=!1);if(!c&&!h||jfgrid.selectIsOverlap())return void(jfgrid.isEditMode()?alert("无法对多重选择区域执行此操作"):jfgrid.tooltip.info("无法对多重选择区域执行此操作",""))}jfgrid.selection.copy(e)}),$("#jfgrid-copy-paste, #jfgrid-cols-paste-btn, #jfgrid-paste-btn-title").click(function(e){jfgrid.selection.paste(e,"btn"),$(this).parent().hide()}),$("#jfgrid-chart-btn-title").click(function(){$("#jfgriddatavisual").click()}),$("#jfgrid-pivot-btn-title").click(function(e){jfgrid.pivotTable.createPivotTable(e)}),$("#jfgrid-selectall-btn-title").click(function(){$("#jfgrid-left-top").trigger("mousedown"),$(document).trigger("mouseup")}),$("#jfgrid-download-btn-title").click(function(){jfgrid.isEditMode()?alert("正在下载！"):jfgrid.tooltip.info("正在下载！","")}),$("#jfgrid-chart-btn-screenshot").click(function(){if(0!=jfgird_select_save.length)if(1<jfgird_select_save.length)jfgrid.isEditMode()?alert("无法对多重选择区域执行此操作"):jfgrid.tooltip.info("提示！","无法对多重选择区域执行此操作");else{if(null!=config.merge){for(var e=!1,r=0;r<jfgird_select_save.length;r++){var t=jfgird_select_save[r].row[0],i=jfgird_select_save[r].row[1],a=jfgird_select_save[r].column[0],n=jfgird_select_save[r].column[1];if(e=jfgrid.hasPartMC(config,t,i,a,n))break}if(e)return void(jfgrid.isEditMode()?alert("无法对合并单元格执行此操作"):jfgrid.tooltip.info("提示！","无法对合并单元格执行此操作"))}for(var o,l,d,f,s=jfgird_select_save[0].row[0],g=jfgird_select_save[0].row[1],c=jfgird_select_save[0].column[0],u=jfgird_select_save[0].column[1],m=jfgrid.datagridgrowth([],g+1,u+1),h=s;h<=g;h++)for(var j=c;j<=u;j++)m[h][j]=jfgrid.flowdata[h][j];l=s-1<0?(o=0,visibledatarow[g]):(o=visibledatarow[s-1],visibledatarow[g]-visibledatarow[s-1]),f=c-1<0?(d=0,visibledatacolumn[u]):(d=visibledatacolumn[c-1],visibledatacolumn[u]-visibledatacolumn[c-1]);var p=$("<canvas>").attr({width:Math.ceil(f*devicePixelRatio),height:Math.ceil(l*devicePixelRatio)}).css({width:f,height:l}),v=jfgrid.flowdata;jfgrid.flowdata=m,jfgridDrawMain(d,o,f,l,1,1,null,null,p),jfgrid.flowdata=v,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata);var b=new Image,_=p.get(0).toDataURL("image/png");b.src=_,l<f?b.style.width="100%":b.style.height="100%";var w=$(window).height()-200;jfgrid.tooltip.screenshot("截取成功！",'<div id="jfgrid-confirm-screenshot-save" style="height:'+w+'px;overflow:auto;"></div>',_),$("#jfgrid-confirm-screenshot-save").append(b),p.remove()}else jfgrid.isEditMode()?alert("请框选需要截图的范围"):jfgrid.tooltip.info("提示！","请框选需要截图的范围")}),$(document).on("click","a.download",function(){for(var e=$("#jfgrid-confirm-screenshot-save img").attr("src"),r=atob(e.split(",")[1]),t=r.length,i=new Uint8Array(t),a=0;a<t;a++)i[a]=r.charCodeAt(a);var n,o=new Blob([i]),l=document.createElement("a");l.setAttribute("href",URL.createObjectURL(o)),l.setAttribute("download","截图.png"),l.style.display="none",document.body.appendChild(l),l.click(),l.addEventListener("click",n=function(){requestAnimationFrame(function(){URL.revokeObjectURL(l.href)}),l.removeAttribute("href"),l.removeEventListener("click",n)}),document.body.removeChild(l)}),$("#jfgrid-share-btn-title").click(function(){for(var savedata=[],i=0;i<jfgridfile.length;i++){var charts=jfgridfile[i].chart;if(null!=charts)for(var c=0;c<charts.length;c++){var chart=charts[c],data=jfgrid.getdatabyselectionD(jfgridfile[i].data,{row:eval("("+chart.row+")"),column:eval("("+chart.column+")")});savedata.push([chart.defaultOption,chart.selfOption,chart.chartType,chart.chartStyle,chart.chartMarkConfig,chart.chartTitleConfig,data])}}jfgrid.tooltip.info("正在发布数据",'<div style="width:100%;text-align:center;position:relative;top:45%;font-size: 16px;"> <div class="jfgridLoaderGif"> </div><span>正在准备！请稍后</span></div>'),$.post("../Home/seth5js",{text:JSON.stringify(savedata)},function(e){"0"==e?jfgrid.isEditMode()?alert("发布数据失败, 请稍后再试！"):jfgrid.tooltip.info("发布数据失败","请稍后再试！"):jfgrid.tooltip.info("发布成功！请扫二维码",'<img src = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAgAElEQVR4nO3df2wk91038PfaPt8P3+R+5JJLd5IrKTTZhOOg5DZP9unzUFq3txS1OiOsCKEsaKEV4gTxI6qni2DFH4/8qM+W53kk949FKUhLZQRIWGAkquIjBtRSuWQDBfUaljbJNUl3Q5pr4rtJfD7bO8Mf9m721jO7M975fma+6/dLihTvrec7M9/5fjzf3wnHcRwQEWlgJOoTICLyiwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKQNBiwi0gYDFhFpgwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKQNBiwi0gYDFhFpgwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKSNMdUJnD17tu93rly5Eug4uVwOhUIhULpzc3OYnJz0/H61WkU+n2//vLS0BNM0e6ZRLpdRLpcBAIZhYGVlpef3Z2ZmsLy83P45nU6jUqn0/J1sNot6vd7+ud+9siwLmUym/XOlUkE6ne75O933ql8andft5/vdaVy6dAmXLl0KdE5B829lZQWGYfRMo/M6TNPE0tJSz+/n83lUq9X2z5OTk5ibm+v5O5lMBpZltX/ud6/q9Tqy2Wz7ZxX5VyqVMD8/7/v7bmm48XOug9LyDavzofHr2Wef7fnvnUEBAGq1Wt9jNhqN9v9blrXrGN26j9n5+278HLPbM8880zPNMOzl/g/6+/3yr/s6u++Dm877X6/Xbwss/b7vlmY3P8fs1n3MoPnvx6D5F6VYBKxsNuuZsZZl3fYXB9jO1M6/pt3cHqTOvyhuisXibT/PzMz0zNhSqYTFxcXbPpuenu6ZRvfD1+9hvHDhQt/z7FStVjEzM7PrPHtde+ebUkuvguh2X4Lmn9t59ku/X/6VSqW+59mpWCzuyj+3+90paP65PQ/d59nJ7b64nWenoPmXz+d3/XvQ/ItSLAJWvV73DED5fN71wfB6GGu1mmdh8Mp4r2M9+eSTnoXHrQB5vRFZluUZaIrFouvDYlmW6+eLi4uehffJJ590/dyrkCwuLro+8G4PdUtnlbZlL/nndhyg9x8jr/zz+twr/8rlsuvveN3zveSf19uV17PTOl83QfNvZmbGM//cnvW95F9UEo7jOCoT8FP37ZZKpQJVZdLpNBqNRqAbm06nA70aG4YR+PU+6HWkUikAwapxpmkGvu5areb7WkzTRDKZDHSvVOefYRhIpVKxzL+g1fhhyL8WiTasWAYsItIPG92JiDowYBGRNhiwiEgbytuwWroHQBKR/vwMuA2T2BvWwsJCuxeMiPSXSqWwsLAgmqbYG1ZLr15DP1MEiEhO3Mor27CISBviAYvVQiL9RVWOxQOWism4RCQrqnLMKiERaUMsYFmW1Xc1AyLSx/T0dOD5mYMSC1jT09OsDhINkVqtJv4SEosVR4lIT/V6vV3GOfmZiKgDAxYRaUN5wMrlchx7RTTEUqkUcrkcksmk8rTEpuZ07zjiJshQ/0QiMegpKeN1S4Oc86DZ4pWWqnMLkl7Qc1Nl0HMO415KC3qP+7VB+9n5KUzKG91bWhfFRnii4cC5hEREPYgHLNXdnkSkXlTlWDxg9ds8lIjiL6pyLNaG1aJy1VHpRltg8AbWoOfsN72gDcJBzkPVNUt2SoR1HmGkp4rKxv+oVg8WfcPi1Byi4RFFeRYLWL12ZCYi/fTaYVqVWG2kOug4rLhUCYNUNYa9ShiH4wYVh3schjCetyDll3MJiYg6MGARkTYYsIhIG8qHNczNzeHZZ5/F/Py86qR6kh5+4JeqrmfpuYRBzsPr94OcWxjnG8b8x0GFcdwo2m475XI5nD9/XmSRA9F9CRcXF1EsFj3/XWWju+TYoThPio1zwApyjCBUBay4BEKVnTy9Gt1nZ2cxNTUV6HiDEq0SSl8cEakTRXkWb8MyDEM6SSIaEtxIlYgCi2rys/hcwn6L+A2zMAZR+j2GdHuZysGSg7b9xKHtcNhEVY45rIGItCEasPbz2xXRsImiPCuvElarVdTr9Z7DGYhIP/l8HsD28AbTNJFKpZR3qu2byc9xGIcVhKo2rDhsQhEGle1SHIf1jrhNfhZvdKfbxaWgBylMgzZ4x2XxvahHiFNwbHQnIm0of8NaWlri4n1EQ2xubg6pVAqmaSpPS/kblmmamJycRKVS4Sh3oiFiGAYqlQomJydFghUgWCWU3iGWiNSSaGTvJtqGxWk5RMMjivIs3ktommYkWwTFoUcojC5sv71ucV/CJQhVQy7CSG9QcXgu9yKq5h3xXsKo9jMjovBYlhVJuhzWQETaEA1YUS+TTEThiaI8iwWsUqmEUqkklRwRKRZFmVbe6F4ul9FoNLC4uKg6KSISNj8/D8uykEwmcfHiReXjsUQClhQdF2rTcYMEye96UbkpiKpJyjo+n360XkbS6bTygMVGdyLShvKAxek4RMPPMAyRsq68SriysoJ6vY7p6enIxm4QkRqGYWBhYUFsLqHISHfTNNuBK5vNSiRJRIotLS2JBaoW0ak5YV6crlMauoWxMqh0Y3UQ0rvbxOG5iMM5SJAOVgAb3YlII9xIlYgCi6ociwesWq0mnSQRhSyqciwasNhLSDQ8oijPogGLcwmJhkcU5Vn5voQzMzOo1Wq+1sEKsi9hUHHYl1By2kgYC/gN856CQY/hRrpXM4peVD/7ErY2Uf30pz+t/9Sc5eVlLtpHNMTq9TqWl5fRaDSUp8VhDUSkDQYsItKG8pHu6XQajUaD1UKiIWWaJpLJpMjkZ+WN7p2KxWLPhfyCNLrHpSFV1dpJQdJzE8aUnyBU7poz6D1WtYOQyo4NldcXRK9G96mpKczOzipL241olbBQKEgmR0QKRVGeRQMW18YiGh5RlGfOJSSiwPbNXEJOzyGiveLOz0QUWFSTn0UX8FP9dhVGb4mqHiWvY0vvxhKX3W2GmXR+RNWjaFmWeDuWSMCyLAsXLlxgdZBoiGQyGRiGgcuXL4sFLuVVwmw2i0wmw2BFNIQsy0Imk0E2mxWpJioPWGyzIhp+9Xpd5KWEcwmJSBsMWESkDeWN7q35gf3mEarmdx5X0J6xQRdgCzqXbNB5btI9SqrSU3luqno2pedESpCeTyg2rGF2dhbJZBLlclkqSSJSqFAoIJfLiaYpuloD0Hv296CrNfS6FFVvWEGomq3vJoyll8MQ5zcIVfdCeqybSmGV17CwDYuItCEesLhiA5H+otimHhCemgOonZ4TtBolvdtMGFWCOOz+4/f3wzgHlecR5BiSDfFe5xDWscMQ1fhKVgmJSBtiAatarSKTyUglR0SKZTIZVKtV0TSVByzLsrC8vIx8Ps/5hERDxLIs5PN5LC8vi5Vt5cMa/Owc26JyEwq/pHdMVtWGFZfrcBP3NixV5xD3XZ7dBCm/lUoF6XR64DR7EW90D0sc1pYKeh6SAUB6958gQUjl/ZEMCmH8sYnLeCtdsNGdiLSh/A2rUqmgVquhVCqpToqIIlAoFJBKpUQ2phDZ+TmdTsMwDBSLRdXJkRC/VRmV44woetLzCbWdS+gmikIwaBtWHHZGDnKMsB+XzjTi3IalatBv3AeOxm0uobaN7iRL9UhvvnGRH+IBK51OKxtsFnS1hjCOHdeenyh2EAorre57Kj28QtXvq0ovyNppYeWp6uELXsR7CaPaz4yIwhNVOebOzxQ7juPE4i2VvEVVjkUDVpRLJJN+GLjiLYryLBawyuUyhzUQDZFisSi+5Lm2cwmDimuje1y6r3Uz7PdN1RCIoNfMuYQhicMk1718P+zf9xLntdT3aq95rmoieBhj3aS/qzvOJdzHdGsj0ulcSQ0GLNIKg9b+JraRaq1W4yJ+MaJzwXcchyPjY8AwDFQqFZFJzy1ib1ipVAqVSkUqOepB52DVMgzXoDvpYAUIN7qrvjjprdXDIL0y6DAVdL/XEue3sThMlN8r6WAFRNBLaJpmZFsEUfzYjoOXrQ389dVVvP72BlbXN3H84CjMiXGcu3sC504fxfgom1rjZt/sS5hMJhmw9rG/uHodf/L8KpZfXoXTtAEHMEaAT/34aXz43cdw7q4JTIyPRn2a1EcymYwkXfGAJb0tEL0jyurgtfUtPFV7E6V/fg0jdhMJx0HugZP42P3H8d+SR9G0Hbywuo6nr76J515/C6vrmxgFcPLQGN5/5jjO3WNgYlzbYYNDJ6pyzCeAlPufz7yGLzy/irVbWxizm/jJ5FH84oMn8dg9E/iH797Ab3/lJSw89z1sbNmA7cCxmxhxHIw4Nhzbwf9t2jgyCrz/zAnM//wjUV8ORUgsYM3MzGB5eVkqOeoi/Xb1J1dv4Hf++Xt45e0tHLSb+IUfOo5fTp3Ab3z5FXzllRv4h5dWMWY3AWcnSG3ZsB0bCcfBmN2EYzuwbQdwHBx0bPzS+TP4jQ+8V/QaqLezZ89icnISc3NzYmkqn0tYLpdRrVZ9vULGYV/CoKS3+dprz5hkwPrWjQ2c+8urgOMg4Tj4fOYefKVh4a9efBPrmzZG7O3/Rp3twOTYDuzmdjVxxHGQaG5/jp23rL/7lf+KB+86uufzUZUfKnt447IwpJ+5hK19Gy5evKi8MV7byc8MWP5/f9Asfu2WjW/e2MJz1hb+5j/W8craFlY3bKze2oTj2Gg6QMoYxZnDozh1cAR//OINbGw0cWp8BB++5zAWn38DiZ3gNdLcCVhwgFZg6qoG2ls2joyNYOqhu/GJR8/g4dPGQOfPgLV3nPxMsWdtOfj4167jxbeb2MB2QIHjoGnbWN+yAceB49jYbDbRtB3YjoN/uraBrzsORne+O9Zs4sbaFhafv4kRe7s3cMS2MWY3kdhpm2pVA4+OJfBL70visfuO47H7jsM4yMeS3PHJoLYN28EfvXILv3f1Jl67ZW8HK2f7L7tt29jYCUZwbMCx28EKO1W5VrBqVe1avYHG2AiOHxjBOBz8gHEYx8ZH8a6JcbzfvAM/dPIwzhw7xLFW5IvYXMJsNsvxVzE39TULtbe20ASwge3YhI5gZdvbb1ZwbGzaDh6/7wgevmMcZ46M4r4jo9hoOnh1bQtff30NX3ju9XY18NjYCL78+EM4xjenoWOaJpaWlsTSE9uX0LIs5PP5novX69iG5UblQmsq2jY+/52b+Oy317G5s9xMqxro7FQDb23ZGIWDx+89jM+fP+nrmI/86Tdx9frGTjVwC7mH78LvfvA9A53nXoWxf2AY4rqHZS+92rBa84MNY7A2xiDE3sMNw8DCwoJUcuTTX756C5/99jrsdrBCuxrYtG1sNB3cf2QEl3/ilO9gtWU77WA1Ym8PVfiRUxNKr4PkLSwsiAYrgG1Y+9oLbzVR/Lc12A46qoHb1bhWsHIcB3/7gbtx6qC/6TL/em0Nha9+tx2sRmDjA/fegZ97+C6l10L7g3jASqVS3JswJv73t9bw9hbQhPPO6qOtN62dYDUKx1ew+uqrb+GpK6/ji1dX4TjA2E6wGoWDP/xYio3qQyaKlRqACAIWg1V8LF/bhO042MRO24Ztt9+sbNtGwrHxgHF7sPr9b6/iu29t4sUbG/jSS9exsWVjxG62hy4chIPzdx3BUxfuR/LowWgujJSLqhyzSriPbQcrp90b2A5WO0MXHMfGv642b/udn7nvKL7+xjpOHxrFyTFgbbMJYyyBcycP473HD+LcqSMwuNoCKSIWsFq9hFEZtNdFeusuCZ3BCh3VwNZYq03bQdN28OmvX8Nv/fAJHB8fxalDY/hI8ig+EmB1kX/87ipeevMm0uYx3H/yiJJrad1zVbMJVPXwBhHGyPowTU9Pi/cSig1r8DMOS+WwBt0ClsSwhnu+9PptvYGOvT3Gyna2hzK0BoWO2k2M2tsj3A80bRw/kMBd4wnceWBku5G+6eDaW+tY39zC6voWbNtB7VfSOPt7X4PdbOIT70vi46m78ei9x/d0nn70ClhxeVakt14L41npNzVHehyW8jesIHORSNZtwWrnrcreebNqBauE806wSjhAwnFgrW/hrZsOvmPbGGluz/87lLAxPpLAe44dwrm7J3Di8AFc+dXHAAAnDh9wTf/VGzfx9L+/hofvuQOP3OdvyATFS71eb5dxziUkpZrN7RHsrWqg3VEN3A5QNkZ2qoyJnZ6/wwkb5Q+ewYPHD+HQaAITB0aQAGAcGL1tpdAX3ljD899fw8urN/HJ9H270m5cv4nH/v/TeHtjE0+cfzcDFvnCgLWPzaeP4/GV77ffrNa37Pab1qht31YNTOzMDdy0bXzy6asYaToYc7baE6O/8YlH8Jmvfgef/6c6Rh0bP376KH70tIH0vccAAOtbTTz78ps4f98JPPyZL6HZdPD3v/5BvOfU3peNof1HecC6dOmS7/WwgpBuq5Buwwjzu17n89F7DuGT9x/BUy/cwKb9TrUw4di7qoGticxwnHY18GPvOQHjwAiOHhjFnYcPYPaDP4hL5+/FCIB7jIOwHQcvfP9t/Nqf/wue/tb3cGNtA43/9TFUP/URHBwbxVEFcwsHXcIl6DFUCeN5kzrn1npYEuu8iwQsgCuORimRSHg+vP/n3HE0bm7iz15+ux2suquBrWCV6AhWI7DxBx994LZjXV/fxGvWOmrX1vAX33gVz/3Hdbzx9i0kbBuHRoGffug0AODOCY7PGhZDt+Jot16N8EF6Cd30+qskuYed9KRaP/xcf3LhBbxxc3NXNXDEtnHq4BgeOj6OxvU13FjfwvpmE81NG5l7DfzZ9I/A/Ozf4UAigdMTB/DAnRN44seSeOTeYzg1cRAvv7mGv//29/DFb9bxmx95GO+790To17eXvI9Dr10YVBZhleV1L9iGtU/0estqufLxH8DvfuP7+P1/fwMbW7dXA2cfS+LxB+8EsD25eaNpAwAOjW1PufnW//jvSCQSOHJgu+H9+vomvvriNXz5hWv4wjMvYqvpYHwsgffeFf6YHV3GvdHgxANWOp3mVl8xdfLgKD5z/m586uxJfPyLL6D2xhYSjoPRpoNff/pFPPUvDfzUu4/h+MEx3DE+ihEACThIAHhjbQOHRkfwE/efxLtPHMEj/28Za7e2AMfBhx84jY8+9C589OF3KWm3Inmqhy94EX96Go2GdJK0w89bFgCcOjSGlZ99sP2z7Ti4traJq9fXsfLKdby0ehOrNzexvrG5vfio4+DMHQfx3jsn2gHp+d/+KWXX0YlvV9GIqhyLB6ywVh2Nw6YAe0nTr0HbXcI8r5FEAndPjOPuiXH8l+QdoR03DCru/6DtnUHOSWXbmMq2rahWDxZd84MrNRANjyjKs1jAqtVqkU5+JqJw9VvyXAXOJSSiPbEsC9PT0+2fJeYSchlIItIGAxYRaWNfD4oJYz6i9KJsqo4xLCTnfAa973GYj6j7s6L8DWtubg65XE51MkQUkVwuh0qlIrIxhehcwsXFRRSLRc9/H3TF0TjP9/KicuzYfhTnNyxVVM6J7NVpNjs7i6mpqUDHG5RoG5b0xRGROlGUZ/FGd+mdYokofFGV40g2UlU1+TmKpWFUVQuiTi8u1Z0whJGnbt8NmkfS1XmVx943G6lypQY9dBauYQpeFI6oyjHHYVFfXBGB4kI0YC0uLkomRyFKJBIMXHSbKMqz8mEN1WoVtVoNpVKp73dVbqTqF9uw9iYu7TaqlgxSNVwi7svL+JkLXCgUkEqlkEqllDfGKw9YQSY/M2DFLz2/GLD2lt4wBKwWbqTaQ9CHatCeHy/SU3PiMKhx0GOHsR1bGOnFIfiHETTj8sdCAhvdiUgbygPWysqK6L5lRCRrbm4OKysrIhtTKA9YhmFgcnISlUqFo9yJhohhGKhUKpicnBQr22JVwnQ6jUqlIpUcESkm0cjeTbTRPczh/EEbFAdtgFTVo6SqAVplQ/OgPWYqz03V9Uk3gqucZhaWKKbniDe6m6YpnSQRhSyq5h3xgBXVfmZEFB7LsiJJl8MaiEgbogFrfn5eMjkiUqhcLounKdboXiwWOfmZaIiUy2U0Gg3Mzs6Kpak8YLUuKupgJTk/TCW/PU1x39EliDisEhGHxfe87oPKNd37aZXrZDKJixcvKu9UEwlYRDS8WkErnU4rD1hsdCcibSgPWBx3RTT8TNMUGZulvEq4tLQEy7Jw4cKFyMZuEJEahmHg8uXLYgNJRXoJDcPAysoKLMtCJpORSJKIFFtZWREf8S46l1CH1RrisuLooFT2rKmaHyg9f046T1X1VEclivLMRnci0oZ4wIpqA0YiCk9U5Vg8YNVqNekkiShkUZVj0YDFXkKi4RFFeRYNWH72JlSltRFo539+v9erYdTr+0GOMSi3tBzHCfSfmzC+G8a5+T2HIPdnL7sjqfhP5TmoFkV5Vr4vYT6fR6PR8LUO1qD7EgZdcVSa5LZSYWwfJrl6ZxjH9Tp2GKu6xuH5CUpqX0LTNJFMJtsbqqqkfFhDtVpVnQQRRaher6Ner4tUETmsgYi0wYBFRNpQXiWcnJxErVYLfS13Hdd7khzJLT3yvFdj/CDH9TqGyh12/J6fdFtcXJmmiVQqhWQyqTwt5Y3unfqtOhqk0V1HqgJWHBYiVDkFZ9BHNIztuIL8fhBxD1i9Gt2npqZEVxsFhKuEhUJBMjkiUiiK8iwasHSY/ExE/uyLyc+cS0ikv30zl5DTc4j0F1U5Fl0PCwhv5+c4jzwOo8csSIOwdM+fZAO9V3px2cUoyDkMmk9hXHNYjflR7eAu+obFbeqJhkcU5VkkYNXrdWQyGWSzWYnkiEhANptFJpMRDVzKq4SZTIbtVkRDyrKs9ovIwsKC8sZ45W9YDFZE+wMnPxMRdRDvJVQpiukM0r1Sg15jkJ4mVWtOSeeTdI+iynmOqtLThfI3rCtXruDKlSvI5XKqkyIiYblcrl3G0+m08vTEqoSFQoFzCYmGSBRlWrQNi29ZRMMjivLMRnci0oZ4o7thGJEMdZCeTjLoOcRhnSRVDb/SHRWq1sPS8TrCen5M0wzlOEFx8jMRBbYv5hISEQ1CLGBVq1VkMhmp5IhIsUwmI76Nn/KAVa/Xsby8jHw+z+og0RCxLAv5fB7Ly8tiVUTlm1D42Tm2Jc47P4fRsCm5a05QKhto/aQVlMq1oeKwplYc1k4DgpXfSqWifPDoUE3N0VFctpQfVFyCUJDjhvX9bmFMadJt0UIpbHQnIm0of8OqVCqo1+soFouqkyKiCMzOzrY3U1VNecBKp9Ptem2pVGLDO9GQMAwDhUIBU1NTYmmK7vwM9G7E24+N7nFpw5Lc3MJLXO7xoKSX5VG5tE9Y5TUsbHSPmPQOK0GEcW6DNjQHTU+VIPdYei2r/dQYL97oLrFmDhGpFVU5Fg9Y0iNjiSh8tVotknQ5rIGIAouq80w0YC0uLkomR0QKRVGexQJWuVzmWCyiIVIsFlEul0XT3DdzCVVRNRxg0J4fHeczeonDsAbpXYHiMgQmbnMJ2YZFRNpgwCIibTBgEZE2lI90b7VL1Wo1zMzMRLYWNBGFyzRNzM3NiUx6bhF7w0qlUpibm5NKjogUkw5WgPBcQtUXN4xzp/xQtTqllzjMXZTeMi2MOZGDnkPcnm/pYAVE0IYV1X5mRBSefbMvYTKZlE6SiEIWVTnm5GciCiyqcsxhDUSkDbFG93w+H2pUjsOibmFQtaOL9E4xYZBe+G5QKs8hDtfXz9mzZ5FOp1GpVMTSVD6XsFQqoVqt+lo/J4olV4nIm5+5hKlUCul0Gk888YTyxnjlb1jz8/OqkyCiCNVqNdRqNXzoQx9SHrDYhkVE2mDAIiJtiM0lzGaznEdINGRM08TS0pJYemJvWAsLC5EM5SciNVKpFBYWFkTT1HYjVSJSL27llW1YRKQN8YDFaiGR/qIqx+IBK6oNGIkoPNxIlYioD7FGd8uykM/n+YZFNCRSqRQqlQoMwxBLUyxgcRwW0fCRHocVq41UiUhf3EiViKgDAxYRaYMBi4i0EcuAFXRQWjqdDrQOj2EYgevae1nnJ+h1pFKpwOkE7aFJp9OBfsc0zcD3ivnn317yLwiJ/JMkui9hL14TKaenpz2HQrjNZeq1w/Ts7CympqZ2fV6tVpHP53d9bhgGKpXKrgycn59HqVRyPaelpSXXh7ZYLGJxcXHX51NTUygUCrseXMuykMlkXNO4dOkSLl26tOvzTCYDy7Jcf8ftXi0uLqJYLO763Ou6Ae9OlDDzL5/Pu16HV/4FvY5e+beysuKaF6VSKVD+1et1ZLNZ1zQKhQJyudyuz73yzzAMrKys7Prc67p77cgcZv5FIRZvWKZpeq4LXalUXAOA11+NXjtMuz3svY71uc99zjXTc7mc6wNnGIbnX9jZ2VnPz93+yhqG4fr51NSUa7BqnW+QtL2O5RWsAGBycnLXZ3vJP7fjAO+M7fE63yCf98o/t9/xuueGYQTOP9M0XT/3enZa5+umUCi4fu6Vf712ZHZ71veSf1GJRcBaWlryfDU2DGPXOI9eD3Xr37t5PSQt3Q/k3Nxcz1fpQqGw66Hvt9RGd8b3exAuX77c9zw7pdPpXcHa7Tw7uT3wvaoEbvclaP65nWe/9PvlX3eh7pd/bm9rbve7U9D8c3sevIIP4H5fvN4qW4Lmn9sfo6D5F6VYBKyg9jLW4/z58z3/vfvh81OP79xMstfbldcx+21G6eeY3R599NGeaYZh0LE2KvKv+zq774Obzvvv9Ubk9X23NLv5OWa37mOqeLtRPVZKJeUDR/1s7eXnBnYeJ5lM9s3I7nRTqVTPh8eyrNvq6n7OqV6vo9FoANgOLv0e4M7v+/2dWq12W7tG0HvV77q7v+8nje7r2C/5150Xfq5jGPPPi59zHZT4An5ERHulZZWQiPYnBiwi0gYDFhFpgwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKQNBiwi0gYDFhFpgwGLiLTBgEVE2mDAIiJtMGARkTYYsIhIGwxYRKQNBiwi0gYDFgsBXbcAAAAcSURBVBFpgwGLiLTBgEVE2mDAIiJtMGARkTb+E290dzfWDONJAAAAAElFTkSuQmCC" />')})}),$("#jfgrid-splitColumn-btn-title").click(function(){null!=jfgird_select_save&&0!=jfgird_select_save.length&&(1<jfgird_select_save.length?jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]?(jfgrid.splitColumn.createDialog(),jfgrid.splitColumn.init()):jfgrid.tooltip.info("一次只能转换一列数据，选定区域可以有多行，但不能有多列，请在选定单列区域以后再试",""))}),$("#jfgrid-freezen-btn-horizontal").click(function(){"取消冻结"==$.trim($(this).text())?(null!=jfgrid.freezen.freezenverticaldata&&(jfgrid.freezen.cancelFreezenVertical(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),null!=jfgrid.freezen.freezenhorizontaldata&&(jfgrid.freezen.cancelFreezenHorizontal(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),jfgrid.freezen.scrollAdapt()):(null!=jfgrid.freezen.freezenverticaldata&&(jfgrid.freezen.cancelFreezenVertical(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),null==jfgrid.freezen.freezenhorizontaldata&&(jfgrid.freezen.createFreezenHorizontal(),jfgrid.freezen.createAssistCanvas()))}),$("#jfgrid-freezen-btn-vertical").click(function(){null!=jfgrid.freezen.freezenverticaldata?(jfgrid.freezen.cancelFreezenVertical(),jfgrid.jfgridrefreshgrid()):jfgrid.freezen.createFreezenVertical(),jfgrid.freezen.createAssistCanvas()});var submenuhide=null,rightclickmenu=null;$(".jfgrid-cols-menu .jfgrid-cols-submenu").hover(function(){var e=$(this),r=e.attr("id"),t=$("#"+r+"_sub"),i=e.parent(),a=$(window).width(),n=$(window).height(),o=i.width(),l=t.height()+25,d=t.width()+5,f=e.offset(),s=f.top,g=f.left+o;a<g+d&&(g=f.left-d),n<s+l&&(s=n-l),t.css({top:s,left:g}).show(),rightclickmenu=e},function(){var e=$(this).attr("id"),r=$("#"+e+"_sub");submenuhide=setTimeout(function(){r.hide()},200)}),$(".jfgrid-rightgclick-menu-sub").hover(function(){rightclickmenu.addClass("jfgrid-cols-menuitem-hover"),clearTimeout(submenuhide)},function(){rightclickmenu.removeClass("jfgrid-cols-menuitem-hover"),$(this).hide()}),$(".jfgrid-grid-container, #jfgrid-rightclick-menu").on("contextmenu",function(e){e.preventDefault()}),$("#jfgrid-rightclick-menu input").on("keydown",function(e){e.stopPropagation()});var copychange=function(){(document.hidden||document.webkitHidden||document.msHidden)&&(iscopyself=!1)};$("#jfgrid-modal-dialog-mask").on("click dbclick mousedown mousemove mouseup",function(e){e.stopPropagation(),e.preventDefault()}),$(document).on("visibilitychange webkitvisibilitychange msvisibilitychange",copychange).mouseleave(function(){iscopyself=!1}).mousedown(function(e){jfgrid.postil.removeActivePs(),$(e.target).hasClass("jfgrid-mousedown-cancel")||0!=$(e.target).filter("[class*='sp-palette']").length||0!=$(e.target).filter("[class*='sp-thumb']").length||0!=$(e.target).filter("[class*='sp-']").length||($("#jfgrid-rightclick-menu").hide(),$("#jfgrid-cols-h-hover").hide(),$("#jfgrid-cols-menu-btn").hide(),$("#jfgrid-rightclick-menu").hide(),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu, #jfgrid-user-menu").hide(),$("body > .jfgrid-filter-menu, body > .jfgrid-filter-submenu, body > .jfgrid-cols-menu").hide(),jfgrid_cols_menu_status=!1),0<$(e.target).closest("#jfgrid-wa-editor").length&&0<parseInt($("#jfgrid-input-box").css("top"))&&(jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgridMoveHighlightCell("down",0,"rangeOfSelect"))}),$("#"+container).add("#jfgrid-input-box").keydown(function(e){var r,t,i,a,n,o,l,d,f,s,g,c,u,m,h,j,p;$("#jfgrid-modal-dialog-mask").is(":visible")||$(e.target).hasClass("jfgrid-mousedown-cancel")||$(e.target).hasClass("formulaInputFocus")||(r=e.ctrlKey,e.altKey,t=e.shiftKey,i=e.keyCode,a=$("#jfgrid-input-box"),i==keycode.ESC&&0<parseInt($("#jfgrid-input-box").css("top"))?(jfgrid.formula.dontupdate(),jfgridMoveHighlightCell("down",0,"rangeOfSelect"),e.preventDefault()):i==keycode.ENTER&&0<parseInt(a.css("top"))?$("#jfgrid-formula-search-c").is(":visible")&&null!=jfgrid.formula.searchFunctionCell&&(jfgrid.formula.searchFunctionEnter($("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item-active")),e.preventDefault()):i==keycode.TAB&&0<parseInt(a.css("top"))?($("#jfgrid-formula-search-c").is(":visible")&&null!=jfgrid.formula.searchFunctionCell?jfgrid.formula.searchFunctionEnter($("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item-active")):(jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgridMoveHighlightCell("right",1,"rangeOfSelect")),e.preventDefault()):i==keycode.F4&&0<parseInt(a.css("top"))?(jfgrid.formula.setfreezonFuc(e),e.preventDefault()):i==keycode.UP&&0<parseInt(a.css("top"))?$("#jfgrid-formula-search-c").is(":visible")?(0==(n=$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item-active").prev()).length&&(n=$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").last()),$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").removeClass("jfgrid-formula-search-item-active"),n.addClass("jfgrid-formula-search-item-active"),e.preventDefault()):r&&t?$("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightRange2("up","rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightRange2("up","rangeOfFormula")),e.preventDefault()):r?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightCell2("up","rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightCell2("up","rangeOfFormula"))),e.preventDefault()):t?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightRange("down",-1,"rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightRange("down",-1,"rangeOfFormula"))),e.preventDefault()):$("#jfgrid-formula-functionrange-select").is(":visible")?(jfgridMoveHighlightCell("down",-1,"rangeOfFormula"),e.preventDefault()):jfgrid.formula.israngeseleciton()?null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightCell("down",-1,"rangeOfFormula"),e.preventDefault()):(j=$(window.getSelection().anchorNode),p=window.getSelection().anchorOffset,(j.parent().is("span")&&0==j.parent().next().length&&0<p||j.is("#jfgrid-rich-text-editor")&&j.context.childElementCount==p||j.parent().is("#jfgrid-rich-text-editor")&&j.context.length==p)&&(jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgridMoveHighlightCell("down",-1,"rangeOfSelect"),e.preventDefault())):i==keycode.DOWN&&0<parseInt(a.css("top"))?$("#jfgrid-formula-search-c").is(":visible")?(0==(n=$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item-active").next()).length&&(n=$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").first()),$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").removeClass("jfgrid-formula-search-item-active"),n.addClass("jfgrid-formula-search-item-active"),e.preventDefault()):r&&t?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightRange2("down","rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightRange2("down","rangeOfFormula"))),e.preventDefault()):r?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightCell2("down","rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightCell2("down","rangeOfFormula"))),e.preventDefault()):t?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightRange("down",1,"rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightRange("down",1,"rangeOfFormula"))),e.preventDefault()):$("#jfgrid-formula-functionrange-select").is(":visible")?(jfgridMoveHighlightCell("down",1,"rangeOfFormula"),e.preventDefault()):jfgrid.formula.israngeseleciton()?null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightCell("down",1,"rangeOfFormula"),e.preventDefault()):(j=$(window.getSelection().anchorNode),p=window.getSelection().anchorOffset,(j.parent().is("span")&&0==j.parent().next().length&&0<p||j.is("#jfgrid-rich-text-editor")&&j.context.childElementCount==p||j.parent().is("#jfgrid-rich-text-editor")&&j.context.length==p)&&(jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgridMoveHighlightCell("down",1,"rangeOfSelect"),e.preventDefault())):i==keycode.LEFT&&0<parseInt(a.css("top"))?$("#jfgrid-formula-search-c").is(":visible")?e.preventDefault():r&&t?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightRange2("left","rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightRange2("left","rangeOfFormula"))),e.preventDefault()):r?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightCell2("left","rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightCell2("left","rangeOfFormula"))),e.preventDefault()):t?$("#jfgrid-formula-functionrange-select").is(":visible")?(jfgridMoveHighlightRange("right",-1,"rangeOfFormula"),e.preventDefault()):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightRange("right",-1,"rangeOfFormula"),e.preventDefault())):$("#jfgrid-formula-functionrange-select").is(":visible")?(jfgridMoveHighlightCell("right",-1,"rangeOfFormula"),e.preventDefault()):jfgrid.formula.israngeseleciton()?null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightCell("right",-1,"rangeOfFormula"),e.preventDefault()):(j=$(window.getSelection().anchorNode),p=window.getSelection().anchorOffset,(j.parent().is("span")&&0==j.parent().prev().length&&0==p||j.is("#jfgrid-rich-text-editor")&&1==p||j.parent().is("#jfgrid-rich-text-editor")&&0==p)&&(jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgridMoveHighlightCell("right",-1,"rangeOfSelect"),e.preventDefault())):i==keycode.RIGHT&&0<parseInt(a.css("top"))?$("#jfgrid-formula-search-c").is(":visible")?e.preventDefault():r&&t?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightRange2("right","rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightRange2("right","rangeOfFormula"))),e.preventDefault()):r?($("#jfgrid-formula-functionrange-select").is(":visible")?jfgridMoveHighlightCell2("right","rangeOfFormula"):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightCell2("right","rangeOfFormula"))),e.preventDefault()):t?$("#jfgrid-formula-functionrange-select").is(":visible")?(jfgridMoveHighlightRange("right",1,"rangeOfFormula"),e.preventDefault()):jfgrid.formula.israngeseleciton()&&(null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightRange("right",1,"rangeOfFormula"),e.preventDefault())):$("#jfgrid-formula-functionrange-select").is(":visible")?(jfgridMoveHighlightCell("right",1,"rangeOfFormula"),e.preventDefault()):jfgrid.formula.israngeseleciton()?null!=(j=$(window.getSelection().anchorNode)).parent().next().text()&&""!=j.parent().next().text()||(o=$("#jfgrid-input-box #jfgrid-input-box-index").text(),null==(l=jfgrid.formula.getcellrange(o))&&(l=jfgrid.formula.getcellrange($("#jfgrid-input-box-index").text())),d=l.row[0],f=l.row[1],s=l.column[0],g=l.column[1],c=visibledatarow[f],u=d-1==-1?0:visibledatarow[d-1],m=visibledatacolumn[g],h=s-1==-1?0:visibledatacolumn[s-1],jfgrid.formula.func_selectedrange={left:h,width:m-h-1,top:u,height:c-u-1,left_move:h,width_move:m-h-1,top_move:u,height_move:c-u-1,row:[d,f],column:[s,g],row_focus:d,column_focus:s},jfgrid.formula.rangeSetValue({row:[d,f],column:[s,g]}),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgridMoveHighlightCell("right",1,"rangeOfFormula"),e.preventDefault()):(j=$(window.getSelection().anchorNode),p=window.getSelection().anchorOffset,(j.parent().is("span")&&0==j.parent().next().length&&0<p||j.is("#jfgrid-rich-text-editor")&&j.context.childElementCount==p||j.parent().is("#jfgrid-rich-text-editor")&&j.context.length==p)&&(jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgridMoveHighlightCell("right",1,"rangeOfSelect"),e.preventDefault())):(!(112<=i&&i<=123||i<=46||144==i||108==i||e.ctrlKey||e.altKey||e.shiftKey&&(37==i||38==i||39==i||40==i))||8==i||32==i||46==i||e.ctrlKey&&86==i)&&jfgrid.formula.functionInputHanddler($("#jfgrid-functionbox-cell"),$("#jfgrid-rich-text-editor"),i))}).keyup(function(e){var r=e.keyCode;e.shiftKey||16!=r||(jfgrid_shiftkeydown=!1,jfgrid.jfgrid_shiftpositon=null),e.preventDefault()});var jfcountfunc=function(){if(0!=jfgird_select_save.length){for(var e=1/0,r=-1/0,t=0,i=0,a=0;a<jfgird_select_save.length;a++)for(var n=jfgrid.getdatabyselectionNoCopy(jfgird_select_save[a]),o=0;o<n.length;o++)for(var l,d=0;d<n[0].length;d++){jfgrid.func_methods.isRealNull(n[o][d])||(i++,null!=n[o][d].ct&&"d"==n[o][d].ct.t||(l=n[o][d].v,jfgrid.func_methods.isRealNum(l)&&(t+=l=parseFloat(l),l<e&&(e=l),r<l&&(r=l))))}var f="";f+="<span>计数:"+i+"</span>",(isFinite(r)||isFinite(e))&&(f+="<span>求和:"+jfgrid.mask.update("w",t)+"</span>",f+="<span>平均值:"+jfgrid.mask.update("w",Math.round(t/i*1e4)/1e4)+"</span>"),isFinite(r)&&(f+="<span>最大值:"+jfgrid.mask.update("w",r)+"</span>"),isFinite(e)&&(f+="<span>最小值:"+jfgrid.mask.update("w",e)+"</span>"),$("#jfgrid-sta-content").html(f)}};jfgrid.jfcountfunc=jfcountfunc,$(document).mousemove(function(L){if(jfgrid.postil.overshow(L),clearInterval(jfautoscrollTimeout),jfgrid.formula.functionResizeStatus){var e=(l=L.pageY)-jfgrid.formula.functionResizeData.y,r=jfgrid.formula.functionResizeData.calculatebarHeight+e,t=Math.round($(window).height()/2);if(r<=28){if(r<=20)return;r=28}else if(t<=r){if(t+8<=r)return;r=t}calculatebarHeight=r,$("#jfgrid-wa-calculate").css("height",calculatebarHeight-2),$("#jfgrid-wa-calculate-size").css({background:"#5e5e5e",cursor:"ns-resize"}),clearTimeout(jfgrid.formula.functionResizeTimeout),jfgrid.formula.functionResizeTimeout=setTimeout(function(){jfgrid.jfgridsizeauto()},15)}else if(jfgrid.freezen.horizontalmovestate){var i=mouseposition(L.pageX,L.pageY),a=$("#jfgrid-cell-main").scrollLeft(),n=$("#jfgrid-cell-main").scrollTop(),o=i[0]+a,l=i[1]+n,d=jfgrid.rowLocation(l),f=d[1],s=d[0],g=d[2];(b=i[1]+columeHeaderHeight)<columeHeaderHeight&&(b=columeHeaderHeight),b>jfgrid.freezen.windowHeight-4&&(b=jfgrid.freezen.windowHeight-4),$("#jfgrid-freezebar-horizontal").find(".jfgrid-freezebar-horizontal-handle").css({top:b}),s+(f-s)/2<=b+n-columeHeaderHeight?(b=f-2-n+columeHeaderHeight,jfgrid.freezen.freezenhorizontaldata=[f,g+1,n,jfgrid.freezen.cutVolumn(visibledatarow,g+1),b]):(b=s-2-n+columeHeaderHeight,jfgrid.freezen.freezenhorizontaldata=[s,g,n,jfgrid.freezen.cutVolumn(visibledatarow,g),b]),$("#jfgrid-freezebar-horizontal").find(".jfgrid-freezebar-horizontal-drop").css({top:b}),jfgrid.freezen.saveFreezen(jfgrid.freezen.freezenhorizontaldata,b,null,null)}else if(jfgrid.freezen.verticalmovestate){var i=mouseposition(L.pageX,L.pageY),a=$("#jfgrid-cell-main").scrollLeft(),n=$("#jfgrid-cell-main").scrollTop(),o=i[0]+a,l=i[1]+n,c=jfgrid.colLocation(o),u=c[1],m=c[0],h=c[2];(w=i[0]+rowHeaderWidth)<rowHeaderWidth&&(w=rowHeaderWidth),w>jfgrid.freezen.windowWidth-4&&(w=jfgrid.freezen.windowWidth-4),$("#jfgrid-freezebar-vertical").find(".jfgrid-freezebar-vertical-handle").css({left:w}),m+(u-m)/2<=w+a-rowHeaderWidth?(w=u-2-a+rowHeaderWidth,jfgrid.freezen.freezenverticaldata=[u,h+1,a,jfgrid.freezen.cutVolumn(visibledatacolumn,h+1),w]):(w=m-2-a+rowHeaderWidth,jfgrid.freezen.freezenverticaldata=[m,h,a,jfgrid.freezen.cutVolumn(visibledatacolumn,h),w]),$("#jfgrid-freezebar-vertical").find(".jfgrid-freezebar-vertical-drop").css({left:w}),jfgrid.freezen.saveFreezen(null,null,jfgrid.freezen.freezenverticaldata,w),jfgrid.jfgridsizeauto()}else if(jfgrid.pivotTable&&jfgrid.pivotTable.movestate){o=L.pageX,l=L.pageY;$("#jfgrid-modal-dialog-slider-pivot-move").css({left:o-jfgrid.pivotTable.movesave.width/2,top:l-jfgrid.pivotTable.movesave.height})}else if(jfgrid.chartparam.jfgrid_chart_point_config&&jfgrid.chartparam.jfgrid_chart_point_config.movestart){for(var o=L.pageX,l=L.pageY,j=jfgrid.chartparam.jfgrid_chart_point_config.container,p=o-j.offset().left+j.scrollLeft(),v=l-j.offset().top+j.scrollTop(),b=0,_=0,_=jfgrid.chartparam.jfgrid_chart_point_config.top>v||jfgrid.chartparam.jfgrid_chart_point_config.top==v?(b=v,jfgrid.chartparam.jfgrid_chart_point_config.top-v):(b=jfgrid.chartparam.jfgrid_chart_point_config.top,v-jfgrid.chartparam.jfgrid_chart_point_config.top-1),w=0,y=0,y=jfgrid.chartparam.jfgrid_chart_point_config.left>p||jfgrid.chartparam.jfgrid_chart_point_config.left==p?(w=p,jfgrid.chartparam.jfgrid_chart_point_config.left-p):(w=jfgrid.chartparam.jfgrid_chart_point_config.left,p-jfgrid.chartparam.jfgrid_chart_point_config.left-1),x=0;x<jfgrid.chartparam.jfgrid_chart_point_config.objectIndicator.length;x++){var C=jfgrid.chartparam.jfgrid_chart_point_config.objectIndicator[x];C.left+C.width+j.scrollLeft()<=w||C.top+C.height+j.scrollTop()<=b||C.left+j.scrollLeft()>=w+y||C.top+j.scrollTop()>=b+_?C.isselected||C.item.removeClass("jfgrid-chart-point-searchitem-active"):C.isselected?C.item.removeClass("jfgrid-chart-point-searchitem-active"):C.item.addClass("jfgrid-chart-point-searchitem-active")}$("#jfgrid-chart-point-selectedhelp").css({left:w,width:y,top:b,height:_})}else if(jfgird_sheet_move_status){a=$("#jfgrid-sheet-container-c").scrollLeft(),o=L.pageX+a;if(Math.abs(L.pageX-jfgird_sheet_move_data.pageX)<3)return;var T=$("#jfgrid-sheet-container").width(),w=o-jfgird_sheet_move_data.curleft-$("#jfgrid-sheet-container").offset().left;jfgird_sheet_move_data.activeobject.css({left:w});g=jfgrid_searcharray(jfgird_sheet_move_data.widthlist,w+jfgird_sheet_move_data.curleft);jfgird_sheet_move_data.cursorobject.css({cursor:"move"}),w-a<=6&&$("#jfgrid-sheets-leftscroll").click(),T-40<=w-a&&$("#jfgrid-sheets-rightscroll").click(),g!=jfgird_sheet_move_data.curindex&&(-1==g&&0<w?(g=jfgird_sheet_move_data.widthlist.length-1,$("#jfgrid-sheets-item-clone").insertAfter($("#jfgrid-sheet-area div.jfgrid-sheets-item:visible").eq(g))):-1==g&&w<=0?$("#jfgrid-sheets-item-clone").insertBefore($("#jfgrid-sheet-area div.jfgrid-sheets-item:visible").eq(0)):$("#jfgrid-sheets-item-clone").insertAfter($("#jfgrid-sheet-area div.jfgrid-sheets-item:visible").eq(g)),jfgird_sheet_move_data.widthlist=[],$("#jfgrid-sheet-area div.jfgrid-sheets-item:visible").each(function(e){0==e?jfgird_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):jfgird_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+jfgird_sheet_move_data.widthlist[e-1])}),jfgird_sheet_move_data.curindex=$("#jfgrid-sheet-area div.jfgrid-sheets-item:visible").index($("#jfgrid-sheets-item-clone")))}else{var I,R,k;jfgrid_model_move_state?(n=$(document).scrollTop(),a=$(document).scrollLeft(),l=L.pageY+n,o=L.pageX+a,I=$(window).height(),T=$(window).width(),R=jfgrid_model_move_obj.height(),k=jfgrid_model_move_obj.width(),(b=l-jfgrid_model_xy[1])<0&&(b=0),I<b+R+62&&(b=I-R-62),(w=o-jfgrid_model_xy[0])<0&&(w=0),T<w+k+86&&(w=T-k-86),jfgrid_model_move_obj.css({top:b,left:w}),L.preventDefault()):(jfgird_scroll_status||jfgird_select_status||jfgrid_rows_selected_status||jfgrid_cols_selected_status||jfgrid_cell_selected_move||jfgrid_cell_selected_move||jfgrid_cell_selected_extend||jfgrid_cols_change_size||jfgrid_rows_change_size||jfgrid.chartparam.jfgridCurrentChartMove||jfgrid.chartparam.jfgridCurrentChartResize||jfgrid.formula.rangeResize||jfgrid.formula.rangeMove)&&(jfgird_select_status&&(clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)),jfautoscrollTimeout=setInterval(function(){var e,r;if(!jfgird_scroll_status||jfgrid_cols_change_size||jfgrid_rows_change_size||(b=mouseposition(L.pageX,L.pageY),u=$("#jfgrid-scrollbar-x").scrollLeft(),s=$("#jfgrid-scrollbar-y").scrollTop(),t=b[0],i=b[1],y=$("#jfgrid-cell-main").height()-20,x=$("#jfgrid-cell-main").width()-60,(i<0||y<i)&&(e=i<0?s+i/2:s+(i-y)/2,$("#jfgrid-scrollbar-y").scrollTop(e)),(t<0||x<t)&&(r=t<0?u+t/2:u+(t-x)/2,$("#jfgrid-scrollbar-x").scrollLeft(r))),jfgird_select_status){var t=(b=mouseposition(L.pageX,L.pageY))[0]+$("#jfgrid-cell-main").scrollLeft(),i=b[1]+$("#jfgrid-cell-main").scrollTop(),a=(F=jfgrid.rowLocation(i))[1],n=F[0],o=F[2],l=(A=jfgrid.colLocation(t))[1],d=A[0],f=A[2],s=0,g=0,c=[];c=(v=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1])).top>n?(s=n,g=v.top+v.height-n,v.row[1]>v.row_focus&&(v.row[1]=v.row_focus),[o,v.row[1]]):v.top==n?(s=n,g=v.top+v.height-n,[o,v.row[0]]):(s=v.top,g=a-v.top-1,v.row[0]<v.row_focus&&(v.row[0]=v.row_focus),[v.row[0],o]);var u=0,m=0,h=[];h=v.left>d?(u=d,m=v.left+v.width-d,v.column[1]>v.column_focus&&(v.column[1]=v.column_focus),[f,v.column[1]]):v.left==d?(u=d,m=v.left+v.width-d,[f,v.column[0]]):(u=v.left,m=l-v.left-1,v.column[0]<v.column_focus&&(v.column[0]=v.column_focus),[v.column[0],f]),null!=(j=jfgrid.menuButton.mergeMoveMain(h,c,v,s,g,u,m))&&(h=j[0],c=j[1],s=j[2],g=j[3],u=j[4],m=j[5]),v.row=c,v.column=h,v.left_move=u,v.width_move=m,v.top_move=s,v.height_move=g,jfgird_select_save[jfgird_select_save.length-1]=v,jfgrid.selectHightlightShow(),jfgrid.freezen.scrollFreezen(),$("#jfgrid-helpbox-cell").text(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,jfgird_select_save[jfgird_select_save.length-1])),$("#jfgrid-alternateformat-rangeDialog").is(":visible")&&$("#jfgrid-alternateformat-rangeDialog input").val(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,jfgird_select_save[jfgird_select_save.length-1])),jfgrid.chartparam.jfgrid_chart_data_select_state&&$("#jfgrid-datavisual-range-selection-input").val(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"!"+jfgrid.jfgridchatatABC(jfgird_select_save[0].column[0])+(jfgird_select_save[0].row[0]+1)+":"+jfgrid.jfgridchatatABC(jfgird_select_save[0].column[1])+(jfgird_select_save[0].row[1]+1)),jfgrid.pivotTable.jfgrid_pivotTable_select_state&&$("#jfgrid-pivotTable-range-selection-input").val(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].name+"!"+jfgrid.jfgridchatatABC(jfgird_select_save[0].column[0])+(jfgird_select_save[0].row[0]+1)+":"+jfgrid.jfgridchatatABC(jfgird_select_save[0].column[1])+(jfgird_select_save[0].row[1]+1))}else if(jfgrid.conditionformat.selectStatus){var t=(b=mouseposition(L.pageX,L.pageY))[0]+$("#jfgrid-cell-main").scrollLeft(),i=b[1]+$("#jfgrid-cell-main").scrollTop(),a=(F=jfgrid.rowLocation(i))[1],n=F[0],o=F[2],l=(A=jfgrid.colLocation(t))[1],d=A[0],f=A[2],s=0,g=0,c=[];c=(v=jfgrid.conditionformat.selectRange[jfgrid.conditionformat.selectRange.length-1]).top>n?(s=n,g=v.top+v.height-n,v.row[1]>v.row_focus&&(v.row[1]=v.row_focus),[o,v.row[1]]):v.top==n?(s=n,g=v.top+v.height-n,[o,v.row[0]]):(s=v.top,g=a-v.top-1,v.row[0]<v.row_focus&&(v.row[0]=v.row_focus),[v.row[0],o]);var j,u=0,m=0,h=[];h=v.left>d?(u=d,m=v.left+v.width-d,v.column[1]>v.column_focus&&(v.column[1]=v.column_focus),[f,v.column[1]]):v.left==d?(u=d,m=v.left+v.width-d,[f,v.column[0]]):(u=v.left,m=l-v.left-1,v.column[0]<v.column_focus&&(v.column[0]=v.column_focus),[v.column[0],f]),null!=(j=jfgrid.menuButton.mergeMoveMain(h,c,v,s,g,u,m))&&(h=j[0],c=j[1],s=j[2],g=j[3],u=j[4],m=j[5]),v.row=c,v.column=h,v.left_move=u,v.width_move=m,v.top_move=s,v.height_move=g,jfgrid.conditionformat.selectRange[jfgrid.conditionformat.selectRange.length-1]=v,jfgrid.selectionCopyShow(jfgrid.conditionformat.selectRange);var p=jfgrid.conditionformat.getTxtByRange(jfgrid.conditionformat.selectRange);$("#jfgrid-multiRange-dialog input").val(p)}else if(jfgrid.formula.rangestart)jfgrid.formula.rangedrag(L);else if(jfgrid.formula.rangedrag_row_start)jfgrid.formula.rangedrag_row(L);else if(jfgrid.formula.rangedrag_column_start)jfgrid.formula.rangedrag_column(L);else if(jfgrid_rows_selected_status){if((i=(b=mouseposition(L.pageX,L.pageY))[1]+$("#jfgrid-rows-h").scrollTop())<0)return!1;a=(F=jfgrid.rowLocation(i))[1],n=F[0],o=F[2],f=visibledatacolumn.length-1,l=visibledatacolumn[f],d=0,s=0,g=0,c=[];c=(v=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1])).top>n?(s=n,g=v.top+v.height-n,v.row[1]>v.row_focus&&(v.row[1]=v.row_focus),[o,v.row[1]]):v.top==n?(s=n,g=v.top+v.height-n,[o,v.row[0]]):(s=v.top,g=a-v.top-1,v.row[0]<v.row_focus&&(v.row[0]=v.row_focus),[v.row[0],o]),v.row=c,v.top_move=s,v.height_move=g,jfgird_select_save[jfgird_select_save.length-1]=v,jfgrid.selectHightlightShow(),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)}else if(jfgrid_cols_selected_status){if((t=(b=mouseposition(L.pageX,L.pageY))[0]+$("#jfgrid-cols-h-c").scrollLeft())<0)return!1;var v,o=visibledatarow.length-1,a=visibledatarow[o],n=0,l=(A=jfgrid.colLocation(t))[1],d=A[0],f=A[2],u=0,m=0,h=[];h=(v=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1])).left>d?(u=d,m=v.left+v.width-d,v.column[1]>v.column_focus&&(v.column[1]=v.column_focus),[f,v.column[1]]):v.left==d?(u=d,m=v.left+v.width-d,[f,v.column[0]]):(u=v.left,m=l-v.left-1,v.column[0]<v.column_focus&&(v.column[0]=v.column_focus),[v.column[0],f]),v.column=h,v.left_move=u,v.width_move=m,jfgird_select_save[jfgird_select_save.length-1]=v,jfgrid.selectHightlightShow(),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)}else if(jfgrid_cell_selected_move){var b=mouseposition(L.pageX,L.pageY),_=$("#jfgrid-cell-main").scrollLeft(),w=$("#jfgrid-cell-main").scrollTop(),t=b[0]+_,i=b[1]+w,y=$(window).height()+w-sheetBarHeight-statisticBarHeight,x=$(window).width()+_,a=(F=jfgrid.rowLocation(i))[1],n=F[0],o=F[2],l=(A=jfgrid.colLocation(t))[1],d=A[0],f=A[2],C=jfgrid_cell_selected_move_index[0],T=jfgrid_cell_selected_move_index[1],I=jfgird_select_save[0].row[0]-C+o,R=jfgird_select_save[0].row[1]-C+o,k=jfgird_select_save[0].column[0]-T+f,S=jfgird_select_save[0].column[1]-T+f;(I<0||i<0)&&(R=jfgird_select_save[I=0].row[1]-jfgird_select_save[0].row[0]),(k<0||t<0)&&(S=jfgird_select_save[k=0].column[1]-jfgird_select_save[0].column[0]),(R>=visibledatarow[visibledatarow.length-1]||y<i)&&(I=visibledatarow.length-1-jfgird_select_save[0].row[1]+jfgird_select_save[0].row[0],R=visibledatarow.length-1),(S>=visibledatacolumn[visibledatacolumn.length-1]||x<t)&&(k=visibledatacolumn.length-1-jfgird_select_save[0].column[1]+jfgird_select_save[0].column[0],S=visibledatacolumn.length-1);d=k-1==-1?0:visibledatacolumn[k-1],l=visibledatacolumn[S],n=I-1==-1?0:visibledatarow[I-1],a=visibledatarow[R];$("#jfgrid-cell-selected-move").css({left:d,width:l-d-2,top:n,height:a-n-2,display:"block"})}else if(jfgrid_cell_selected_extend){b=mouseposition(L.pageX,L.pageY),_=$("#jfgrid-cell-main").scrollLeft()-5,w=$("#jfgrid-cell-main").scrollTop()-5,t=b[0]+_,i=b[1]+w,y=$(window).height()+w-sheetBarHeight-statisticBarHeight,x=$(window).width()+_,a=(F=jfgrid.rowLocation(i))[1],n=F[0],o=F[2],l=(A=jfgrid.colLocation(t))[1],d=A[0],f=A[2],C=jfgrid_cell_selected_extend_index[0],T=jfgrid_cell_selected_extend_index[1],I=jfgird_select_save[0].row[0],R=jfgird_select_save[0].row[1],k=jfgird_select_save[0].column[0],S=jfgird_select_save[0].column[1];(I<0||i<0)&&(R=jfgird_select_save[I=0].row[1]-jfgird_select_save[0].row[0]),(k<0||t<0)&&(S=jfgird_select_save[k=0].column[1]-jfgird_select_save[0].column[0]),(R>=visibledatarow[visibledatarow.length-1]||y<i)&&(I=visibledatarow.length-1-jfgird_select_save[0].row[1]+jfgird_select_save[0].row[0],R=visibledatarow.length-1),(S>=visibledatacolumn[visibledatacolumn.length-1]||x<t)&&(k=visibledatacolumn.length-1-jfgird_select_save[0].column[1]+jfgird_select_save[0].column[0],S=visibledatacolumn.length-1);s=jfgird_select_save[0].top_move,g=jfgird_select_save[0].height_move,u=jfgird_select_save[0].left_move,m=jfgird_select_save[0].width_move;Math.abs(C-o)>Math.abs(T-f)?I<=o&&o<=R||(g=jfgird_select_save[0].top_move>=n?(s=n,jfgird_select_save[0].top_move+jfgird_select_save[0].height_move-n):(s=jfgird_select_save[0].top_move,a-jfgird_select_save[0].top_move-1)):k<=f&&f<=S||(m=jfgird_select_save[0].left_move>=d?(u=d,jfgird_select_save[0].left_move+jfgird_select_save[0].width_move-d):(u=jfgird_select_save[0].left_move,l-jfgird_select_save[0].left_move-1)),$("#jfgrid-cell-selected-extend").css({left:u,width:m,top:s,height:g,display:"block"})}else if(jfgrid_cols_change_size){var A,b=mouseposition(L.pageX,L.pageY),_=$("#jfgrid-cols-h-c").scrollLeft(),t=b[0]+_,x=$(window).width(),o=visibledatarow.length-1,a=visibledatarow[o],n=0,l=(A=jfgrid.colLocation(t))[1],d=A[0],f=A[2];jfgridConfigsetting.pointEdit?30<(t+3)/jfgridConfigsetting.pointEditZoom-jfgrid_cols_change_size_start[0]&&t/jfgridConfigsetting.pointEditZoom<x+_-100&&($("#jfgrid-change-size-line").css({left:t/jfgridConfigsetting.pointEditZoom}),$("#jfgrid-cols-change-size").css({left:(t-2)/jfgridConfigsetting.pointEditZoom})):30<t+3-jfgrid_cols_change_size_start[0]&&t<x+_-100&&($("#jfgrid-change-size-line").css({left:t}),$("#jfgrid-cols-change-size").css({left:t-2}))}else if(jfgrid_rows_change_size){var F,b=mouseposition(L.pageX,L.pageY),w=$("#jfgrid-rows-h").scrollTop(),i=b[1]+w,y=$(window).height(),a=(F=jfgrid.rowLocation(i))[1],n=F[0],o=F[2];jfgridConfigsetting.pointEdit?19<(i+3)/jfgridConfigsetting.pointEditZoom-jfgrid_rows_change_size_start[0]&&i/jfgridConfigsetting.pointEditZoom<y+w-200&&($("#jfgrid-change-size-line").css({top:i/jfgridConfigsetting.pointEditZoom}),$("#jfgrid-rows-change-size").css({top:i/jfgridConfigsetting.pointEditZoom})):19<i+3-jfgrid_rows_change_size_start[0]&&i<y+w-200&&($("#jfgrid-change-size-line").css({top:i}),$("#jfgrid-rows-change-size").css({top:i}))}else if(jfgrid.chartparam.jfgridCurrentChartMove){var N,M,t=(b=mouseposition(L.pageX,L.pageY))[0]+$("#jfgrid-cell-main").scrollLeft(),i=b[1]+$("#jfgrid-cell-main").scrollTop(),E=jfgrid.chartparam.jfgridCurrentChartMoveObj.height(),O=jfgrid.chartparam.jfgridCurrentChartMoveObj.width(),s=i-jfgrid.chartparam.jfgridCurrentChartMoveXy[1],u=t-jfgrid.chartparam.jfgridCurrentChartMoveXy[0];s<0&&(s=0),s+E+42+6>jfgrid.chartparam.jfgridCurrentChartMoveWinH&&(s=jfgrid.chartparam.jfgridCurrentChartMoveWinH-E-42-6),u<0&&(u=0),u+O+22+36>jfgrid.chartparam.jfgridCurrentChartMoveWinW&&(u=jfgrid.chartparam.jfgridCurrentChartMoveWinW-O-22-36),jfgrid.chartparam.jfgridCurrentChartMoveObj.css({top:s,left:u}),null==jfgrid.freezen.freezenhorizontaldata&&null==jfgrid.freezen.freezenverticaldata||(jfgrid.freezen.scrollAdapt(),N=jfgrid.chartparam.jfgridCurrentChartMoveObj.offset(),M=jfgrid.chartparam.jfgridCurrentChartMoveObj.position(),jfgrid.chartparam.jfgridCurrentChartMoveXy=[L.pageX-N.left,L.pageY-N.top,M.left,M.top,$("#jfgrid-scrollbar-x").scrollLeft(),$("#jfgrid-scrollbar-y").scrollTop()])}else if(jfgrid.chartparam.jfgridCurrentChartResize){w=$("#jfgrid-cell-main").scrollTop(),_=$("#jfgrid-cell-main").scrollLeft(),t=(b=mouseposition(L.pageX,L.pageY))[0]+_,i=b[1]+w;if(t<0||i<0)return!1;var E=jfgrid.chartparam.jfgridCurrentChartResizeObj.height(),O=jfgrid.chartparam.jfgridCurrentChartResizeObj.width(),z=i-jfgrid.chartparam.jfgridCurrentChartResizeXy[1],D=t-jfgrid.chartparam.jfgridCurrentChartResizeXy[0],s=jfgrid.chartparam.jfgridCurrentChartResizeXy[5],g=jfgrid.chartparam.jfgridCurrentChartResizeXy[3],u=jfgrid.chartparam.jfgridCurrentChartResizeXy[4],m=jfgrid.chartparam.jfgridCurrentChartResizeXy[2];"lm"!=jfgrid.chartparam.jfgridCurrentChartResize&&"lt"!=jfgrid.chartparam.jfgridCurrentChartResize&&"lb"!=jfgrid.chartparam.jfgridCurrentChartResize||(u=t,m=jfgrid.chartparam.jfgridCurrentChartResizeXy[2]-D,u>jfgrid.chartparam.jfgridCurrentChartResizeXy[2]+jfgrid.chartparam.jfgridCurrentChartResizeXy[4]-60?(u=jfgrid.chartparam.jfgridCurrentChartResizeXy[2]+jfgrid.chartparam.jfgridCurrentChartResizeXy[4]-60,m=jfgrid.chartparam.jfgridCurrentChartResizeXy[2]-(jfgrid.chartparam.jfgridCurrentChartResizeXy[2]+jfgrid.chartparam.jfgridCurrentChartResizeXy[4]-60-jfgrid.chartparam.jfgridCurrentChartResizeXy[0])):u<=0&&(u=0,m=jfgrid.chartparam.jfgridCurrentChartResizeXy[2]+jfgrid.chartparam.jfgridCurrentChartResizeXy[0])),"rm"!=jfgrid.chartparam.jfgridCurrentChartResize&&"rt"!=jfgrid.chartparam.jfgridCurrentChartResize&&"rb"!=jfgrid.chartparam.jfgridCurrentChartResize||((m=jfgrid.chartparam.jfgridCurrentChartResizeXy[2]+D)<60?m=60:m>=jfgrid.chartparam.jfgridCurrentChartResizeWinW-jfgrid.chartparam.jfgridCurrentChartResizeXy[4]-22-36&&(m=jfgrid.chartparam.jfgridCurrentChartResizeWinW-jfgrid.chartparam.jfgridCurrentChartResizeXy[4]-22-36)),"mt"!=jfgrid.chartparam.jfgridCurrentChartResize&&"lt"!=jfgrid.chartparam.jfgridCurrentChartResize&&"rt"!=jfgrid.chartparam.jfgridCurrentChartResize||(s=i,g=jfgrid.chartparam.jfgridCurrentChartResizeXy[3]-z,s>jfgrid.chartparam.jfgridCurrentChartResizeXy[3]+jfgrid.chartparam.jfgridCurrentChartResizeXy[5]-60?(s=jfgrid.chartparam.jfgridCurrentChartResizeXy[3]+jfgrid.chartparam.jfgridCurrentChartResizeXy[5]-60,g=jfgrid.chartparam.jfgridCurrentChartResizeXy[3]-(jfgrid.chartparam.jfgridCurrentChartResizeXy[3]+jfgrid.chartparam.jfgridCurrentChartResizeXy[5]-60-jfgrid.chartparam.jfgridCurrentChartResizeXy[1])):s<=0&&(s=0,g=jfgrid.chartparam.jfgridCurrentChartResizeXy[3]+jfgrid.chartparam.jfgridCurrentChartResizeXy[1])),"mb"!=jfgrid.chartparam.jfgridCurrentChartResize&&"lb"!=jfgrid.chartparam.jfgridCurrentChartResize&&"rb"!=jfgrid.chartparam.jfgridCurrentChartResize||((g=jfgrid.chartparam.jfgridCurrentChartResizeXy[3]+z)<60?g=60:g>=jfgrid.chartparam.jfgridCurrentChartResizeWinH-jfgrid.chartparam.jfgridCurrentChartResizeXy[5]-42-6&&(g=jfgrid.chartparam.jfgridCurrentChartResizeWinH-jfgrid.chartparam.jfgridCurrentChartResizeXy[5]-42-6));var P={top:s,left:u,height:g,width:m};jfgrid.chartparam.jfgridCurrentChartResizeObj.css(P),window.generator&&generator.resize(jfgrid.chartparam.jfgridcurrentChart)}else if(jfgrid.postil.move){t=(b=mouseposition(L.pageX,L.pageY))[0]+$("#jfgrid-cell-main").scrollLeft(),i=b[1]+$("#jfgrid-cell-main").scrollTop(),E=jfgrid.postil.currentObj.outerHeight(),O=jfgrid.postil.currentObj.outerWidth(),s=i-jfgrid.postil.moveXY[1],u=t-jfgrid.postil.moveXY[0];s<0&&(s=0),s+E+42+6>jfgrid.postil.currentWinH&&(s=jfgrid.postil.currentWinH-E-42-6),u<0&&(u=0),u+O+22+36>jfgrid.postil.currentWinW&&(u=jfgrid.postil.currentWinW-O-22-36),jfgrid.postil.currentObj.css({left:u,top:s})}else if(jfgrid.postil.resize){t=(b=jfgrid.mouseposition(L.pageX,L.pageY))[0]+$("#jfgrid-cell-main").scrollLeft(),i=b[1]+$("#jfgrid-cell-main").scrollTop();if(t<0||i<0)return!1;z=i-jfgrid.postil.resizeXY[1],D=t-jfgrid.postil.resizeXY[0],s=jfgrid.postil.resizeXY[5],g=jfgrid.postil.resizeXY[3],u=jfgrid.postil.resizeXY[4],m=jfgrid.postil.resizeXY[2];"lm"!=jfgrid.postil.resize&&"lt"!=jfgrid.postil.resize&&"lb"!=jfgrid.postil.resize||(u=t,m=jfgrid.postil.resizeXY[2]-D,u>jfgrid.postil.resizeXY[2]+jfgrid.postil.resizeXY[4]-60?(u=jfgrid.postil.resizeXY[2]+jfgrid.postil.resizeXY[4]-60,m=jfgrid.postil.resizeXY[2]-(jfgrid.postil.resizeXY[2]+jfgrid.postil.resizeXY[4]-60-jfgrid.postil.resizeXY[0])):u<=0&&(u=0,m=jfgrid.postil.resizeXY[2]+jfgrid.postil.resizeXY[0])),"rm"!=jfgrid.postil.resize&&"rt"!=jfgrid.postil.resize&&"rb"!=jfgrid.postil.resize||((m=jfgrid.postil.resizeXY[2]+D)<60?m=60:m>=jfgrid.postil.currentWinW-jfgrid.postil.resizeXY[4]-22-36&&(m=jfgrid.postil.currentWinW-jfgrid.postil.resizeXY[4]-22-36)),"mt"!=jfgrid.postil.resize&&"lt"!=jfgrid.postil.resize&&"rt"!=jfgrid.postil.resize||(s=i,g=jfgrid.postil.resizeXY[3]-z,s>jfgrid.postil.resizeXY[3]+jfgrid.postil.resizeXY[5]-60?(s=jfgrid.postil.resizeXY[3]+jfgrid.postil.resizeXY[5]-60,g=jfgrid.postil.resizeXY[3]-(jfgrid.postil.resizeXY[3]+jfgrid.postil.resizeXY[5]-60-jfgrid.postil.resizeXY[1])):s<=0&&(s=0,g=jfgrid.postil.resizeXY[3]+jfgrid.postil.resizeXY[1])),"mb"!=jfgrid.postil.resize&&"lb"!=jfgrid.postil.resize&&"rb"!=jfgrid.postil.resize||((g=jfgrid.postil.resizeXY[3]+z)<60?g=60:g>=jfgrid.postil.currentWinH-jfgrid.postil.resizeXY[5]-42-6&&(g=jfgrid.postil.currentWinH-jfgrid.postil.resizeXY[5]-42-6)),jfgrid.postil.currentObj.css({width:m,height:g,left:u,top:s})}else jfgrid.formula.rangeResize?jfgrid.formula.rangeResizeDraging(L,jfgrid.formula.rangeResizeObj,jfgrid.formula.rangeResizexy,jfgrid.formula.rangeResize,jfgrid.formula.rangeResizeWinW,jfgrid.formula.rangeResizeWinH,ch_width,rh_height):jfgrid.formula.rangeMove?jfgrid.formula.rangeMoveDraging(L,jfgrid.formula.rangeMovexy,jfgrid.formula.rangeMoveObj.data("range"),jfgrid.formula.rangeMoveObj,sheetBarHeight,statisticBarHeight):jfgrid.chart_selection.rangeResize?jfgrid.chart_selection.rangeResizeDraging(L,sheetBarHeight,statisticBarHeight):jfgrid.chart_selection.rangeMove&&jfgrid.chart_selection.rangeMoveDraging(L,sheetBarHeight,statisticBarHeight)},1))}}),$(document).mouseup(function(e){var r,t,i,a,n,o,l,d,f,s,g,c,u,m,h,j,p;if(jfgird_select_status&&(clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},0),jfgrid.menuButton.jfgridPaintModelOn&&(jfgrid.selection.pasteHandlerOfPaintModel(jfgrid_copy_save),jfgrid.menuButton.jfgridPaintSingle&&jfgrid.menuButton.cancelPaintModel())),jfgird_select_status=!1,clearTimeout(jfautoscrollTimeout),jfgird_scroll_status=!1,$("#jfgrid-cell-selected").find(".jfgrid-cs-fillhandle").css("cursor","crosshair").end().find(".jfgrid-cs-draghandle").css("cursor","move"),$("#jfgrid-cell-main, #jfgridTableContent, #jfgrid-sheettable_0").css("cursor","default"),jfgrid_model_move_state=jfgrid_cols_selected_status=jfgrid_rows_selected_status=!1,jfgrid.formula.functionResizeStatus&&(jfgrid.formula.functionResizeStatus=!1,$("#jfgrid-wa-calculate-size").removeAttr("style")),jfgrid.freezen.horizontalmovestate&&(jfgrid.freezen.horizontalmovestate=!1,$("#jfgrid-freezebar-horizontal").removeClass("jfgrid-freezebar-active"),$("#jfgrid-freezebar-horizontal").find(".jfgrid-freezebar-horizontal-handle").css("cursor","-webkit-grab"),jfgrid.freezen.freezenhorizontaldata[4]<=columeHeaderHeight&&jfgrid.freezen.cancelFreezenHorizontal(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),jfgrid.freezen.verticalmovestate&&(jfgrid.freezen.verticalmovestate=!1,$("#jfgrid-freezebar-vertical").removeClass("jfgrid-freezebar-active"),$("#jfgrid-freezebar-vertical").find(".jfgrid-freezebar-vertical-handle").css("cursor","-webkit-grab"),jfgrid.freezen.freezenverticaldata[4]<=rowHeaderWidth&&jfgrid.freezen.cancelFreezenVertical(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),jfgrid.pivotTable&&jfgrid.pivotTable.movestate&&($("#jfgrid-modal-dialog-slider-pivot-move").remove(),jfgrid.pivotTable.movestate=!1,$("#jfgrid-modal-dialog-pivotTable-list, #jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column, #jfgrid-modal-dialog-config-value").css("cursor","default"),"jfgrid-modal-dialog-pivotTable-list"!=jfgrid.pivotTable.movesave.containerid&&0==$(e.target).closest(".jfgrid-modal-dialog-slider-config-list").length&&("jfgrid-modal-dialog-config-value"==jfgrid.pivotTable.movesave.containerid&&jfgrid.pivotTable.resetOrderby(jfgrid.pivotTable.movesave.obj),jfgrid.pivotTable.movesave.obj.remove(),jfgrid.pivotTable.showvaluecolrow(),$("#jfgrid-modal-dialog-pivotTable-list").find(".jfgrid-modal-dialog-slider-list-item").each(function(){$(this).find(".jfgrid-slider-list-item-selected").find("i").remove()}),$("#jfgrid-modal-dialog-config-filter, #jfgrid-modal-dialog-config-row, #jfgrid-modal-dialog-config-column, #jfgrid-modal-dialog-config-value").find(".jfgrid-modal-dialog-slider-config-item").each(function(){var r=$(this).data("index");$("#jfgrid-modal-dialog-pivotTable-list").find(".jfgrid-modal-dialog-slider-list-item").each(function(){var e=$(this).find(".jfgrid-slider-list-item-selected");$(this).data("index")==r&&0==e.find("i").length&&e.append('<i class="fa fa-check jfgrid-mousedown-cancel"></i>')})}),jfgrid.pivotTable.refreshPivotTable())),jfgrid.chartparam.jfgrid_chart_point_config&&jfgrid.chartparam.jfgrid_chart_point_config.movestart&&(clearTimeout(jfgrid.chartparam.jfgrid_chart_point_config.lagTimeoutclick),jfgrid.chartparam.jfgrid_chart_point_config.mouseupdone=!0,jfgrid.chartparam.jfgrid_chart_point_config.movestart=!1,$("#jfgrid-chart-point-selectedhelp").hide(),jfgrid.chartparam.jfgrid_chart_point_config.objectIndicator=[],jfgrid.chartparam.jfgrid_chart_point_config.changeindex=[],t=!(r=null),i=jfgrid.chartparam.jfgrid_chart_point_config.pointchart.getOption(),$("#jfgrid-chart-point-config .jfgrid-chart-point-searchitem-c").find(".jfgrid-chart-point-searchitem-active").each(function(){jfgrid.chartparam.jfgrid_chart_point_config.changeindex.push($(this).data("index"));var e=i.series[0].data[$(this).data("index")];!t||e instanceof Array||(t=!1,r=e)}),jfgrid.jfgridactivepointconfig(i,r)),jfgird_sheet_move_status&&(jfgird_sheet_move_status=!1,jfgird_sheet_move_data.activeobject.insertBefore($("#jfgrid-sheets-item-clone")),jfgird_sheet_move_data.activeobject.removeAttr("style"),$("#jfgrid-sheets-item-clone").remove(),jfgird_sheet_move_data.cursorobject.css({cursor:"pointer"}),jfgird_sheet_move_data={},jfgrid.sheetmanage.reOrderAllSheet()),clearTimeout(jfgrid.chartparam.jfgridCurrentChartMoveTimeout),jfgrid.chartparam.jfgridCurrentChartMove&&(jfgrid.chartparam.jfgridCurrentChartMove=!1,jfgrid.chartparam.jfgridInsertChartTosheetChange&&(o=jfgrid.chartparam.jfgridCurrentChartMoveObj.css("top"),l=jfgrid.chartparam.jfgridCurrentChartMoveObj.css("left"),_=$("#jfgrid-cell-main").scrollLeft(),k=$("#jfgrid-cell-main").scrollTop(),w=jfgrid.chartparam.jfgridCurrentChartMoveXy[2],S=jfgrid.chartparam.jfgridCurrentChartMoveXy[3],c=jfgrid.chartparam.jfgridCurrentChartMoveXy[4],u=jfgrid.chartparam.jfgridCurrentChartMoveXy[5],d=jfgrid.chartparam.jfgridCurrentChartMoveObj.find(".jfgrid-modal-dialog-content").attr("id"),f=!!window.store&&store.state.chartSetting.chartList[d].sheetIndex,jfgrid.jfredo.push({type:"moveChart",chart_id:d,sheetIndex:f,myTop:o,myLeft:l,scrollTop:k,scrollLeft:_,x:w,y:S,scrollTop1:u,scrollLeft1:c}),window.store&&store.commit({type:"updateChartItem",key:"left",value:l,chartId:d}),window.store&&store.commit({type:"updateChartItem",key:"top",value:o,chartId:d}),jfgrid.server.saveParam("c",f,{left:l,top:o,scrollTop:k,scrollLeft:_},{op:"xy",cid:d}))),jfgrid.formula.rangeResize&&jfgrid.formula.rangeResizeDragged(e,jfgrid.formula.rangeResizeObj,jfgrid.formula.rangeResize,jfgrid.formula.rangeResizexy,jfgrid.formula.rangeResizeWinW,jfgrid.formula.rangeResizeWinH),jfgrid.chartparam.jfgridCurrentChartResize&&(jfgrid.chartparam.jfgridCurrentChartResize=null,jfgrid.chartparam.jfgridInsertChartTosheetChange&&(a=jfgrid.chartparam.jfgridCurrentChartResizeObj.height(),n=jfgrid.chartparam.jfgridCurrentChartResizeObj.width(),_=$("#jfgrid-cell-main").scrollLeft(),k=$("#jfgrid-cell-main").scrollTop(),o=jfgrid.chartparam.jfgridCurrentChartMoveObj.css("top"),l=jfgrid.chartparam.jfgridCurrentChartMoveObj.css("left"),d=jfgrid.chartparam.jfgridCurrentChartResizeObj.find(".jfgrid-modal-dialog-content").attr("id"),f=!!window.store&&store.state.chartSetting.chartList[d].sheetIndex,s=jfgrid.chartparam.jfgridCurrentChartResizeXy[2],g=jfgrid.chartparam.jfgridCurrentChartResizeXy[3],w=jfgrid.chartparam.jfgridCurrentChartResizeXy[4],S=jfgrid.chartparam.jfgridCurrentChartResizeXy[5],c=jfgrid.chartparam.jfgridCurrentChartResizeXy[6],u=jfgrid.chartparam.jfgridCurrentChartResizeXy[7],jfgrid.jfredo.push({type:"resizeChart",chart_id:d,sheetIndex:f,myTop:o,myLeft:l,myHeight:a,myWidth:n,scrollTop:k,scrollLeft:_,x:w,y:S,myWidth1:s,myHeight1:g,scrollTop1:u,scrollLeft1:c}),window.store&&store.commit({type:"updateChartItem",key:"height",value:a,chartId:d}),window.store&&store.commit({type:"updateChartItem",key:"width",value:n,chartId:d}),window.store&&store.commit({type:"updateChartItem",key:"left",value:l,chartId:d}),window.store&&store.commit({type:"updateChartItem",key:"top",value:o,chartId:d}),jfgrid.server.saveParam("c",f,{width:n,height:a,top:o,left:l,scrollTop:k,scrollLeft:_},{op:"wh",cid:d}))),jfgrid.postil.move&&(jfgrid.postil.move=!1,h=(m=jfgrid.postil.currentObj.closest(".jfgrid-postil-show").attr("id")).split("jfgrid-postil-show_")[1].split("_")[0],j=m.split("jfgrid-postil-show_")[1].split("_")[1],p=[],(E=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata))[h][j].ps.left=jfgrid.postil.currentObj.position().left,E[h][j].ps.top=jfgrid.postil.currentObj.position().top,E[h][j].ps.value=jfgrid.postil.currentObj.find(".formulaInputFocus").text(),p.push(h+"_"+j),jfgrid.postil.ref(E,p),$("#"+m).remove(),E[h][j].ps.isshow?(jfgrid.postil.buildPs(h,j,E[h][j].ps),$("#"+m).addClass("jfgrid-postil-show-active"),$("#"+m).find(".jfgrid-postil-dialog-resize").show()):jfgrid.postil.editPs(h,j)),jfgrid.postil.resize&&(jfgrid.postil.resize=null,h=(m=jfgrid.postil.currentObj.closest(".jfgrid-postil-show").attr("id")).split("jfgrid-postil-show_")[1].split("_")[0],j=m.split("jfgrid-postil-show_")[1].split("_")[1],p=[],(E=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata))[h][j].ps.left=jfgrid.postil.currentObj.position().left,E[h][j].ps.top=jfgrid.postil.currentObj.position().top,E[h][j].ps.width=jfgrid.postil.currentObj.outerWidth(),E[h][j].ps.height=jfgrid.postil.currentObj.outerHeight(),E[h][j].ps.value=jfgrid.postil.currentObj.find(".formulaInputFocus").text(),p.push(h+"_"+j),jfgrid.postil.ref(E,p),$("#"+m).remove(),E[h][j].ps.isshow?(jfgrid.postil.buildPs(h,j,E[h][j].ps),$("#"+m).addClass("jfgrid-postil-show-active"),$("#"+m).find(".jfgrid-postil-dialog-resize").show()):jfgrid.postil.editPs(h,j)),jfgrid_rows_change_size&&(jfgrid_rows_change_size=!1,$("#jfgrid-change-size-line").hide(),$("#jfgrid-rows-change-size").css("opacity",0),$("#jfgrid-sheettable, #jfgrid-rows-h, #jfgrid-rows-h canvas").css("cursor","default"),b=mouseposition(e.pageX,e.pageY),k=$("#jfgrid-rows-h").scrollTop(),S=b[1]+k,A=$(window).height(),(ge=jfgrid.rowLocation(S))[1],C=ge[0],x=ge[2],jfgridConfigsetting.pointEdit?(v=(S+3)/jfgridConfigsetting.pointEditZoom-jfgrid_rows_change_size_start[0],(S+3)/jfgridConfigsetting.pointEditZoom-jfgrid_rows_change_size_start[0]<19&&(v=19),S/jfgridConfigsetting.pointEditZoom>=A-200+k&&(v=y-200-jfgrid_rows_change_size_start[0]+k)):(v=S+3-jfgrid_rows_change_size_start[0],S+3-jfgrid_rows_change_size_start[0]<19&&(v=19),A-200+k<=S&&(v=y-200-jfgrid_rows_change_size_start[0]+k)),null==(M=$.extend(!0,{},config)).rowlen&&(M.rowlen={}),M.rowlen[jfgrid_rows_change_size_start[1]]=Math.ceil(v),clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:"resize",ctrlType:"resizeR",config:$.extend(!0,{},config),curconfig:$.extend(!0,{},M),sheetIndex:jfgrid.currentSheetIndex})),config=M,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,M.rowlen,{k:"rowlen"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,null)),jfgrid_cols_change_size){jfgrid_cols_change_size=!1,$("#jfgrid-change-size-line").hide(),$("#jfgrid-cols-change-size").css("opacity",0),$("#jfgrid-sheettable, #jfgrid-cols-h-c, .jfgrid-cols-h-cells, .jfgrid-cols-h-cells canvas").css("cursor","default");var v,b=mouseposition(e.pageX,e.pageY),_=$("#jfgrid-cols-h-c").scrollLeft(),w=b[0]+_,y=$(window).width(),x=visibledatarow.length-1,C=(visibledatarow[x],0),T=((ce=jfgrid.colLocation(w))[1],ce[0]),I=ce[2];v=jfgridConfigsetting.pointEdit?(w+3)/jfgridConfigsetting.pointEditZoom-jfgrid_cols_change_size_start[0]:w+3-jfgrid_cols_change_size_start[0];var R=defaultcollen;if(null!=config.columlen&&null!=config.columlen[jfgrid_cols_change_size_start[1]]&&(R=config.columlen[jfgrid_cols_change_size_start[1]]),Math.abs(v-R)<3)return;jfgridConfigsetting.pointEdit?((w+3)/jfgridConfigsetting.pointEditZoom-jfgrid_cols_change_size_start[0]<30&&(v=30),w/jfgridConfigsetting.pointEditZoom>=y-100+_&&(v=y-100-jfgrid_cols_change_size_start[0]+_)):(w+3-jfgrid_cols_change_size_start[0]<30&&(v=30),y-100+_<=w&&(v=y-100-jfgrid_cols_change_size_start[0]+_)),null==(M=$.extend(!0,{},config)).columlen&&(M.columlen={}),M.columlen[jfgrid_cols_change_size_start[1]]=Math.ceil(v),clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:"resize",ctrlType:"resizeC",config:$.extend(!0,{},config),curconfig:$.extend(!0,{},M),sheetIndex:jfgrid.currentSheetIndex})),config=M,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,M.columlen,{k:"columlen"}),jfgrid.jfrefreshgrid_rhcw(null,jfgrid.flowdata[0].length),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1)}if(jfgrid.formula.rangeMove&&jfgrid.formula.rangeMoveDragged(jfgrid.formula.rangeMoveObj),jfgrid_cell_selected_move){$("#jfgrid-cell-selected-move").hide(),jfgrid_cell_selected_move=!1;var b=mouseposition(e.pageX,e.pageY),_=$("#jfgrid-cell-main").scrollLeft(),k=$("#jfgrid-cell-main").scrollTop(),w=b[0]+_,S=b[1]+k,A=$(window).height()+k-sheetBarHeight-statisticBarHeight,y=$(window).width()+_,x=(ge=jfgrid.rowLocation(S))[2],I=(ce=jfgrid.colLocation(w))[2],F=jfgrid_cell_selected_move_index[0],N=jfgrid_cell_selected_move_index[1];if(x==F&&I==N)return;var M,E=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),O=jfgird_select_save[jfgird_select_save.length-1],z=jfgrid.getdatabyselection(O);if(null==(M=$.extend(!0,{},config)).merge&&(M.merge={}),null==M.rowlen&&(M.rowlen={}),jfgrid.hasPartMC(M,O.row[0],O.row[1],O.column[0],O.column[1]))return void(jfgrid.isEditMode()?alert("无法对合并单元格执行此操作"):jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"无法对合并单元格执行此操作"));var D=O.row[0]-F+x,P=O.row[1]-F+x,L=O.column[0]-N+I,B=O.column[1]-N+I;if((D<0||S<0)&&(D=0,P=O.row[1]-O.row[0]),(L<0||w<0)&&(L=0,B=O.column[1]-O.column[0]),(P>=visibledatarow[visibledatarow.length-1]||A<S)&&(D=visibledatarow.length-1-O.row[1]+O.row[0],P=visibledatarow.length-1),(B>=visibledatacolumn[visibledatacolumn.length-1]||y<w)&&(L=visibledatacolumn.length-1-O.column[1]+O.column[0],B=visibledatacolumn.length-1),jfgrid.hasPartMC(M,D,P,L,B))return void(jfgrid.isEditMode()?alert("无法对合并单元格执行此操作"):jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"无法对合并单元格执行此操作"));for(var q=jfgrid.getBorderInfoCompute(jfgrid.currentSheetIndex),H=null,V=O.row[0];V<=O.row[1];V++){V in M.rowlen&&(H=!0);for(var U=O.column[0];U<=O.column[1];U++){var Y=E[V][U];"object"==jfgrid.getObjType(Y)&&"mc"in Y&&Y.mc.r+"_"+Y.mc.c in M.merge&&delete M.merge[Y.mc.r+"_"+Y.mc.c],E[V][U]=null}}if(M.borderInfo&&0<M.borderInfo.length){for(var W=[],G=0;G<M.borderInfo.length;G++){var X,Z,K=M.borderInfo[G].rangeType;if("range"==K){for(var J=M.borderInfo[G].range,Q=[],ee=0;ee<J.length;ee++)Q=Q.concat(jfgrid.conditionformat.CFSplitRange(J[ee],{row:O.row,column:O.column},{row:[D,P],column:[L,B]},"restPart"));M.borderInfo[G].range=Q,W.push(M.borderInfo[G])}else{"cell"==K&&(X=M.borderInfo[G].value.row_index,Z=M.borderInfo[G].value.col_index,X>=O.row[0]&&X<=O.row[1]&&Z>=O.column[0]&&Z<=O.column[1]||W.push(M.borderInfo[G]))}}M.borderInfo=W}for(var re={},V=0;V<z.length;V++)for(var te,U=0;U<z[0].length;U++){q[V+O.row[0]+"_"+(U+O.column[0])]&&(te={rangeType:"cell",value:{row_index:V+D,col_index:U+L,l:q[V+O.row[0]+"_"+(U+O.column[0])].l,r:q[V+O.row[0]+"_"+(U+O.column[0])].r,t:q[V+O.row[0]+"_"+(U+O.column[0])].t,b:q[V+O.row[0]+"_"+(U+O.column[0])].b}},null==M.borderInfo&&(M.borderInfo=[]),M.borderInfo.push(te));var ie,ae="";null!=z[V]&&null!=z[V][U]&&(ae=z[V][U]),"object"==jfgrid.getObjType(ae)&&"mc"in ae&&(ie=$.extend(!0,{},ae.mc),"rs"in ae.mc?(re[ie.r+"_"+ie.c]=[V+D,U+L],ae.mc.r=V+D,ae.mc.c=U+L,M.merge[V+D+"_"+(U+L)]=ae.mc):(ae.mc.r=re[ie.r+"_"+ie.c][0],ae.mc.c=re[ie.r+"_"+ie.c][1])),E[V+D][U+L]=ae}H&&(M=jfgrid.rowlenByRange(E,O.row[0],O.row[1],M),M=jfgrid.rowlenByRange(E,D,P,M));var ne,oe,le=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save);if(null!=le&&0<le.length)for(G=0;G<le.length;G++){for(var de=le[G].cellrange,fe=[],ee=0;ee<de.length;ee++)var se=jfgrid.conditionformat.CFSplitRange(de[ee],{row:O.row,column:O.column},{row:[D,P],column:[L,B]},"allPart"),fe=fe.concat(se);le[G].cellrange=fe}ne=jfgird_select_save[0].row_focus==jfgird_select_save[0].row[0]?D:P,oe=jfgird_select_save[0].column_focus==jfgird_select_save[0].column[0]?L:B,(se=[]).push({row:O.row,column:O.column}),se.push({row:[D,P],column:[L,B]}),O.row=[D,P],O.column=[L,B],O.row_focus=ne,O.column_focus=oe,jfgrid.jfrefreshgrid(E,se,M,le,H),jfgrid.selectHightlightShow(),$("#jfgrid-sheettable").css("cursor","default"),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)}if(jfgrid.chart_selection.rangeMove&&jfgrid.chart_selection.rangeMoveDragged(),jfgrid.chart_selection.rangeResize&&jfgrid.chart_selection.rangeResizeDragged(),jfgrid_cell_selected_extend){jfgrid_cell_selected_extend=!1,$("#jfgrid-cell-selected-extend").hide();var ge,ce,b=mouseposition(e.pageX,e.pageY),_=$("#jfgrid-cell-main").scrollLeft(),k=$("#jfgrid-cell-main").scrollTop(),w=b[0]+_-5,S=b[1]+k-5,A=$(window).height()+k-sheetBarHeight-statisticBarHeight,y=$(window).width()+_,C=((ge=jfgrid.rowLocation(S))[1],ge[0]),x=ge[2],T=((ce=jfgrid.colLocation(w))[1],ce[0]),I=ce[2],F=jfgrid_cell_selected_extend_index[0],N=jfgrid_cell_selected_extend_index[1],D=(O=jfgird_select_save[jfgird_select_save.length-1]).row[0],P=O.row[1],L=O.column[0],B=O.column[1];(D<0||S<0)&&(D=0,P=O.row[1]-O.row[0]),(L<0||w<0)&&(L=0,B=O.column[1]-O.column[0]),(P>=visibledatarow[visibledatarow.length-1]||A<S)&&(D=visibledatarow.length-1-O.row[1]+O.row[0],P=visibledatarow.length-1),(B>=visibledatacolumn[visibledatacolumn.length-1]||y<w)&&(L=visibledatacolumn.length-1-O.column[1]+O.column[0],B=visibledatacolumn.length-1),jfgrid.dropCell.copyRange={row:$.extend(!0,[],O.row),column:$.extend(!0,[],O.column)};var ue=jfgrid.dropCell.typeItemHide();if(ue[0]||ue[1]||ue[2]||ue[3]||ue[4]||ue[5]||ue[6]?jfgrid.dropCell.applyType="1":jfgrid.dropCell.applyType="0",Math.abs(F-x)>Math.abs(N-I)){if(D<=x&&x<=P)return;if(jfgird_select_save[0].top_move>=C){if(jfgrid.dropCell.applyRange={row:[x,O.row[0]-1],column:O.column},jfgrid.dropCell.direction="up",D-=O.row[0]-x,jfgrid.pivotTable.isPivotRange(D,B))return void jfgrid.tooltip.info("无法对所选单元格进行此更改，因为它会影响数据透视表！","")}else if(jfgrid.dropCell.applyRange={row:[O.row[1]+1,x],column:O.column},jfgrid.dropCell.direction="down",P+=x-O.row[1],jfgrid.pivotTable.isPivotRange(P,B))return void jfgrid.tooltip.info("无法对所选单元格进行此更改，因为它会影响数据透视表！","")}else{if(L<=I&&I<=B)return;if(jfgird_select_save[0].left_move>=T){if(jfgrid.dropCell.applyRange={row:O.row,column:[I,O.column[0]-1]},jfgrid.dropCell.direction="left",L-=O.column[0]-I,jfgrid.pivotTable.isPivotRange(P,L))return void jfgrid.tooltip.info("无法对所选单元格进行此更改，因为它会影响数据透视表！","")}else if(jfgrid.dropCell.applyRange={row:O.row,column:[O.column[1]+1,I]},jfgrid.dropCell.direction="right",B+=I-O.column[1],jfgrid.pivotTable.isPivotRange(P,B))return void jfgrid.tooltip.info("无法对所选单元格进行此更改，因为它会影响数据透视表！","")}if(null!=config.merge){for(var me=!1,V=O.row[0];V<=O.row[1];V++)for(U=O.column[0];U<=O.column[1];U++){if(null!=(Y=jfgrid.flowdata[V][U])&&null!=Y.mc){me=!0;break}}if(me)return void(jfgrid.isEditMode()?alert("无法对合并单元格执行此操作"):jfgrid.tooltip.info("无法对合并单元格执行此操作",""));for(V=D;V<=P;V++)for(U=L;U<=B;U++){if(null!=(Y=jfgrid.flowdata[V][U])&&null!=Y.mc){me=!0;break}}if(me)return void(jfgrid.isEditMode()?alert("无法对合并单元格执行此操作"):jfgrid.tooltip.info("无法对合并单元格执行此操作",""))}O.row=[D,P],O.column=[L,B],jfgrid.dropCell.update(),jfgrid.dropCell.createIcon(),$("#jfgrid-cell-selected-move").hide(),$("#jfgrid-sheettable").css("cursor","default"),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500)}}),$("#jfgrid-left-top").mousedown(function(e){$("#jfgrid-wa-functionbox-confirm").click(),jfgird_select_status=!1,jfgird_select_save=[{row:[0,jfgrid.flowdata.length-1],column:[0,jfgrid.flowdata[0].length-1],row_focus:0,column_focus:0}],jfgrid.selectHightlightShow(),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfcountfunc()},500),e.stopPropagation()});var jfgrid_rows_selected_status=!1;$("#jfgrid-rows-h").mousedown(function(e){jfgrid.postil.removeActivePs();var r=mouseposition(e.pageX,e.pageY)[1]+$("#jfgrid-rows-h").scrollTop(),t=jfgrid.rowLocation(r),i=t[1],a=t[0],n=t[2],o=visibledatacolumn.length-1,l=visibledatacolumn[o];if($("#jfgrid-rightclick-menu").hide(),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide(),"3"==e.which){for(var d=!1,f=0;f<jfgird_select_save.length;f++){var s=jfgird_select_save[f];if(null!=s.row&&n>=s.row[0]&&n<=s.row[1]&&0==s.column[0]&&s.column[1]==jfgrid.flowdata[0].length-1){d=!0;break}}if(d)return}var g=a,c=i-a-1,u=[n,n];jfgird_scroll_status=!0;var m=$("#jfgrid-input-box");if(0<parseInt(m.css("top"))){if(jfgrid.formula.rangestart||jfgrid.formula.rangedrag_column_start||jfgrid.formula.rangedrag_row_start||jfgrid.formula.israngeseleciton()||$("#jfgrid-ifFormulaGenerator-multiRange-dialog").is(":visible")){var h,j,p,v,b,_=jfgrid.menuButton.mergeMoveMain([0,o],u,{row_focus:n,column_focus:0},g,c,0,l);return null!=_&&(u=_[1],g=_[2],c=_[3]),e.shiftKey?(c=g=0,u=[],u=(h=jfgrid.formula.func_selectedrange).top>a?(g=a,c=h.top+h.height-a,h.row[1]>h.row_focus&&(h.row[1]=h.row_focus),[n,h.row[1]]):h.top==a?(g=a,c=h.top+h.height-a,[n,h.row[0]]):(g=h.top,c=i-h.top-1,h.row[0]<h.row_focus&&(h.row[0]=h.row_focus),[h.row[0],n]),null!=(_=jfgrid.menuButton.mergeMoveMain([0,o],u,{row_focus:n,column_focus:0},g,c,0,l))&&(u=_[1],g=_[2],c=_[3]),h.row=u,h.top_move=g,h.height_move=c,jfgrid.formula.func_selectedrange=h):(e.ctrlKey&&","!=$("#jfgrid-rich-text-editor").find("span").last().text()&&(0<(v=$("#jfgrid-rich-text-editor").text()+",").length&&"="==v.substr(0,1)&&(v=jfgrid.formula.functionHTMLGenerate(v),window.getSelection?(j=window.getSelection(),jfgrid.formula.functionRangeIndex=[$(j.anchorNode).parent().index(),j.anchorOffset]):(p=document.selection.createRange(),jfgrid.formula.functionRangeIndex=p),$("#jfgrid-rich-text-editor").html(v),jfgrid.formula.canceFunctionrangeSelected(),jfgrid.formula.createRangeHightlight()),jfgrid.formula.rangestart=!1,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,$("#jfgrid-functionbox-cell").html(v),jfgrid.formula.rangeHightlightselected($("#jfgrid-rich-text-editor")),jfgrid.formula.israngeseleciton()),jfgrid.formula.func_selectedrange={left:jfgrid.colLocationByIndex(0)[0],width:jfgrid.colLocationByIndex(0)[1]-jfgrid.colLocationByIndex(0)[0]-1,top:g,height:c,left_move:0,width_move:l-1,top_move:g,height_move:c,row:u,column:[0,o],row_focus:n,column_focus:0}),jfgrid.formula.rangestart||jfgrid.formula.rangedrag_column_start||jfgrid.formula.rangedrag_row_start||jfgrid.formula.israngeseleciton()?jfgrid.formula.rangeSetValue({row:u,column:[null,null]}):$("#jfgrid-ifFormulaGenerator-multiRange-dialog").is(":visible")&&(b=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:u,column:[0,o]},jfgrid.currentSheetIndex),$("#jfgrid-ifFormulaGenerator-multiRange-dialog input").val(b)),jfgrid.formula.rangedrag_row_start=!0,jfgrid.formula.rangestart=!1,jfgrid.formula.rangedrag_column_start=!1,$("#jfgrid-formula-functionrange-select").css({left:0,width:l-1,top:g,height:c}).show(),$("#jfgrid-formula-help-c").hide(),jfgrid.jfgrid_count_show(0,g,l-1,c,u,[0,o]),void setTimeout(function(){var e=window.getSelection().anchorNode;$("#jfgrid-search-formula-parm").is(":visible")||$("#jfgrid-search-formula-parm-select").is(":visible")?($editor=$("#jfgrid-rich-text-editor"),jfgrid.formula.rangechangeindex=jfgrid.formula.data_parm_index):$editor=$(e).closest("div");var r=$editor.find("span[rangeindex='"+jfgrid.formula.rangechangeindex+"']");jfgrid.formula.setCaretPosition(r.get(0),0,r.html().length)},1)}jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgrid_rows_selected_status=!0}else jfgrid_rows_selected_status=!0;jfgrid_rows_selected_status&&(e.shiftKey?(c=g=0,u=[],u=(h=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1])).top>a?(g=a,c=h.top+h.height-a,h.row[1]>h.row_focus&&(h.row[1]=h.row_focus),[n,h.row[1]]):h.top==a?(g=a,c=h.top+h.height-a,[n,h.row[0]]):(g=h.top,c=i-h.top-1,h.row[0]<h.row_focus&&(h.row[0]=h.row_focus),[h.row[0],n]),h.row=u,h.top_move=g,h.height_move=c,jfgird_select_save[jfgird_select_save.length-1]=h):e.ctrlKey?jfgird_select_save.push({left:jfgrid.colLocationByIndex(0)[0],width:jfgrid.colLocationByIndex(0)[1]-jfgrid.colLocationByIndex(0)[0]-1,top:g,height:c,left_move:0,width_move:l-1,top_move:g,height_move:c,row:u,column:[0,o],row_focus:n,column_focus:0}):(jfgird_select_save=[]).push({left:jfgrid.colLocationByIndex(0)[0],width:jfgrid.colLocationByIndex(0)[1]-jfgrid.colLocationByIndex(0)[0]-1,top:g,height:c,left_move:0,width_move:l-1,top_move:g,height_move:c,row:u,column:[0,o],row_focus:n,column_focus:0}),jfgrid.selectHightlightShow(),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("mv",jfgrid.currentSheetIndex,jfgird_select_save)),$("#jfgrid-helpbox-cell").text(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,jfgird_select_save[jfgird_select_save.length-1])),setTimeout(function(){clearTimeout(jfcountfuncTimeout),jfcountfunc()},101)}).mousemove(function(e){var r,t,i,a;jfgrid_rows_selected_status||jfgrid_rows_change_size||jfgird_select_status?$("#jfgrid-rows-h-hover").hide():(r=mouseposition(e.pageX,e.pageY)[1]+$("#jfgrid-rows-h").scrollTop(),i=(t=jfgrid.rowLocation(r))[1],a=t[0],t[2],$("#jfgrid-rows-h-hover").css({top:a,height:i-a-1,display:"block"}),r<i-1&&i-5<=r?$("#jfgrid-rows-change-size").css({top:i-3,opacity:0}):$("#jfgrid-rows-change-size").css("opacity",0))}).mouseleave(function(e){$("#jfgrid-rows-h-hover").hide(),$("#jfgrid-rows-change-size").css("opacity",0)}).mouseup(function(e){if(3==e.which){if(jfgrid.isEditMode())return;$("#jfgrid-cols-rows-shift").hide(),jfgridRightHeadClickIs="row",$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-word").text("行"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-size").text("高"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-left").text("上"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-right").text("下"),$("#jfgrid-cols-rows-add").show(),$("#jfgrid-cols-rows-data").show(),$("#jfgrid-cols-rows-shift").hide(),showrightclickmenu($("#jfgrid-rightclick-menu"),$(this).offset().left+46,e.pageY),jfgrid_cols_menu_status=!0;var r=$.extend(!0,{},config);null==r.rowlen&&(r.rowlen={});for(var t=null==r.rowlen[jfgird_select_save[0].row[0]]?jfgrid.defaultrowlen:r.rowlen[jfgird_select_save[0].row[0]],i=!0,a=0;a<jfgird_select_save.length;a++)for(var n=jfgird_select_save[a],o=n.row[0],l=n.row[1],d=o;d<=l;d++){if((null==r.rowlen[d]?jfgrid.defaultrowlen:r.rowlen[d])!=t){i=!1;break}}i?$("#jfgrid-cols-rows-add").find("input[type='number'].rcsize").val(t):$("#jfgrid-cols-rows-add").find("input[type='number'].rcsize").val("")}}),jfgrid.jfgrid_count_show=function(e,r,t,i,a,n){var o,l,d=a[1]-a[0]+1,f=n[1]-n[0]+1,s=jfgridTableContentHW[0],g=jfgridTableContentHW[1],c=$("#jfgrid-cell-main").scrollLeft(),u=$("#jfgrid-cell-main").scrollTop();4<=d?((l=e-25)<0&&(l=e+5),l<c&&(l=c+10),o=g<i?u+g/2:r+i/2,$("#jfgrid-row-count-show").css({left:l,top:o,display:"block"}).html("<div>"+d.toString().split("").join("</div><div>")+"</div><div>行</div>")):$("#jfgrid-row-count-show").hide(),4<=f?((o=r-25)<0&&(o=r+5),o<u&&(o=u+10),l=s<t?c+s/2:e+t/2,$("#jfgrid-column-count-show").css({left:l,top:o,display:"block"}).text(f+"列")):$("#jfgrid-column-count-show").hide()};var jfgrid_cols_selected_status=!1;$("#jfgrid-cols-h-c").mousedown(function(e){jfgrid.postil.removeActivePs();var r=mouseposition(e.pageX,e.pageY)[0]+$(this).scrollLeft(),t=visibledatarow.length-1,i=visibledatarow[t],a=jfgrid.colLocation(r),n=a[1],o=a[0],l=a[2];if(orderbyindex=l,$("#jfgrid-rightclick-menu").hide(),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide(),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide(),"3"==e.which){for(var d=!1,f=0;f<jfgird_select_save.length;f++){var s=jfgird_select_save[f];if(null!=s.column&&l>=s.column[0]&&l<=s.column[1]&&0==s.row[0]&&s.row[1]==jfgrid.flowdata.length-1){d=!0;break}}if(d)return}var g=o,c=n-o-1,u=[l,l];jfgird_scroll_status=!0;var m=$("#jfgrid-input-box");if(0<parseInt(m.css("top"))){if(jfgrid.formula.rangestart||jfgrid.formula.rangedrag_column_start||jfgrid.formula.rangedrag_row_start||jfgrid.formula.israngeseleciton()||$("#jfgrid-ifFormulaGenerator-multiRange-dialog").is(":visible")){var h,j,p,v,b,_=jfgrid.menuButton.mergeMoveMain(u,[0,t],{row_focus:0,column_focus:l},0,i,g,c);return null!=_&&(u=_[0],g=_[4],c=_[5]),e.shiftKey?(c=g=0,u=[],u=(h=jfgrid.formula.func_selectedrange).left>o?(g=o,c=h.left+h.width-o,h.column[1]>h.column_focus&&(h.column[1]=h.column_focus),[l,h.column[1]]):h.left==o?(g=o,c=h.left+h.width-o,[l,h.column[0]]):(g=h.left,c=n-h.left-1,h.column[0]<h.column_focus&&(h.column[0]=h.column_focus),[h.column[0],l]),null!=(_=jfgrid.menuButton.mergeMoveMain(u,[0,t],{row_focus:0,column_focus:l},0,i,g,c))&&(u=_[0],g=_[4],c=_[5]),h.column=u,h.left_move=g,h.width_move=c,jfgrid.formula.func_selectedrange=h):(e.ctrlKey&&","!=$("#jfgrid-rich-text-editor").find("span").last().text()&&(0<(v=$("#jfgrid-rich-text-editor").text()+",").length&&"="==v.substr(0,1)&&(v=jfgrid.formula.functionHTMLGenerate(v),window.getSelection?(j=window.getSelection(),jfgrid.formula.functionRangeIndex=[$(j.anchorNode).parent().index(),j.anchorOffset]):(p=document.selection.createRange(),jfgrid.formula.functionRangeIndex=p),$("#jfgrid-rich-text-editor").html(v),jfgrid.formula.canceFunctionrangeSelected(),jfgrid.formula.createRangeHightlight()),jfgrid.formula.rangestart=!1,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,$("#jfgrid-functionbox-cell").html(v),jfgrid.formula.rangeHightlightselected($("#jfgrid-rich-text-editor")),jfgrid.formula.israngeseleciton()),jfgrid.formula.func_selectedrange={left:g,width:c,top:jfgrid.rowLocationByIndex(0)[0],height:jfgrid.rowLocationByIndex(0)[1]-jfgrid.rowLocationByIndex(0)[0]-1,left_move:g,width_move:c,top_move:0,height_move:i-1,row:[0,t],column:u,row_focus:0,column_focus:l}),jfgrid.formula.rangestart||jfgrid.formula.rangedrag_column_start||jfgrid.formula.rangedrag_row_start||jfgrid.formula.israngeseleciton()?jfgrid.formula.rangeSetValue({row:[null,null],column:u}):$("#jfgrid-ifFormulaGenerator-multiRange-dialog").is(":visible")&&(b=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:[0,t],column:u},jfgrid.currentSheetIndex),$("#jfgrid-ifFormulaGenerator-multiRange-dialog input").val(b)),jfgrid.formula.rangedrag_column_start=!0,jfgrid.formula.rangestart=!1,jfgrid.formula.rangedrag_row_start=!1,$("#jfgrid-formula-functionrange-select").css({left:g,width:c,top:0,height:i-1}).show(),$("#jfgrid-formula-help-c").hide(),void jfgrid.jfgrid_count_show(g,0,c,i-1,[0,t],u)}jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgrid_cols_selected_status=!0}else jfgrid_cols_selected_status=!0;jfgrid_cols_selected_status&&(e.shiftKey?(c=g=0,u=[],u=(h=$.extend(!0,{},jfgird_select_save[jfgird_select_save.length-1])).left>o?(g=o,c=h.left+h.width-o,h.column[1]>h.column_focus&&(h.column[1]=h.column_focus),[l,h.column[1]]):h.left==o?(g=o,c=h.left+h.width-o,[l,h.column[0]]):(g=h.left,c=n-h.left-1,h.column[0]<h.column_focus&&(h.column[0]=h.column_focus),[h.column[0],l]),h.column=u,h.left_move=g,h.width_move=c,jfgird_select_save[jfgird_select_save.length-1]=h):e.ctrlKey?jfgird_select_save.push({left:g,width:c,top:jfgrid.rowLocationByIndex(0)[0],height:jfgrid.rowLocationByIndex(0)[1]-jfgrid.rowLocationByIndex(0)[0]-1,left_move:g,width_move:c,top_move:0,height_move:i-1,row:[0,t],column:u,row_focus:0,column_focus:l}):(jfgird_select_save=[]).push({left:g,width:c,top:jfgrid.rowLocationByIndex(0)[0],height:jfgrid.rowLocationByIndex(0)[1]-jfgrid.rowLocationByIndex(0)[0]-1,left_move:g,width_move:c,top_move:0,height_move:i-1,row:[0,t],column:u,row_focus:0,column_focus:l}),jfgrid.selectHightlightShow(),jfgrid.server.allowUpdate&&jfgrid.server.saveParam("mv",jfgrid.currentSheetIndex,jfgird_select_save)),$("#jfgrid-helpbox-cell").text(jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,jfgird_select_save[jfgird_select_save.length-1])),setTimeout(function(){clearTimeout(jfcountfuncTimeout),jfcountfunc()},101),jfgrid_cols_menu_status&&($("#jfgrid-rightclick-menu").hide(),$("#jfgrid-cols-h-hover").hide(),$("#jfgrid-cols-menu-btn").hide(),jfgrid_cols_menu_status=!1),e.stopPropagation()}).mousemove(function(e){return jfgrid_cols_selected_status||jfgird_select_status?($("#jfgrid-cols-h-hover").hide(),void $("#jfgrid-cols-menu-btn").hide()):void(jfgrid_cols_menu_status||jfgrid_cols_change_size||(r=mouseposition(e.pageX,e.pageY)[0]+$("#jfgrid-cols-h-c").scrollLeft(),i=(t=jfgrid.colLocation(r))[1],a=t[0],t[2],$("#jfgrid-cols-h-hover").css({left:a,width:i-a-1,display:"block"}),$("#jfgrid-cols-menu-btn").css({left:i-19,display:"block"}),$("#jfgrid-cols-change-size").css({left:i-5}),r<i&&i-5<=r?($("#jfgrid-cols-change-size").css({opacity:0}),$("#jfgrid-cols-menu-btn").hide()):($("#jfgrid-change-size-line").hide(),$("#jfgrid-cols-change-size").css("opacity",0))));var r,t,i,a}).mouseleave(function(e){jfgrid_cols_menu_status||jfgrid_cols_change_size||($("#jfgrid-cols-h-hover").hide(),$("#jfgrid-cols-menu-btn").hide(),$("#jfgrid-cols-change-size").css("opacity",0))}).mouseup(function(e){if(3==e.which){if(jfgrid.isEditMode())return;jfgridRightHeadClickIs="column",$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-word").text("列"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-size").text("宽"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-left").text("左"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-right").text("右"),$("#jfgrid-cols-rows-add").show(),$("#jfgrid-cols-rows-data").show(),$("#jfgrid-cols-rows-shift").hide(),showrightclickmenu($("#jfgrid-rightclick-menu"),e.pageX,$(this).offset().top+18),jfgrid_cols_menu_status=!0;var r=$.extend(!0,{},config);null==r.columlen&&(r.columlen={});for(var t=null==r.columlen[jfgird_select_save[0].column[0]]?jfgrid.defaultcollen:r.columlen[jfgird_select_save[0].column[0]],i=!0,a=0;a<jfgird_select_save.length;a++)for(var n=jfgird_select_save[a],o=n.column[0],l=n.column[1],d=o;d<=l;d++){if((null==r.columlen[d]?jfgrid.defaultcollen:r.columlen[d])!=t){i=!1;break}}i?$("#jfgrid-cols-rows-add").find("input[type='number'].rcsize").val(t):$("#jfgrid-cols-rows-add").find("input[type='number'].rcsize").val("")}});var jfgrid_cols_change_size=!1,jfgrid_cols_change_size_start=[],jfgrid_cols_dbclick_timeout=null,jfgrid_cols_dbclick_times=0;function jfgridcolsdbclick(){jfgrid_cols_change_size=!1,$("#jfgrid-change-size-line").hide(),$("#jfgrid-cols-change-size").css("opacity",0),$("#jfgrid-sheettable, #jfgrid-cols-h-c, .jfgrid-cols-h-cells, .jfgrid-cols-h-cells canvas").css("cursor","default");var e=mouseposition(event.pageX,event.pageY),r=$("#jfgrid-cols-h-c").scrollLeft(),t=e[0]+r,i=$(window).width(),a=visibledatarow.length-1,n=(visibledatarow[a],jfgrid.colLocation(t)),o=(n[1],n[0]),l=n[2];jfgrid_cols_change_size_start=[o,l];for(var d=$("#jfgridTableContent").get(0).getContext("2d"),f=$.extend(!0,{},config),s={},g=0;g<jfgird_select_save.length;g++){var c=jfgird_select_save[g].column[0],u=jfgird_select_save[g].column[1];if(l<c||u<l){if(l in s)continue;t=-1/0;for(var m=0,h=13,j=0;j<jfgrid.flowdata.length&&!(15<=m);j++){var p=jfgrid.getcellvalue(j,jfgrid_cols_change_size_start[1],jfgrid.flowdata),v=jfgrid.getcellvalue(j,jfgrid_cols_change_size_start[1],jfgrid.flowdata,"m");null!=v&&(p=v);var b=jfgrid.flowdata[j][jfgrid_cols_change_size_start[1]];"object"==jfgrid.getObjType(b)&&"fs"in b&&b.fs>h&&(h=b.fs),null!=p&&0!=p.toString().length?t<(y=d.measureText(p).width)&&(t=y):m++}var _=i-100+r<=t?i-100+r:t+3<30?30:t+1.5*h;null==f.columlen&&(f.columlen={}),f.columlen[jfgrid_cols_change_size_start[1]]=Math.ceil(_),s[l]=1}else for(var w=c;w<=u;w++)if(!(w in s)){t=-1/0;for(m=0,h=13,j=0;j<jfgrid.flowdata.length&&!(15<=m);j++){var y,p=jfgrid.getcellvalue(j,w,jfgrid.flowdata),b=jfgrid.flowdata[j][w];"object"==jfgrid.getObjType(b)&&"fs"in b&&b.fs>h&&(h=b.fs),jfgrid.func_methods.isRealNull(p)?m++:t<(y=d.measureText(p).width)&&(t=y)}_=i-100+r<=t?i-100+r:t+3<30?30:t+1.5*h;null==f.columlen&&(f.columlen={}),f.columlen[w]=Math.ceil(_),s[w]=1}}jfgrid.jfrefreshgridall(jfgrid.flowdata[0].length,jfgrid.flowdata.length,jfgrid.flowdata,f,jfgird_select_save,"resizeC","columlen")}$("#jfgrid-cols-change-size").mousedown(function(e){jfgrid.postil.removeActivePs(),$("#jfgrid-input-box").hide(),$("#jfgrid-cols-change-size").css({opacity:1});var r=mouseposition(e.pageX,e.pageY),t=$("#jfgrid-cols-h-c").scrollLeft(),i=$("#jfgrid-cell-main").scrollTop(),a=$("#jfgrid-cell-main").height(),n=r[0]+t,o=visibledatarow.length-1,l=(visibledatarow[o],jfgrid.colLocation(n)),d=l[1],f=l[0],s=l[2];jfgird_scroll_status=jfgrid_cols_change_size=!0,$("#jfgrid-change-size-line").css({height:a+i,"border-width":"0 1px 0 0",top:0,left:d-3,width:"1px",display:"block",cursor:"ew-resize"}),$("#jfgrid-sheettable, #jfgrid-cols-h-c, .jfgrid-cols-h-cells, .jfgrid-cols-h-cells canvas").css("cursor","ew-resize"),jfgrid_cols_change_size_start=[f,s],$("#jfgrid-rightclick-menu").hide(),$("#jfgrid-cols-h-hover").hide(),$("#jfgrid-cols-menu-btn").hide(),jfgrid_cols_dbclick_times=0,e.stopPropagation()}).dblclick(function(){jfgridcolsdbclick()});var jfgrid_rows_change_size=!1,jfgrid_rows_change_size_start=[];$("#jfgrid-rows-change-size").mousedown(function(e){jfgrid.postil.removeActivePs(),$("#jfgrid-input-box").hide(),$("#jfgrid-rows-change-size").css({opacity:1});var r=mouseposition(e.pageX,e.pageY)[1]+$("#jfgrid-rows-h").scrollTop(),t=$("#jfgrid-cell-main").scrollLeft(),i=$("#jfgrid-cell-main").width(),a=jfgrid.rowLocation(r),n=a[1],o=a[0],l=a[2];jfgird_scroll_status=jfgrid_rows_change_size=!0,$("#jfgrid-change-size-line").css({height:"1px","border-width":"0 0px 1px 0",top:n-3,left:0,width:t+i,display:"block",cursor:"ns-resize"}),$("#jfgrid-sheettable, #jfgrid-rows-h, #jfgrid-rows-h canvas").css("cursor","ns-resize"),jfgrid_rows_change_size_start=[o,l],$("#jfgrid-rightclick-menu").hide(),$("#jfgrid-rows-h-hover").hide(),$("#jfgrid-cols-menu-btn").hide(),e.stopPropagation()}),window.jfgrid_cols_menu_status=!1,$("#jfgrid-cols-menu-btn").click(function(e){var r=$("#jfgrid-rightclick-menu"),t=$(this).offset();$("#jfgrid-cols-rows-shift").show(),jfgridRightHeadClickIs="column",$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-word").text("列"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-left").text("左"),$("#jfgrid-rightclick-menu .jfgrid-cols-rows-shift-right").text("右"),$("#jfgrid-cols-rows-add").show(),$("#jfgrid-cols-rows-data").hide(),$("#jfgrid-cols-rows-shift").show(),showrightclickmenu(r,t.left,t.top+18),jfgrid_cols_menu_status=!0});var orderbyindex=0;$("#jfgridorderbyasc, #jfgridorderbyasc_t").mousedown(function(e){jfgrid.cleargridelement(e),jfgrid.sortColumnSeletion(orderbyindex,!0),jfgrid.selectHightlightShow()}),$("#jfgridorderbydesc, #jfgridorderbydesc_t").click(function(e){jfgrid.cleargridelement(e),jfgrid.sortColumnSeletion(orderbyindex,!1),jfgrid.selectHightlightShow()}),$("#jfgrid-copy-json-head").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){if(1==l.length){for(var f={},s=0;s<l[0].length;s++)f[jfgrid.getcellvalue(0,s,l)]="";d.push(f)}else for(var g=1;g<l.length;g++){for(var f={},c=0;c<l[0].length;c++)null==jfgrid.getcellvalue(0,c,l)?f[""]=jfgrid.getcellvalue(g,c,l):f[jfgrid.getcellvalue(0,c,l)]=jfgrid.getcellvalue(g,c,l);d.push(f)}jfgrid.selection.copybyformat(e,JSON.stringify(d))}}}),$("#jfgrid-copy-json-nohead").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){for(var f=jfgird_select_save[0].column[0],s=0;s<l.length;s++){for(var g={},c=0;c<l[0].length;c++)g[jfgrid.jfgridchatatABC(c+f)]=jfgrid.getcellvalue(s,c,l);d.push(g)}jfgrid.selection.copybyformat(e,JSON.stringify(d))}}}),$("#jfgrid-copy-array1").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){for(var f=0;f<l.length;f++)for(var s=0;s<l[0].length;s++)d.push(jfgrid.getcellvalue(f,s,l));jfgrid.selection.copybyformat(e,JSON.stringify(d))}}}),$("#jfgrid-copy-array2").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){for(var f=0;f<l.length;f++){for(var s=[],g=0;g<l[0].length;g++)s.push(jfgrid.getcellvalue(f,g,l));d.push(s)}jfgrid.selection.copybyformat(e,JSON.stringify(d))}}}),$("#jfgrid-copy-arraymore-confirm").click(function(e){if($("body .jfgrid-cols-menu").hide(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){for(var f=0;f<l.length;f++)for(var s=0;s<l[0].length;s++)d.push(l[f][s]);var g=$("#jfgrid-copy-arraymore-row").val(),c=$("#jfgrid-copy-arraymore-col").val();if(""==g&&""==c)return jfgrid.selection.copybyformat(e,JSON.stringify(d)),void $("body .jfgrid-cols-menu").hide();if((""==g||null==(g=parseInt(g)))&&(g=1),""!=c&&null!=(c=parseInt(c))||(c=1),"NaN"!=g.toString()&&"NaN"!=c.toString())if(g<1||c<1)jfgrid.isEditMode()?alert("行列数不能小于1!"):jfgrid.tooltip.info("行列数不能小于1!","");else{for(var u=d.length,m=0,h=[],f=0;f<g;f++){for(var j=[],s=0;s<c;s++)if(j.push(d[m++]),u<=m)return jfgrid.selection.copybyformat(e,JSON.stringify(h)),void $("body .jfgrid-cols-menu").hide();h.push(j)}jfgrid.selection.copybyformat(e,JSON.stringify(h))}else jfgrid.isEditMode()?alert("请输入正确的数值!"):jfgrid.tooltip.info("请输入正确的数值!","")}}}),$("#jfgrid-copy-diagonal").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){for(var f=l[0].length,s=0;s<l.length&&!(f<=s);s++)d.push(l[s][s]);jfgrid.selection.copybyformat(e,JSON.stringify(d)),copyType="diagonal",copysetting=[]}}}),$("#jfgrid-copy-antidiagonal").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){for(var f=l[0].length,s=0;s<l.length&&!(f<=s);s++)d.push(l[s][f-s-1]);jfgrid.selection.copybyformat(e,JSON.stringify(d)),copyType="antidiagonal",copysetting=[]}}}),$("#jfgrid-copy-diagonaloffset").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){var f=l[0].length,s=parseInt($("#jfgrid-copy-diagonaloffset-value").val());if("NaN"!=s.toString())if(s<0)jfgrid.isEditMode()?alert("偏移列不能为负数！"):jfgrid.tooltip.info("偏移列不能为负数！","");else{null==s&&(s=1);for(var f=l[0].length,g=0;g<l.length&&!(f<=g+s);g++)d.push(l[g][g+s]);jfgrid.selection.copybyformat(e,JSON.stringify(d)),copyType="diagonaloffset",copysetting=[s]}else jfgrid.isEditMode()?alert("请输入正确的数值！"):jfgrid.tooltip.info("请输入正确的数值！","")}}}),$("#jfgrid-copy-boolvalue").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{if(null!=config.merge){for(var r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(r=jfgrid.hasPartMC(config,i,a,n,o))break}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var l=jfgrid.getdatabyselection(jfgird_select_save[0]),d=[];if(0!=l.length){for(var f=0;f<l.length;f++){for(var s=[],g=0;g<l[0].length;g++){var c,u=!1,u=null!=(c="object"==jfgrid.getObjType(l[f][g])?l[f][g].v:l[f][g])&&""!=c&&(null==(c=parseInt(c))||0<c);s.push(u)}d.push(s)}jfgrid.selection.copybyformat(e,JSON.stringify(d)),copyType="boolvalue",copysetting=[]}}}),$("#jfgrid-matrix-turn-up").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=r.length-1;0<=i;i--){for(var a=[],n=0;n<r[0].length;n++){var o="";null!=r[i]&&null!=r[i][n]&&(o=r[i][n]),a.push(o)}t.push(a)}jfgrid.editor.controlHandler(t)}}}),$("#jfgrid-matrix-turn-left").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=0;i<r.length;i++){for(var a=[],n=r[0].length-1;0<=n;n--){var o="";null!=r[i]&&null!=r[i][n]&&(o=r[i][n]),a.push(o)}t.push(a)}jfgrid.editor.controlHandler(t)}}}),$("#jfgrid-matrix-turn-cw").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=0;i<r[0].length;i++){for(var a=[],n=r.length-1;0<=n;n--){var o="";null!=r[n]&&null!=r[n][i]&&(o=r[n][i]),a.push(o)}t.push(a)}jfgrid.editor.controlHandlerD(t)}}}),$("#jfgrid-matrix-turn-anticw").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=r[0].length-1;0<=i;i--){for(var a=[],n=0;n<r.length;n++){var o="";null!=r[n]&&null!=r[n][i]&&(o=r[n][i]),a.push(o)}t.push(a)}jfgrid.editor.controlHandlerD(t)}}}),$("#jfgrid-matrix-turn-trans").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=0;i<r[0].length;i++){for(var a=[],n=0;n<r.length;n++){var o="";null!=r[n]&&null!=r[n][i]&&(o=r[n][i]),a.push(o)}t.push(a)}jfgrid.editor.controlHandlerD(t)}}});var jfnqrt=function(e,r){if(0==e)return 0;for(var t=e,i=(r-1)*t/r+e/(Math.pow(t,r-1)*r);1e-6<Math.abs(i-t);)i=(r-1)*(t=i)/r+e/(Math.pow(t,r-1)*r);return i};$("#jfgrid-matrix-cal-confirm").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){var t=$("#jfgrid-matrix-cal-type").val(),i=parseInt($("#jfgrid-matrix-cal-value").val());if("NaN"!=i.toString()){null==i&&(i=2);for(var a=[],n=0;n<r.length;n++){for(var o=[],l=0;l<r[0].length;l++){var d="";null!=r[n]&&null!=r[n][l]&&(d=r[n][l],null!=parseInt(d)&&null!=r[n][l].ct&&"n"==r[n][l].ct.t&&("minus"==t?d.v=d.v-i:"multiply"==t?d.v=d.v*i:"divided"==t?d.v=jfgrid.numFormat(d.v/i,4):"power"==t?d.v=Math.pow(d.v,i):"root"==t?2==i?d.v=jfgrid.numFormat(Math.sqrt(d.v),4):3==i&&Math.cbrt?d.v=jfgrid.numFormat(Math.cbrt(d.v),4):d.v=jfgrid.numFormat(jfnqrt(d.v,i),4):d.v="log"==t?jfgrid.numFormat(1e4*Math.log(d.v)/Math.log(Math.abs(i)),4):d.v+i,null==d.v?d.m="":d.m=d.v.toString())),o.push(d)}a.push(o)}jfgrid.editor.controlHandler(a)}else jfgrid.isEditMode()?alert("请输入正确的数值！"):jfgrid.tooltip.info("请输入正确的数值！","")}}}),$("#jfgrid-matrix-delezero-row").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=r[0].length,a=0;a<r.length;a++){for(var n=[],o=!0,l=!0,d=0;d<i;d++){var f="";if(null!=r[a]&&null!=r[a][d]){if(("0"==(f=r[a][d]).v||0==f.v)&&o)continue;o=!1}n.push(f)}var s=[];if(n.length==i)s=n;else{for(d=n.length-1;0<=d;d--){f="";if(null!=n[d]){if(("0"==(f=n[d]).v||0==f.v)&&l)continue;l=!1}s.unshift(f)}for(var g=i-s.length,c=0;c<g;c++)s.push("")}t.push(s)}jfgrid.editor.controlHandler(t)}}}),$("#jfgrid-matrix-delezero-column").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=r.length,a=r[0].length,n=0;n<a;n++){for(var o=[],l=!0,d=!0,f=0;f<i;f++){var s="";if(null!=r[f]&&null!=r[f][n]){if(("0"==(s=r[f][n]).v||0==s.v)&&l)continue;l=!1}o.push(s)}var g=[];if(o.length==i)g=o;else{for(f=o.length-1;0<=f;f--){s="";if(null!=o[f]){if(("0"==(s=o[f]).v||0==s.v)&&d)continue;d=!1}g.unshift(s)}for(var c=i-g.length,u=0;u<c;u++)g.push("")}t.push(g)}for(var m=[],n=0;n<t[0].length;n++){for(o=[],f=0;f<t.length;f++){s="";null!=t[f]&&null!=t[f][n]&&(s=t[f][n]),o.push(s)}m.push(o)}jfgrid.editor.controlHandler(m)}}}),$("#jfgrid-matrix-delerpt-row").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=r[0].length,a=0;a<r.length;a++){for(var n=[],o={},l=0;l<i;l++){var d=null;null!=r[a]&&null!=r[a][l]&&((d=r[a][l]).v in o||(o[d.v]=[]),o[d.v].push(d))}for(l=0;l<i;l++){d=null;null!=r[a]&&null!=r[a][l]&&1==o[(d=r[a][l]).v].length&&n.push(d)}for(var f=i-n.length,s=0;s<f;s++)n.push(null);t.push(n)}jfgrid.editor.controlHandler(t)}}}),$("#jfgrid-matrix-delerpt-column").click(function(e){if($("body .jfgrid-cols-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选定区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选定区域执行此操作，请选择单个区域，然后再试","");else{var r=jfgrid.getdatabyselection(jfgird_select_save[0]);if(0!=r.length){for(var t=[],i=r.length,a=r[0].length,n=0;n<a;n++){for(var o=[],l={},d=0;d<i;d++){var f=null;null!=r[d]&&null!=r[d][n]&&((f=r[d][n]).v in l||(l[f.v]=[]),l[f.v].push(f))}for(d=0;d<i;d++){f=null;null!=r[d]&&null!=r[d][n]&&1==l[(f=r[d][n]).v].length&&o.push(f)}a1=o;for(var s=i-a1.length,g=0;g<s;g++)a1.push(null);t.push(a1)}for(var c=[],n=0;n<t[0].length;n++){for(o=[],d=0;d<t.length;d++){f=null;null!=t[d]&&null!=t[d][n]&&(f=t[d][n]),o.push(f)}c.push(o)}jfgrid.editor.controlHandler(c)}}}),$("#jfgrid-icon-undo").click(function(e){jfgrid.controlHistory.redo(e)}),$("#jfgrid-icon-redo").click(function(e){jfgrid.controlHistory.undo(e)});var isInitialSheetConfig=!1,jfgridcurrentSheetitem=null,jfdbclicklagTimeout=null;function showsheetconfigmenu(){isInitialSheetConfig||(isInitialSheetConfig=!0,$("#jfgridsheetconfigcolorur").spectrum({showPalette:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!1,showSelectionPalette:!0,maxPaletteSize:10,cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"更多",togglePaletteLessText:"少于",clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)"],["rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)"],["rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)"],["rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)"],["rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"],["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"]],change:function(e){$(this);e=null!=e?e.toHexString():"rgb(0, 0, 0)";var r=null;0<jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").length&&(r=jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").css("background-color")),jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").remove(),jfgridcurrentSheetitem.append('<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+e+';"></div>');var t,i=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex);jfgridfile[i].color=e,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,e,{k:"color"}),clearjfundo&&((t={type:"sheetColor"}).sheetIndex=jfgrid.currentSheetIndex,t.oldcolor=r,t.color=e,jfgrid.jfundo=[],jfgrid.jfredo.push(t))}}),$("#jfgridsheetconfigcolorreset").click(function(){var e=null;0<jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").length&&(e=jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").css("background-color")),jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").remove();var r,t=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex);jfgridfile[t].color=null,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,null,{k:"color"}),clearjfundo&&((r={type:"sheetColor"}).sheetIndex=jfgrid.currentSheetIndex,r.oldcolor=e,r.color=null,jfgrid.jfundo=[],jfgrid.jfredo.push(r))}));var e=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex);null!=jfgridfile[e].color&&0<jfgridfile[e].color.length&&$("#jfgridsheetconfigcolorur").spectrum("set",jfgridfile[e].color),$("#jfgridsheetconfigcolorur").parent().find("span, div, button, input, a").addClass("jfgrid-mousedown-cancel"),setTimeout(function(){mouseclickposition($("#jfgrid-rightclick-sheet-menu"),jfgridcurrentSheetitem.offset().left+jfgridcurrentSheetitem.width(),jfgridcurrentSheetitem.offset().top-18,"leftbottom")},1)}var jfgridsheetrightclick=function(e,r,t){clearTimeout(jfdbclicklagTimeout),r.hasClass("jfgrid-sheets-item-name")&&"true"==r.attr("contenteditable")||(jfgrid.formula.rangestart||jfgrid.formula.rangedrag_column_start||jfgrid.formula.rangedrag_row_start||jfgrid.formula.israngeseleciton()?setTimeout(function(){jfgrid.formula.setCaretPosition(jfgrid.formula.rangeSetValueTo.get(0),0,jfgrid.formula.rangeSetValueTo.text().length),jfgrid.formula.createRangeHightlight(),$("#jfgrid-input-box-index").find(".jfgrid-input-box-index-sheettxt").remove().end().prepend("<span class='jfgrid-input-box-index-sheettxt'>"+jfgrid.sheetmanage.getSheetName(jfgrid.formula.rangetosheet)+"!</span>").show(),$("#jfgrid-input-box-index").css({left:$("#jfgrid-input-box").css("left"),top:parseInt($("#jfgrid-input-box").css("top"))-20+"px","z-index":$("#jfgrid-input-box").css("z-index")})},1):($("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-formula-functionrange .jfgrid-formula-functionrange-highlight").remove()),$("#jfgrid-sheet-area div.jfgrid-sheets-item").removeClass("jfgrid-sheets-item-active"),e.addClass("jfgrid-sheets-item-active"),jfgrid.cleargridelement(t),jfgrid.sheetmanage.changeSheet(e.data("index")),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide(),(r.hasClass("jfgrid-sheets-item-menu")||r.hasClass("fa-sort-desc")||"3"==t.which)&&(jfgridcurrentSheetitem=r.closest(".jfgrid-sheets-item"),showsheetconfigmenu()))};$("#jfgrid-sheet-area").on("mousedown","div.jfgrid-sheets-item",function(t){if(!jfgrid.isEditMode()){var e=$(this),i=$(t.target),a=i.closest(".jfgrid-sheets-item");if("3"==t.which)return jfgridsheetrightclick(e,i,t),jfgridcurrentSheetitem=a,void showsheetconfigmenu();a.hasClass("jfgrid-sheets-item-active")&&"false"==a.find(".jfgrid-sheets-item-name").attr("contenteditable")&&(jfdbclicklagTimeout=setTimeout(function(){jfgird_sheet_move_status=!0,jfgird_sheet_move_data={widthlist:[]},$("#jfgrid-sheet-area div.jfgrid-sheets-item:visible").each(function(e){0==e?jfgird_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())):jfgird_sheet_move_data.widthlist.push(parseInt($(this).outerWidth())+jfgird_sheet_move_data.widthlist[e-1])}),jfgird_sheet_move_data.curindex=$("#jfgrid-sheet-area div.jfgrid-sheets-item").index(a);var e=t.pageX;jfgird_sheet_move_data.curleft=e-a.offset().left,jfgird_sheet_move_data.pageX=e,jfgird_sheet_move_data.activeobject=a,jfgird_sheet_move_data.cursorobject=i;var r=a.clone().css("visibility","hidden").attr("id","jfgrid-sheets-item-clone");a.after(r),a.css({position:"absolute",opacity:.8,cursor:"move",transition:"initial","z-index":10})},200))}}).on("click","div.jfgrid-sheets-item",function(e){var r,t;jfgrid.isEditMode()||(r=$(this),t=$(e.target),jfgridsheetrightclick(r,t,e))});var jfgridsheetnameeditor=function(r){r.attr("contenteditable","true").addClass("jfgrid-mousedown-cancel").data("oldtxt",r.text()),setTimeout(function(){var e;document.selection?((e=document.body.createTextRange()).moveToElementText(r.get(0)),e.select()):window.getSelection&&((e=document.createRange()).selectNodeContents(r.get(0)),window.getSelection().removeAllRanges(),window.getSelection().addRange(e))},1)};$("#jfgrid-sheet-area").on("dblclick","span.jfgrid-sheets-item-name",function(e){jfgridsheetnameeditor($(this))}),$("#jfgrid-sheet-area").on("blur","span.jfgrid-sheets-item-name",function(e){for(var r=$(this),t=r.text(),i=r.data("oldtxt"),a=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),n=0;n<jfgridfile.length;n++)if(a!=n&&jfgridfile[n].name==t)return jfgrid.isEditMode()?alert("标签页的名称不能重复！请重新修改"):jfgrid.tooltip.info("提示","标签页的名称不能重复！请重新修改"),void r.text(i).attr("contenteditable","false");var o,l=$(window).width(),d=0;$("#jfgrid-sheet-container-c > div.jfgrid-sheets-item:visible").each(function(){d+=$(this).outerWidth()}),.7*l<=d&&($("#jfgrid-sheet-area .jfgrid-sheets-scroll").css("display","inline-block"),$("#jfgrid-sheet-container .docs-sheet-fade-left").show()),jfgridfile[a].name=t,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,t,{k:"name"}),r.attr("contenteditable","false").removeClass("jfgrid-mousedown-cancel"),clearjfundo&&((o={type:"sheetName"}).sheetIndex=jfgrid.currentSheetIndex,o.oldtxt=i,o.txt=t,jfgrid.jfundo=[],jfgrid.jfredo.push(o))}),$("#jfgrid-sheet-area").on("keydown","span.jfgrid-sheets-item-name",function(e){var r,t=e.keyCode,i=$(this);t==keycode.ENTER&&(r=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),jfgridfile[r].name=i.text(),i.attr("contenteditable","false"))}),$("#jfgridsheetconfigrename").click(function(){jfgridsheetnameeditor(jfgridcurrentSheetitem.find("span.jfgrid-sheets-item-name")),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide()}),$("#jfgridsheetconfigshow").click(function(){$("#jfgrid-sheets-m").click(),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-rightclick-sheet-menu").hide()}),$("#jfgridsheetconfigmoveleft").click(function(){0<jfgridcurrentSheetitem.prevAll(":visible").length&&(jfgridcurrentSheetitem.insertBefore(jfgridcurrentSheetitem.prevAll(":visible").eq(0)),jfgrid.sheetmanage.reOrderAllSheet()),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide()}),$("#jfgridsheetconfigmoveright").click(function(){0<jfgridcurrentSheetitem.nextAll(":visible").length&&(jfgridcurrentSheetitem.insertAfter(jfgridcurrentSheetitem.nextAll(":visible").eq(0)),jfgrid.sheetmanage.reOrderAllSheet()),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide()}),$("#jfgridsheetconfigdelete").click(function(e){var r;$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide(),$("#jfgrid-sheet-container-c .jfgrid-sheets-item:visible").length<=1?jfgrid.isEditMode()?alert("工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。"):jfgrid.tooltip.info("工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。",""):(r=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),jfgrid.tooltip.confirm("是否删除【"+jfgridfile[r].name+"】？","<span style='color:#9e9e9e;font-size:12px;'>可以通过Ctrl+Z撤销删除</span>",function(){jfgrid.sheetmanage.deleteSheet(jfgridcurrentSheetitem.data("index"))},null),$("#jfgrid-input-box").removeAttr("style"))}),$("#jfgridsheetconfigcopy").click(function(e){jfgrid.sheetmanage.copySheet(jfgridcurrentSheetitem.data("index"),e),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide()}),$("#jfgridsheetconfighide").click(function(){1!=$("#jfgrid-sheet-area div.jfgrid-sheets-item:visible").length?(jfgrid.sheetmanage.setSheetHide(jfgridcurrentSheetitem.data("index")),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-sheet-list, #jfgrid-rightclick-sheet-menu").hide()):jfgrid.isEditMode()?alert("不能隐藏, 至少保留一个sheet标签"):jfgrid.tooltip.info("不能隐藏","至少保留一个sheet标签")}),$("#jfgrid-sheets-add").click(function(e){jfgrid.sheetmanage.addNewSheet(e),jfgrid.sheetmanage.locationSheet(),$("#jfgrid-input-box").removeAttr("style")});var sheetscrollani=null,sheetscrollstart=0,sheetscrollend=0,sheetscrollstep=150;$("#jfgrid-sheets-leftscroll").click(function(){var e=$("#jfgrid-sheet-container-c");sheetscrollstart=e.scrollLeft(),(sheetscrollend=e.scrollLeft()-sheetscrollstep)<=0&&$("#jfgrid-sheet-container .docs-sheet-fade-left").hide(),$("#jfgrid-sheet-container .docs-sheet-fade-right").show(),clearInterval(sheetscrollani),sheetscrollani=setInterval(function(){sheetscrollstart-=4,e.scrollLeft(sheetscrollstart),sheetscrollstart<=sheetscrollend&&clearInterval(sheetscrollani)},1)}),$("#jfgrid-sheets-rightscroll").click(function(){var e=$("#jfgrid-sheet-container-c");sheetscrollstart=e.scrollLeft(),sheetscrollend=e.scrollLeft()+sheetscrollstep,0<sheetscrollstart&&$("#jfgrid-sheet-container .docs-sheet-fade-right").hide(),$("#jfgrid-sheet-container .docs-sheet-fade-left").show(),clearInterval(sheetscrollani),sheetscrollani=setInterval(function(){sheetscrollstart+=4,e.scrollLeft(sheetscrollstart),sheetscrollend<=sheetscrollstart&&clearInterval(sheetscrollani)},1)});var initialOpenSheet=!0;$("#jfgrid-sheets-m").click(function(e){$("#jfgrid-sheet-list").html("");for(var r="",t=0;t<jfgridfile.length;t++){var i=jfgridfile[t],a="",n="";1==i.status&&(a='<i class="fa fa-check" aria-hidden="true"></i>'),1==i.hide&&(a='<i class="fa fa-low-vision" aria-hidden="true"></i>',n+="color:#BBBBBB;"),null!=i.color&&0<i.color.length&&(n+="border-right:4px solid "+i.color+";"),r+=jfgrid.replaceHtml(sheetselectlistitemHTML,{index:i.index,name:i.name,icon:a,style:n})}initialOpenSheet?($("#"+container).append(jfgrid.replaceHtml(sheetselectlistHTML,{item:r})),$("#jfgrid-sheet-list").on("click",".jfgrid-cols-menuitem",function(e){var r,t;jfgrid.isEditMode()?alert("图表编辑模式下不允许该操作！"):(t=(r=$(this)).data("index"),r.data("index")!=jfgrid.currentSheetIndex&&(jfgrid.sheetmanage.setSheetShow(t),jfgrid.sheetmanage.locationSheet()))}),initialOpenSheet=!1):$("#jfgrid-sheet-list").html(r),$t=$("#jfgrid-sheet-list"),mouseclickposition($t,$(this).offset().left,$(this).offset().top-12,"leftbottom"),$("#jfgrid-input-box").removeAttr("style")});var jfgridextendtable=function(type,index,value,direction){var d=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),file=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)];value=Math.floor(value);var cfg=$.extend(!0,{},config);null==cfg.merge&&(cfg.merge={});var merge_new={};for(var m in cfg.merge){var mc=cfg.merge[m],r=mc.r,c=mc.c,rs=mc.rs,cs=mc.cs;"row"==type?index<r?merge_new[r+value+"_"+c]={r:r+value,c:c,rs:rs,cs:cs}:index==r?"lefttop"==direction?merge_new[r+value+"_"+c]={r:r+value,c:c,rs:rs,cs:cs}:merge_new[r+"_"+c]={r:r,c:c,rs:rs+value,cs:cs}:merge_new[r+"_"+c]=index<r+rs-1||index==r+rs-1&&"lefttop"==direction?{r:r,c:c,rs:rs+value,cs:cs}:{r:r,c:c,rs:rs,cs:cs}:"column"==type&&(index<c?merge_new[r+"_"+(c+value)]={r:r,c:c+value,rs:rs,cs:cs}:index==c?"lefttop"==direction?merge_new[r+"_"+(c+value)]={r:r,c:c+value,rs:rs,cs:cs}:merge_new[r+"_"+c]={r:r,c:c,rs:rs,cs:cs+value}:merge_new[r+"_"+c]=index<c+cs-1||index==c+cs-1&&"lefttop"==direction?{r:r,c:c,rs:rs,cs:cs+value}:{r:r,c:c,rs:rs,cs:cs})}cfg.merge=merge_new;var calcChain=file.calcChain,newCalcChain=[];if(null!=calcChain&&0<calcChain.length)for(var i=0;i<calcChain.length;i++){var calc=$.extend(!0,{},calcChain[i]),calc_r=calc.r,calc_c=calc.c,calc_i=calc.index,calc_funcStr=calc.func[2],functionStr,functionStr;"row"==type?(functionStr="="+jfgrid.formula.functionStrChange(calc_funcStr,"add","row",direction,index,value),d[calc_r][calc_c].f==calc_funcStr&&(d[calc_r][calc_c].f=functionStr),calc.func[2]=functionStr,"lefttop"==direction?index<=calc_r&&(calc.r+=value):"rightbottom"==direction&&index<calc_r&&(calc.r+=value),newCalcChain.push(calc)):"column"==type&&(functionStr="="+jfgrid.formula.functionStrChange(calc_funcStr,"add","col",direction,index,value),d[calc_r][calc_c].f==calc_funcStr&&(d[calc_r][calc_c].f=functionStr),calc.func[2]=functionStr,"lefttop"==direction?index<=calc_c&&(calc.c+=value):"rightbottom"==direction&&index<calc_c&&(calc.c+=value),newCalcChain.push(calc))}var filter_select=file.filter_select,filter=file.filter,newFilterObj=null;if(null!=filter_select&&"{}"!=JSON.stringify(filter_select)){newFilterObj={filter_select:null,filter:null};var f_r1=filter_select.row[0],f_r2=filter_select.row[1],f_c1=filter_select.column[0],f_c2=filter_select.column[1];if("row"==type){if(f_r1<index?(f_r2==index&&"lefttop"==direction||index<f_r2)&&(f_r2+=value):f_r1!=index||"lefttop"==direction?(f_r1+=value,f_r2+=value):"rightbottom"==direction&&index<f_r2&&(f_r2+=value),null!=filter)for(var k in newFilterObj.filter={},filter){var f_rowhidden=filter[k].rowhidden,f_rowhidden_new={};for(var n in f_rowhidden)n=parseFloat(n),n<index?f_rowhidden_new[n]=0:n!=index||"lefttop"==direction?f_rowhidden_new[n+value]=0:"rightbottom"==direction&&(f_rowhidden_new[n]=0);newFilterObj.filter[k]=$.extend(!0,{},filter[k]),newFilterObj.filter[k].rowhidden=f_rowhidden_new,newFilterObj.filter[k].str=f_r1,newFilterObj.filter[k].edr=f_r2}}else if("column"==type&&(f_c1<index?(f_c2==index&&"lefttop"==direction||index<f_c2)&&(f_c2+=value):f_c1!=index||"lefttop"==direction?(f_c1+=value,f_c2+=value):"rightbottom"==direction&&index<f_c2&&(f_c2+=value),null!=filter))for(var k in newFilterObj.filter={},filter){var f_cindex=filter[k].cindex;(f_cindex==index&&"lefttop"==direction||index<f_cindex)&&(f_cindex+=value),newFilterObj.filter[f_cindex-f_c1]=$.extend(!0,{},filter[k]),newFilterObj.filter[f_cindex-f_c1].cindex=f_cindex,newFilterObj.filter[f_cindex-f_c1].stc=f_c1,newFilterObj.filter[f_cindex-f_c1].edc=f_c2}newFilterObj.filter_select={row:[f_r1,f_r2],column:[f_c1,f_c2]}}if(null!=newFilterObj&&null!=newFilterObj.filter)for(var k in cfg.rowhidden={},newFilterObj.filter){var f_rowhidden=newFilterObj.filter[k].rowhidden;for(var n in f_rowhidden)cfg.rowhidden[n]=0}else delete cfg.rowhidden;var CFarr=file.jfgrid_conditionformat_save,newCFarr=[];if(null!=CFarr&&0<CFarr.length)for(var i=0;i<CFarr.length;i++){for(var cf_range=CFarr[i].cellrange,cf_new_range=[],j=0;j<cf_range.length;j++){var CFr1=cf_range[j].row[0],CFr2=cf_range[j].row[1],CFc1=cf_range[j].column[0],CFc2=cf_range[j].column[1];"row"==type?CFr1<index?(CFr2==index&&"lefttop"==direction||index<CFr2)&&(CFr2+=value):CFr1!=index||"lefttop"==direction?(CFr1+=value,CFr2+=value):"rightbottom"==direction&&index<CFr2&&(CFr2+=value):"column"==type&&(CFc1<index?(CFc2==index&&"lefttop"==direction||index<CFc2)&&(CFc2+=value):CFc1!=index||"lefttop"==direction?(CFc1+=value,CFc2+=value):"rightbottom"==direction&&index<CFc2&&(CFc2+=value)),cf_new_range.push({row:[CFr1,CFr2],column:[CFc1,CFc2]})}var cf=$.extend(!0,{},CFarr[i]);cf.cellrange=cf_new_range,newCFarr.push(cf)}var AFarr=file.jfgrid_alternateformat_save,newAFarr=[];if(null!=AFarr&&0<AFarr.length)for(var i=0;i<AFarr.length;i++){var AFr1=AFarr[i].cellrange.row[0],AFr2=AFarr[i].cellrange.row[1],AFc1=AFarr[i].cellrange.column[0],AFc2=AFarr[i].cellrange.column[1],af=$.extend(!0,{},AFarr[i]);"row"==type?AFr1<index?(AFr2==index&&"lefttop"==direction||index<AFr2)&&(AFr2+=value):AFr1!=index||"lefttop"==direction?(AFr1+=value,AFr2+=value):"rightbottom"==direction&&index<AFr2&&(AFr2+=value):"column"==type&&(AFc1<index?(AFc2==index&&"lefttop"==direction||index<AFc2)&&(AFc2+=value):AFc1!=index||"lefttop"==direction?(AFc1+=value,AFc2+=value):"rightbottom"==direction&&index<AFc2&&(AFc2+=value)),af.cellrange={row:[AFr1,AFr2],column:[AFc1,AFc2]},newAFarr.push(af)}var newFreezen={freezenhorizontaldata:null,freezenverticaldata:null},freezen_scrollTop,freezen_row_st,freezen_top,freezen_scrollLeft,freezen_col_st,freezen_left;if(null!=jfgrid.freezen.freezenhorizontaldata&&"row"==type?(freezen_scrollTop=jfgrid.freezen.freezenhorizontaldata[2],freezen_row_st=jfgrid.freezen.freezenhorizontaldata[1]-1,(freezen_row_st==index&&"lefttop"==direction||index<freezen_row_st)&&(freezen_row_st+=value),freezen_top=visibledatarow[freezen_row_st]-2-freezen_scrollTop+columeHeaderHeight,newFreezen.freezenhorizontaldata=[visibledatarow[freezen_row_st],freezen_row_st+1,freezen_scrollTop,jfgrid.freezen.cutVolumn(visibledatarow,freezen_row_st+1),freezen_top]):newFreezen.freezenhorizontaldata=jfgrid.freezen.freezenhorizontaldata,null!=jfgrid.freezen.freezenverticaldata&&"column"==type?(freezen_scrollLeft=jfgrid.freezen.freezenverticaldata[2],freezen_col_st=jfgrid.freezen.freezenverticaldata[1]-1,(freezen_col_st==index&&"lefttop"==direction||index<freezen_col_st)&&(freezen_col_st+=value),freezen_left=visibledatacolumn[freezen_col_st]-2-freezen_scrollLeft+rowHeaderWidth,newFreezen.freezenverticaldata=[visibledatacolumn[freezen_col_st],freezen_col_st+1,freezen_scrollLeft,jfgrid.freezen.cutVolumn(visibledatacolumn,freezen_col_st+1),freezen_left]):newFreezen.freezenverticaldata=jfgrid.freezen.freezenverticaldata,"row"==type){var type1="r";if(null!=cfg.rowlen){var rowlen_new={};for(var r in cfg.rowlen)r=parseFloat(r),r<index?rowlen_new[r]=cfg.rowlen[r]:r!=index||"lefttop"==direction?rowlen_new[r+value]=cfg.rowlen[r]:"rightbottom"==direction&&(rowlen_new[r]=cfg.rowlen[r]);cfg.rowlen=rowlen_new}for(var row=[],c=0;c<d[0].length;c++)row.push(null);if(cfg.borderInfo&&0<cfg.borderInfo.length){for(var borderInfo=[],i=0;i<cfg.borderInfo.length;i++){var rangeType=cfg.borderInfo[i].rangeType,row_index;if("range"==rangeType){for(var borderRange=cfg.borderInfo[i].range,emptyRange=[],j=0,bd_obj;j<borderRange.length;j++){var bd_r1=borderRange[j].row[0],bd_r2=borderRange[j].row[1];"lefttop"==direction?index<=bd_r1?(bd_r1+=value,bd_r2+=value):index<=bd_r2&&(bd_r2+=value):index<bd_r1?(bd_r1+=value,bd_r2+=value):index<bd_r2&&(bd_r2+=value),bd_r1<=bd_r2&&emptyRange.push({row:[bd_r1,bd_r2],column:borderRange[j].column})}0<emptyRange.length&&(bd_obj={rangeType:"range",borderType:cfg.borderInfo[i].borderType,style:cfg.borderInfo[i].style,color:cfg.borderInfo[i].color,range:emptyRange},borderInfo.push(bd_obj))}else{"cell"==rangeType&&(row_index=cfg.borderInfo[i].value.row_index,"lefttop"==direction?index<=row_index&&(row_index+=value):index<row_index&&(row_index+=value),cfg.borderInfo[i].value.row_index=row_index,borderInfo.push(cfg.borderInfo[i]))}}cfg.borderInfo=borderInfo}for(var arr=[],r=0;r<value;r++)arr.push(JSON.stringify(row));"lefttop"==direction?0==index?eval("d.unshift("+arr.join(",")+")"):eval("d.splice("+index+", 0, "+arr.join(",")+")"):eval("d.splice("+(index+1)+", 0, "+arr.join(",")+")")}else{var type1="c";if(null!=cfg.columlen){var columlen_new={};for(var c in cfg.columlen)c=parseFloat(c),c<index?columlen_new[c]=cfg.columlen[c]:c!=index||"lefttop"==direction?columlen_new[c+value]=cfg.columlen[c]:"rightbottom"==direction&&(columlen_new[c]=cfg.columlen[c]);cfg.columlen=columlen_new}for(var col=[],r=0;r<d.length;r++)col.push(null);if(cfg.borderInfo&&0<cfg.borderInfo.length){for(var borderInfo=[],i=0;i<cfg.borderInfo.length;i++){var rangeType=cfg.borderInfo[i].rangeType,col_index;if("range"==rangeType){for(var borderRange=cfg.borderInfo[i].range,emptyRange=[],j=0,bd_obj;j<borderRange.length;j++){var bd_c1=borderRange[j].column[0],bd_c2=borderRange[j].column[1];"lefttop"==direction?index<=bd_c1?(bd_c1+=value,bd_c2+=value):index<=bd_c2&&(bd_c2+=value):index<bd_c1?(bd_c1+=value,bd_c2+=value):index<bd_c2&&(bd_c2+=value),bd_c1<=bd_c2&&emptyRange.push({row:borderRange[j].row,column:[bd_c1,bd_c2]})}0<emptyRange.length&&(bd_obj={rangeType:"range",borderType:cfg.borderInfo[i].borderType,style:cfg.borderInfo[i].style,color:cfg.borderInfo[i].color,range:emptyRange},borderInfo.push(bd_obj))}else{"cell"==rangeType&&(col_index=cfg.borderInfo[i].value.col_index,"lefttop"==direction?index<=col_index&&(col_index+=value):index<col_index&&(col_index+=value),cfg.borderInfo[i].value.col_index=col_index,borderInfo.push(cfg.borderInfo[i]))}}cfg.borderInfo=borderInfo}for(var r=0;r<d.length;r++)for(var row=d[r],i=0;i<value;i++)"lefttop"==direction?0==index?row.unshift(col[r]):row.splice(index,0,col[r]):row.splice(index+1,0,col[r])}jfgrid.jfrefreshgrid_adRC(d,cfg,"addRC",{index:index,len:value,direction:direction,rc:type1,restore:!1},newCalcChain,newFilterObj,newCFarr,newAFarr,newFreezen);var range=null,scrollLeft,scrollTop,winH,winW,row,row_pre,range="row"==type?"lefttop"==direction?[{row:[index,index+value-1],column:[0,d[0].length-1]}]:[{row:[index+1,index+value],column:[0,d[0].length-1]}]:"lefttop"==direction?[{row:[0,d.length-1],column:[index,index+value-1]}]:[{row:[0,d.length-1],column:[index+1,index+value]}];jfgird_select_save=range,jfgrid.selectHightlightShow(),"row"==type&&(scrollLeft=$("#jfgrid-cell-main").scrollLeft(),scrollTop=$("#jfgrid-cell-main").scrollTop(),winH=$("#jfgrid-cell-main").height(),winW=$("#jfgrid-cell-main").width(),row=visibledatarow[range[0].row[1]],row_pre=range[0].row[0]-1==-1?0:visibledatarow[range[0].row[0]-1],0<row-scrollTop-winH+20?$("#jfgrid-scrollbar-y").scrollTop(row-winH+20):row_pre-scrollTop-20<0&&$("#jfgrid-scrollbar-y").scrollTop(row_pre-20),30<value&&($("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").hide()))};jfgrid.jfgridextendtable=jfgridextendtable;var jfgridextendData=function(e,r){var t=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),i=$.extend(!0,{},config);null==i.merge&&(i.merge={});for(var a=t[0].length,n=jfgrid.datagridgrowth([],e,a),t=t.concat(n),o=0;o<r.length;o++){var l=r[o].r,d=r[o].c,f=r[o].v;jfgrid.setcellvalue(l,d,t,f),null!=f&&null!=f.mc&&null!=f.mc.rs&&(i.merge[f.mc.r+"_"+f.mc.c]=$.extend(!0,{},f.mc))}jfgrid.flowdata=t,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].data=t,config=i,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length)};jfgrid.jfgridextendData=jfgridextendData,$("#jfgrid-add-lefttop, #jfgrid-add-lefttop_t").click(function(e){var r,t;$("#jfgrid-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length?jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):(t=$(this).parent().find("input").val(),jfgrid.func_methods.isRealNum(t)?(t=parseInt(t))<1||100<t?jfgrid.isEditMode()?alert("增加错误, 增加范围限制在1-100"):jfgrid.tooltip.info("增加错误, 增加范围限制在1-100",""):(r=jfgird_select_save[0][jfgridRightHeadClickIs][0],jfgridextendtable(jfgridRightHeadClickIs,r,t,"lefttop")):jfgrid.isEditMode()?alert("增加错误, 请输入数字"):jfgrid.tooltip.info("增加错误, 请输入数字",""))}),$("#jfgrid-add-rightbottom, #jfgrid-add-rightbottom_t").click(function(e){var r,t;$("#jfgrid-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length?jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):(t=$(this).parent().find("input").val(),jfgrid.func_methods.isRealNum(t)?(t=parseInt(t))<1||100<t?jfgrid.isEditMode()?alert("增加错误, 增加范围限制在1-100"):jfgrid.tooltip.info("增加错误, 增加范围限制在1-100",""):(r=jfgird_select_save[0][jfgridRightHeadClickIs][1],jfgridextendtable(jfgridRightHeadClickIs,r,t,"rightbottom")):jfgrid.isEditMode()?alert("增加错误, 请输入数字"):jfgrid.tooltip.info("增加错误, 请输入数字",""))});var jfgriddeletetable=function(e,r,t){var i=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),a=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)],n=t-r+1,o=$.extend(!0,{},config);null==o.merge&&(o.merge={});var l={};for(var d in o.merge){var f=o.merge[d],s=f.r,g=f.c,c=f.rs,u=f.cs;"row"==e?s<r?s+c-1<r?l[s+"_"+g]={r:s,c:g,rs:c,cs:u}:r<=s+c-1&&s+c-1<t?l[s+"_"+g]={r:s,c:g,rs:r-s,cs:u}:t<=s+c-1&&(l[s+"_"+g]={r:s,c:g,rs:c-n,cs:u}):r<=s&&s<=t?t<s+c-1&&(l[r+"_"+g]={r:r,c:g,rs:s+c-1-t,cs:u}):t<s&&(l[s-n+"_"+g]={r:s-n,c:g,rs:c,cs:u}):"column"==e&&(g<r?g+u-1<r?l[s+"_"+g]={r:s,c:g,rs:c,cs:u}:r<=g+u-1&&g+u-1<t?l[s+"_"+g]={r:s,c:g,rs:c,cs:r-g}:t<=g+u-1&&(l[s+"_"+g]={r:s,c:g,rs:c,cs:u-n}):r<=g&&g<=t?t<g+u-1&&(l[s+"_"+r]={r:s,c:r,rs:c,cs:g+u-1-t}):t<g&&(l[s+"_"+(g-n)]={r:s,c:g-n,rs:c,cs:u}))}o.merge=l;var m=a.calcChain,h=[];if(null!=m&&0<m.length)for(var j=0;j<m.length;j++){var p,v=$.extend(!0,{},m[j]),b=v.r,_=v.c,w=(v.index,v.func[2]);"row"==e?(b<r||t<b)&&(p="="+jfgrid.formula.functionStrChange(w,"del","row",null,r,n),i[b][_].f==w&&(i[b][_].f=p),v.func[2]=p,t<b&&(v.r=b-n),h.push(v)):"column"==e&&(_<r||t<_)&&(p="="+jfgrid.formula.functionStrChange(w,"del","col",null,r,n),i[b][_].f==w&&(i[b][_].f=p),v.func[2]=p,t<_&&(v.c=_-n),h.push(v))}var y=a.filter_select,x=a.filter,C=null;if(null!=y&&"{}"!=JSON.stringify(y)){C={filter_select:null,filter:null};var T=y.row[0],I=y.row[1],R=y.column[0],k=y.column[1];if("row"==e){if(t<T?(T-=n,I-=n,C.filter_select={row:[T,I],column:[R,k]}):T<r&&(I<r||(I<=t?I=r-1:I-=n),C.filter_select={row:[T,I],column:[R,k]}),null!=C.filter_select&&null!=x)for(var S in x){var A=x[S].rowhidden,F={};for(var N in A)N<r?F[N]=0:t<N&&(F[N-n]=0);"{}"!=JSON.stringify(F)&&(null==C.filter&&(C.filter={}),C.filter[S]=$.extend(!0,{},x[S]),C.filter[S].rowhidden=F,C.filter[S].str=T,C.filter[S].edr=I)}}else if("column"==e&&(t<R?(R-=n,k-=n,C.filter_select={row:[T,I],column:[R,k]}):R<r?(k<r||(k<=t?k=r-1:k-=n),C.filter_select={row:[T,I],column:[R,k]}):t<k&&(R=r,k-=n,C.filter_select={row:[T,I],column:[R,k]}),null!=C.filter_select&&null!=x))for(var S in x){var M=x[S].cindex;M<r?(null==C.filter&&(C.filter={}),C.filter[M-R]=$.extend(!0,{},x[S]),C.filter[M-R].edc=k):t<M&&(M-=n,null==C.filter&&(C.filter={}),C.filter[M-R]=$.extend(!0,{},x[S]),C.filter[M-R].cindex=M,C.filter[M-R].stc=R,C.filter[M-R].edc=k)}}if(null!=C&&null!=C.filter)for(var S in o.rowhidden={},C.filter){A=C.filter[S].rowhidden;for(var N in A)o.rowhidden[N]=0}else delete o.rowhidden;var E=a.jfgrid_conditionformat_save,O=[];if(null!=E&&0<E.length)for(j=0;j<E.length;j++){for(var z,D=E[j].cellrange,P=[],L=0;L<D.length;L++){var B=D[L].row[0],q=D[L].row[1],H=D[L].column[0],V=D[L].column[1];"row"==e?r<=B&&q<=t||(t<B?(B-=n,q-=n):B<r?q<r||(q<=t?q=r-1:q-=n):t<q&&(B=r,q-=n),P.push({row:[B,q],column:[H,V]})):"column"==e&&(r<=H&&V<=t||(t<H?(H-=n,V-=n):H<r?V<r||(V<=t?V=r-1:V-=n):t<V&&(H=r,V-=n),P.push({row:[B,q],column:[H,V]})))}0<P.length&&((z=$.extend(!0,{},E[j])).cellrange=P,O.push(z))}var U=a.jfgrid_alternateformat_save,Y=[];if(null!=U&&0<U.length)for(j=0;j<U.length;j++){var W,G=U[j].cellrange.row[0],X=U[j].cellrange.row[1],Z=U[j].cellrange.column[0],K=U[j].cellrange.column[1];"row"==e?r<=G&&X<=t||(t<G?(G-=n,X-=n):G<r?X<r||(X<=t?X=r-1:X-=n):t<X&&(G=r,X-=n),(W=$.extend(!0,{},U[j])).cellrange={row:[G,X],column:[Z,K]},Y.push(W)):"column"==e&&(r<=Z&&K<=t||(t<Z?(Z-=n,K-=n):Z<r?K<r||(K<=t?K=r-1:K-=n):t<K&&(Z=r,K-=n),(W=$.extend(!0,{},U[j])).cellrange={row:[G,X],column:[Z,K]},Y.push(W)))}var J,Q,ee,re,te,ie,ae,ne,oe={freezenhorizontaldata:null,freezenverticaldata:null};if(null!=jfgrid.freezen.freezenhorizontaldata&&"row"==e?(J=jfgrid.freezen.freezenhorizontaldata[2],-1==(Q=jfgrid_searcharray(visibledatarow,J))&&(Q=0),r<=(ee=jfgrid.freezen.freezenhorizontaldata[1]-1)&&(ee<t?ee=r-1:ee-=n),ee<Q&&(ee=Q),re=visibledatarow[ee]-2-J+columeHeaderHeight,oe.freezenhorizontaldata=[visibledatarow[ee],ee+1,J,jfgrid.freezen.cutVolumn(visibledatarow,ee+1),re]):oe.freezenhorizontaldata=jfgrid.freezen.freezenhorizontaldata,null!=jfgrid.freezen.freezenverticaldata&&"column"==e?(te=jfgrid.freezen.freezenverticaldata[2],-1==(ie=jfgrid_searcharray(visibledatacolumn,te))&&(ie=0),r<=(ae=jfgrid.freezen.freezenverticaldata[1]-1)&&(ae<t?ae=r-1:ae-=n),ae<ie&&(ae=ie),ne=visibledatacolumn[ae]-2-te+rowHeaderWidth,oe.freezenverticaldata=[visibledatacolumn[ae],ae+1,te,jfgrid.freezen.cutVolumn(visibledatacolumn,ae+1),ne]):oe.freezenverticaldata=jfgrid.freezen.freezenverticaldata,"row"==e){var le="r";null==o.rowlen&&(o.rowlen={});var de={};for(var s in o.rowlen)s<r?de[s]=o.rowlen[s]:t<s&&(de[s-n]=o.rowlen[s]);if(o.rowlen=de,o.borderInfo&&0<o.borderInfo.length){for(var fe,se=[],j=0;j<o.borderInfo.length;j++){if("range"==(pe=o.borderInfo[j].rangeType)){for(var ge=o.borderInfo[j].range,ce=[],L=0;L<ge.length;L++){for(var ue=ge[L].row[0],me=ge[L].row[1],s=r;s<=t;s++)s<ge[L].row[0]?(--ue,--me):s<=ge[L].row[1]&&--me;ue<=me&&ce.push({row:[ue,me],column:ge[L].column})}0<ce.length&&(be={rangeType:"range",borderType:o.borderInfo[j].borderType,style:o.borderInfo[j].style,color:o.borderInfo[j].color,range:ce},se.push(be))}else{"cell"==pe&&((fe=o.borderInfo[j].value.row_index)<r?se.push(o.borderInfo[j]):t<fe&&(o.borderInfo[j].value.row_index=fe-(t-r+1),se.push(o.borderInfo[j])))}}o.borderInfo=se}if(i.splice(r,n),!jfgridConfigsetting.pointEdit){for(var he=[],g=0;g<i[0].length;g++)he.push(null);for(s=0;s<n;s++)i.push(he)}}else{le="c";null==o.columlen&&(o.columlen={});var je={};for(var g in o.columlen)g<r?je[g]=o.columlen[g]:t<g&&(je[g-n]=o.columlen[g]);if(o.columlen=je,o.borderInfo&&0<o.borderInfo.length){for(var pe,ve,se=[],j=0;j<o.borderInfo.length;j++){if("range"==(pe=o.borderInfo[j].rangeType)){for(var be,ge=o.borderInfo[j].range,ce=[],L=0;L<ge.length;L++){for(var _e=ge[L].column[0],we=ge[L].column[1],g=r;g<=t;g++)g<ge[L].column[0]?(--_e,--we):g<=ge[L].column[1]&&--we;_e<=we&&ce.push({row:ge[L].row,column:[_e,we]})}0<ce.length&&(be={rangeType:"range",borderType:o.borderInfo[j].borderType,style:o.borderInfo[j].style,color:o.borderInfo[j].color,range:ce},se.push(be))}else{"cell"==pe&&((ve=o.borderInfo[j].value.col_index)<r?se.push(o.borderInfo[j]):t<ve&&(o.borderInfo[j].value.col_index=ve-(t-r+1),se.push(o.borderInfo[j])))}}o.borderInfo=se}var ye=[];if(!jfgridConfigsetting.pointEdit)for(s=0;s<n;s++)ye.push(null);for(s=0;s<i.length;s++){(he=[].concat(i[s])).splice(r,n),i[s]=he.concat(ye)}}jfgrid.jfrefreshgrid_adRC(i,o,"delRC",{index:r,len:t-r+1,rc:le},h,C,O,Y,oe)};jfgrid.jfgriddeletetable=jfgriddeletetable,$("#jfgrid-del-selected, #jfgrid-del-selected_t").click(function(e){var r,t;$("#jfgrid-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length?"row"!=jfgridRightHeadClickIs&&"column"!=jfgridRightHeadClickIs||(jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","")):(r=jfgird_select_save[0][jfgridRightHeadClickIs][0],t=jfgird_select_save[0][jfgridRightHeadClickIs][1],jfgriddeletetable(jfgridRightHeadClickIs,r,t))}),$("#jfgrid-delete-text").click(function(){if($("#jfgrid-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus(),0<jfgird_select_save.length){for(var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=!1,t=0;t<jfgird_select_save.length;t++){var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1];if(jfgrid.hasPartMC(config,i,a,n,o)){r=!0;break}}if(r)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""));for(t=0;t<jfgird_select_save.length;t++)for(var i=jfgird_select_save[t].row[0],a=jfgird_select_save[t].row[1],n=jfgird_select_save[t].column[0],o=jfgird_select_save[t].column[1],l=i;l<=a;l++)for(var d=n;d<=o;d++)jfgrid.pivotTable.isPivotRange(l,d)||("object"==jfgrid.getObjType(e[l][d])?(delete e[l][d].m,delete e[l][d].v,null!=e[l][d].f&&(delete e[l][d].f,jfgrid.formula.delFunctionGroup(l,d,jfgrid.currentSheetIndex),delete e[l][d].spl)):e[l][d]=null);jfgrid.jfrefreshgrid(e,jfgird_select_save)}}),$("#jfgrid-rows-cols-changesize").click(function(){$("#jfgrid-rightclick-menu").hide(),$("#"+container).attr("tabindex",0).focus();var e=parseInt($(this).siblings("input[type='number']").val().trim());if(e<0||255<e)jfgrid.isEditMode()?alert("数值必须在0 ~ 255之间"):jfgrid.tooltip.info("数值必须在0 ~ 255之间","");else{var r,t=$.extend(!0,{},config);if("row"==jfgridRightHeadClickIs){r="resizeR",null==t.rowlen&&(t.rowlen={});for(var i=0;i<jfgird_select_save.length;i++)for(var a=jfgird_select_save[i].row[0],n=jfgird_select_save[i].row[1],o=a;o<=n;o++)t.rowlen[o]=e}else if("column"==jfgridRightHeadClickIs){r="resizeC",null==t.columlen&&(t.columlen={});for(i=0;i<jfgird_select_save.length;i++)for(var l=jfgird_select_save[i].column[0],d=jfgird_select_save[i].column[1],f=l;f<=d;f++)t.columlen[f]=e}clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:"resize",ctrlType:r,config:$.extend(!0,{},config),curconfig:$.extend(!0,{},t),sheetIndex:jfgrid.currentSheetIndex})),config=t,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,"row"==jfgridRightHeadClickIs?(jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,t.rowlen,{k:"rowlen"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,null)):"column"==jfgridRightHeadClickIs&&(jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,t.columlen,{k:"columlen"}),jfgrid.jfrefreshgrid_rhcw(null,jfgrid.flowdata[0].length))}});var jfgrid_sort_existSort={},jfgrid_sort_initial=!0,jfgrid_model_move_state=!1,jfgrid_model_xy=[0,0],jfgrid_model_move_obj=null;$(document).on("mousedown","div.jfgrid-modal-dialog",function(e){var r;$(e.target).is(".jfgrid-modal-dialog")&&(jfgrid_model_move_state=!0,r=(jfgrid_model_move_obj=$(e.currentTarget)).offset(),jfgrid_model_xy=[e.pageX-r.left,e.pageY-r.top])}),$(document).on("click",".jfgrid-modal-dialog-title-close, .jfgrid-model-close-btn",function(e){($("#textcolorselect").is(":visible")||$("#cellcolorselect").is(":visible"))&&$("#jfgrid-conditionformat-dialog").show(),$(e.currentTarget).parents(".jfgrid-modal-dialog").hide(),$("#jfgrid-modal-dialog-mask").hide(),$(this).parents(".jfgrid-modal-dialog").hasClass("jfgrid-search-formula")&&(jfgrid.formula.dontupdate(),jfgridMoveHighlightCell("down",0,"rangeOfSelect")),$(this).parents(".jfgrid-modal-dialog").hasClass("jfgrid-search-formula-parm")&&(jfgrid.formula.dontupdate(),jfgridMoveHighlightCell("down",0,"rangeOfSelect")),$(this).parents(".jfgrid-modal-dialog").hasClass("jfgrid-search-formula-parm-select")&&(jfgrid.formula.dontupdate(),jfgridMoveHighlightCell("down",0,"rangeOfSelect")),$("#"+container).attr("tabindex",0).focus()}),$("#jfgridorderby").click(function(){if($("body .jfgrid-cols-menu").hide(),1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","");else{var e=jfgird_select_save[0],a=e.row[0],r=e.row[1],n=e.column[0],o=e.column[1];jfgrid_sort_initial&&(jfgrid_sort_initial=!1,$("body").append(jfgrid.replaceHtml(modelHTML,{id:"jfgrid-sort-dialog",addclass:"",title:"排序范围",content:'<div style="overflow: hidden;" class="jfgrid-sort-modal"><div><label><input type="checkbox" id="jfgrid-sort-haveheader"/><span>数据具有标题行</span></label></div><div style="overflow-y:auto;" id="jfgrid-sort-dialog-tablec"><table data-itemcount="0" cellspacing="0"> <tr><td>排序依据 <select name="sort_0"> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> </select> </td> <td> <div><label><input value="asc" type="radio" checked="checked" name="sort_0"><span>正序A-Z</span></label></div> <div><label><input value="desc" type="radio" name="sort_0"><span>倒序Z-A</span></label></div></td></tr></table></div><div style="background: #e5e5e5;border-top: 1px solid #f5f5f5; height: 1px; width: 100%;margin:2px 0px;margin-bottom:10px;"></div> <div> <span style="font-weight: bold; text-decoration: underline;text-align:center;color: blue;cursor: pointer;" class="jfgrid-sort-dialog-additem">+ 添加其他排序列</span> </div> </div>',botton:'<button id="jfgrid-sort-modal-confirm" class="btn btn-primary">排序</button><button class="btn btn-default jfgrid-model-close-btn">关闭</button>'})),$("#jfgrid-sort-dialog .jfgrid-sort-dialog-additem").click(function(){for(var e,r=jfgird_select_save[0],t=r.row[0],i=(r.row[1],r.column[0]),a=r.column[1],n="",o=$("#jfgrid-sort-dialog table").data("itemcount")+1,l=$("#jfgrid-sort-haveheader").is(":checked"),d=i;d<=a;d++){l?(null==(e=jfgrid.getcellvalue(t,d,jfgrid.flowdata,"m"))&&(e="列"+(d-i+1)),n+='<option value="'+d+'">'+e+"</option>"):n+='<option value="'+d+'">'+jfgrid.jfgridchatatABC(d)+"</option>"}$("#jfgrid-sort-dialog table").append('<tr class="jfgrid-sort-dialog-tr"><td><span class="jfgrid-sort-item-close" onclick="$(this).parent().parent().remove();"><i class="fa fa-times" aria-hidden="true"></i></span>次要排序 <select name="sort_'+o+'">'+n+'</select> </td> <td> <div><label><input value="asc" type="radio" checked="checked" name="sort_'+o+'"><span>正序A-Z</span></label></div> <div><label><input value="desc" type="radio" name="sort_'+o+'"><span>倒序Z-A</span></label></div></td></tr>'),$("#jfgrid-sort-dialog table").data("itemcount",o)}),$("#jfgrid-sort-haveheader").change(function(){for(var e,r=jfgird_select_save[0],t=r.row[0],i=(r.row[1],r.column[0]),a=r.column[1],n=$(this).is(":checked"),o="",l=i;l<=a;l++){n?(null==(e=jfgrid.getcellvalue(t,l,jfgrid.flowdata,"m"))&&(e="列"+(l-i+1)),o+='<option value="'+l+'">'+e+"</option>"):o+='<option value="'+l+'">'+jfgrid.jfgridchatatABC(l)+"</option>"}$("#jfgrid-sort-dialog tr select").each(function(){$(this).html(o)})}),$("#jfgrid-sort-modal-confirm").click(function(){if(1<jfgird_select_save.length)jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试","");else{for(var e,r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),t=jfgird_select_save[0],i=t.row[0],a=t.row[1],n=t.column[0],o=t.column[1],l=$("#jfgrid-sort-haveheader").is(":checked"),d=!1,f=[],s=e=l?i+1:i;s<=a;s++){for(var g=[],c=n;c<=o;c++){if(null!=r[s][c]&&null!=r[s][c].mc){d=!0;break}g.push(r[s][c])}f.push(g)}if(d)jfgrid.isEditMode()?alert("选区有合并单元格，无法执行此操作！"):jfgrid.tooltip.info("选区有合并单元格，无法执行此操作！","");else{$($("#jfgrid-sort-dialog table tr").toArray().reverse()).each(function(){var e=$(this).find("select").val(),r=$(this).find("input:radio:checked").val();e-=n,r="asc"==r,f=jfgrid.orderbydata([].concat(f),e,r)});for(var u,s=e;s<=a;s++)for(c=n;c<=o;c++)r[s][c]=f[s-e][c-n];null!=config.rowlen?(u=$.extend(!0,{},config),u=jfgrid.rowlenByRange(r,e,a,u),jfgrid.jfrefreshgrid(r,[{row:[e,a],column:[n,o]}],u,null,!0)):jfgrid.jfrefreshgrid(r,[{row:[e,a],column:[n,o]}]),$("#jfgrid-sort-dialog").hide(),$("#jfgrid-modal-dialog-mask").hide()}}}));for(var t="",i=n;i<=o;i++)t+='<option value="'+i+'">'+jfgrid.jfgridchatatABC(i)+"</option>";$("#jfgrid-sort-dialog select").html(t),$("#jfgrid-sort-dialog .jfgrid-sort-dialog-tr").remove(),$("#jfgrid-sort-haveheader").prop("checked",!1),$("#jfgrid-sort-dialog input:radio:first").prop("checked","checked"),$("#jfgrid-sort-dialog .jfgrid-modal-dialog-title-text").html("排序范围从<span>"+jfgrid.jfgridchatatABC(n)+(a+1)+"</span>到<span>"+jfgrid.jfgridchatatABC(o)+(r+1)+"</span>");var l=$("#jfgrid-sort-dialog"),d=l.outerHeight(),f=l.outerWidth(),s=$(window).width(),g=$(window).height(),c=$(document).scrollLeft(),u=$(document).scrollTop();$("#jfgrid-sort-dialog-tablec").css("max-height",(g-d)/2),$("#jfgrid-sort-dialog").css({left:(s+c-f)/2,top:(g+u-d)/2}).show(),$("#jfgrid-modal-dialog-mask").show(),a<r&&setTimeout(function(){for(var e=jfgrid.flowdata[a],r=jfgrid.flowdata[a+1],t=!1,i=n;i<=o;i++){jfgrid.isdatatype(e[i])!=jfgrid.isdatatype(r[i])&&(t=!0)}t&&$("#jfgrid-sort-haveheader").prop("checked",!0).change()},10)}});var hidefilersubmenu=null;$("#jfgrid-filter-menu").mouseover(function(){clearTimeout(hidefilersubmenu),hidefilersubmenu=setTimeout(function(){$("#jfgrid-filter-submenu").hide()},500)}),$("#jfgrid-filter-submenu").mouseover(function(){clearTimeout(hidefilersubmenu)}).find(".jfgrid-cols-menuitem").click(function(e){$("#jfgrid-filter-selected span").html($(this).find(".jfgrid-cols-menuitem-content").text()).data("value",$(this).data("value")),$("#jfgrid-filter-menu .jfgrid-filter-selected-input").hide();var r=$(this).data("type"),t=$(this).attr("data-value");"2"==r?($("#jfgrid-filter-selected span").data("type","2"),$("#jfgrid-filter-menu .jfgrid-filter-selected-input2").show(),$("#jfgrid-filter-menu .jfgrid-filter-selected-input input").prop("type","number")):"0"==r?$("#jfgrid-filter-selected span").data("type","0"):($("#jfgrid-filter-selected span").data("type","1"),$("#jfgrid-filter-menu .jfgrid-filter-selected-input").eq(0).show(),"dateequal"==t||"datelessthan"==t||"datemorethan"==t?$("#jfgrid-filter-menu .jfgrid-filter-selected-input input").prop("type","date"):"morethan"==t||"moreequalthan"==t||"lessthan"==t||"lessequalthan"==t||"equal"==t||"noequal"==t?$("#jfgrid-filter-menu .jfgrid-filter-selected-input input").prop("type","number"):$("#jfgrid-filter-menu .jfgrid-filter-selected-input input").prop("type","text")),$("#jfgrid-filter-byvalue").next().slideUp(),$("#jfgrid-filter-submenu").hide()}),$("#jfgrid-filter-bycondition, #jfgrid-filter-byvalue").click(function(){var e=$(this);e.next().slideToggle(200),setTimeout(function(){"jfgrid-filter-bycondition"==e.attr("id")&&$("#jfgrid-filter-bycondition").next().is(":visible")&&"无"!=$("#jfgrid-filter-selected span").text()&&$("#jfgrid-filter-byvalue").next().slideUp(200),e.is($("#jfgrid-filter-bycondition"))&&$("#jfgrid-filter-bycondition").next().is(":hidden")&&$("#jfgrid-filter-byvalue").next().is(":hidden")&&$("#jfgrid-filter-byvalue").next().slideDown(200)},300)}),$("#jfgrid-filter-cancel").click(function(){$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide()}),$("#jfgrid-filter-confirm").click(function(){var e=$("#jfgrid-filter-menu"),r=e.data("str"),t=e.data("edr"),i=e.data("cindex"),a=e.data("stc"),n=e.data("edc"),o={};$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").not($("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").eq(i-a).get(0)).each(function(){var e=$(this).data("rowhidden");if(""==e)return!0;for(var r in e=JSON.parse(e.replace(/\'/g,'"')))o[r]=0});var l={},d={},f={};if($("#jfgrid-filter-bycondition").next().is(":visible")&&$("#jfgrid-filter-byvalue").next().is(":hidden")&&"null"!=$("#jfgrid-filter-selected span").data("value")){var s,g=$("#jfgrid-filter-selected span"),c=g.data("type"),u=g.data("value");f.value=u,f.text=g.text(),"0"==c?f.type="0":"2"==c?(s=$("#jfgrid-filter-menu .jfgrid-filter-selected-input2 input"),f.type="2",f.value1=s.eq(0).val(),f.value2=s.eq(1).val()):(f.type="1",f.value1=$("#jfgrid-filter-menu .jfgrid-filter-selected-input").eq(0).find("input").val());for(var m,h,j,p,v,b=r+1;b<=t;b++){b in o||null!=jfgrid.flowdata[b]&&(_=jfgrid.flowdata[b][i],"cellnull"==u?null==_||jfgrid.func_methods.isRealNull(_.v)||(d[b]=0):"cellnonull"==u?null!=_&&!jfgrid.func_methods.isRealNull(_.v)||(d[b]=0):"textinclude"==u?(h=f.value1,null!=_&&!jfgrid.func_methods.isRealNull(_.v)&&-1!=_.m.indexOf(h)||(d[b]=0)):"textnotinclude"==u?(h=f.value1,null==_||jfgrid.func_methods.isRealNull(_.v)||-1<_.m.indexOf(h)&&(d[b]=0)):"textstart"==u?(m=(h=f.value1).length,null!=_&&!jfgrid.func_methods.isRealNull(_.v)&&_.m.substr(0,m)==h||(d[b]=0)):"textend"==u?(m=(h=f.value1).length,(null==_||jfgrid.func_methods.isRealNull(_.v)||m>_.m.length||_.m.substr(_.m.length-m,m)!=h)&&(d[b]=0)):"textequal"==u?(h=f.value1,null!=_&&!jfgrid.func_methods.isRealNull(_.v)&&_.m==h||(d[b]=0)):"dateequal"==u?(h=jfgrid.mask.genarate(f.value1)[2],null!=_&&!jfgrid.func_methods.isRealNull(_.v)&&null!=_.ct&&"d"==_.ct.t&&parseInt(_.v)==h||(d[b]=0)):"datelessthan"==u?(h=jfgrid.mask.genarate(f.value1)[2],(null==_||jfgrid.func_methods.isRealNull(_.v)||null==_.ct||"d"!=_.ct.t||parseInt(_.v)>=h)&&(d[b]=0)):"datemorethan"==u?(h=jfgrid.mask.genarate(f.value1)[2],(null==_||jfgrid.func_methods.isRealNull(_.v)||null==_.ct||"d"!=_.ct.t||parseInt(_.v)<=h)&&(d[b]=0)):"morethan"==u?(h=parseFloat(f.value1),(null==_||jfgrid.func_methods.isRealNull(_.v)||null==_.ct||"n"!=_.ct.t||_.v<=h)&&(d[b]=0)):"moreequalthan"==u?(h=parseFloat(f.value1),(null==_||jfgrid.func_methods.isRealNull(_.v)||null==_.ct||"n"!=_.ct.t||_.v<h)&&(d[b]=0)):"lessthan"==u?(h=parseFloat(f.value1),(null==_||jfgrid.func_methods.isRealNull(_.v)||null==_.ct||"n"!=_.ct.t||_.v>=h)&&(d[b]=0)):"lessequalthan"==u?(h=parseFloat(f.value1),(null==_||jfgrid.func_methods.isRealNull(_.v)||null==_.ct||"n"!=_.ct.t||_.v>h)&&(d[b]=0)):"equal"==u?(h=parseFloat(f.value1),null!=_&&!jfgrid.func_methods.isRealNull(_.v)&&null!=_.ct&&"n"==_.ct.t&&_.v==h||(d[b]=0)):"noequal"==u?(h=parseFloat(f.value1),null!=_&&!jfgrid.func_methods.isRealNull(_.v)&&null!=_.ct&&"n"==_.ct.t&&_.v!=h||(d[b]=0)):"include"==u?((h=parseFloat(f.value1))<(j=parseFloat(f.value2))?(v=h,p=j):(p=h,v=j),(null==_||jfgrid.func_methods.isRealNull(_.v)||null==_.ct||"n"!=_.ct.t||_.v<v||_.v>p)&&(d[b]=0)):"noinclude"==u&&((h=parseFloat(f.value1))<(j=parseFloat(f.value2))?(v=h,p=j):(p=h,v=j),(null==_||jfgrid.func_methods.isRealNull(_.v)||null==_.ct||"n"!=_.ct.t||_.v>=v&&_.v<=p)&&(d[b]=0)))}}else{$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']").each(function(e,r){return!(!$(r).is(":visible")||!$(r).is(":checked"))||(0<$(r).closest(".day").length&&(t=$(r).siblings("label").text(),Number(t)<10&&(t="0"+Number(t)),i=$(r).closest(".monthBox").find(".month label").text().replace("月",""),Number(i)<10&&(i="0"+Number(i)),a=$(r).closest(".yearBox").find(".year label").text().replace("年",""),l[n="日期格式#$$$#"+a+"-"+i+"-"+t]="1"),void(0<$(r).closest(".textBox").length&&(n=$(r).closest(".textBox").data("filter"),l[n]="1")));var t,i,a,n});for(var _,b=r+1;b<=t;b++){b in o||null!=jfgrid.flowdata[b]&&(u=null==(_=jfgrid.flowdata[b][i])||jfgrid.func_methods.isRealNull(_.v)?"null#$$$#null":null!=_.ct&&"d"==_.ct.t?"日期格式#$$$#"+jfgrid.mask.update("YYYY-MM-DD",_.v):_.v+"#$$$#"+_.m)in l&&(d[b]=0)}}var w=$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").eq(i-a),y=$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']:visible:checked").length<$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']:visible").length||0<$("#jfgrid-filter-byvalue-input").val().length||$("#jfgrid-filter-bycondition").next().is(":visible")&&$("#jfgrid-filter-byvalue").next().is(":hidden")&&"null"!=$("#jfgrid-filter-selected span").data("value"),x=$.extend(!0,o,d),C=jfgrid.json.parseJsonParm(w.data("rowhidden"));jfgrid.labelFilterOptionState(w,y,d,f,!0,r,t,i,a,n);var T,I=$.extend(!0,{},config);I.rowhidden=x,clearjfundo&&((T={type:"datachangeAll_filter"}).sheetIndex=jfgrid.currentSheetIndex,T.config=$.extend(!0,{},config),T.curconfig=I,T.optionstate=y,T.optionsindex=i-a,T.rowhidden=$.extend(!0,{},d),T.rowhidenPre=$.extend(!0,{},C),null!=f&&(T.caljs=f),jfgrid.jfundo=[],jfgrid.jfredo.push(T)),config=I,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,I.rowhidden,{k:"rowhidden"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide(),jfgrid.cleargridelement()}),jfgrid.json={parseJsonParm:function(obj){if(null==obj)return{};if("string"!=jfgrid.getObjType(obj))return obj;try{var json=eval("("+obj+")");return json}catch(e){return{}}},hasKey:function(e){var r=this.parseJsonParm(e);for(var t in r)return!0;return!1}},jfgrid.labelFilterOptionState=function(e,r,t,i,a,n,o,l,d,f){var s,g;r?(e.addClass("jfgrid-filter-options-active").data("rowhidden",JSON.stringify(t)).data("caljs",JSON.stringify(i)).html('<i class="fa fa-filter jfgrid-mousedown-cancel" aria-hidden="true"></i>'),null!=i&&(e.data("byconditionvalue",i.value).data("byconditiontype",i.type).data("byconditiontext",i.text),null!=i.value1&&e.data("byconditionvalue1",i.value1),null!=i.value2&&e.data("byconditionvalue2",i.value2))):(e.removeClass("jfgrid-filter-options-active").data("rowhidden","").data("caljs","").html('<i class="fa fa-caret-down jfgrid-mousedown-cancel" aria-hidden="true"></i>'),e.data("byconditionvalue","null").data("byconditiontype","0").data("byconditiontext","无").data("byconditionvalue1","").data("byconditionvalue2","")),a&&(null==(s=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)]).filter&&(s.filter={}),r?(g={caljs:i,rowhidden:t,optionstate:r,str:n,edr:o,cindex:l,stc:d,edc:f},s.filter[l-d]=g):delete s.filter[l-d],jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,s.filter,{k:"filter"}))},$("#jfgrid-filter-selected").click(function(){var e=$(this).offset(),r=$("#jfgrid-filter-submenu");r.hide();var t=$(window).height(),i=$(window).width(),a=r.width(),n=(r.height(),e.top),o=e.left,l=t-e.top-20;e.left+a>i&&(o=e.left-a),e.top>t/2&&((n=t-e.top)<0&&(n=0),l=e.top-20),r.css({top:n,left:o,height:l}).show(),clearTimeout(hidefilersubmenu)});var orderbydatafiler=function(e,r,t,i,a,n){for(var o=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),l=!1,d=[],f=e+=1;f<=t;f++){for(var s=[],g=r;g<=i;g++){if(null!=o[f][g]&&null!=o[f][g].mc){l=!0;break}s.push(o[f][g])}d.push(s)}if(l)jfgrid.isEditMode()?alert("筛选选区有合并单元格，无法执行此操作！"):jfgrid.tooltip.info("筛选选区有合并单元格，无法执行此操作！","");else{d=jfgrid.orderbydata(d,a-r,n);for(var c,f=e;f<=t;f++)for(g=r;g<=i;g++)o[f][g]=d[f-e][g-r];null!=config.rowlen?(c=$.extend(!0,{},config),c=jfgrid.rowlenByRange(o,e,t,c),jfgrid.jfrefreshgrid(o,[{row:[e,t],column:[r,i]}],c,null,!0)):jfgrid.jfrefreshgrid(o,[{row:[e,t],column:[r,i]}])}};jfgrid.createFilter=function(){if(1<jfgird_select_save.length)return $("#jfgrid-rightclick-menu").hide(),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide(),$("#"+container).attr("tabindex",0).focus(),void(jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""));if(!jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].isPivotTable){$("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex+", #jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).remove();var e=jfgird_select_save[0];if(e.row[0]==e.row[1]&&e.column[0]==e.column[1]){for(var r,t,i=e.row[1],a=0;a<jfgrid.flowdata[i].length;a++){var n=jfgrid.flowdata[i][a];if(null==n||jfgrid.func_methods.isRealNull(n.v)){if(null!=r){t=a-1;break}}else null==r&&(r=a)}null==t&&(t=jfgrid.flowdata[i].length-1),jfgird_select_save=[{row:[i,i],column:[r,t]}],jfgrid.selectHightlightShow(),jfgrid.jfgrid_shiftpositon=$.extend(!0,{},e),jfgridMoveEndCell("down","range")}else e.row[1]-e.row[0]<2&&(jfgrid.jfgrid_shiftpositon=$.extend(!0,{},e),jfgridMoveEndCell("down","range"));jfgird_filter_save=$.extend(!0,{},jfgird_select_save[0]),jfgrid.createFilterOptions(jfgird_filter_save),jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,jfgird_filter_save,{k:"filter_select"}),filterchage&&jfgrid.jfredo.push({type:"filtershow",data:[],curdata:[],sheetIndex:jfgrid.currentSheetIndex,filter_save:jfgird_filter_save})}},jfgrid.createFilterOptions=function(e,r){if($("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex).remove(),$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).remove(),null!=e&&"{}"!=JSON.stringify(e)){var t=e.row[0],i=e.row[1],a=e.column[0],n=e.column[1],o=visibledatarow[i],l=t-1==-1?0:visibledatarow[t-1],d=visibledatacolumn[n],f=a-1==-1?0:visibledatacolumn[a-1],s='<div id="jfgrid-filter-selected-sheet'+jfgrid.currentSheetIndex+'" class="jfgrid-cell-selected jfgrid-filter-selected"  style="left:'+f+"px;width:"+(d-f-1)+"px;top:"+l+"px;height:"+(o-l-1)+'px;display:block;border-color:#897BFF;z-index:20;background:none;"></div>';$("#jfgrid-cell-main").append(s);for(var g,c,u,m="",h=a;h<=n;h++){null==r||null==r[h-a]?m+='<div data-rowhidden="" data-str="'+t+'" data-edr="'+i+'" data-cindex="'+h+'" data-stc="'+a+'" data-edc="'+n+'" class="jfgrid-filter-options" style="left:'+(visibledatacolumn[h]-20)+"px;top:"+l+'px;display:block;"><i class="fa fa-caret-down" aria-hidden="true"></i></div>':(u=null!=r[h-a].caljs?(g=null!=r[h-a].caljs.value1?'data-byconditionvalue1="'+r[h-a].caljs.value1+'" ':"",c=null!=r[h-a].caljs.value2?'data-byconditionvalue2="'+r[h-a].caljs.value2+'" ':"",'data-caljs="'+JSON.stringify(r[h-a].caljs)+'" data-byconditionvalue="'+r[h-a].caljs.value+'" data-byconditiontype="'+r[h-a].caljs.type+'" data-byconditiontext="'+r[h-a].caljs.text+'" '+g+c):"",m+='<div data-rowhidden="'+JSON.stringify(r[h-a].rowhidden).replace(/\"/g,"'")+'" '+u+' data-str="'+t+'" data-edr="'+i+'" data-cindex="'+h+'" data-stc="'+a+'" data-edc="'+n+'" class="jfgrid-filter-options jfgrid-filter-options-active" style="left:'+(visibledatacolumn[h]-20)+"px;top:"+l+'px;display:block;"><i class="fa fa-filter jfgrid-mousedown-cancel" aria-hidden="true"></i></div>')}$("#jfgrid-cell-main").append('<div id="jfgrid-filter-options-sheet'+jfgrid.currentSheetIndex+'" class="jfgrid-filter-options-c">'+m+"</div>"),$("#jfgrid-rightclick-menu").hide(),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide(),$("#jfgrid-cell-main").scrollTop()>e.top_move&&$("#jfgrid-scrollbar-y").scrollTop(e.top_move),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].filter_select=e}},$("#jfgridfilter").click(jfgrid.createFilter);var submenuhide=null;if($("#jfgrid-filter-orderby-color").hover(function(){for(var e=$("#jfgrid-filter-menu"),r=e.data("str"),t=e.data("edr"),i=e.data("cindex"),a=(e.data("stc"),e.data("edc"),{}),n={},o=jfgrid.alternateformat.getComputeMap(),l=jfgrid.conditionformat.getComputeMap(),d=r+1;d<=t;d++){var s=jfgrid.flowdata[d][i],g=jfgrid.menuButton.checkstatus(jfgrid.flowdata,d,i,"bg"),c=jfgrid.alternateformat.checksAF(d,i,o);null!=c&&(g=c[1]);var u=jfgrid.conditionformat.checksCF(d,i,l);null!=u&&null!=u.cellColor&&(g=u.cellColor),-1<g.indexOf("rgb")&&(g=jfgrid.rgbTohex(g)),4==g.length&&(g=g.substr(0,1)+g.substr(1,1).repeat(2)+g.substr(2,1).repeat(2)+g.substr(3,1).repeat(2));var m=jfgrid.menuButton.checkstatus(jfgrid.flowdata,d,i,"fc");null!=c&&(m=c[0]),null!=u&&null!=u.textColor&&(m=u.textColor),-1<m.indexOf("rgb")&&(m=jfgrid.rgbTohex(m)),4==m.length&&(m=m.substr(0,1)+m.substr(1,1).repeat(2)+m.substr(2,1).repeat(2)+m.substr(3,1).repeat(2)),null!=config&&null!=config.rowhidden&&d in config.rowhidden?(a[g]=1,null==s||jfgrid.func_methods.isRealNull(s.v)||(n[m]=1)):(a[g]=0,null==s||jfgrid.func_methods.isRealNull(s.v)||(n[m]=0))}var h="";if(2<JSON.stringify(a).length&&1<Object.keys(a).length){var j="";for(b in a)0==a[b]?j+='<div class="item jfgrid-mousedown-cancel"><label class="jfgrid-mousedown-cancel" style="background-color: '+b+'" title="'+b+'"></label><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/></div>':j+='<div class="item jfgrid-mousedown-cancel"><label class="jfgrid-mousedown-cancel" style="background-color: '+b+'" title="'+b+'"></label><input class="jfgrid-mousedown-cancel" type="checkbox"/></div>';h='<div id="filterBgColor" class="box jfgrid-mousedown-cancel"><div class="title jfgrid-mousedown-cancel">按单元格颜色筛选</div><div style="max-height:128px;overflow:auto;" class="jfgrid-mousedown-cancel">'+j+"</div></div>"}var p,v="";if(2<JSON.stringify(n).length&&1<Object.keys(n).length){var _="";for(f in n)0==n[f]?_+='<div class="item jfgrid-mousedown-cancel"><label class="jfgrid-mousedown-cancel" style="background-color: '+f+'" title="'+f+'"></label><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/></div>':_+='<div class="item jfgrid-mousedown-cancel"><label class="jfgrid-mousedown-cancel" style="background-color: '+f+'" title="'+f+'"></label><input class="jfgrid-mousedown-cancel" type="checkbox"/></div>';v='<div id="filterFcColor" class="box jfgrid-mousedown-cancel"><div class="title jfgrid-mousedown-cancel">按字体颜色筛选</div><div style="max-height:128px;overflow:auto;" class="jfgrid-mousedown-cancel">'+_+"</div></div>"}p=""==h&&""==v?'<div class="jfgrid-mousedown-cancel" style="padding: 10px 30px;text-align: center;">本列仅包含一种颜色</div>':h+v+'<div class="jfgrid-mousedown-cancel"><button id="jfgrid-filter-orderby-color-confirm" class="btn btn-primary jfgrid-mousedown-cancel" style="margin: 5px 20px;width: 70px;">确认</button></div>',$("#jfgrid-filter-orderby-color-submenu").remove(),$("body").append('<div id="jfgrid-filter-orderby-color-submenu" class="jfgrid-cols-menu jfgrid-mousedown-cancel">'+p+"</div>");var w=$("#jfgrid-filter-orderby-color-submenu").end(),y=w.outerHeight(),x=w.outerWidth(),C=$(this).parent(),T=$(window).width(),I=$(window).height(),R=C.width(),y=w.height()+25,x=w.width()+5,k=$(this).offset(),S=k.top,A=k.left+R;T<A+x&&(A=k.left-x),I<S+y&&(S=I-y),$("#jfgrid-filter-orderby-color-submenu").css({top:S,left:A}).show()},function(){submenuhide=setTimeout(function(){$("#jfgrid-filter-orderby-color-submenu").hide()},200)}),$(document).on("mouseover mouseleave","#jfgrid-filter-orderby-color-submenu",function(e){"mouseover"===e.type?clearTimeout(submenuhide):$(this).hide()}),$(document).on("click","#jfgrid-filter-orderby-color-submenu .item label",function(){$(this).siblings("input[type='checkbox']").click()}),$(document).off("click.orderbyColorConfirm").on("click.orderbyColorConfirm","#jfgrid-filter-orderby-color-submenu #jfgrid-filter-orderby-color-confirm",function(){var e,r,a={},n={};$("#jfgrid-filter-orderby-color-submenu .item").each(function(e,r){var t,i;$(r).find("input[type='checkbox']").is(":checked")&&(t=$(this).find("label").attr("title"),"filterBgColor"==(i=$(this).closest(".box").attr("id"))?a[t]=0:"filterFcColor"==i&&(n[t]=0))}),e=0<$("#jfgrid-filter-orderby-color-submenu #filterBgColor").length,r=0<$("#jfgrid-filter-orderby-color-submenu #filterFcColor").length;var t=$("#jfgrid-filter-menu"),i=t.data("str"),o=t.data("edr"),l=t.data("cindex"),d=t.data("stc"),f=t.data("edc"),s={};$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").not($("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").eq(l-d).get(0)).each(function(){var e=$(this).data("rowhidden");if(""==e)return!0;for(var r in e=JSON.parse(e))s[r]=0});for(var g,c,u,m,h,j={},p={},v=jfgrid.alternateformat.getComputeMap(),b=jfgrid.conditionformat.getComputeMap(),_=i+1;_<=o;_++){_ in s||null!=jfgrid.flowdata[_]&&(g=jfgrid.flowdata[_][l],c=jfgrid.menuButton.checkstatus(jfgrid.flowdata,_,l,"bg"),null!=(u=jfgrid.alternateformat.checksAF(_,l,v))&&(c=u[1]),null!=(m=jfgrid.conditionformat.checksCF(_,l,b))&&null!=m.cellColor&&(c=m.cellColor),-1<c.indexOf("rgb")&&(c=jfgrid.rgbTohex(c)),4==c.length&&(c=c.substr(0,1)+c.substr(1,1).repeat(2)+c.substr(2,1).repeat(2)+c.substr(3,1).repeat(2)),h=jfgrid.menuButton.checkstatus(jfgrid.flowdata,_,l,"fc"),null!=u&&(h=u[0]),null!=m&&null!=m.textColor&&(h=m.textColor),-1<h.indexOf("rgb")&&(h=jfgrid.rgbTohex(h)),4==h.length&&(h=h.substr(0,1)+h.substr(1,1).repeat(2)+h.substr(2,1).repeat(2)+h.substr(3,1).repeat(2)),e&&r?c in a||h in n&&null!=g&&!jfgrid.func_methods.isRealNull(g.v)||(j[_]=0):e?c in a||(j[_]=0):r&&(h in n&&null!=g&&!jfgrid.func_methods.isRealNull(g.v)||(j[_]=0)))}var w=$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").eq(l-d),y=0<Object.keys(j).length,x=$.extend(!0,s,j),C=jfgrid.json.parseJsonParm(w.data("rowhidden"));jfgrid.labelFilterOptionState(w,y,j,p,!0,i,o,l,d,f);var T,I=$.extend(!0,{},config);I.rowhidden=x,clearjfundo&&((T={type:"datachangeAll_filter"}).sheetIndex=jfgrid.currentSheetIndex,T.config=$.extend(!0,{},config),T.curconfig=I,T.optionstate=y,T.optionsindex=l-d,T.rowhidden=$.extend(!0,{},j),T.rowhidenPre=$.extend(!0,{},C),null!=p&&(T.caljs=p),jfgrid.jfundo=[],jfgrid.jfredo.push(T)),config=I,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,I.rowhidden,{k:"rowhidden"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length),$("#jfgrid-filter-menu, #jfgrid-filter-submenu, #jfgrid-filter-orderby-color-submenu").hide(),jfgrid.cleargridelement()}),$("#jfgrid-cell-main").on("click",".jfgrid-filter-options",function(e){var r=$(e.currentTarget),T=r.offset(),t=$("#jfgrid-filter-menu"),I=$(window).height(),R=($(window).width(),r.data("str")),k=r.data("edr"),S=r.data("cindex"),i=r.data("stc"),a=r.data("edc"),A=""==r.data("rowhidden")?{}:JSON.parse(r.data("rowhidden").replace(/\'/g,'"'));$("body .jfgrid-cols-menu").hide(),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide(),$("#jfgrid-filter-byvalue-input").val(""),$("#jfgrid-filter-bycondition").next().hide(),$("#jfgrid-filter-byvalue").next().show(),t.data("str",R),t.data("edr",k),t.data("cindex",S),t.data("stc",i),t.data("edc",a),$("#jfgrid-filter-menu .jfgrid-filter-selected-input").hide().find("input").val(),$("#jfgrid-filter-selected span").data("type","0").data("type",null).text("无");var n,o=r.data("byconditiontype");$("#jfgrid-filter-selected span").data("value",r.data("byconditionvalue")).data("type",o).text(r.data("byconditiontext")),"2"==o?((n=$("#jfgrid-filter-menu .jfgrid-filter-selected-input2").show().find("input")).eq(0).val(r.data("byconditionvalue1")),n.eq(1).val(r.data("byconditionvalue2"))):"1"==o&&$("#jfgrid-filter-menu .jfgrid-filter-selected-input").eq(0).show().find("input").val(r.data("byconditionvalue1")),$("#jfgrid-filter-orderby-asc").off("click").on("click",function(){orderbydatafiler(R,i,k,a,S,!0)}),$("#jfgrid-filter-orderby-desc").off("click").on("click",function(){orderbydatafiler(R,i,k,a,S,!1)}),$("#jfgrid-filter-byvalue-select").empty().html('<div style="width:100%;text-align:center;position:relative;top:45%;font-size:14px;"><div class="jfgridLoaderGif"></div><span>数据量大！请稍后</span></div>');var F={};$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").not(this).each(function(){var e=$(this).data("rowhidden");if(""==e)return!0;for(var r in e=JSON.parse(e.replace(/\'/g,'"')))F[r]=0});jfgrid.flowdata;return setTimeout(function(){for(var e,r,t,i,a={},n={},o={},l={},d=R+1;d<=k;d++){d in F||null!=jfgrid.flowdata[d]&&(null==(e=jfgrid.flowdata[d][S])||jfgrid.func_methods.isRealNull(e.v)||null==e.ct||"d"!=e.ct.t?(t=null==e||jfgrid.func_methods.isRealNull(e.v)?C=null:(C=e.v,e.m),C in o||(o[C]={}),t in o[C]||(o[C][t]=0),o[C][t]++,d in A&&(l[C+"#$$$#"+t]=0)):(r=(C=jfgrid.mask.update("YYYY-MM-DD",e.v)).split("-")[0],t=C.split("-")[1],i=C.split("-")[2],r in a||(a[r]={}),t in a[r]||(a[r][t]={}),i in a[r][t]||(a[r][t][i]=0),a[r][t][i]++,d in A&&(n[r]=0,n[t]=0,n[i]=0)))}var f=[];if(2<JSON.stringify(a).length)for(r in a){var s,g=0,c="";for(t in a[r]){var u,m=0,h="";for(i in a[r][t]){var j,p,v=a[r][t][i];m+=v,j=Number(t)<10?"0"+Number(t):t,p=Number(i)<10?"0"+Number(i):i,h+=r in n&&t in n&&i in n?'<div class="day jfgrid-mousedown-cancel cf" data-check="false" title="'+r+"-"+j+"-"+p+'"><input class="jfgrid-mousedown-cancel" type="checkbox"/><label class="jfgrid-mousedown-cancel">'+i+'</label><span class="count jfgrid-mousedown-cancel">( '+v+" )</span></div>":'<div class="day jfgrid-mousedown-cancel cf" data-check="true" title="'+r+"-"+j+"-"+p+'"><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/><label class="jfgrid-mousedown-cancel">'+i+'</label><span class="count jfgrid-mousedown-cancel">( '+v+" )</span></div>"}g+=m,u=Number(t)<10?"0"+Number(t):t,c+=r in n&&t in n?'<div class="monthBox jfgrid-mousedown-cancel"><div class="month jfgrid-mousedown-cancel cf" data-check="false" title="'+r+"-"+u+'"><i class="fa fa-caret-right jfgrid-mousedown-cancel" aria-hidden="true"></i><input class="jfgrid-mousedown-cancel" type="checkbox"/><label class="jfgrid-mousedown-cancel">'+t+'月</label><span class="count jfgrid-mousedown-cancel">( '+m+' )</span></div><div class="dayList jfgrid-mousedown-cancel">'+h+"</div></div>":'<div class="monthBox jfgrid-mousedown-cancel"><div class="month jfgrid-mousedown-cancel cf" data-check="true" title="'+r+"-"+u+'"><i class="fa fa-caret-right jfgrid-mousedown-cancel" aria-hidden="true"></i><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/><label class="jfgrid-mousedown-cancel">'+t+'月</label><span class="count jfgrid-mousedown-cancel">( '+m+' )</span></div><div class="dayList jfgrid-mousedown-cancel">'+h+"</div></div>"}s=r in n?'<div class="yearBox jfgrid-mousedown-cancel"><div class="year jfgrid-mousedown-cancel cf" data-check="false" title="'+r+'"><i class="fa fa-caret-right jfgrid-mousedown-cancel" aria-hidden="true"></i><input class="jfgrid-mousedown-cancel" type="checkbox"/><label class="jfgrid-mousedown-cancel">'+r+'年</label><span class="count jfgrid-mousedown-cancel">( '+g+' )</span></div><div class="monthList jfgrid-mousedown-cancel">'+c+"</div></div>":'<div class="yearBox jfgrid-mousedown-cancel"><div class="year jfgrid-mousedown-cancel cf" data-check="true" title="'+r+'"><i class="fa fa-caret-right jfgrid-mousedown-cancel" aria-hidden="true"></i><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/><label class="jfgrid-mousedown-cancel">'+r+'年</label><span class="count jfgrid-mousedown-cancel">( '+g+' )</span></div><div class="monthList jfgrid-mousedown-cancel">'+c+"</div></div>",f.unshift(s)}if(2<JSON.stringify(o).length)for(var b=Object.keys(o),b=jfgrid.orderbydata1D(b,!0),_=0;_<b.length;_++){var w,y,C=b[_];for(x in o[C]){w=C+"#$$$#"+x=="null#$$$#null"?"(空白)":x,y=C+"#$$$#"+x in l?'<div class="textBox jfgrid-mousedown-cancel cf" data-check="false" data-filter="'+C+"#$$$#"+x+'" title="'+w+'"><input class="jfgrid-mousedown-cancel" type="checkbox"/><label class="jfgrid-mousedown-cancel">'+w+'</label><span class="jfgrid-mousedown-cancel count">( '+o[C][x]+" )</span></div>":'<div class="textBox jfgrid-mousedown-cancel cf" data-check="true" data-filter="'+C+"#$$$#"+x+'" title="'+w+'"><input class="jfgrid-mousedown-cancel" type="checkbox" checked="checked"/><label class="jfgrid-mousedown-cancel">'+w+'</label><span class="jfgrid-mousedown-cancel count">( '+o[C][x]+" )</span></div>",f.push(y)}}$("#jfgrid-filter-byvalue-select").html("<div class='ListBox jfgrid-mousedown-cancel' style='min-height: 100px; max-height: "+(I-T.top-350)+"px; overflow-y: auto; overflow-x: hidden;'><table cellspacing='0' style='width:100%;' class='jfgrid-mousedown-cancel'>"+f.join("")+"</table></div>")},1),showrightclickmenu(t,T.left,T.top+20),e.stopPropagation(),!1}),$(document).off("click.filterCheckbox1").on("click.filterCheckbox1","#jfgrid-filter-byvalue-select .textBox",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox2").on("click.filterCheckbox2","#jfgrid-filter-byvalue-select .year",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).parents(".yearBox").find(".month").attr("data-check","false"),$(this).parents(".yearBox").find(".day").attr("data-check","false"),$(this).parents(".yearBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".yearBox").find(".month").attr("data-check","true"),$(this).parents(".yearBox").find(".day").attr("data-check","true"),$(this).parents(".yearBox").find("input[type='checkbox']").prop("checked",!0))}),$(document).off("click.filterCheckbox3").on("click.filterCheckbox3","#jfgrid-filter-byvalue-select .month",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).parents(".monthBox").find(".day").attr("data-check","false"),$(this).parents(".monthBox").find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).parents(".monthBox").find(".day").attr("data-check","true"),$(this).parents(".monthBox").find("input[type='checkbox']").prop("checked",!0));var t=!0;$(this).parents(".yearBox").find(".day").each(function(e,r){"true"==$(r).attr("data-check")||(t=!1)}),t?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterCheckbox4").on("click.filterCheckbox4","#jfgrid-filter-byvalue-select .day",function(){"true"==$(this).attr("data-check")?($(this).attr("data-check","false"),$(this).find("input[type='checkbox']").removeAttr("checked")):($(this).attr("data-check","true"),$(this).find("input[type='checkbox']").prop("checked",!0));var t=!0;$(this).parents(".monthBox").find(".day").each(function(e,r){"true"==$(r).attr("data-check")||(t=!1)}),t?($(this).parents(".monthBox").find(".month").attr("data-check","true"),$(this).parents(".monthBox").find(".month input[type='checkbox']").prop("checked",!0)):($(this).parents(".monthBox").find(".month").attr("data-check","false"),$(this).parents(".monthBox").find(".month input[type='checkbox']").removeAttr("checked"));var i=!0;$(this).parents(".yearBox").find(".day").each(function(e,r){"true"==$(r).attr("data-check")||(i=!1)}),i?($(this).parents(".yearBox").find(".year").attr("data-check","true"),$(this).parents(".yearBox").find(".year input[type='checkbox']").prop("checked",!0)):($(this).parents(".yearBox").find(".year").attr("data-check","false"),$(this).parents(".yearBox").find(".year input[type='checkbox']").removeAttr("checked"))}),$(document).off("click.filterYearDropdown").on("click.filterYearDropdown","#jfgrid-filter-byvalue-select .yearBox .fa-caret-right",function(e){var r=$(this).parents(".jfgrid-mousedown-cancel");r.hasClass("year")&&$(this).parents(".yearBox").find(".monthList").slideToggle(),r.hasClass("month")&&$(this).parents(".monthBox").find(".dayList").slideToggle(),e.stopPropagation()}),$("#jfgrid-filter-byvalue-btn-all").click(function(){$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']").prop("checked",!0),$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']").parents(".jfgrid-mousedown-cancel").attr("data-check","true")}),$("#jfgrid-filter-byvalue-btn-clear").click(function(){$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']").removeAttr("checked"),$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']").parents(".jfgrid-mousedown-cancel").attr("data-check","false")}),$("#jfgrid-filter-byvalue-btn-contra").click(function(){$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']").each(function(e,r){$(r).is(":checked")?($(r).removeAttr("checked"),$(r).parents(".jfgrid-mousedown-cancel").attr("data-check","false")):($(r).prop("checked",!0),$(r).parents(".jfgrid-mousedown-cancel").attr("data-check","true"))}),$("#jfgrid-filter-byvalue-select .ListBox .monthBox").each(function(e,r){var t=!0;$(r).find(".day input[type='checkbox']").each(function(e,r){$(r).is(":checked")||(t=!1)}),t?($(r).find(".month input[type='checkbox']").prop("checked",!0),$(r).attr("data-check","true")):($(r).find(".month input[type='checkbox']").removeAttr("checked"),$(r).attr("data-check","false"))}),$("#jfgrid-filter-byvalue-select .ListBox .yearBox").each(function(e,r){var t=!0;$(r).find(".day input[type='checkbox']").each(function(e,r){$(r).is(":checked")||(t=!1)}),t?($(r).find(".year input[type='checkbox']").prop("checked",!0),$(r).attr("data-check","true")):($(r).find(".year input[type='checkbox']").removeAttr("checked"),$(r).attr("data-check","false"))})}),$("#jfgrid-filter-initial").click(function(){$("#jfgrid-filter-menu .jfgrid-filter-selected-input").hide().find("input").val(),$("#jfgrid-filter-selected span").data("type","0").data("type",null).text("无"),$("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex+", #jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).remove(),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide();var e={type:"datachangeAll_filter_clear"};e.sheetIndex=jfgrid.currentSheetIndex,e.config=$.extend(!0,{},config),config.rowhidden={},e.curconfig=$.extend(!0,{},config),e.filter_save=$.extend(!0,{},jfgird_filter_save);var a=[];$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").each(function(){var e=$(this),r=e.hasClass("jfgrid-filter-options-active"),t=jfgrid.json.parseJsonParm(e.data("rowhidden")),i=jfgrid.json.parseJsonParm(e.data("caljs"));a.push({optionstate:r,rowhidden:t,caljs:i,str:e.data("str"),edr:e.data("edr"),cindex:e.data("cindex"),stc:e.data("stc"),edc:e.data("edc")})}),e.optiongroups=a,jfgrid.jfundo=[],jfgrid.jfredo.push(e),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].filter=null,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].filter_select=null,jfgrid.server.saveParam("fsc",jfgrid.currentSheetIndex,null),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,{},{k:"rowhidden"}),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length)}),$("#jfgrid-filter-byvalue-input").on("input propertychange",function(){var a=$(this).val().toString();$("#jfgrid-filter-byvalue-select .ListBox .jfgrid-mousedown-cancel").show(),""!=a&&$("#jfgrid-filter-byvalue-select .ListBox input[type='checkbox']").each(function(e,r){var t,i;0<$(r).closest(".day").length&&(t=$(r).siblings("label").text().toString(),i=$(r).closest(".monthBox").find(".month label").text().toString(),-1==($(r).closest(".yearBox").find(".year label").text().toString()+"-"+i+"-"+t).indexOf(a)&&($(r).closest(".day").hide(),0==$(r).closest(".dayList").find(".day:visible").length&&$(r).closest(".monthBox").find(".month").hide(),0==$(r).closest(".monthList").find(".day:visible").length&&$(r).closest(".yearBox").find(".year").hide())),0<$(r).closest(".textBox").length&&-1==$(r).siblings("label").text().toString().indexOf(a)&&$(r).parents(".textBox").hide()})}),$("#jfgrid_info_detail_user").html(jfgridConfigsetting.userInfo+'&nbsp;<i class="fa fa-caret-down" aria-hidden="true"></i>').click(function(){var e,r,t;0!=jfgridConfigsetting.userMenuItem.length&&(e=$(this).outerWidth(),r=$("#jfgrid-user-menu").outerWidth(),t=$(this).offset().left,e<r&&r+t>$("#"+container).width()&&(t=t-r+e),mouseclickposition($("#jfgrid-user-menu"),t,$(this).offset().top+20,"lefttop"))}),0<jfgridConfigsetting.userMenuItem.length){$("body").append('<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-mousedown-cancel" id="jfgrid-user-menu">${item}</div>');for(var itemset="",i=0;i<jfgridConfigsetting.userMenuItem.length;i++){var item=jfgridConfigsetting.userMenuItem[i];itemset+='<div data-src="'+item.url+'" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 6px 0px 6px 5px;"><span style="margin-right:3px;" class="icon jfgrid-mousedown-cancel">'+item.icon+"</span> "+item.name+"</div></div>"}$("#jfgrid-user-menu").html(itemset).find("i").addClass("jfgrid-mousedown-cancel").end().find(".jfgrid-cols-menuitem").click(function(){window.open($(this).data("src"),"_self")})}$("#jfgrid_info_detail_title").click(function(){window.open(jfgridConfigsetting.myFolderUrl,"_self")}),$("#jfgrid_info_detail_input").val(jfgrid.server.title).css("width",10*jfgrid.getByteLen(jfgrid.server.title)).keydown(function(){event.ctrlKey,event.altKey,event.shiftKey;var e=event.keyCode,r=$(this);e==keycode.ENTER&&r.blur().change()}).bind("input propertychange",function(){var e=$(this),r=10*jfgrid.getByteLen(e.val()),t=$("#jfgrid_info_detail_update").outerWidth(),i=$("#jfgrid_info_detail_save").outerWidth(),a=$("#jfgrid_info_detail_user").parent().outerWidth()+60,n=$("#"+container).outerWidth()-i-t-a-100;n<r?$("#jfgrid_info_detail_input").css("width",n):$("#jfgrid_info_detail_input").css("width",r)}).change(function(){jfgrid.server.saveParam("na",null,$(this).val())}),$("#jfgrid-functionbox-cell").focus(function(){var e,r,t,i,a,n,o,l;jfgrid.isEditMode()||0<jfgird_select_save.length&&(r=(e=jfgird_select_save[jfgird_select_save.length-1]).row_focus,t=e.column_focus,i=visibledatarow[r],a=r-1==-1?0:visibledatarow[r-1],n=visibledatacolumn[t],o=t-1==-1?0:visibledatacolumn[t-1],(l=jfgrid.menuButton.mergeborer(jfgrid.flowdata,r,t))&&(i=l.row[1],a=l.row[0],r=l.row[2],n=l.column[1],o=l.column[0],t=l.column[2]),jfgrid.jfgridupdateCell(i,a,r,n,o,t,jfgrid.flowdata,null,!0),jfgrid.formula.rangeResizeTo=$("#jfgrid-functionbox-cell"))}).keydown(function(e){var r,t,i;jfgrid.isEditMode()||(e.ctrlKey,e.altKey,e.shiftKey,r=e.keyCode,t=$("#jfgrid-input-box"),r==keycode.ENTER&&0<parseInt(t.css("top"))?($("#jfgrid-formula-search-c").is(":visible")&&null!=jfgrid.formula.searchFunctionCell?jfgrid.formula.searchFunctionEnter($("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item-active")):(jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgird_select_save=[{row:[jfgridCellUpdate[0],jfgridCellUpdate[0]],column:[jfgridCellUpdate[1],jfgridCellUpdate[1]],row_focus:jfgridCellUpdate[0],column_focus:jfgridCellUpdate[1]}],jfgridMoveHighlightCell("down",1,"rangeOfSelect"),$("#jfgrid-functionbox-cell").blur()),e.preventDefault()):r==keycode.ESC&&0<parseInt(t.css("top"))?(jfgrid.formula.dontupdate(),jfgridMoveHighlightCell("down",0,"rangeOfSelect"),e.preventDefault()):r==keycode.F4&&0<parseInt(t.css("top"))?(jfgrid.formula.setfreezonFuc(e),e.preventDefault()):r==keycode.UP&&0<parseInt(t.css("top"))?$("#jfgrid-formula-search-c").is(":visible")&&(0==(i=$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item-active").prev()).length&&(i=$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").last()),$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").removeClass("jfgrid-formula-search-item-active"),i.addClass("jfgrid-formula-search-item-active"),e.preventDefault()):r==keycode.DOWN&&0<parseInt(t.css("top"))?$("#jfgrid-formula-search-c").is(":visible")&&(0==(i=$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item-active").next()).length&&(i=$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").first()),$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").removeClass("jfgrid-formula-search-item-active"),i.addClass("jfgrid-formula-search-item-active"),e.preventDefault()):r==keycode.LEFT&&0<parseInt(t.css("top"))||r==keycode.RIGHT&&0<parseInt(t.css("top"))?jfgrid.formula.rangeHightlightselected($("#jfgrid-functionbox-cell")):(!(112<=r&&r<=123||r<=46||144==r||108==r||e.ctrlKey||e.altKey||e.shiftKey&&(37==r||38==r||39==r||40==r))||8==r||32==r||46==r||e.ctrlKey&&86==r)&&jfgrid.formula.functionInputHanddler($("#jfgrid-rich-text-editor"),$("#jfgrid-functionbox-cell"),r))}).click(function(){jfgrid.isEditMode()||jfgrid.formula.rangeHightlightselected($("#jfgrid-functionbox-cell"))}),$("#jfgrid-wa-functionbox-cancel").click(function(){$(this).hasClass("jfgrid-wa-calculate-active")&&($("#jfgrid-search-formula-parm").is(":visible")&&$("#jfgrid-search-formula-parm").hide(),$("#jfgrid-search-formula-parm-select").is(":visible")&&$("#jfgrid-search-formula-parm-select").hide(),jfgrid.formula.dontupdate(),jfgridMoveHighlightCell("down",0,"rangeOfSelect"))}),$("#jfgrid-wa-functionbox-confirm").click(function(){$(this).hasClass("jfgrid-wa-calculate-active")&&($("#jfgrid-search-formula-parm").is(":visible")&&$("#jfgrid-search-formula-parm").hide(),$("#jfgrid-search-formula-parm-select").is(":visible")&&$("#jfgrid-search-formula-parm-select").hide(),jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1]),jfgridMoveHighlightCell("down",0,"rangeOfSelect"))}),$("#jfgrid-wa-functionbox-fx").click(function(){var e,r,t,i,a,n,o,l,d;0!=jfgird_select_save.length?(r=(e=jfgird_select_save[jfgird_select_save.length-1]).row_focus,t=e.column_focus,i=visibledatarow[r],a=r-1==-1?0:visibledatarow[r-1],n=visibledatacolumn[t],o=t-1==-1?0:visibledatacolumn[t-1],jfgrid.jfgridupdateCell(i,a,r,n,o,t,jfgrid.flowdata),null!=(l=jfgrid.flowdata[r][t])&&null!=l.f?null!=(d=jfgrid.formula.getfunctionParam(l.f)).fn?jfgrid.insertFormula.formulaParmDialog(d.fn,d.param):jfgrid.insertFormula.formulaListDialog():($("#jfgrid-rich-text-editor").html('<span dir="auto" class="jfgrid-formula-text-color">=</span>'),$("#jfgrid-functionbox-cell").html($("#jfgrid-rich-text-editor").html()),jfgrid.insertFormula.formulaListDialog()),jfgrid.insertFormula.init()):jfgrid.isEditMode()?alert("请选择单元格插入函数"):jfgrid.tooltip.info("请选择单元格插入函数","")}),$("#jfgrid-formula-functionrange").on("mousedown",".jfgrid-copy",function(e){jfgrid.formula.rangeMove=!0,jfgird_scroll_status=!0,jfgrid.formula.rangeMoveObj=$(this).parent(),jfgrid.formula.rangeMoveIndex=$(this).parent().attr("rangeindex");var r=mouseposition(e.pageX,e.pageY),t=r[0]+$("#jfgrid-cell-main").scrollLeft(),i=r[1]+$("#jfgrid-cell-main").scrollTop();$("#jfgrid-formula-functionrange-highlight-"+jfgrid.formula.rangeMoveIndex).find(".jfgrid-selection-copy-hc").css("opacity",.13);var a=$(this).data("type");"top"==a?i+=3:"right"==a?t-=3:"bottom"==a?i-=3:"left"==a&&(t+=3);var n=jfgrid.rowLocation(i)[2],o=jfgrid.colLocation(t)[2];jfgrid.formula.rangeMovexy=[n,o],$("#jfgrid-sheettable").css("cursor","move"),e.stopPropagation()}),$("#jfgrid-formula-functionrange").on("mousedown",".jfgrid-highlight",function(e){jfgrid.formula.rangeResize=$(this).data("type"),jfgrid.formula.rangeResizeIndex=$(this).parent().attr("rangeindex");var r=mouseposition(e.pageX,e.pageY),t=$("#jfgrid-cell-main").scrollLeft(),i=$("#jfgrid-cell-main").scrollTop(),a=r[0]+t,n=r[1]+i;jfgrid.formula.rangeResizeObj=$(this).parent(),$("#jfgrid-formula-functionrange-highlight-"+jfgrid.formula.rangeResizeIndex).find(".jfgrid-selection-copy-hc").css("opacity",.13),"lt"==jfgrid.formula.rangeResize?(a+=3,n+=3):"lb"==jfgrid.formula.rangeResize?(a+=3,n-=3):"rt"==jfgrid.formula.rangeResize?(a-=3,n+=3):"rb"==jfgrid.formula.rangeResize&&(a-=3,n-=3);var o=jfgrid.rowLocation(n),l=o[1],d=o[0],f=(o[2],jfgrid.colLocation(a)),s=f[1],g=f[0],c=(f[2],jfgrid.formula.rangeResizeObj.position());jfgrid.formula.rangeResizexy=[g,d,jfgrid.formula.rangeResizeObj.width(),jfgrid.formula.rangeResizeObj.height(),c.left+t,c.top+i,s,l],jfgrid.formula.rangeResizeWinH=$("#jfgrid-cell-main")[0].scrollHeight,jfgrid.formula.rangeResizeWinW=$("#jfgrid-cell-main")[0].scrollWidth,jfgird_scroll_status=!0,event.stopPropagation()}),$("#jfgrid-chart-rangeShow").on("mousedown.chartRangeShowMove",".jfgrid-chart-rangeShow-move",function(e){jfgrid.chart_selection.rangeMove=!0,jfgird_scroll_status=!0,jfgrid.chart_selection.rangeMoveObj=$(this).parent();var r,t,i=jfgrid.chartparam.jfgridCurrentChartMoveObj.find(".jfgrid-modal-dialog-content").attr("id"),a=!!window.store&&store.state.chartSetting.chartList[i],n=$(this).parent().attr("id");"jfgrid-chart-rangeShow-content"==n?(r=a.rangeArray[0].row[0]+a.rangeSplitArray.content.row[0],t=a.rangeArray[0].column[0]+a.rangeSplitArray.content.column[0],jfgrid.chart_selection.rangeMoveIndex=[r,t]):"jfgrid-chart-rangeShow-rowtitle"==n?(r=a.rangeArray[0].row[0]+a.rangeSplitArray.rowtitle.row[0],t=a.rangeArray[0].column[0]+a.rangeSplitArray.rowtitle.column[0],jfgrid.chart_selection.rangeMoveIndex=[r,t]):"jfgrid-chart-rangeShow-coltitle"==n&&(r=a.rangeArray[0].row[0]+a.rangeSplitArray.coltitle.row[0],t=a.rangeArray[0].column[0]+a.rangeSplitArray.coltitle.column[0],jfgrid.chart_selection.rangeMoveIndex=[r,t]);var o=jfgrid.mouseposition(e.pageX,e.pageY),l=o[0]+$("#jfgrid-cell-main").scrollLeft(),d=o[1]+$("#jfgrid-cell-main").scrollTop(),f=$(this).data("type");"top"==f?d+=3:"right"==f?l-=3:"bottom"==f?d-=3:"left"==f&&(l+=3);var s=jfgrid.rowLocation(d)[2],g=jfgrid.colLocation(l)[2];jfgrid.chart_selection.rangeMovexy=[s,g],e.stopPropagation()}),$("#jfgrid-chart-rangeShow").on("mousedown.chartRangeShowResize",".jfgrid-chart-rangeShow-resize",function(e){jfgrid.chart_selection.rangeResize=$(this).data("type"),jfgird_scroll_status=!0,jfgrid.chart_selection.rangeResizeObj=$(this).parent();var r,t,i,a,n=jfgrid.chartparam.jfgridCurrentChartMoveObj.find(".jfgrid-modal-dialog-content").attr("id"),o=!!window.store&&store.state.chartSetting.chartList[n],l=$(this).parent().attr("id");"jfgrid-chart-rangeShow-content"==l?(t=o.rangeRowCheck.exits?(r=o.rangeArray[0].row[0]+o.rangeSplitArray.content.row[0],o.rangeArray[0].row[0]+o.rangeSplitArray.content.row[1]):(r=o.rangeSplitArray.content.row[0],o.rangeSplitArray.content.row[0]),a=o.rangeColCheck.exits?(i=o.rangeArray[0].column[0]+o.rangeSplitArray.content.column[0],o.rangeArray[0].column[0]+o.rangeSplitArray.content.column[1]):(i=o.rangeSplitArray.content.column[0],o.rangeSplitArray.content.column[1]),jfgrid.chart_selection.rangeResizeIndex={row:[r,t],column:[i,a]}):"jfgrid-chart-rangeShow-rowtitle"==l?(r=o.rangeArray[0].row[0]+o.rangeSplitArray.rowtitle.row[0],t=o.rangeArray[0].row[0]+o.rangeSplitArray.rowtitle.row[1],i=o.rangeArray[0].column[0]+o.rangeSplitArray.rowtitle.column[0],a=o.rangeArray[0].column[0]+o.rangeSplitArray.rowtitle.column[1],jfgrid.chart_selection.rangeResizeIndex={row:[r,t],column:[i,a]}):"jfgrid-chart-rangeShow-coltitle"==l&&(r=o.rangeArray[0].row[0]+o.rangeSplitArray.coltitle.row[0],t=o.rangeArray[0].row[0]+o.rangeSplitArray.coltitle.row[1],i=o.rangeArray[0].column[0]+o.rangeSplitArray.coltitle.column[0],a=o.rangeArray[0].column[0]+o.rangeSplitArray.coltitle.column[1],jfgrid.chart_selection.rangeResizeIndex={row:[r,t],column:[i,a]});var d=jfgrid.mouseposition(e.pageX,e.pageY),f=d[0]+$("#jfgrid-cell-main").scrollLeft(),s=d[1]+$("#jfgrid-cell-main").scrollTop();"lt"==jfgrid.chart_selection.rangeResize?(f+=3,s+=3):"lb"==jfgrid.chart_selection.rangeResize?(f+=3,s-=3):"rt"==jfgrid.chart_selection.rangeResize?(f-=3,s+=3):"rb"==jfgrid.chart_selection.rangeResize&&(f-=3,s-=3);var g=jfgrid.rowLocation(s)[2],c=jfgrid.colLocation(f)[2];jfgrid.chart_selection.rangeResizexy=[g,c],e.stopPropagation()}),$("#jfgrid-wa-calculate-size").mousedown(function(e){var r=e.pageY;jfgrid.formula.functionResizeData.y=r,jfgrid.formula.functionResizeStatus=!0,jfgrid.formula.functionResizeData.calculatebarHeight=calculatebarHeight,null!=jfgrid.formula.rangetosheet&&jfgrid.formula.updatecell(jfgridCellUpdate[0],jfgridCellUpdate[1])});for(var jfgrid_function_exe={},i=0;i<jfgrid.functionlist.length;i++){var func=jfgrid.functionlist[i];jfgrid_function_exe[func.n]=func}window.jfgrid_function=jfgrid_function_exe,$("#"+container+" .jfgrid-wa-editor").on("click",".jfgrid-toolbar-zoom-combobox",function(e){$(e.currentTarget).addClass("jfgrid-toolbar-combo-button-open"),$(e.currentTarget).find(".jfgrid-toolbar-combo-button-input").focus()}),$("#"+container+" .jfgrid-wa-editor").on("blur",".jfgrid-toolbar-combo-button-input",function(e){$(e.currentTarget).closest(".jfgrid-toolbar-zoom-combobox").removeClass("jfgrid-toolbar-combo-button-open")}),jfgrid.menuButton.initialMenuButton();var devicePixelRatio=window.devicePixelRatio||1,devicePixelRatio=Math.ceil(devicePixelRatio);jfgrid.dpi_x=document.getElementById("testdpidiv").offsetWidth*devicePixelRatio,jfgrid.dpi_y=document.getElementById("testdpidiv").offsetHeight*devicePixelRatio,$("#testdpidiv").remove(),$(document).on("paste",function(e){if(!jfgrid.isEditMode()&&jfgrid.selection.isPasteAction){$("#jfgrid-rich-text-editor").blur(),jfgrid.selection.isPasteAction=!1;var r=window.clipboardData,t=(r=r||e.originalEvent.clipboardData).getData("text/html");if(-1<t.indexOf("jfgrid_copy_action_table")&&null!=jfgrid_copy_save.copyRange&&0<jfgrid_copy_save.copyRange.length){for(var i=[],a=new RegExp("<tr.*?>(.*?)</tr>","g"),n=new RegExp("<td.*?>(.*?)</td>","g"),o=t.match(a),l=0;l<o.length;l++){for(var d=[],f=o[l].match(n),s=0;s<f.length;s++){var g=f[s].replace(/<td.*?>/g,"").replace(/<\/td>/g,"");d.push(g)}i.push(d)}var c,u=jfgrid_copy_save.copyRange[0].row[0],m=jfgrid_copy_save.copyRange[0].row[1],h=jfgrid_copy_save.copyRange[0].column[0],j=jfgrid_copy_save.copyRange[0].column[1],p=jfgrid_copy_save.dataSheetIndex;c=p==jfgrid.currentSheetIndex?jfgrid.editor.deepCopyFlowData(jfgrid.flowdata):jfgridfile[jfgrid.sheetmanage.getSheetIndex(p)].data;for(var v=!0,S=u;S<=m&&!(5<S-u);S++)for(var b=h;b<=j;b++){var _=c[S][b];if((null!=_&&null!=_.ct&&-1<_.ct.fa.indexOf("w")?c[S][b].v:c[S][b].m)!=i[S-u][b-h]){v=!1;break}}}if(-1<t.indexOf("jfgrid_copy_action_table")&&null!=jfgrid_copy_save.copyRange&&0<jfgrid_copy_save.copyRange.length&&v)jfgrid_paste_iscut?(jfgrid_paste_iscut=!1,jfgrid.selection.pasteHandlerOfCutPaste(jfgrid_copy_save),jfgrid.selection.clearcopy(e)):jfgrid.selection.pasteHandlerOfCopyPaste(jfgrid_copy_save);else if(-1<t.indexOf("table")){$("#jfgird-copy-content").html(t);var A=new Array($("#jfgird-copy-content").find("table tr").length),F=0;$("#jfgird-copy-content").find("table tr").eq(0).find("td").each(function(){var e=parseInt($(this).attr("colspan"));isNaN(e)&&(e=1),F+=e});for(l=0;l<A.length;l++)A[l]=new Array(F);var S=0,N={};$("#jfgird-copy-content").find("table tr").each(function(){var e=$(this),k=0;e.find("td").each(function(){var e,r=$(this),t={},i=r.text();0==$.trim(i).length?(t.v=null,t.m=""):(e=jfgrid.mask.genarate(r.text()),t.v=e[2],t.ct=e[1],t.m=e[0]);var a=r.css("background-color");"rgba(0, 0, 0, 0)"==a&&(a="rgba(255,255,255)"),t.bg=a;var n=r.css("font-weight");t.bl=400==n||"normal"==n?0:1;var o=r.css("font-style");t.it="normal"==o?0:1;for(var l=r.css("font-family").split(","),d=0;d<l.length;d++){var f=$.trim(l[d].toLowerCase());if(null!=(f=jfgrid.menuButton.fontjson[f])){t.ff=f;break}t.ff=0}var s=Math.floor(72*parseInt(r.css("font-size"))/jfgrid.dpi_y)+1;t.fs=s;var g=r.css("color");t.fc=g;var c=r.css("text-align");t.ht="center"==c?0:"right"==c?2:1;var u=r.css("vertical-align");for(t.vt="middle"==u?0:"top"==u||"text-top"==u?1:2;k<F&&null!=A[S][k];)k++;if(k==F)return!0;if(null==A[S][k]){A[S][k]=t;var m=parseInt(r.attr("rowspan")),h=parseInt(r.attr("colspan"));isNaN(m)&&(m=1),isNaN(h)&&(h=1);for(var j,p=jfgird_select_save[0].row[0]+S,v=jfgird_select_save[0].column[0]+k,b=0;b<m;b++)for(var _,w,y,x,C,T,I,R=0;R<h;R++){0!=b||null!=(_=r.css("border-top"))&&0<_.length&&"0px"!=_.substr(0,3).toLowerCase()&&(x=r.css("border-top-width"),C=r.css("border-top-style"),T=r.css("border-top-color"),I=jfgrid.menuButton.getQKBorder(x,C,T),null==N[S+b+"_"+(k+R)]&&(N[S+b+"_"+(k+R)]={}),N[S+b+"_"+(k+R)].t={style:I[0],color:I[1]}),b!=m-1||null!=(w=r.css("border-bottom"))&&0<w.length&&"0px"!=w.substr(0,3).toLowerCase()&&(x=r.css("border-bottom-width"),C=r.css("border-bottom-style"),T=r.css("border-bottom-color"),I=jfgrid.menuButton.getQKBorder(x,C,T),null==N[S+b+"_"+(k+R)]&&(N[S+b+"_"+(k+R)]={}),N[S+b+"_"+(k+R)].b={style:I[0],color:I[1]}),0==R&&null!=(n=r.css("border-left"))&&0<n.length&&"0px"!=n.substr(0,3).toLowerCase()&&(x=r.css("border-left-width"),C=r.css("border-left-style"),T=r.css("border-left-color"),I=jfgrid.menuButton.getQKBorder(x,C,T),null==N[S+b+"_"+(k+R)]&&(N[S+b+"_"+(k+R)]={}),N[S+b+"_"+(k+R)].l={style:I[0],color:I[1]}),R!=h-1||null!=(y=r.css("border-right"))&&0<y.length&&"0px"!=y.substr(0,3).toLowerCase()&&(x=r.css("border-right-width"),C=r.css("border-right-style"),T=r.css("border-right-color"),I=jfgrid.menuButton.getQKBorder(x,C,T),null==N[S+b+"_"+(k+R)]&&(N[S+b+"_"+(k+R)]={}),N[S+b+"_"+(k+R)].r={style:I[0],color:I[1]}),0==b&&0==R||(A[S+b][k+R]={mc:{r:p,c:v}})}(1<m||1<h)&&(j={rs:m,cs:h,r:p,c:v},A[S][k].mc=j)}return++k==F||void 0}),S++}),jfgrid_selection_range=[],jfgrid.selection.pasteHandler(A,N),$("#jfgird-copy-content").empty()}else t=r.getData("text/plain"),jfgrid.selection.pasteHandler(t)}}),jfgridConfigsetting.enablePage&&$("#jfgrid-bottom-page-next").click(function(){var e=jfgridConfigsetting.pageInfo.queryExps,r=jfgridConfigsetting.pageInfo.reportId,t=jfgridConfigsetting.pageInfo.fields,i=jfgridConfigsetting.pageInfo.mobile,a=jfgridConfigsetting.pageInfo.frezon,n=jfgridConfigsetting.pageInfo.currentPage,o=(jfgridConfigsetting.pageInfo.totalPage,jfgridConfigsetting.pageInfo.pageUrl);jfgrid.method.addDataAjax({queryExps:e,reportId:r,fields:t,mobile:i,frezon:a,pageIndex:n,currentPage:n},jfgrid.currentSheetIndex,o,function(){jfgridConfigsetting.pageInfo.currentPage++,jfgridConfigsetting.pageInfo.totalPage==jfgridConfigsetting.pageInfo.currentPage?($("#jfgrid-bottom-page-next").hide(),$("#jfgrid-bottom-page-info").html("共"+jfgridConfigsetting.total+"条，"+jfgridConfigsetting.pageInfo.totalPage+"页，已显示全部数据")):$("#jfgrid-bottom-page-info").html("共"+jfgridConfigsetting.total+"条，"+jfgridConfigsetting.pageInfo.totalPage+"页，当前已显示"+jfgridConfigsetting.pageInfo.currentPage+"页")})}).mousedown(function(e){e.stopPropagation()}),$("#jfgrid-bottom-bottom-top").click(function(){$("#jfgrid-scrollbar-y").scrollTop(0)}).mousedown(function(e){e.stopPropagation()})};var showrightclickmenu=function(e,r,t){var i=$(window).height(),a=$(window).width(),n=e.width(),o=e.height(),l=t,d=a<r+n?r-n:r;i<t+o&&(l=t-o),l<0&&(l=0),e.css({top:l,left:d}).show()};function mouseclickposition(e,r,t,i){var a=$(window).height(),n=($(window).width(),e.width());e.height();null==i&&(i="lefttop"),"lefttop"==i?e.css({top:t,left:r}).show():"righttop"==i?e.css({top:t,left:r-n}).show():"leftbottom"==i?e.css({bottom:a-t-12,left:r}).show():"rightbottom"==i&&e.css({bottom:a-t-12,left:r-n}).show()}jfgrid.showrightclickmenu=showrightclickmenu;var jfgridfontformat=function(e){if("object"!=jfgrid.getObjType(e))return jfgriddefaultstyle.font;var r,t,i="";return"0"==e.it||null==e.it?i+="normal ":i+="italic ",i+="normal ","0"==e.bl||null==e.bl?i+="normal ":i+="bold ",e.fs?i+=Math.ceil(e.fs*devicePixelRatio)+"pt ":i+=Math.ceil(10*devicePixelRatio)+"pt ",e.ff?(r=jfgrid.menuButton.fontarray,(t=null)==(t=jfgrid.isdatatypemulti(e.ff).num?r[parseInt(e.ff)]:r[jfgrid.menuButton.fontjson[e.ff]])&&(t="微软雅黑"),i+=t+', "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'):i+='微软雅黑, "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',i};function jfgridDrawgrid(e,r,t,i,a,n){0!=$("#jfgridTableContent").length&&((jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].isPivotTable?jfgridDrawMain_back:jfgridDrawMain)(e,r,t,i,a,n),$("#jfgridTableContent").get(0).getContext("2d").clearRect(0,0,46,20),jfgridDrawgridColumnTitle(e,t,a),jfgridDrawgridRowTitle(r,i,n))}function jfgridDrawgridRowTitle(e,r,t){null==e&&(e=$("#jfgrid-cell-main").scrollTop()),null==r&&(r=jfgridTableContentHW[1]),null==t&&(t=columeHeaderHeight);var i,a,n,o,l=$("#jfgridTableContent").get(0).getContext("2d");l.clearRect(0,t*devicePixelRatio,(rowHeaderWidth-1)*devicePixelRatio,r*devicePixelRatio),l.font=jfgriddefaultstyle.font,l.textBaseline=jfgriddefaultstyle.textBaseline,l.fillStyle=jfgriddefaultstyle.fillStyle,-1==(i=jfgrid_searcharray(visibledatarow,e))&&(i=0),-1==(a=jfgrid_searcharray(visibledatarow,e+r))&&(a=visibledatarow.length-1);for(var d,f,s,g=i;g<=a&&(o=0==g?-e-1:visibledatarow[g-1]-e-1,!(e+r<(n=visibledatarow[g]-e)));g++){null!=config.rowhidden&&null!=config.rowhidden[g]||(d=l.measureText(g+1),f=(rowHeaderWidth*devicePixelRatio-d.width)/2,s=(o+(n-o)/2+t)*devicePixelRatio,l.fillText(g+1,f,s)),l.beginPath(),l.moveTo(-1,(n+t-2+.5)*devicePixelRatio),l.lineTo((rowHeaderWidth-1)*devicePixelRatio,(n+t-2+.5)*devicePixelRatio),l.lineWidth=devicePixelRatio,l.strokeStyle=jfgriddefaultstyle.strokeStyle,l.closePath(),l.stroke()}l.beginPath(),l.moveTo((rowHeaderWidth-2+.5)*devicePixelRatio,(t-1)*devicePixelRatio),l.lineTo((rowHeaderWidth-2+.5)*devicePixelRatio,(rh_height+t)*devicePixelRatio),l.lineWidth=devicePixelRatio,l.strokeStyle=jfgriddefaultstyle.strokeStyle,l.closePath(),l.stroke(),l.clearRect(0,0,rowHeaderWidth*devicePixelRatio,columeHeaderHeight*devicePixelRatio)}function jfgridDrawgridColumnTitle(e,r,t){null==e&&(e=$("#jfgrid-cell-main").scrollLeft()),null==r&&(r=jfgridTableContentHW[0]),null==t&&(t=rowHeaderWidth);var i,a,n,o,l=$("#jfgridTableContent").get(0).getContext("2d");l.clearRect(t*devicePixelRatio,-.5,r*devicePixelRatio,(columeHeaderHeight-1.5)*devicePixelRatio),l.font=jfgriddefaultstyle.font,l.textBaseline=jfgriddefaultstyle.textBaseline,l.fillStyle=jfgriddefaultstyle.fillStyle,-1==(i=jfgrid_searcharray(visibledatacolumn,e))&&(i=0),-1==(a=jfgrid_searcharray(visibledatacolumn,e+r))&&(a=visibledatacolumn.length-1);for(var d=i;d<=a&&(o=0==d?-e:visibledatacolumn[d-1]-e,!(e+r<(n=visibledatacolumn[d]-e)));d++){var f=jfgrid.jfgridchatatABC(d),s=l.measureText(f),g=Math.round((o+(n-o)/2+t)*devicePixelRatio-s.width/2),c=Math.round(columeHeaderHeight/2*devicePixelRatio);l.fillText(f,g,c),l.beginPath(),l.moveTo((n+t-2+.5)*devicePixelRatio,.5),l.lineTo((n+t-2+.5)*devicePixelRatio,(columeHeaderHeight-2)*devicePixelRatio),l.lineWidth=devicePixelRatio,l.strokeStyle=jfgriddefaultstyle.strokeStyle,l.closePath(),l.stroke()}l.beginPath(),l.moveTo((t-1)*devicePixelRatio,(columeHeaderHeight-2+.5)*devicePixelRatio),l.lineTo((ch_width+t-2)*devicePixelRatio,(columeHeaderHeight-2+.5)*devicePixelRatio),l.lineWidth=devicePixelRatio,l.strokeStyle=jfgriddefaultstyle.strokeStyle,l.closePath(),l.stroke(),l.clearRect(0,0,rowHeaderWidth*devicePixelRatio,columeHeaderHeight*devicePixelRatio)}function jfgridDrawMain(scrollWidth,scrollHeight,drawWidth,drawHeight,offsetLeft,offsetTop,columnOffsetCell,rowOffsetCell,mycanvas,ctx,ctxdata){if(null!=ctxdata&&(jfgrid.flowdata=ctxdata),null!=jfgrid.flowdata){null==scrollWidth&&(scrollWidth=$("#jfgrid-cell-main").scrollLeft()),null==scrollHeight&&(scrollHeight=$("#jfgrid-cell-main").scrollTop()),null==drawWidth&&(drawWidth=jfgridTableContentHW[0]),null==drawHeight&&(drawHeight=jfgridTableContentHW[1]),null==offsetLeft&&(offsetLeft=rowHeaderWidth),null==offsetTop&&(offsetTop=columeHeaderHeight),null==columnOffsetCell&&(columnOffsetCell=0),null==rowOffsetCell&&(rowOffsetCell=0);var jfgridTableContent=null;if(null!=ctx){var jfgridTableElement=document.createElement("canvas");jfgridTableElement.width=drawWidth,jfgridTableElement.height=drawHeight,jfgridTableContent=jfgridTableElement.getContext("2d")}else if(null==mycanvas)jfgridTableContent=$("#jfgridTableContent").get(0).getContext("2d");else if("object"==jfgrid.getObjType(mycanvas))try{jfgridTableContent=mycanvas.get(0).getContext("2d")}catch(e){jfgridTableContent=mycanvas}else jfgridTableContent=$("#"+mycanvas).get(0).getContext("2d");jfgridTableContent.clearRect(0,0,jfgridTableContentHW[0]*devicePixelRatio,jfgridTableContentHW[1]*devicePixelRatio);var offlinecanvas=null,offlineElement,dataset_row_st,dataset_row_ed,dataset_col_st,dataset_col_ed,fill_row_st,fill_row_ed,fill_col_st,fill_col_ed,end_r,start_r,end_c,start_c,offlinecanvas=null!=ctx?(offlineElement=document.createElement("canvas"),offlineElement.width=drawWidth,offlineElement.height=drawHeight,offlineElement.getContext("2d")):$("#jfgridTableContentF").get(0).getContext("2d");offlinecanvas.fillStyle="#ffffff",offlinecanvas.fillRect(0,0,jfgridTableContentHW[0]*devicePixelRatio,jfgridTableContentHW[1]*devicePixelRatio),offlinecanvas.font=jfgriddefaultstyle.font,offlinecanvas.textBaseline="top",offlinecanvas.fillStyle=jfgriddefaultstyle.fillStyle,dataset_row_st=jfgrid_searcharray(visibledatarow,scrollHeight),dataset_row_ed=jfgrid_searcharray(visibledatarow,scrollHeight+drawHeight),-1==dataset_row_st&&(dataset_row_st=0),dataset_row_st+=rowOffsetCell,-1==dataset_row_ed&&(dataset_row_ed=visibledatarow.length-1),dataset_row_ed+=rowOffsetCell,dataset_row_ed>=visibledatarow.length&&(dataset_row_ed=visibledatarow.length-1),dataset_col_st=jfgrid_searcharray(visibledatacolumn,scrollWidth),dataset_col_ed=jfgrid_searcharray(visibledatacolumn,scrollWidth+drawWidth),-1==dataset_col_st&&(dataset_col_st=0),dataset_col_st+=columnOffsetCell,-1==dataset_col_ed&&(dataset_col_ed=visibledatacolumn.length-1),dataset_col_ed+=columnOffsetCell,dataset_col_ed>=visibledatacolumn.length&&(dataset_col_ed=visibledatacolumn.length-1),fill_row_st=0==dataset_row_st?0:visibledatarow[dataset_row_st-1],fill_row_ed=visibledatarow[dataset_row_ed],fill_col_st=0==dataset_col_st?0:visibledatacolumn[dataset_col_st-1],fill_col_ed=visibledatacolumn[dataset_col_ed],jfgridTableContent.fillStyle="#ffffff",jfgridTableContent.fillRect((offsetLeft-1)*devicePixelRatio,(offsetTop-1)*devicePixelRatio,(fill_col_ed-scrollWidth)*devicePixelRatio,(fill_row_ed-scrollHeight)*devicePixelRatio),jfgridTableContent.font=jfgriddefaultstyle.font,jfgridTableContent.textBaseline="top",jfgridTableContent.fillStyle=jfgriddefaultstyle.fillStyle;for(var cellupdate=[],mergeCache={},borderOffset={},r=dataset_row_st;r<=dataset_row_ed;r++){start_r=0==r?-scrollHeight-1:visibledatarow[r-1]-scrollHeight-1,end_r=visibledatarow[r]-scrollHeight;for(var c=dataset_col_st;c<=dataset_col_ed;c++)if(start_c=0==c?-scrollWidth:visibledatacolumn[c-1]-scrollWidth,end_c=visibledatacolumn[c]-scrollWidth,c!=dataset_col_ed||jfgridcurrentisPivotTable||(jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(offsetLeft-1),devicePixelRatio*(end_r+offsetTop-2+.5)),jfgridTableContent.lineTo(devicePixelRatio*(fill_col_ed-scrollWidth+offsetLeft-2),devicePixelRatio*(end_r+offsetTop-2+.5)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridTableContent.strokeStyle=jfgriddefaultstyle.strokeStyle,jfgridTableContent.closePath(),jfgridTableContent.stroke()),r!=dataset_row_st||jfgridcurrentisPivotTable||(jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(end_c+offsetLeft-2+.5),devicePixelRatio*(offsetTop-1)),jfgridTableContent.lineTo(devicePixelRatio*(end_c+offsetLeft-2+.5),devicePixelRatio*(fill_row_ed-scrollHeight+offsetTop-2)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridTableContent.strokeStyle=jfgriddefaultstyle.strokeStyle,jfgridTableContent.closePath(),jfgridTableContent.stroke()),jfgridcurrentisPivotTable&&jfgrid.pivotTable.drawPivotTable?((0==c||5==c)&&r<=11&&(jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(end_c-2+.5+offsetLeft),devicePixelRatio*(start_r+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(end_c-2+.5+offsetLeft),devicePixelRatio*(end_r-2+offsetTop)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridTableContent.strokeStyle="#000000",jfgridTableContent.closePath(),jfgridTableContent.stroke()),(2==r||11==r)&&c<=5&&(jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(start_c-1+offsetLeft),devicePixelRatio*(end_r-2+.5+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(end_c-2+offsetLeft),devicePixelRatio*(end_r-2+.5+offsetTop)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridTableContent.strokeStyle="#000000",jfgridTableContent.closePath(),jfgridTableContent.stroke()),6==r&&3==c&&jfgridTableContent.fillText("数据透视表",devicePixelRatio*(start_c+4+offsetLeft),devicePixelRatio*(start_r+(end_r-start_r)/2-1+offsetTop))):jfgridcurrentisPivotTable&&c<jfgrid.pivotTable.pivotTableBoundary[1]&&r<jfgrid.pivotTable.pivotTableBoundary[0]&&(jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(end_c-2+.5+offsetLeft),devicePixelRatio*(start_r+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(end_c-2+.5+offsetLeft),devicePixelRatio*(end_r-2+offsetTop)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridTableContent.strokeStyle="#000000",jfgridTableContent.closePath(),jfgridTableContent.stroke(),jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(start_c-1+offsetLeft),devicePixelRatio*(end_r-2+.5+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(end_c-2+offsetLeft),devicePixelRatio*(end_r-2+.5+offsetTop)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridTableContent.strokeStyle="#000000",jfgridTableContent.closePath(),jfgridTableContent.stroke()),null==config.rowhidden||null==config.rowhidden[r]){var firstcolumlen=defaultcollen;if(null!=config.columlen&&null!=config.columlen[c]&&(firstcolumlen=config.columlen[c]),null!=jfgrid.flowdata[r]&&null!=jfgrid.flowdata[r][c]){var value=jfgrid.flowdata[r][c],key,key,margeMain;if("object"==jfgrid.getObjType(value)&&"mc"in value){borderOffset[r+"_"+c]={start_r:start_r,start_c:start_c,end_r:end_r,end_c:end_c},"rs"in value.mc?(key="r"+r+"c"+c,mergeCache[key]=cellupdate.length):(key="r"+value.mc.r+"c"+value.mc.c,margeMain=cellupdate[mergeCache[key]],null==margeMain?(mergeCache[key]=cellupdate.length,cellupdate.push({r:r,c:c,start_c:start_c,start_r:start_r,end_r:end_r,end_c:end_c,firstcolumlen:firstcolumlen,startlist:[]})):(margeMain.c==c&&(margeMain.end_r+=end_r-start_r-1,margeMain.startlist.push(start_r)),margeMain.r==r&&(margeMain.end_c+=end_c-start_c,margeMain.firstcolumlen+=firstcolumlen)));continue}}cellupdate.push({r:r,c:c,start_r:start_r,start_c:start_c,end_r:end_r,end_c:end_c,firstcolumlen:firstcolumlen,startlist:[]}),borderOffset[r+"_"+c]={start_r:start_r,start_c:start_c,end_r:end_r,end_c:end_c}}}for(var dynamicArray_compute=jfgrid.dynamicArray_compute(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].dynamicArray),af_compute=jfgrid.alternateformat.getComputeMap(),cf_compute=jfgrid.conditionformat.getComputeMap(),sparklinesRender=function(r,c,offsetX,offsetY,canvasid,ctx){if(null!=jfgrid.flowdata[r]&&null!=jfgrid.flowdata[r][c]){var sparklines=jfgrid.flowdata[r][c].spl;if(null!=sparklines)if("string"==typeof sparklines&&(sparklines=eval("("+sparklines+")")),"object"==jfgrid.getObjType(sparklines)){var temp1=sparklines,x=temp1.offsetX,y=temp1.offsetY;x=null==x?0:x,y=null==y?0:y,jfgrid.sparkline.render(temp1.shapeseq,temp1.shapes,offsetX+x,offsetY+y,temp1.pixelWidth,temp1.pixelHeight,canvasid,ctx)}else if("array"==jfgrid.getObjType(sparklines)&&"object"==jfgrid.getObjType(sparklines[0]))for(var i=0;i<sparklines.length;i++){var temp1=sparklines[i],x=temp1.offsetX,y=temp1.offsetY;x=null==x?0:x,y=null==y?0:y,jfgrid.sparkline.render(temp1.shapeseq,temp1.shapes,offsetX+x,offsetY+y,temp1.pixelWidth,temp1.pixelHeight,canvasid,ctx)}}},nullCellRender=function(e,r,t,i,a,n){var o=jfgrid.alternateformat.checksAF(e,r,af_compute),l=jfgrid.conditionformat.checksCF(e,r,cf_compute),d=jfgrid.menuButton.borderfix(jfgrid.flowdata,e,r);jfgridTableContent.fillStyle=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"bg"),null!=o&&null!=o[1]&&(jfgridTableContent.fillStyle=o[1]),null!=l&&null!=l.cellColor&&(jfgridTableContent.fillStyle=l.cellColor),null!=jfgrid.flowdata[e][r]&&null!=jfgrid.flowdata[e][r].tc&&(jfgridTableContent.fillStyle=jfgrid.flowdata[e][r].tc);var f,s,g,c,u,m,h=[devicePixelRatio*(i+offsetLeft+d[0]),devicePixelRatio*(t+offsetTop+1+d[1]),devicePixelRatio*(n-i-3+d[2]),devicePixelRatio*(a-t-3-.5+d[3])];jfgridTableContent.fillRect(h[0],h[1],h[2],h[3]),e+"_"+r in dynamicArray_compute&&(f=dynamicArray_compute[e+"_"+r].v,jfgridTableContent.fillStyle="#000000",s=jfgriddefaultstyle.font,jfgridTableContent.font=s,jfgridTableContent.measureText(f).width,g=jfgrid.menuButton.getTextSize("田",s)[1],c=(i+4+offsetLeft)*devicePixelRatio,u=jfgrid.browser.jfgridrefreshfixed(),m=(a+offsetTop-2+u)*devicePixelRatio-g,jfgridTableContent.fillText(null==f?"":f,c,m)),null!=jfgrid.flowdata[e][r]&&null!=jfgrid.flowdata[e][r].ps&&(jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(n+offsetLeft-6),devicePixelRatio*(t+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(n+offsetLeft-1),devicePixelRatio*(t+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(n+offsetLeft-1),devicePixelRatio*(t+offsetTop+5)),jfgridTableContent.fillStyle="#FC6666",jfgridTableContent.fill(),jfgridTableContent.closePath()),jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(n-2+.5+offsetLeft),devicePixelRatio*(t+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(n-2+.5+offsetLeft),devicePixelRatio*(a-2+offsetTop)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridcurrentisPivotTable&&!jfgrid.pivotTable.drawPivotTable?jfgridTableContent.strokeStyle="#000000":jfgridTableContent.strokeStyle=jfgriddefaultstyle.strokeStyle,jfgridTableContent.stroke(),jfgridTableContent.closePath(),jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(i-2+offsetLeft),devicePixelRatio*(a-2+.5+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(n+offsetLeft-2),devicePixelRatio*(a-2+.5+offsetTop)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridcurrentisPivotTable&&!jfgrid.pivotTable.drawPivotTable?jfgridTableContent.strokeStyle="#000000":jfgridTableContent.strokeStyle=jfgriddefaultstyle.strokeStyle,jfgridTableContent.stroke(),jfgridTableContent.closePath()},cellRender=function(e,r,t,i,a,n,o,l){var d=jfgrid.alternateformat.checksAF(e,r,af_compute),f=jfgrid.conditionformat.checksCF(e,r,cf_compute),s=jfgrid.menuButton.borderfix(jfgrid.flowdata,e,r),g=jfgridfontformat(jfgrid.flowdata[e][r]);jfgridTableContent.font=g;var c=jfgridTableContent.measureText(o).width,u=jfgrid.menuButton.getTextSize("田",g)[1];if("2"==jfgrid.flowdata[e][r].tb){for(var m=o.toString(),h=n-i-8,j=[],p=1;p<=m.length;p++){var v=m.substring(j.join("").length,p);h<(q=jfgridTableContent.measureText(v).width)?(j.push(m.substring(j.join("").length,p-1)),p-=2):q<=h&&p==m.length&&j.push(v)}var b=j.length*u}else{null!=jfgrid.flowdata[e][r].tr&&"0"!=jfgrid.flowdata[e][r].tr?"1"==(z=jfgrid.flowdata[e][r].tr)||"2"==z?b=U=.707*(c+u):"3"==z?(1<(o=o.toString()).length?D=o.split(""):(D=[]).push(o),U=jfgridTableContent.measureText(D[0]).width,b=D.length*u):"4"!=z&&"5"!=z||(U=u,b=c):(U=c,b=u)}var _=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"ht"),w=(i+4+offsetLeft)*devicePixelRatio;"0"==_?w=(i+(n-i)/2+offsetLeft)*devicePixelRatio-c/2:"2"==_&&(w=(n+offsetLeft-8)*devicePixelRatio-c);var y,x,C,T,I,R,k,S,A,F,N,M,E,O,z,D,P=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"vt"),L=jfgrid.browser.jfgridrefreshfixed(),B=(a+offsetTop-2+L)*devicePixelRatio-u;if("0"==P?B=(t+(a-t)/2+offsetTop+L)*devicePixelRatio-u/2:"1"==P&&(B=(t+offsetTop+L)*devicePixelRatio),x="Safari"!=jfgrid.browser.BrowserType()&&("offline"==l||("0"==_||"2"==_)&&n-i<U||("0"==P||"2"==P)&&a-t<b)?((y=offlinecanvas).font=g,[devicePixelRatio*(i+offsetLeft+s[0]),devicePixelRatio*(t+offsetTop+.5+s[1]),devicePixelRatio*(n-i-3+s[2]),devicePixelRatio*(a-t-3-.5+s[3])]):(y=jfgridTableContent,[devicePixelRatio*(i+offsetLeft+s[0]),devicePixelRatio*(t+offsetTop+1+s[1]),devicePixelRatio*(n-i-3+s[2]),devicePixelRatio*(a-t-3-.5+s[3])]),y.fillStyle=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"bg"),null!=d&&null!=d[1]&&(y.fillStyle=d[1]),null!=f&&null!=f.cellColor&&(y.fillStyle=f.cellColor),null!=jfgrid.flowdata[e][r]&&null!=jfgrid.flowdata[e][r].tc&&(jfgridTableContent.fillStyle=jfgrid.flowdata[e][r].tc),y.fillRect(x[0],x[1],x[2],x[3]),null!=jfgrid.flowdata[e][r].ps&&(y.beginPath(),y.moveTo(devicePixelRatio*(n+offsetLeft-6),devicePixelRatio*(t+offsetTop)),y.lineTo(devicePixelRatio*(n+offsetLeft-1),devicePixelRatio*(t+offsetTop)),y.lineTo(devicePixelRatio*(n+offsetLeft-1),devicePixelRatio*(t+offsetTop+5)),y.fillStyle="#FC6666",y.fill(),y.closePath()),null!=f&&null!=f.dataBar&&(C=devicePixelRatio*(i+offsetLeft+s[0]+2),T=devicePixelRatio*(t+offsetTop+.5+s[1]+2),I=devicePixelRatio*(n-i-3+s[2]-4),R=devicePixelRatio*(a-t-3-.5+s[3]-4),k=f.dataBar.valueType,S=f.dataBar.valueLen,1<(A=f.dataBar.format).length?"minus"==k?(M=f.dataBar.minusLen,(F=y.createLinearGradient(C+I*M*(1-S),T,C+I*M,T)).addColorStop(0,"#ffffff"),F.addColorStop(1,"#ff0000"),y.fillStyle=F,y.fillRect(C+I*M*(1-S),T,I*M*S,R),y.beginPath(),y.moveTo(C+I*M*(1-S),T),y.lineTo(C+I*M*(1-S),T+R),y.lineTo(C+I*M,T+R),y.lineTo(C+I*M,T),y.lineTo(C+I*M*(1-S),T),y.lineWidth=devicePixelRatio,y.strokeStyle="#ff0000",y.stroke(),y.closePath()):"plus"==k&&(1==(N=f.dataBar.plusLen)?((F=y.createLinearGradient(C,T,C+I*S,T)).addColorStop(0,A[0]),F.addColorStop(1,A[1]),y.fillStyle=F,y.fillRect(C,T,I*S,R),y.beginPath(),y.moveTo(C,T),y.lineTo(C,T+R),y.lineTo(C+I*S,T+R),y.lineTo(C+I*S,T),y.lineTo(C,T)):(M=f.dataBar.minusLen,(F=y.createLinearGradient(C+I*M,T,C+I*M+I*N*S,T)).addColorStop(0,A[0]),F.addColorStop(1,A[1]),y.fillStyle=F,y.fillRect(C+I*M,T,I*N*S,R),y.beginPath(),y.moveTo(C+I*M,T),y.lineTo(C+I*M,T+R),y.lineTo(C+I*M+I*N*S,T+R),y.lineTo(C+I*M+I*N*S,T),y.lineTo(C+I*M,T)),y.lineWidth=devicePixelRatio,y.strokeStyle=A[0],y.stroke(),y.closePath()):"minus"==k?(M=f.dataBar.minusLen,y.fillStyle="#ff0000",y.fillRect(C+I*M*(1-S),T,I*M*S,R),y.beginPath(),y.moveTo(C+I*M*(1-S),T),y.lineTo(C+I*M*(1-S),T+R),y.lineTo(C+I*M,T+R),y.lineTo(C+I*M,T),y.lineTo(C+I*M*(1-S),T),y.lineWidth=devicePixelRatio,y.strokeStyle="#ff0000",y.stroke(),y.closePath()):"plus"==k&&(1==(N=f.dataBar.plusLen)?(y.fillStyle=A[0],y.fillRect(C,T,I*S,R),y.beginPath(),y.moveTo(C,T),y.lineTo(C,T+R),y.lineTo(C+I*S,T+R),y.lineTo(C+I*S,T),y.lineTo(C,T)):(M=f.dataBar.minusLen,y.fillStyle=A[0],y.fillRect(C+I*M,T,I*N*S,R),y.beginPath(),y.moveTo(C+I*M,T),y.lineTo(C+I*M,T+R),y.lineTo(C+I*M+I*N*S,T+R),y.lineTo(C+I*M+I*N*S,T),y.lineTo(C+I*M,T)),y.lineWidth=devicePixelRatio,y.strokeStyle=A[0],y.stroke(),y.closePath())),null!=f&&null!=f.icons&&(E=f.icons.left,O=f.icons.top,y.drawImage(jfgrid_CFiconsImg,42*E,32*O,32,32,x[0],B+2,u-2,u-2),"0"!=_&&"2"!=_&&(w=w+u-2)),y.fillStyle=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"fc"),null!=d&&null!=d[0]&&(y.fillStyle=d[0]),null!=f&&null!=f.textColor&&(y.fillStyle=f.textColor),null!=jfgrid.flowdata[e][r].dd)y.fillStyle="#0000ff",y.fillText(null==o?"":o,w,B),y.beginPath(),y.strokeStyle="#0000ff",y.moveTo(w,B+u),y.lineTo(w+c,B+u),y.closePath(),y.stroke();else if("2"==jfgrid.flowdata[e][r].tb){for(m=o.toString(),h=n-i-8,j=[],p=1;p<=m.length;p++){var q,v=m.substring(j.join("").length,p);h<(q=y.measureText(v).width)?(j.push(m.substring(j.join("").length,p-1)),p-=2):q<=h&&p==m.length&&j.push(v)}for(var H=0;H<j.length;H++){var V=y.measureText(j[H]).width;"0"==_?w=(i+(n-i)/2+offsetLeft)*devicePixelRatio-V/2:"2"==_&&(w=(n+offsetLeft-8)*devicePixelRatio-V),B="0"==P?(t+(a-t)/2+offsetTop+L)*devicePixelRatio-u*j.length/2:"1"==P?(t+offsetTop+L)*devicePixelRatio:(a+offsetTop-2+L)*devicePixelRatio-u*j.length,y.fillText(j[H],w,B+H*u)}}else if(null!=jfgrid.flowdata[e][r].tr&&"0"!=jfgrid.flowdata[e][r].tr){if("1"==(z=jfgrid.flowdata[e][r].tr)||"2"==z){var U=.707*(c+u),Y=(i+4+offsetLeft)*devicePixelRatio;"0"==_?Y=(i+(n-i)/2+offsetLeft)*devicePixelRatio-U/2:"2"==_&&(Y=(n+offsetLeft-8)*devicePixelRatio-U);var W=(a+offsetTop-2+L)*devicePixelRatio-(b=.707*(c+u));"0"==P?W=(t+(a-t)/2+offsetTop+L)*devicePixelRatio-b/2:"1"==P&&(W=(t+offsetTop+L)*devicePixelRatio),"1"==z&&(y.save(),y.translate(Y,W),y.rotate(45*Math.PI/180),y.translate(-Y,-W),y.fillText(null==o?"":o,Y+.707*.707*u,W-.707*.707*u),y.restore(),"1"!=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"cl")||jfgrid.func_methods.isRealNull(o)||(y.beginPath(),y.strokeStyle="#000",y.moveTo(Y+u/2,W+u/2),y.lineTo(Y+U-u/2,W+b-u/2),y.closePath(),y.stroke())),"2"==z&&(y.save(),y.translate(Y,W+b),y.rotate(-45*Math.PI/180),y.translate(-Y,-(W+b)),y.fillText(null==o?"":o,Y+.707*.707*u,W+b-.707*.707*u),y.restore(),"1"!=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"cl")||jfgrid.func_methods.isRealNull(o)||(y.beginPath(),y.strokeStyle="#000",y.moveTo(Y+u/2,W+b-u/2),y.lineTo(Y+U-u/2,W+u/2),y.closePath(),y.stroke()))}else if("3"==z){if(!jfgrid.func_methods.isRealNull(o)){1<(o=o.toString()).length?D=o.split(""):(D=[]).push(o);for(var U=y.measureText(D[0]).width,b=D.length*u,G=0;G<D.length;G++){var X=y.measureText(D[G]).width,w="0"==_?(i+(n-i)/2+offsetLeft)*devicePixelRatio-X/2:"2"==_?(n+offsetLeft-8)*devicePixelRatio-X:(i+4+offsetLeft)*devicePixelRatio,B="0"==P?(t+(a-t)/2+offsetTop+L)*devicePixelRatio-u*D.length/2:"1"==P?(t+offsetTop+L)*devicePixelRatio:(a+offsetTop-2+L)*devicePixelRatio-u*D.length;y.fillText(D[G],w,B+G*u)}"1"!=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"cl")||jfgrid.func_methods.isRealNull(o)||(y.beginPath(),y.strokeStyle="#000",y.moveTo(w+U/2,B),y.lineTo(w+U/2,B+b),y.closePath(),y.stroke())}}else{"4"!=z&&"5"!=z||(U=u,Y=(i+4+offsetLeft)*devicePixelRatio,"0"==_?Y=(i+(n-i)/2+offsetLeft)*devicePixelRatio-U/2:"2"==_&&(Y=(n+offsetLeft-8)*devicePixelRatio-U),W=(a+offsetTop-2+L)*devicePixelRatio-(b=c),"0"==P?W=(t+(a-t)/2+offsetTop+L)*devicePixelRatio-b/2:"1"==P&&(W=(t+offsetTop+L)*devicePixelRatio),"4"==z&&(y.save(),y.translate(Y,W),y.rotate(90*Math.PI/180),y.translate(-Y,-W),y.fillText(null==o?"":o,Y,W-U),y.restore(),"1"!=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"cl")||jfgrid.func_methods.isRealNull(o)||(y.beginPath(),y.strokeStyle="#000",y.moveTo(Y+U/2,W),y.lineTo(Y+U/2,W+b),y.closePath(),y.stroke())),"5"==z&&(y.save(),y.translate(Y+b,W),y.rotate(-90*Math.PI/180),y.translate(-(Y+b),-W),y.fillText(null==o?"":o,Y,W-b),y.restore(),"1"!=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"cl")||jfgrid.func_methods.isRealNull(o)||(y.beginPath(),y.strokeStyle="#000",y.moveTo(Y+U/2,W),y.lineTo(Y+U/2,W+b),y.closePath(),y.stroke())))}}else{y.fillText(null==o?"":o,w,B),"1"!=jfgrid.menuButton.checkstatus(jfgrid.flowdata,e,r,"cl")||jfgrid.func_methods.isRealNull(o)||(y.beginPath(),y.strokeStyle="#000",y.moveTo(w,B+u/2),y.lineTo(w+c,B+u/2),y.closePath(),y.stroke())}"Safari"!=jfgrid.browser.BrowserType()&&("offline"==l||("0"==_||"2"==_)&&n-i<U||("0"==P||"2"==P)&&a-t<b)&&(y.font=jfgriddefaultstyle.font,0<$("#jfgridTableContentF").length?jfgridTableContent.drawImage($("#jfgridTableContentF").get(0),x[0],x[1],x[2],x[3],x[0],x[1],x[2],x[3]):jfgridTableContent.drawImage(offlineElement,x[0],x[1],x[2],x[3],x[0],x[1],x[2],x[3])),jfgridTableContent.font=jfgriddefaultstyle.font,jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(n-2+.5+offsetLeft),devicePixelRatio*(t+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(n-2+.5+offsetLeft),devicePixelRatio*(a-2+offsetTop)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridcurrentisPivotTable&&!jfgrid.pivotTable.drawPivotTable?jfgridTableContent.strokeStyle="#000000":jfgridTableContent.strokeStyle=jfgriddefaultstyle.strokeStyle,jfgridTableContent.stroke(),jfgridTableContent.closePath(),jfgridTableContent.beginPath(),jfgridTableContent.moveTo(devicePixelRatio*(i-2+offsetLeft),devicePixelRatio*(a-2+.5+offsetTop)),jfgridTableContent.lineTo(devicePixelRatio*(n+offsetLeft-2),devicePixelRatio*(a-2+.5+offsetTop)),jfgridTableContent.lineWidth=devicePixelRatio,jfgridcurrentisPivotTable&&!jfgrid.pivotTable.drawPivotTable?jfgridTableContent.strokeStyle="#000000":jfgridTableContent.strokeStyle=jfgriddefaultstyle.strokeStyle,jfgridTableContent.stroke(),jfgridTableContent.closePath()},mcArr=[],cud=0;cud<cellupdate.length;cud++){var item=cellupdate[cud],r=item.r,c=item.c,start_r=item.start_r,start_c=item.start_c,end_r=item.end_r,end_c=item.end_c,firstcolumlen=item.firstcolumlen,cell,value,er,ec,end_ec,margeMaindata,borderfix,cellsize;null!=jfgrid.flowdata[r]&&(null==jfgrid.flowdata[r][c]?nullCellRender(r,c,start_r,start_c,end_r,end_c):(cell=jfgrid.flowdata[r][c],value=null,er=r,ec=c,end_ec=end_c,"object"==typeof cell&&"mc"in cell?(mcArr.push(cellupdate[cud]),margeMaindata=cell.mc,value=jfgrid.getcellvalue(margeMaindata.r,margeMaindata.c,null,"m"),null==value&&(value=jfgrid.getcellvalue(margeMaindata.r,margeMaindata.c)),r=margeMaindata.r,c=margeMaindata.c,er+=margeMaindata.rs,ec+=margeMaindata.rc,start_c=0==c?-scrollWidth:visibledatacolumn[c-1]-scrollWidth,start_r=0==r?-scrollHeight-1:visibledatarow[r-1]-scrollHeight-1,end_ec=visibledatacolumn[ec]-scrollWidth):(value=jfgrid.getcellvalue(r,c,null,"m"),null==value&&(value=jfgrid.getcellvalue(r,c))),null==value||0==value.toString().length?(nullCellRender(r,c,start_r,start_c,end_r,end_c),borderfix=jfgrid.menuButton.borderfix(jfgrid.flowdata,r,c),cellsize=[devicePixelRatio*(start_c+offsetLeft+borderfix[0]),devicePixelRatio*(start_r+offsetTop+.5+borderfix[1]),devicePixelRatio*(end_c-start_c-3+borderfix[2]),devicePixelRatio*(end_r-start_r-3-.5+borderfix[3])],sparklinesRender(r,c,cellsize[0],cellsize[1],"jfgridTableContent",jfgridTableContent)):(r+"_"+c in dynamicArray_compute&&(value=dynamicArray_compute[r+"_"+c].v),cellRender(r,c,start_r,start_c,end_r,end_c,value))))}for(var m=0;m<mcArr.length;m++){var item=mcArr[m],r=item.r,c=item.c,start_r=item.start_r,start_c=item.start_c,end_r=item.end_r,end_c=item.end_c,firstcolumlen=item.firstcolumlen,cell=jfgrid.flowdata[r][c],value=null,er=r,ec=c,end_ec=end_c,margeMaindata=cell.mc,borderfix,cellsize;value=jfgrid.getcellvalue(margeMaindata.r,margeMaindata.c,null,"m"),null==value&&(value=jfgrid.getcellvalue(margeMaindata.r,margeMaindata.c)),r=margeMaindata.r,c=margeMaindata.c,er+=margeMaindata.rs,ec+=margeMaindata.rc,start_c=0==c?-scrollWidth:visibledatacolumn[c-1]-scrollWidth,start_r=0==r?-scrollHeight-1:visibledatarow[r-1]-scrollHeight-1,end_ec=visibledatacolumn[ec]-scrollWidth,null==value||0==value.toString().length?(nullCellRender(r,c,start_r,start_c,end_r,end_c),borderfix=jfgrid.menuButton.borderfix(jfgrid.flowdata,r,c),cellsize=[devicePixelRatio*(start_c+offsetLeft+borderfix[0]),devicePixelRatio*(start_r+offsetTop+.5+borderfix[1]),devicePixelRatio*(end_c-start_c-3+borderfix[2]),devicePixelRatio*(end_r-start_r-3-.5+borderfix[3])],sparklinesRender(r,c,cellsize[0],cellsize[1],"jfgridTableContent",jfgridTableContent)):(r+"_"+c in dynamicArray_compute&&(value=dynamicArray_compute[r+"_"+c].v),cellRender(r,c,start_r,start_c,end_r,end_c,value,"offline"))}if(null!=config.borderInfo&&0<config.borderInfo.length){var borderLeftRender=function(e,r,t,i,a,n,o,l,d){var f=devicePixelRatio*(i-2+.5+o),s=devicePixelRatio*(t+l),g=devicePixelRatio*(i-2+.5+o),c=devicePixelRatio*(a-2+l);jfgrid.menuButton.setLineDash(d,e,"v",f,s,g,c),d.strokeStyle=r,d.stroke(),d.closePath()},borderRightRender=function(e,r,t,i,a,n,o,l,d){var f=devicePixelRatio*(n-2+.5+o),s=devicePixelRatio*(t+l),g=devicePixelRatio*(n-2+.5+o),c=devicePixelRatio*(a-2+l);jfgrid.menuButton.setLineDash(d,e,"v",f,s,g,c),d.strokeStyle=r,d.stroke(),d.closePath()},borderBottomRender=function(e,r,t,i,a,n,o,l,d){var f=devicePixelRatio*(i-2+o),s=devicePixelRatio*(a-2+.5+l),g=devicePixelRatio*(n+o-2),c=devicePixelRatio*(a-2+.5+l);jfgrid.menuButton.setLineDash(d,e,"h",f,s,g,c),d.strokeStyle=r,d.stroke(),d.closePath()},borderTopRender=function(e,r,t,i,a,n,o,l,d){var f=devicePixelRatio*(i-2+o),s=devicePixelRatio*(t-1+.5+l),g=devicePixelRatio*(n+o-2),c=devicePixelRatio*(t-1+.5+l);jfgrid.menuButton.setLineDash(d,e,"h",f,s,g,c),d.strokeStyle=r,d.stroke(),d.closePath()},borderInfoCompute=jfgrid.getBorderInfoCompute();for(x in borderInfoCompute){var bd_r=x.split("_")[0],bd_c=x.split("_")[1],start_r,start_c,end_r,end_c,borderLeft,borderRight,borderTop,borderBottom;borderOffset[bd_r+"_"+bd_c]&&(start_r=borderOffset[bd_r+"_"+bd_c].start_r,start_c=borderOffset[bd_r+"_"+bd_c].start_c,end_r=borderOffset[bd_r+"_"+bd_c].end_r,end_c=borderOffset[bd_r+"_"+bd_c].end_c,borderLeft=borderInfoCompute[x].l,null!=borderLeft&&borderLeftRender(borderLeft.style,borderLeft.color,start_r,start_c,end_r,end_c,offsetLeft,offsetTop,jfgridTableContent),borderRight=borderInfoCompute[x].r,null!=borderRight&&borderRightRender(borderRight.style,borderRight.color,start_r,start_c,end_r,end_c,offsetLeft,offsetTop,jfgridTableContent),borderTop=borderInfoCompute[x].t,null!=borderTop&&borderTopRender(borderTop.style,borderTop.color,start_r,start_c,end_r,end_c,offsetLeft,offsetTop,jfgridTableContent),borderBottom=borderInfoCompute[x].b,null!=borderBottom&&borderBottomRender(borderBottom.style,borderBottom.color,start_r,start_c,end_r,end_c,offsetLeft,offsetTop,jfgridTableContent))}}dataset_col_ed==visibledatacolumn.length-1&&jfgridTableContent.clearRect((fill_col_ed-scrollWidth+offsetLeft-1)*devicePixelRatio,(offsetTop-1)*devicePixelRatio,(ch_width-visibledatacolumn[dataset_col_ed])*devicePixelRatio,(fill_row_ed-scrollHeight)*devicePixelRatio),null!=ctx&&ctx.drawImage(jfgridTableElement,0,0,drawWidth,drawHeight,-drawWidth/2+offsetLeft,-drawHeight/2+offsetTop,drawWidth,drawHeight)}}function jfgridDrawMain_back(e,r,t,i,a,n,o,l,d){null==e&&(e=$("#jfgrid-cell-main").scrollLeft()),null==r&&(r=$("#jfgrid-cell-main").scrollTop()),null==t&&(t=jfgridTableContentHW[0]),null==i&&(i=jfgridTableContentHW[1]),null==a&&(a=rowHeaderWidth),null==n&&(n=columeHeaderHeight),null==o&&(o=0),null==l&&(l=0);var f=null;if(null==d)f=$("#jfgridTableContent").get(0).getContext("2d");else if("object"==jfgrid.getObjType(d))try{f=d.get(0).getContext("2d")}catch(e){f=d}else f=$("#"+d).get(0).getContext("2d");f.clearRect(a*devicePixelRatio,n*devicePixelRatio,t*devicePixelRatio,i*devicePixelRatio);var s,g,c,u,m,h,j,p,v=$("#jfgridTableContentF").get(0).getContext("2d");v.fillStyle="#ffffff",v.fillRect(0,0,jfgridTableContentHW[0]*devicePixelRatio,jfgridTableContentHW[1]*devicePixelRatio),v.font=jfgriddefaultstyle.font,v.textBaseline="top",v.fillStyle=jfgriddefaultstyle.fillStyle,-1==(s=jfgrid_searcharray(visibledatarow,r))&&(s=0),s+=l,-1==(g=jfgrid_searcharray(visibledatarow,r+i))&&(g=visibledatarow.length-1),(g+=l)>=visibledatarow.length&&(g=visibledatarow.length-1),-1==(c=jfgrid_searcharray(visibledatacolumn,e))&&(c=0),c+=o,-1==(u=jfgrid_searcharray(visibledatacolumn,e+t))&&(u=visibledatacolumn.length-1),(u+=o)>=visibledatacolumn.length&&(u=visibledatacolumn.length-1),m=0==s?0:visibledatarow[s-1],h=visibledatarow[g],j=0==c?0:visibledatacolumn[c-1],p=visibledatacolumn[u],f.fillStyle="#ffffff",f.fillRect((a-1)*devicePixelRatio,(n-1)*devicePixelRatio,(p-j)*devicePixelRatio,(h-m)*devicePixelRatio);for(var b=[],_={},w=s;w<=g;w++){F=0==w?-r-1:visibledatarow[w-1]-r-1,M=visibledatarow[w]-r;for(var y=c;y<=u;y++)if(A=0==y?-e:visibledatacolumn[y-1]-e,N=visibledatacolumn[y]-e,y==u&&!jfgridcurrentisPivotTable&&M<=i&&-1<=F&&(f.beginPath(),f.moveTo(devicePixelRatio*(a-1),devicePixelRatio*(M+n-2+.5)),f.lineTo(devicePixelRatio*(N+a-2),devicePixelRatio*(M+n-2+.5)),f.lineWidth=devicePixelRatio,f.strokeStyle=jfgriddefaultstyle.strokeStyle,f.closePath(),f.stroke()),w==s&&!jfgridcurrentisPivotTable&&N<=t+18&&-1<=A&&(f.beginPath(),f.moveTo(devicePixelRatio*(N+a-2+.5),devicePixelRatio*(n-1)),f.lineTo(devicePixelRatio*(N+a-2+.5),devicePixelRatio*(h-m+n-2)),f.lineWidth=devicePixelRatio,f.strokeStyle=jfgriddefaultstyle.strokeStyle,f.closePath(),f.stroke()),jfgridcurrentisPivotTable&&jfgrid.pivotTable.drawPivotTable?((0==y||5==y)&&w<=11&&(f.beginPath(),f.moveTo(devicePixelRatio*(N-2+.5+a),devicePixelRatio*(F+n)),f.lineTo(devicePixelRatio*(N-2+.5+a),devicePixelRatio*(M-2+n)),f.lineWidth=devicePixelRatio,f.strokeStyle="#000000",f.closePath(),f.stroke()),(2==w||11==w)&&y<=5&&(f.beginPath(),f.moveTo(devicePixelRatio*(A-1+a),devicePixelRatio*(M-2+.5+n)),f.lineTo(devicePixelRatio*(N+a-2),devicePixelRatio*(M-2+.5+n)),f.lineWidth=devicePixelRatio,f.strokeStyle="#000000",f.closePath(),f.stroke()),6==w&&3==y&&f.fillText("数据透视表",devicePixelRatio*(A+4+a),devicePixelRatio*(F+(M-F)/2-1+n))):jfgridcurrentisPivotTable&&y<jfgrid.pivotTable.pivotTableBoundary[1]&&w<jfgrid.pivotTable.pivotTableBoundary[0]&&(f.beginPath(),f.moveTo(devicePixelRatio*(N-2+.5+a),devicePixelRatio*(F+n)),f.lineTo(devicePixelRatio*(N-2+.5+a),devicePixelRatio*(M-2+n)),f.lineWidth=devicePixelRatio,f.strokeStyle="#000000",f.closePath(),f.stroke(),f.beginPath(),f.moveTo(devicePixelRatio*(A-1+a),devicePixelRatio*(M-2+.5+n)),f.lineTo(devicePixelRatio*(N+a-2),devicePixelRatio*(M-2+.5+n)),f.lineWidth=devicePixelRatio,f.strokeStyle="#000000",f.closePath(),f.stroke()),(null==config.rowhidden||null==config.rowhidden[w])&&null!=jfgrid.flowdata[w]&&null!=jfgrid.flowdata[w][y]&&-1<=F&&-1<=A){var x=jfgrid.flowdata[w][y],C=defaultcollen;if(null!=config.columlen&&null!=config.columlen[y]&&(C=config.columlen[y]),"object"==jfgrid.getObjType(x)&&"mc"in x){if(!("rs"in x.mc)){var T,I=b[_[T="r"+x.mc.r+"c"+x.mc.c]];null==I?(_[T]=b.length,b.push({r:w,c:y,start_c:A,start_r:F,end_r:M,end_c:N,firstcolumlen:C,startlist:[]})):(I.c==y&&(I.end_r+=M-F-1,I.startlist.push(F)),I.r==w&&(I.end_c+=N-A,I.firstcolumlen+=C),k=jfgrid.flowdata[I.r][I.c],I.c+k.mc.cs-1==y&&(I.r,k.mc.rs));continue}_[T="r"+w+"c"+y]=b.length}b.push({r:w,c:y,start_c:A,start_r:F,end_r:M,end_c:N,firstcolumlen:C,startlist:[]})}null!=config.rowhidden&&config.rowhidden[w]}for(var R=0;R<b.length;R++){var k,S=b[R],w=S.r,y=S.c,A=S.start_c,F=S.start_r,N=S.end_c,M=S.end_r,C=S.firstcolumlen,E=jfgrid.flowdata[w][y],x=null,O=y;"object"==typeof E&&"mc"in E?(k=E.mc,null==(x=jfgrid.getcellvalue(k.r,k.c,null,"m"))&&(x=jfgrid.getcellvalue(k.r,k.c)),w=k.r,y=k.c,k.rs,O+=k.rc,A=0==y?-e:visibledatacolumn[y-1]-e,F=0==w?-r-1:visibledatarow[w-1]-r-1,visibledatacolumn[O]):null==(x=jfgrid.getcellvalue(w,y,null,"m"))&&(x=jfgrid.getcellvalue(w,y));var z=jfgrid.menuButton.borderfix(jfgrid.flowdata,w,y);v.fillStyle=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bg");var D=[devicePixelRatio*(A+a+z[0]),devicePixelRatio*(F+n+.5+z[1]),devicePixelRatio*(N-A-3+z[2]),devicePixelRatio*(M-F-3-.5+z[3])];v.fillRect(D[0],D[1],D[2],D[3]),v.fillStyle=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"fc");var P=jfgridfontformat(jfgrid.flowdata[w][y]);v.font=P;var L=v.measureText(x).width,B=jfgrid.menuButton.getTextSize("田",P)[1];v.fillStyle=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"fc");var q=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"ht"),H=(A+4+a)*devicePixelRatio;"0"==q?H=(A+(N-A)/2+a)*devicePixelRatio-L/2:"2"==q&&(H=(N+a-8)*devicePixelRatio-L);var V=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"vt"),U=jfgrid.browser.jfgridrefreshfixed(),Y=(M+n-2+U)*devicePixelRatio-B;if("0"==V?Y=(F+(M-F)/2+n+U)*devicePixelRatio-B/2:"1"==V&&(Y=(F+n+U)*devicePixelRatio),"2"==jfgrid.flowdata[w][y].tb&&N-A<L){for(var W=x.toString(),G=N-A-8,X=[],Z=1;Z<=W.length;Z++){var K=W.substring(X.join("").length,Z),J=v.measureText(K).width;G<J?(X.push(W.substring(X.join("").length,Z-1)),Z-=2):J<=G&&Z==W.length&&X.push(K)}for(var Q=0;Q<X.length;Q++){var ee=v.measureText(X[Q]).width,H="0"==q?(A+(N-A)/2+a)*devicePixelRatio-ee/2:"2"==q?(N+a-8)*devicePixelRatio-ee:(A+4+a)*devicePixelRatio,Y="0"==V?(F+(M-F)/2+n+U)*devicePixelRatio-B*X.length/2:"1"==V?(F+n+U)*devicePixelRatio:(M+n-2+U)*devicePixelRatio-B*X.length;v.fillText(X[Q],H,Y+Q*B)}}else if(jfgrid.flowdata[w][y].tr&&"0"!=jfgrid.flowdata[w][y].tr){var re,te=jfgrid.flowdata[w][y].tr;if("1"==te||"2"==te){var ie=.707*(L+B),ae=(A+4+a)*devicePixelRatio;"0"==q?ae=(A+(N-A)/2+a)*devicePixelRatio-ie/2:"2"==q&&(ae=(N+a-8)*devicePixelRatio-ie);var ne=(M+n-2+U)*devicePixelRatio-(oe=.707*(L+B));"0"==V?ne=(F+(M-F)/2+n+U)*devicePixelRatio-oe/2:"1"==V&&(ne=(F+n+U)*devicePixelRatio),"1"==te&&(v.save(),v.translate(ae,ne),v.rotate(45*Math.PI/180),v.translate(-ae,-ne),v.fillText(null==x?"":x,ae+.707*.707*B,ne-.707*.707*B),v.restore(),"1"==jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"cl")&&x&&(v.beginPath(),v.moveTo(ae+B/2,ne+B/2),v.lineTo(ae+ie-B/2,ne+oe-B/2),v.closePath(),v.stroke())),"2"==te&&(v.save(),v.translate(ae+ie,ne),v.rotate(-45*Math.PI/180),v.translate(-(ae+ie),-ne),v.fillText(null==x?"":x,ae-.707*.707*B,ne-.707*.707*B),v.restore(),"1"==jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"cl")&&x&&(v.beginPath(),v.moveTo(ae+B/2,ne+oe-B/2),v.lineTo(ae+ie-B/2,ne+B/2),v.closePath(),v.stroke()))}else if("3"==te){if(x){1<(x=x.toString()).length?re=x.split(""):(re=[]).push(x);for(var ie=v.measureText(re[0]).width,oe=re.length*B,le=0;le<re.length;le++){var de=v.measureText(re[le]).width;H="0"==q?(A+(N-A)/2+a)*devicePixelRatio-de/2:"2"==q?(N+a-8)*devicePixelRatio-de:(A+4+a)*devicePixelRatio,Y="0"==V?(F+(M-F)/2+n+U)*devicePixelRatio-B*re.length/2:"1"==V?(F+n+U)*devicePixelRatio:(M+n-2+U)*devicePixelRatio-B*re.length,v.fillText(re[le],H,Y+le*B)}"1"==jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"cl")&&x&&(v.beginPath(),v.moveTo(H+ie/2,Y),v.lineTo(H+ie/2,Y+oe),v.closePath(),v.stroke())}}else{"4"!=te&&"5"!=te||(ie=B,ae=(A+4+a)*devicePixelRatio,"0"==q?ae=(A+(N-A)/2+a)*devicePixelRatio-ie/2:"2"==q&&(ae=(N+a-8)*devicePixelRatio-ie),ne=(M+n-2+U)*devicePixelRatio-(oe=L),"0"==V?ne=(F+(M-F)/2+n+U)*devicePixelRatio-oe/2:"1"==V&&(ne=(F+n+U)*devicePixelRatio),"4"==te&&(v.save(),v.translate(ae,ne),v.rotate(90*Math.PI/180),v.translate(-ae,-ne),v.fillText(null==x?"":x,ae,ne-ie),v.restore(),"1"==jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"cl")&&x&&(v.beginPath(),v.moveTo(ae+ie/2,ne),v.lineTo(ae+ie/2,ne+oe),v.closePath(),v.stroke())),"5"==te&&(v.save(),v.translate(ae+oe,ne),v.rotate(-90*Math.PI/180),v.translate(-(ae+oe),-ne),v.fillText(null==x?"":x,ae,ne-oe),v.restore(),"1"==jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"cl")&&x&&(v.beginPath(),v.moveTo(ae+ie/2,ne),v.lineTo(ae+ie/2,ne+oe),v.closePath(),v.stroke())))}}else{"1"==jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"cl")&&x?(f.strokeStyle="#000000",v.beginPath(),v.moveTo(H,Y+B/2),v.lineTo(H+L,Y+B/2),v.closePath(),v.stroke(),v.textBaseline="middle",v.fillText(null==x?"":x,H,Y+B/2)):(v.textBaseline="top",v.fillText(null==x?"":x,H,Y))}v.font=jfgriddefaultstyle.font,f.drawImage($("#jfgridTableContentF").get(0),D[0],D[1],D[2],D[3],D[0],D[1],D[2],D[3]);var fe,se=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bs"),ge=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bc"),ce=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bs_t"),ue=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bc_t"),me=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bs_b"),he=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bc_b"),je=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bs_l"),pe=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bc_l"),ve=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bs_r"),be=jfgrid.menuButton.checkstatus(jfgrid.flowdata,w,y,"bc_r");"none"==je&&"none"==se||(fe="none"==je?se:je,jfgrid.menuButton.setLineDash(f,fe,"v",devicePixelRatio*(A-2+.5+a),devicePixelRatio*(F+n),devicePixelRatio*(A-2+.5+a),devicePixelRatio*(M-2+n)),f.strokeStyle="none"==je?ge:pe,f.stroke(),f.closePath()),"none"==ve&&"none"==se||(fe="none"==ve?se:ve,jfgrid.menuButton.setLineDash(f,fe,"v",devicePixelRatio*(N-2+.5+a),devicePixelRatio*(F+n),devicePixelRatio*(N-2+.5+a),devicePixelRatio*(M-2+n)),f.strokeStyle="none"==ve?ge:be,f.stroke(),f.closePath()),"none"==me&&"none"==se||(fe="none"==me?se:me,jfgrid.menuButton.setLineDash(f,fe,"h",devicePixelRatio*(A-2+a),devicePixelRatio*(M-2+.5+n),devicePixelRatio*(N+a-2),devicePixelRatio*(M-2+.5+n)),f.strokeStyle="none"==me?ge:he,f.stroke(),f.closePath()),"none"==ce&&"none"==se||(fe="none"==ce?se:ce,jfgrid.menuButton.setLineDash(f,fe,"h",devicePixelRatio*(A-2+a),devicePixelRatio*(F-1+.5+n),devicePixelRatio*(N+a-2),devicePixelRatio*(F-1+.5+n)),f.strokeStyle="none"==ce?ge:ue,f.stroke(),f.closePath())}}function jfgridDrawgrid_c(e,r,t,i,a,n){null==e&&(e=$("#jfgrid-cell-main").scrollLeft()),null==r&&(r=$("#jfgrid-cell-main").scrollTop()),null==t&&(t=jfgridTableContentHW[0]),null==i&&(i=jfgridTableContentHW[1]),null==a&&(a=0),null==n&&(n=0);var o,l,d,f,s=$("#jfgridTableContent").get(0).getContext("2d");s.clearRect(a,n,t,i),s.font=jfgriddefaultstyle.font,s.textBaseline=jfgriddefaultstyle.textBaseline,s.fillStyle=jfgriddefaultstyle.fillStyle,-1==(o=jfgrid_searcharray(visibledatarow,r))&&(o=0),-1==(l=jfgrid_searcharray(visibledatarow,r+i))&&(l=visibledatarow.length-1),-1==(d=jfgrid_searcharray(visibledatacolumn,e))&&(d=0),-1==(f=jfgrid_searcharray(visibledatacolumn,e+t))&&(f=visibledatacolumn.length-1);for(var g,c,u=o;u<=l;u++){c=0==u?-r-1:visibledatarow[u-1]-r-1,g=visibledatarow[u]-r;for(var m=d;m<=f;m++){var h,j,p=0==m?-e:visibledatacolumn[m-1]-e,v=visibledatacolumn[m]-e;null!=config.rowhidden&&null!=config.rowhidden[u]||null!=jfgrid.flowdata[u]&&null!=jfgrid.flowdata[u][m]&&(j=s.measureText(jfgrid.flowdata[u][m]),s.clearRect(p+rowHeaderWidth-1+a,c+columeHeaderHeight+n,v-p-1,g-c),s.fillText(jfgrid.flowdata[u][m],p+4+rowHeaderWidth+a,columeHeaderHeight+c+(g-c)/2-1+n)),u==l&&(s.clearRect(p+rowHeaderWidth-1,0,v-p-1,columeHeaderHeight-2),jfgridcurrentisPivotTable||(s.beginPath(),s.moveTo(v+rowHeaderWidth-2+a,.5+n),s.lineTo(v+rowHeaderWidth-2+a,columeHeaderHeight+rh_height+n),s.lineWidth=devicePixelRatio,s.strokeStyle=jfgriddefaultstyle.strokeStyle,s.closePath(),s.stroke()),h=jfgrid.jfgridchatatABC(m),j=s.measureText(h),s.fillText(h,Math.round(p+rowHeaderWidth+(v-p-j.width)/2),Math.round(columeHeaderHeight/2-2))),jfgridcurrentisPivotTable&&jfgrid.pivotTable.drawPivotTable?((0==m||5==m)&&u<=11&&(s.beginPath(),s.moveTo(v+rowHeaderWidth-2+a,columeHeaderHeight+c+n),s.lineTo(v+rowHeaderWidth-2+a,columeHeaderHeight+g-2+n),s.lineWidth=devicePixelRatio,s.strokeStyle="#000000",s.closePath(),s.stroke(),s.clearRect(v+rowHeaderWidth-2+a,n,2,columeHeaderHeight)),(2==u||11==u)&&m<=5&&(s.beginPath(),s.moveTo(rowHeaderWidth-1+p+a,g+columeHeaderHeight-2+n),s.lineTo(rowHeaderWidth+v+a,g+columeHeaderHeight-2+n),s.lineWidth=devicePixelRatio,s.strokeStyle="#000000",s.closePath(),s.stroke()),6==u&&3==m&&s.fillText("数据透视表",p+4+rowHeaderWidth+a,columeHeaderHeight+c+(g-c)/2-1+n)):jfgridcurrentisPivotTable&&m<jfgrid.pivotTable.pivotTableBoundary[1]&&u<jfgrid.pivotTable.pivotTableBoundary[0]&&(s.beginPath(),s.moveTo(v+rowHeaderWidth-2+a,columeHeaderHeight+c+n),s.lineTo(v+rowHeaderWidth-2+a,columeHeaderHeight+g-2+n),s.lineWidth=devicePixelRatio,s.strokeStyle="#000000",s.closePath(),s.stroke(),s.clearRect(v+rowHeaderWidth-2,0,2,columeHeaderHeight),s.beginPath(),s.moveTo(rowHeaderWidth-1+p+a,g+columeHeaderHeight-2+n),s.lineTo(rowHeaderWidth+v+a,g+columeHeaderHeight-2+n),s.lineWidth=devicePixelRatio,s.strokeStyle="#000000",s.closePath(),s.stroke())}null!=config.rowhidden&&null!=config.rowhidden[u]||(s.clearRect(a,c+columeHeaderHeight-1+n,rowHeaderWidth-2,g-c-1),j=s.measureText(u+1),s.fillText(u+1,a+(rowHeaderWidth-j.width)/2,columeHeaderHeight+c+(g-c)/2-2+n)),jfgridcurrentisPivotTable||(s.beginPath(),s.moveTo(-.5+a,g+columeHeaderHeight-2+n),s.lineTo(rowHeaderWidth+ch_width+a,g+columeHeaderHeight-2+n),s.lineWidth=devicePixelRatio,s.strokeStyle=jfgriddefaultstyle.strokeStyle,s.closePath(),s.stroke())}s.beginPath(),s.moveTo(rowHeaderWidth-2+a,-.5+n),s.lineTo(rowHeaderWidth-2+a,columeHeaderHeight+rh_height+n),s.lineWidth=devicePixelRatio,s.strokeStyle=jfgriddefaultstyle.strokeStyle,s.closePath(),s.stroke(),s.beginPath(),s.moveTo(-.5+a,columeHeaderHeight-2+n),s.lineTo(rowHeaderWidth+ch_width+a,columeHeaderHeight-2+n),s.lineWidth=devicePixelRatio,s.strokeStyle=jfgriddefaultstyle.strokeStyle,s.closePath(),s.stroke(),s.clearRect(a,n,rowHeaderWidth-2,columeHeaderHeight-2),s.clearRect(ch_width+rowHeaderWidth<t?ch_width+rowHeaderWidth-2:t-2+a,n,t,i)}function jfexecStroke(e,r){e[r++].stroke(),r<e.length&&setTimeout(function(){jfexecStroke(e,r)},1e3)}jfgrid.jfgridfontformat=jfgridfontformat,jfgrid.menuButton={menu:'<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-menuButton ${subclass} jfgrid-mousedown-cancel" id="jfgrid-icon-${id}-menuButton">${item}</div>',item:'<div itemvalue="${value}" itemname="${name}" class="jfgrid-cols-menuitem ${sub} jfgrid-mousedown-cancel"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel" style="padding: 3px 0px 3px 1px;"><span style="margin-right:3px;width:13px;display:inline-block;" class="icon jfgrid-mousedown-cancel"></span> ${name} <span class="jfgrid-submenu-arrow jfgrid-mousedown-cancel" style="user-select: none;">${example}</span></div></div>',split:'<div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div>',color:'<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-rightgclick-menu-sub jfgrid-mousedown-cancel jfgrid-menuButton ${sub}" id="${id}"><div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel jfgrid-color-reset"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">重置颜色</div></div> <div class="jfgrid-mousedown-cancel"> <div class="jfgrid-mousedown-cancel"> <input type="text" class="jfgrid-color-selected" /> </div> </div> <div class="jfgrid-menuseparator jfgrid-mousedown-cancel" role="separator"></div> ${coloritem}</div>',coloritem:'<div class="jfgrid-cols-menuitem jfgrid-mousedown-cancel ${class}"><div class="jfgrid-cols-menuitem-content jfgrid-mousedown-cancel">${name}</div></div>',subcolor:'<div id="jfgrid-icon-${id}-menuButton" class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-rightgclick-menu-sub jfgrid-menuButton-sub jfgrid-mousedown-cancel"> <div class="jfgrid-mousedown-cancel"> <div class="jfgrid-mousedown-cancel"> <input type="text" class="jfgrid-color-selected" /> </div> </div></div>',rightclickmenu:null,submenuhide:null,focus:function(e,r){e.find(".jfgrid-cols-menuitem").find("span.icon").html(""),null==r?e.find(".jfgrid-cols-menuitem").eq(0).find("span.icon").html('<i class="fa fa-check jfgrid-mousedown-cancel"></i>'):e.find(".jfgrid-cols-menuitem[itemvalue='"+r+"']").find("span.icon").html('<i class="fa fa-check jfgrid-mousedown-cancel"></i>')},createButtonMenu:function(e){for(var r="",t=0;t<e.length;t++){var i=e[t];"split"==i.value?r+=this.split:"more"==i.example?r+=jfgrid.replaceHtml(this.item,{value:i.value,name:i.text,example:"►",sub:"jfgrid-cols-submenu"}):r+=jfgrid.replaceHtml(this.item,{value:i.value,name:i.text,example:i.example,sub:""})}return r},cancelPaintModel:function(){$("#jfgrid-sheettable_0").removeClass("jfgridPaintCursor"),jfgrid_copy_save.dataSheetIndex==jfgrid.currentSheetIndex?(jfgrid_selection_range=[],jfgrid.selectionCopyShow()):jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid_copy_save.dataSheetIndex)].jfgrid_selection_range=[],jfgrid_copy_save={},this.jfgridPaintModelOn=!1,$("#jfgridpopover").fadeOut(200,function(){$("#jfgridpopover").remove()})},jfgridPaintModelOn:!1,jfgridPaintSingle:!1,initialMenuButton:function(){var _this=this;$("#jfgrid-icon-paintformat").click(function(){if(null!=jfgird_select_save&&0!=jfgird_select_save.length)if(1<jfgird_select_save.length)jfgrid.isEditMode()?alert("无法对多重选择区域执行此操作"):jfgrid.tooltip.info("提示","无法对多重选择区域执行此操作");else{jfgrid.tooltip.popover("<i class='fa fa-paint-brush'></i> 格式刷开启","topCenter",!0,null,"ESC键退出",function(){_this.cancelPaintModel()}),$("#jfgrid-sheettable_0").addClass("jfgridPaintCursor"),jfgrid_selection_range=[{row:jfgird_select_save[0].row,column:jfgird_select_save[0].column}],jfgrid.selectionCopyShow();for(var e=!1,r=!1,t=jfgird_select_save[0].row[0];t<=jfgird_select_save[0].row[1];t++)if(null==config.rowhidden||null==config.rowhidden[t]){null!=config.rowlen&&t in config.rowlen&&(e=!0);for(var i=jfgird_select_save[0].column[0];i<=jfgird_select_save[0].column[1];i++){var a=jfgrid.flowdata[t][i];"object"==jfgrid.getObjType(a)&&"mc"in a&&null!=a.mc.rs&&(r=!0)}}jfgrid_copy_save={dataSheetIndex:jfgrid.currentSheetIndex,copyRange:[{row:jfgird_select_save[0].row,column:jfgird_select_save[0].column}],RowlChange:e,HasMC:r},_this.jfgridPaintModelOn=!0,_this.jfgridPaintSingle=!0}else jfgrid.isEditMode()?alert("请选择需要复制格式的区域"):jfgrid.tooltip.info("提示","请选择需要复制格式的区域")}),$("#jfgrid-icon-paintformat").dblclick(function(){if(null!=jfgird_select_save&&0!=jfgird_select_save.length)if(1<jfgird_select_save.length)jfgrid.isEditMode()?alert("无法对多重选择区域执行此操作"):jfgrid.tooltip.info("提示","无法对多重选择区域执行此操作");else{jfgrid.tooltip.popover("<i class='fa fa-paint-brush'></i> 格式刷开启","topCenter",!0,null,"ESC键退出",function(){_this.cancelPaintModel()}),$("#jfgrid-sheettable_0").addClass("jfgridPaintCursor"),jfgrid_selection_range=[{row:jfgird_select_save[0].row,column:jfgird_select_save[0].column}],jfgrid.selectionCopyShow();for(var e=!1,r=!1,t=jfgird_select_save[0].row[0];t<=jfgird_select_save[0].row[1];t++)if(null==config.rowhidden||null==config.rowhidden[t]){null!=config.rowlen&&t in config.rowlen&&(e=!0);for(var i=jfgird_select_save[0].column[0];i<=jfgird_select_save[0].column[1];i++){var a=jfgrid.flowdata[t][i];"object"==jfgrid.getObjType(a)&&"mc"in a&&null!=a.mc.rs&&(r=!0)}}jfgrid_copy_save={dataSheetIndex:jfgrid.currentSheetIndex,copyRange:[{row:jfgird_select_save[0].row,column:jfgird_select_save[0].column}],RowlChange:e,HasMC:r},_this.jfgridPaintModelOn=!0,_this.jfgridPaintSingle=!1}else jfgrid.isEditMode()?alert("请选择需要复制格式的区域"):jfgrid.tooltip.info("提示","请选择需要复制格式的区域")}),$("#jfgrid-icon-currency").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(e,"ct","¥ #.00")}),$("#jfgrid-icon-percent").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(e,"ct","0.00%")}),$("#jfgrid-icon-fmt-decimal-decrease").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=jfgird_select_save[0].row_focus,t=jfgird_select_save[0].column_focus,a=_this.checkstatus(e,r,t,"ct"),n=e[r][t];if(null!=a&&"n"==a.t){"General"==a.fa&&(a=jfgrid.mask.genarate(n.v)[1]);if(/^(w|W)((0?)|(0\.0+))$/.test(a.fa))-1<a.fa.indexOf(".")?".0"==a.fa.substr(-2)?_this.updateFormat(e,"ct",a.fa.split(".")[0]):_this.updateFormat(e,"ct",a.fa.substr(0,a.fa.length-1)):_this.updateFormat(e,"ct",a.fa);else{var o="",l="";if(-1<a.fa.indexOf(".")){o=(d=a.fa.split("."))[0];var d=(l=d[1]).split(""),f="";for(i=d.length-1;0<=i;i--){var s=d[i];if("#"==s||"0"==s||","==s||!isNaN(parseInt(s)))break;f=s+f}var g,c,u="";-1<a.fa.indexOf(".")&&(g=l,0<f.length&&(g=l.replace(f,"")),u=""==(c=(c=g.replace(/#/g,"0")).substr(0,c.length-1))?o+f:o+"."+c+f),_this.updateFormat(e,"ct",u)}}}}),$("#jfgrid-icon-fmt-decimal-increase").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=jfgird_select_save[0].row_focus,t=jfgird_select_save[0].column_focus,a=_this.checkstatus(e,r,t,"ct"),n=e[r][t];if(null!=a&&"n"==a.t)if("General"==a.fa&&(a=jfgrid.mask.genarate(n.v)[1]),"General"!=a.fa){if(/^(w|W)((0?)|(0\.0+))$/.test(a.fa))-1<a.fa.indexOf(".")?_this.updateFormat(e,"ct",a.fa+"0"):"0"==a.fa.substr(-1)?_this.updateFormat(e,"ct",a.fa+".0"):_this.updateFormat(e,"ct",a.fa+"0.0");else{var o="",l="",d=(l=-1<a.fa.indexOf(".")?(o=(d=a.fa.split("."))[0],d[1]):a.fa).split(""),f="";for(i=d.length-1;0<=i;i--){var s=d[i];if("#"==s||"0"==s||","==s||!isNaN(parseInt(s)))break;f=s+f}var g,c,u="";u=-1<a.fa.indexOf(".")?(g=l,0<f.length&&(g=l.replace(f,"")),c=g.replace(/#/g,"0"),o+"."+(c+="0")+f):0<f.length?l.replace(f,"")+".0"+f:l+".0"+f,_this.updateFormat(e,"ct",u)}}else _this.updateFormat(e,"ct","#.0")}),$("#jfgrid-icon-fmt-other").click(function(){var e,r,t,i,a=$(this).attr("id")+"-menuButton",n=$("#"+a);0==n.length&&(e=_this.createButtonMenu([{text:"自动",value:"General",example:""},{text:"纯文本",value:"@",example:""},{text:"",value:"split",example:""},{text:"数字",value:"##0.00",example:"1000.12"},{text:"百分比",value:"#0.00%",example:"12.21%"},{text:"科学计数",value:"0.00E+00",example:"1.01E+5"},{text:"",value:"split",example:""},{text:"会计",value:"¥(0.00)",example:"¥(1200.09)"},{text:"万元",value:"w",example:"1亿2000万2500"},{text:"货币",value:"¥0.00",example:"¥1200.09"},{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},{text:"",value:"split",example:""},{text:"日期",value:"yyyy-MM-dd",example:"2017-11-29"},{text:"时间",value:"hh:mm AM/PM",example:"3:00 PM"},{text:"时间24H",value:"hh:mm",example:"15:00"},{text:"日期时间",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},{text:"日期时间24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},{text:"",value:"split",example:""},{text:"自定义格式",value:"fmtOtherSelf",example:"more"}]),r=jfgrid.replaceHtml(_this.menu,{id:"fmt-other",item:e,subclass:"",sub:""}),t=_this.createButtonMenu([{text:"更多货币格式...",value:"morecurrency",example:""},{text:"更多日期与时间格式...",value:"moredatetime",example:""},{text:"更多数字格式...",value:"moredigit",example:""}]),i=jfgrid.replaceHtml(_this.menu,{id:"fmtOtherSelf",item:t,subclass:"jfgrid-menuButton-sub"}),$("body").append(r+i),n=$("#"+a).width(250),_this.focus(n),n.find(".jfgrid-cols-menuitem").click(function(){n.hide(),$("#"+container).attr("tabindex",0).focus();var e,r=$(this).attr("itemvalue");"fmtOtherSelf"!=r&&(e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),_this.focus(n,r),_this.updateFormat(e,"ct",r))}),$("#jfgrid-icon-fmtOtherSelf-menuButton").find(".jfgrid-cols-menuitem").click(function(){n.hide(),$("#jfgrid-icon-fmtOtherSelf-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");jfgrid.moreFormat.createDialog(e),jfgrid.moreFormat.init()}));var o=$(this).outerWidth(),l=n.outerWidth(),d=$(this).offset().left;o<l&&l+d>$("#"+container).width()&&(d=d-l+o),mouseclickposition(n,d,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-font-family").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",a=$("#"+t);0==a.length&&(e=_this.createButtonMenu([{value:"0",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:微软雅黑'>微软雅黑</span>",example:""},{value:"1",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:宋体'>宋体</span>",example:""},{value:"2",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:黑体'>黑体</span>",example:""},{value:"3",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:楷体'>楷体</span>",example:""},{value:"4",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:仿宋'>仿宋</span>",example:""},{value:"5",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:新宋体'>新宋体</span>",example:""},{value:"6",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:华文新魏'>华文新魏</span>",example:""},{value:"7",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:华文行楷'>华文行楷</span>",example:""},{value:"8",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:华文隶书'>华文隶书</span>",example:""},{value:"9",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:Arial'>Arial</span>",example:""},{value:"10",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:Times New Roman'>Times New Roman</span>",example:""},{value:"11",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:Tahoma'>Tahoma</span>",example:""},{value:"12",text:"<span class='jfgrid-mousedown-cancel' style='font-size:16px;font-family:Verdana'>Verdana</span>",example:""}]),r=jfgrid.replaceHtml(_this.menu,{id:"font-family",item:e,subclass:"",sub:""}),$("body").append(r),a=$("#"+t).width(150),_this.focus(a),a.find(".jfgrid-cols-menuitem").click(function(){a.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this),r=e.attr("itemvalue"),t=e.attr("itemname");_this.focus(a,r),$("#jfgrid-icon-font-family").find(".jfgrid-toolbar-menu-button-caption").html(" "+t+" ");var i=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(i,"ff",r)}));var i=$(this).outerWidth(),n=a.outerWidth(),o=$(this).offset().left;i<n&&n+o>$("#"+container).width()&&(o=o-n+i),mouseclickposition(a,o,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-text-color").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=$(this).attr("color");null==r&&(r="#000000"),_this.updateFormat(e,"fc",r)}),$("#jfgrid-icon-text-color-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(_this.createButtonMenu([{name:"交替颜色...",id:"jfgrid-color-alternate",example:""}]),e=jfgrid.replaceHtml(_this.coloritem,{class:"jfgrid-icon-alternateformat",name:"交替颜色..."}),r=jfgrid.replaceHtml(_this.color,{id:t,coloritem:e,colorself:"text-color-self",sub:""}),$("body").append(r),i=$("#"+t),$("#"+t).find(".jfgrid-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",color:"#000",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.textcolor"+jfgrid.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(e){$(this);e=null!=e?e.toHexString():"#000";$("#jfgrid-icon-text-color .jfgrid-color-menu-button-indicator").css("border-bottom-color",e),$("#jfgrid-icon-text-color").attr("color",e);var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"fc",e),i.hide(),$("#"+container).attr("tabindex",0).focus()}}),i.find(".jfgrid-color-reset").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$("#"+t).find(".jfgrid-color-selected");e.val("#000000"),$("#jfgrid-icon-text-color").attr("color",null),e.spectrum("set","#000000"),$("#jfgrid-icon-text-color .jfgrid-color-menu-button-indicator").css("border-bottom-color","#000000");var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"fc",null)}),i.find(".jfgrid-icon-alternateformat").click(function(){var e;i.hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length?jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):(e=$.extend(!0,{},jfgird_select_save[0]),jfgrid.alternateformat.rangeIsExists(e)[0]||(jfgrid.alternateformat.modelfocusIndex=0,jfgrid.alternateformat.new(e)),jfgrid.alternateformat.init(),jfgrid.alternateformat.perfect())}));var a=$(this).outerWidth(),n=i.outerWidth(),o=$(this).offset().left;a<n&&n+o>$("#"+container).width()&&(o=o-n+a);var l=$(this).offset().top+26;setTimeout(function(){var e=$("#"+t).find(".jfgrid-color-selected");e.spectrum("set",e.val()),mouseclickposition(i,o-28,l,"lefttop")},1)}),$("#jfgrid-icon-cell-color").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=$(this).attr("color");null==r&&(r="#ffffff"),_this.updateFormat(e,"bg",r)}),$("#jfgrid-icon-cell-color-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(e=jfgrid.replaceHtml(_this.coloritem,{class:"jfgrid-icon-alternateformat",name:"交替颜色..."}),r=jfgrid.replaceHtml(_this.color,{id:t,coloritem:e,colorself:"cell-color-self",sub:""}),$("body").append(r),i=$("#"+t),$("#"+t).find(".jfgrid-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:"#fff",cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.bgcolor"+jfgrid.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(e){$(this);e=null!=e?e.toHexString():"#fff";$("#jfgrid-icon-cell-color .jfgrid-color-menu-button-indicator").css("border-bottom-color",e),$("#jfgrid-icon-cell-color").attr("color",e);var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"bg",e),i.hide(),$("#"+container).attr("tabindex",0).focus()}}),i.find(".jfgrid-color-reset").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$("#"+t).find(".jfgrid-color-selected");e.val("#ffffff"),$("#jfgrid-icon-cell-color").attr("color",null),e.spectrum("set","#ffffff"),$("#jfgrid-icon-cell-color .jfgrid-color-menu-button-indicator").css("border-bottom-color","#ffffff");var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"bg",null)}),i.find(".jfgrid-icon-alternateformat").click(function(){var e;i.hide(),$("#"+container).attr("tabindex",0).focus(),1<jfgird_select_save.length?jfgrid.isEditMode()?alert("不能对多重选择区域执行此操作，请选择单个区域，然后再试"):jfgrid.tooltip.info("不能对多重选择区域执行此操作，请选择单个区域，然后再试",""):(e=$.extend(!0,{},jfgird_select_save[0]),jfgrid.alternateformat.rangeIsExists(e)[0]||(jfgrid.alternateformat.modelfocusIndex=0,jfgrid.alternateformat.new(e)),jfgrid.alternateformat.init(),jfgrid.alternateformat.perfect())}),$("#"+t).find(".jfgrid-color-selected").val("#fff"));var a=$(this).outerWidth(),n=i.outerWidth(),o=$(this).offset().left;a<n&&n+o>$("#"+container).width()&&(o=o-n+a);var l=$(this).offset().top+26;setTimeout(function(){var e=$("#"+t).find(".jfgrid-color-selected");e.spectrum("set",e.val()),mouseclickposition(i,o-28,l,"lefttop")},1)});var jfgrid_fs_setTimeout=null;$("#jfgrid-icon-font-size").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(e=_this.createButtonMenu([{text:"9",value:"9",example:""},{text:"10",value:"10",example:""},{text:"11",value:"11",example:""},{text:"12",value:"12",example:""},{text:"14",value:"14",example:""},{text:"16",value:"16",example:""},{text:"18",value:"18",example:""},{text:"20",value:"20",example:""},{text:"22",value:"22",example:""},{text:"24",value:"24",example:""},{text:"26",value:"26",example:""},{text:"28",value:"28",example:""},{text:"36",value:"36",example:""},{text:"48",value:"48",example:""},{text:"72",value:"72",example:""}]),r=jfgrid.replaceHtml(_this.menu,{id:"font-size",item:e,subclass:"",sub:""}),$("body").append(r),i=$("#"+t).width(150),_this.focus(i,10),i.find(".jfgrid-cols-menuitem").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue"),r=$("#jfgrid-icon-font-size input");$("#jfgrid-icon-font-size").attr("itemvalue",e),_this.focus(i,e),r.val(e);var t=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(t,"fs",e),clearTimeout(jfgrid_fs_setTimeout)}));var a=$(this).outerWidth(),n=i.outerWidth(),o=$("#jfgrid-icon-font-size").attr("itemvalue");null==o&&(o=10),_this.focus(i,o);var l=$(this).offset().left;a<n&&n+l>$("#"+container).width()&&(l=l-n+a),mouseclickposition(i,l,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-border-all").click(function(){jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);var e=$(this).attr("type");null==e&&(e="border-all");var r=$("#jfgrid-icon-borderColor-menuButton").find(".jfgrid-color-selected").val(),t=$("#jfgridborderSizepreview").attr("itemvalue");null!=r&&""!=r||(r="#000"),null!=t&&""!=t||(t="1");var i=$.extend(!0,{},config);null==i.borderInfo&&(i.borderInfo=[]);var a,n={rangeType:"range",borderType:e,color:r,style:t,range:jfgird_select_save};i.borderInfo.push(n),clearjfundo&&(jfgrid.jfundo=[],(a=[]).type="borderChange",a.config=$.extend(!0,{},config),a.curconfig=$.extend(!0,{},i),a.sheetIndex=jfgrid.currentSheetIndex,jfgrid.jfredo.push(a)),jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,i.borderInfo,{k:"borderInfo"}),config=i,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,setTimeout(function(){jfgrid.jfgridrefreshgrid()},1)}),$("#jfgrid-icon-border-menu").click(function(){var e,r,t,i,a,n,o,l,d=$(this).attr("id")+"-menuButton",f=$("#"+d);0==f.length&&(e=_this.createButtonMenu([{text:"上框线",value:"border-top",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-top" style="user-select: none;"> </div> </div>'},{text:"下框线",value:"border-bottom",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-bottom" style="user-select: none;"> </div> </div>'},{text:"左框线",value:"border-left",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-left" style="user-select: none;"> </div> </div>'},{text:"右框线",value:"border-right",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-right" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"无",value:"border-none",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-none" style="user-select: none;"> </div> </div>'},{text:"所有",value:"border-all",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-all" style="user-select: none;"> </div> </div>'},{text:"外侧",value:"border-outside",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-outside" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"内侧",value:"border-inside",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-inside" style="user-select: none;"> </div> </div>'},{text:"内侧横线",value:"border-horizontal",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-horizontal" style="user-select: none;"> </div> </div>'},{text:"内侧竖线",value:"border-vertical",example:'<div class="jfgrid-icon jfgrid-inline-block jfgrid-material-icon jfgrid-mousedown-cancel" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-border-vertical" style="user-select: none;"> </div> </div>'},{text:"",value:"split",example:""},{text:"<span id='jfgrid-icon-borderColor-linecolor' class='jfgrid-mousedown-cancel' style='border-bottom:3px solid #000;'>边框颜色</span>",value:"borderColor",example:"more"},{text:"边框粗细<img id='jfgridborderSizepreview' width=100 height=10 src='data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==' style='position:absolute;bottom:-5px;right:0px;width:100px;height:10px;'>",value:"borderSize",example:"more"}]),r=jfgrid.replaceHtml(_this.menu,{id:"border-menu",item:e,subclass:"",sub:""}),t=[{text:"无边框",value:"0",example:""},{text:"<canvas type='Thin' class='border-Thin' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"1",example:""},{text:"<canvas type='Hair' class='border-Hair' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"2",example:""},{text:"<canvas type='Dotted' class='border-Dotted' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"3",example:""},{text:"<canvas type='Dashed' class='border-Dashed' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"4",example:""},{text:"<canvas type='DashDot' class='border-DashDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"5",example:""},{text:"<canvas type='DashDotDot' class='border-DashDotDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"6",example:""},{text:"<canvas type='Medium' class='border-Medium' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"8",example:""},{text:"<canvas type='MediumDashed' class='border-MediumDashed' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"9",example:""},{text:"<canvas type='MediumDashDot' class='border-MediumDashDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"10",example:""},{text:"<canvas type='MediumDashDotDot' class='border-MediumDashDotDot' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"11",example:""},{text:"<canvas type='Thick' class='border-Thick' width=120 height=10 style='width:120px;height:10px;position:static;'></canvas>",value:"13",example:""}],i=_this.createButtonMenu(t),a=jfgrid.replaceHtml(_this.menu,{id:"borderSize",item:i,subclass:"jfgrid-menuButton-sub"}),n="jfgrid-icon-borderSize-menuButton",o="jfgrid-icon-borderColor-menuButton",l=jfgrid.replaceHtml(_this.color,{id:o,coloritem:"",colorself:"",sub:"jfgrid-menuButton-sub"}),$("body").append(r+l+a),f=$("#"+d).width(150),_this.focus(f,"border-all"),$("#"+n+" canvas").each(function(e){$(this).attr("type");var r=$(this).closest(".jfgrid-cols-menuitem").attr("itemvalue"),t=$(this).addClass("jfgrid-mousedown-cancel").get(0).getContext("2d");t.translate(.5,.5),_this.setLineDash(t,r,"h",0,5,100,5),t.strokeStyle="#000000",t.stroke(),t.closePath()}),$("#"+n+" .jfgrid-cols-menuitem").click(function(){$("#"+n).hide();var e,r=$(this),t=r.attr("itemvalue");0==t?$("#jfgridborderSizepreview").attr("src","data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==").attr("itemvalue",null):(e=r.find("canvas").get(0).toDataURL("image/png"),$("#jfgridborderSizepreview").attr("src",e).attr("itemvalue",t)),_this.focus($("#"+n),t)}),f.find(".jfgrid-cols-menuitem").click(function(){f.hide(),$("#"+container).attr("tabindex",0).focus();var e,r,t,i,a,n=$(this).attr("itemvalue");"borderColor"!=n&&"borderSize"!=n&&(jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),null!=(e=$("#"+o).find(".jfgrid-color-selected").val())&&""!=e||(e="#000"),null!=(r=$("#jfgridborderSizepreview").attr("itemvalue"))&&""!=r||(r="1"),null==(t=$.extend(!0,{},config)).borderInfo&&(t.borderInfo=[]),i={rangeType:"range",borderType:n,color:e,style:r,range:jfgird_select_save},t.borderInfo.push(i),clearjfundo&&(jfgrid.jfundo=[],(a=[]).type="borderChange",a.config=$.extend(!0,{},config),a.curconfig=$.extend(!0,{},t),a.sheetIndex=jfgrid.currentSheetIndex,jfgrid.jfredo.push(a)),jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,t.borderInfo,{k:"borderInfo"}),config=t,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,setTimeout(function(){jfgrid.jfgridrefreshgrid()},1),$("#jfgrid-icon-border-all").attr("type",n),$("#jfgrid-icon-border-all").find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-"+n),_this.focus(f,n))}),$("#"+o).find(".jfgrid-color-selected").spectrum({showPalette:!0,showPaletteOnly:!0,preferredFormat:"hex",clickoutFiresChange:!1,showInitial:!0,showInput:!0,flat:!0,hideAfterPaletteSelect:!0,showSelectionPalette:!0,maxPaletteSize:8,maxSelectionSize:8,color:"#000",cancelText:"取消",chooseText:"确定颜色",togglePaletteMoreText:"自定义",togglePaletteLessText:"收起",togglePaletteOnly:!0,clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",localStorageKey:"spectrum.bordercolor"+jfgrid.server.gridKey,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]],change:function(e){$(this);e=null!=e?e.toHexString():"#000";$("#jfgrid-icon-borderColor-linecolor").css("border-bottom-color",e),$("#"+o).find(".jfgrid-color-selected").val(e)}}),$("#"+o).find(".jfgrid-color-reset").click(function(){var e=$("#"+o).find(".jfgrid-color-selected");e.val("#000"),$("#jfgrid-icon-cell-color").attr("color",null),e.spectrum("set","#000"),$("#jfgrid-icon-borderColor-linecolor").css("border-bottom-color","#000")}));var s=$(this).outerWidth(),g=f.outerWidth(),c=$(this).offset().left;s<g&&g+c>$("#"+container).width()&&(c=c-g+s),mouseclickposition(f,c-28,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-merge-button").click(function(){if(jfgrid.selectIsOverlap())jfgrid.isEditMode()?alert("不能合并重叠区域"):jfgrid.tooltip.info("不能合并重叠区域","");else{if(null!=config.merge){for(var e=!1,r=0;r<jfgird_select_save.length;r++){var t=jfgird_select_save[r].row[0],i=jfgird_select_save[r].row[1],a=jfgird_select_save[r].column[0],n=jfgird_select_save[r].column[1];if(e=jfgrid.hasPartMC(config,t,i,a,n))break}if(e)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat_mc(o,"mergeAll")}}),$("#jfgrid-icon-merge-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",d=$("#"+t);0==d.length&&(e=_this.createButtonMenu([{text:"全部合并",value:"mergeAll",example:""},{text:"垂直合并",value:"mergeV",example:""},{text:"水平合并",value:"mergeH",example:""},{text:"取消合并",value:"mergeCancel",example:""}]),r=jfgrid.replaceHtml(_this.menu,{id:"merge-menu",item:e,subclass:"",sub:""}),$("body").append(r),d=$("#"+t).width(100),_this.focus(d),d.find(".jfgrid-cols-menuitem").click(function(){if(d.hide(),$("#"+container).attr("tabindex",0).focus(),jfgrid.selectIsOverlap())jfgrid.isEditMode()?alert("不能合并重叠区域"):jfgrid.tooltip.info("不能合并重叠区域","");else{if(null!=config.merge){for(var e=!1,r=0;r<jfgird_select_save.length;r++){var t=jfgird_select_save[r].row[0],i=jfgird_select_save[r].row[1],a=jfgird_select_save[r].column[0],n=jfgird_select_save[r].column[1];if(e=jfgrid.hasPartMC(config,t,i,a,n))break}if(e)return void(jfgrid.isEditMode()?alert("无法对部分合并单元格执行此操作"):jfgrid.tooltip.info("无法对部分合并单元格执行此操作",""))}var o=$(this).attr("itemvalue");_this.focus(d,o);var l=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat_mc(l,o)}}));var i=$(this).outerWidth(),a=d.outerWidth(),n=$(this).offset().left;i<a&&a+n>$("#"+container).width()&&(n=n-a+i),mouseclickposition(d,n-28,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-align").click(function(){var e=$("#jfgrid-icon-align").attr("type");null==e&&(e="left");var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"ht",e)}),$("#jfgrid-icon-align-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(e=_this.createButtonMenu([{text:"左对齐",value:"left",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-align-left" style="user-select: none;"> </div> </div>'},{text:"中间对齐",value:"center",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-align-center" style="user-select: none;"> </div> </div>'},{text:"右对齐",value:"right",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-align-right" style="user-select: none;"> </div> </div>'}]),r=jfgrid.replaceHtml(_this.menu,{id:"align-menu",item:e,subclass:"",sub:""}),$("body").append(r),i=$("#"+t).width(120),_this.focus(i),i.find(".jfgrid-cols-menuitem").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");_this.focus(i,e),$("#jfgrid-icon-align").attr("type",e).find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-align-"+e);var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"ht",e)}));var a=$(this).outerWidth(),n=i.outerWidth(),o=$(this).offset().left;a<n&&n+o>$("#"+container).width()&&(o=o-n+a),mouseclickposition(i,o-28,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-valign").click(function(){var e=$("#jfgrid-icon-valign").attr("type");null==e&&(e="bottom");var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"vt",e)}),$("#jfgrid-icon-valign-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(e=_this.createButtonMenu([{text:"顶部对齐",value:"top",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-valign-top" style="user-select: none;"> </div> </div>'},{text:"居中对齐",value:"middle",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-valign-middle" style="user-select: none;"> </div> </div>'},{text:"底部对齐",value:"bottom",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-valign-bottom" style="user-select: none;"> </div> </div>'}]),r=jfgrid.replaceHtml(_this.menu,{id:"valign-menu",item:e,subclass:"",sub:""}),$("body").append(r),i=$("#"+t).width(120),_this.focus(i,"bottom"),i.find(".jfgrid-cols-menuitem").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");_this.focus(i,e),$("#jfgrid-icon-valign").attr("type",e).find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-valign-"+e);var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"vt",e)}));var a=$(this).outerWidth(),n=i.outerWidth(),o=$(this).offset().left;a<n&&n+o>$("#"+container).width()&&(o=o-n+a),mouseclickposition(i,o-28,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-textwrap-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(e=_this.createButtonMenu([{text:"溢出",value:"overflow",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-textwrap-overflow" style="user-select: none;"> </div> </div>'},{text:"自动换行",value:"wrap",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-textwrap-wrap" style="user-select: none;"> </div> </div>'},{text:"截断",value:"clip",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-textwrap-clip" style="user-select: none;"> </div> </div>'}]),r=jfgrid.replaceHtml(_this.menu,{id:"textwrap-menu",item:e,subclass:"",sub:""}),$("body").append(r),i=$("#"+t).width(120),_this.focus(i),i.find(".jfgrid-cols-menuitem").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");_this.focus(i,e),$("#jfgrid-icon-textwrap").attr("type",e).find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-textwrap-"+e);var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"tb",e)}));var a=$(this).outerWidth(),n=i.outerWidth(),o=$(this).offset().left;a<n&&n+o>$("#"+container).width()&&(o=o-n+a),mouseclickposition(i,o-28,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-rotation-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(e=_this.createButtonMenu([{text:"无旋转",value:"none",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-none" style="user-select: none;"> </div> </div>'},{text:"向上倾斜",value:"angleup",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-angleup" style="user-select: none;"> </div> </div>'},{text:"向下倾斜",value:"angledown",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-angledown" style="user-select: none;"> </div> </div>'},{text:"竖排文字",value:"vertical",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-vertical" style="user-select: none;"> </div> </div>'},{text:"向上90°",value:"rotation-up",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-rotation-up" style="user-select: none;"> </div> </div>'},{text:"向下90°",value:"rotation-down",example:'<div class="jfgrid-icon jfgrid-inline-block" style="user-select: none;opacity:1;"> <div aria-hidden="true" class="jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-rotation-down" style="user-select: none;"> </div> </div>'}]),r=jfgrid.replaceHtml(_this.menu,{id:"rotation-menu",item:e,subclass:"",sub:""}),$("body").append(r),i=$("#"+t).width(120),_this.focus(i),i.find(".jfgrid-cols-menuitem").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");_this.focus(i,e),$("#jfgrid-icon-rotation").attr("type",e).find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-"+e);var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);_this.updateFormat(r,"tr",e)}));var a=$(this).outerWidth(),n=i.outerWidth(),o=$(this).offset().left;a<n&&n+o>$("#"+container).width()&&(o=o-n+a),mouseclickposition(i,o-28,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-freezen-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",c=$("#"+t);0==c.length&&(e=_this.createButtonMenu([{text:"冻结首行",value:"freezenRow",example:""},{text:"冻结首列",value:"freezenColumn",example:""},{text:"冻结行列",value:"freezenRC",example:""},{text:"",value:"split",example:""},{text:"冻结行到选区",value:"freezenRowRange",example:""},{text:"冻结列到选区",value:"freezenColumnRange",example:""},{text:"冻结行列到选区",value:"freezenRCRange",example:""},{text:"",value:"split",example:""},{text:"取消冻结",value:"freezenCancel",example:""}]),r=jfgrid.replaceHtml(_this.menu,{id:"freezen-menu",item:e,subclass:"",sub:""}),$("body").append(r),(c=$("#"+t).width(130)).find(".jfgrid-cols-menuitem").click(function(){c.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if(_this.focus(c,e),"freezenRow"==e){var r=$("#jfgrid-cell-main").scrollTop();-1==(l=jfgrid_searcharray(visibledatarow,r))&&(l=0);var t=visibledatarow[l]-2-r+columeHeaderHeight,i=[visibledatarow[l],l+1,r,jfgrid.freezen.cutVolumn(visibledatarow,l+1),t];jfgrid.freezen.saveFreezen(i,t,null,null),null!=jfgrid.freezen.freezenverticaldata&&(jfgrid.freezen.cancelFreezenVertical(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),jfgrid.freezen.createFreezenHorizontal(i,t),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()}else if("freezenColumn"==e){var a=$("#jfgrid-cell-main").scrollLeft();-1==(f=jfgrid_searcharray(visibledatacolumn,a))&&(f=0);var n=visibledatacolumn[f]-2-a+rowHeaderWidth,o=[visibledatacolumn[f],f+1,a,jfgrid.freezen.cutVolumn(visibledatacolumn,f+1),n];jfgrid.freezen.saveFreezen(null,null,o,n),null!=jfgrid.freezen.freezenhorizontaldata&&(jfgrid.freezen.cancelFreezenHorizontal(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),jfgrid.freezen.createFreezenVertical(o,n),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()}else if("freezenRC"==e){r=$("#jfgrid-cell-main").scrollTop();-1==(l=jfgrid_searcharray(visibledatarow,r))&&(l=0);t=visibledatarow[l]-2-r+columeHeaderHeight,i=[visibledatarow[l],l+1,r,jfgrid.freezen.cutVolumn(visibledatarow,l+1),t];jfgrid.freezen.saveFreezen(i,t,null,null),jfgrid.freezen.createFreezenHorizontal(i,t);a=$("#jfgrid-cell-main").scrollLeft();-1==(f=jfgrid_searcharray(visibledatacolumn,a))&&(f=0);n=visibledatacolumn[f]-2-a+rowHeaderWidth,o=[visibledatacolumn[f],f+1,a,jfgrid.freezen.cutVolumn(visibledatacolumn,f+1),n];jfgrid.freezen.saveFreezen(null,null,o,n),jfgrid.freezen.createFreezenVertical(o,n),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()}else if("freezenRowRange"==e){if(null==jfgird_select_save||0==jfgird_select_save.length)return void(jfgrid.isEditMode()?alert("没有选区"):jfgrid.tooltip.info("没有选区",""));r=$("#jfgrid-cell-main").scrollTop();(l=jfgrid_searcharray(visibledatarow,r))<(d=null==(s=jfgird_select_save[jfgird_select_save.length-1]).row_focus?s.row[0]:s.row_focus)&&(l=d),-1==l&&(l=0);t=visibledatarow[l]-2-r+columeHeaderHeight,i=[visibledatarow[l],l+1,r,jfgrid.freezen.cutVolumn(visibledatarow,l+1),t];jfgrid.freezen.saveFreezen(i,t,null,null),null!=jfgrid.freezen.freezenverticaldata&&(jfgrid.freezen.cancelFreezenVertical(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),jfgrid.freezen.createFreezenHorizontal(i,t),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()}else if("freezenColumnRange"==e){if(null==jfgird_select_save||0==jfgird_select_save.length)return void(jfgrid.isEditMode()?alert("没有选区"):jfgrid.tooltip.info("没有选区",""));a=$("#jfgrid-cell-main").scrollLeft();(f=jfgrid_searcharray(visibledatacolumn,a))<(g=null==(s=jfgird_select_save[jfgird_select_save.length-1]).column_focus?s.column[0]:s.column_focus)&&(f=g),-1==f&&(f=0);n=visibledatacolumn[f]-2-a+rowHeaderWidth,o=[visibledatacolumn[f],f+1,a,jfgrid.freezen.cutVolumn(visibledatacolumn,f+1),n];jfgrid.freezen.saveFreezen(null,null,o,n),null!=jfgrid.freezen.freezenhorizontaldata&&(jfgrid.freezen.cancelFreezenHorizontal(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),jfgrid.freezen.createFreezenVertical(o,n),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()}else if("freezenRCRange"==e){if(null==jfgird_select_save||0==jfgird_select_save.length)return void(jfgrid.isEditMode()?alert("没有选区"):jfgrid.tooltip.info("没有选区",""));var l,d,r=$("#jfgrid-cell-main").scrollTop();(l=jfgrid_searcharray(visibledatarow,r))<(d=null==(s=jfgird_select_save[jfgird_select_save.length-1]).row_focus?s.row[0]:s.row_focus)&&(l=d),-1==l&&(l=0);t=visibledatarow[l]-2-r+columeHeaderHeight,i=[visibledatarow[l],l+1,r,jfgrid.freezen.cutVolumn(visibledatarow,l+1),t];jfgrid.freezen.saveFreezen(i,t,null,null),jfgrid.freezen.createFreezenHorizontal(i,t);var f,s,g,a=$("#jfgrid-cell-main").scrollLeft();(f=jfgrid_searcharray(visibledatacolumn,a))<(g=null==(s=jfgird_select_save[jfgird_select_save.length-1]).column_focus?s.column[0]:s.column_focus)&&(f=g),-1==f&&(f=0);n=visibledatacolumn[f]-2-a+rowHeaderWidth,o=[visibledatacolumn[f],f+1,a,jfgrid.freezen.cutVolumn(visibledatacolumn,f+1),n];jfgrid.freezen.saveFreezen(null,null,o,n),jfgrid.freezen.createFreezenVertical(o,n),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()}else"freezenCancel"==e&&(null!=jfgrid.freezen.freezenverticaldata&&(jfgrid.freezen.cancelFreezenVertical(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),null!=jfgrid.freezen.freezenhorizontaldata&&(jfgrid.freezen.cancelFreezenHorizontal(),jfgrid.freezen.createAssistCanvas(),jfgrid.jfgridrefreshgrid()),jfgrid.freezen.scrollAdapt());setTimeout(function(){jfgrid.jfgridsizeauto()},0)}));var i=$(this).outerWidth(),a=c.outerWidth(),n=$(this).offset().left;i<a&&a+n>$("#"+container).width()&&(n=n-a+i),mouseclickposition(c,n-68,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-autofilter").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(e=_this.createButtonMenu([{text:"升序",value:"asc",example:'<i style="font-size:14px;" class="fa fa-sort-numeric-asc" aria-hidden="true"></i>'},{text:"降序",value:"desc",example:'<i style="font-size:14px;" class="fa fa-sort-numeric-desc" aria-hidden="true"></i>'},{text:"自定义排序...",value:"diysort",example:'<i style="font-size:14px;" class="fa fa-sort" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:"筛选",value:"filter",example:'<i style="font-size:14px;" class="fa fa-filter" aria-hidden="true"></i>'},{text:"清除筛选",value:"clearfilter",example:'<i style="font-size:14px;" class="fa fa-window-close" aria-hidden="true"></i>'}]),r=jfgrid.replaceHtml(_this.menu,{id:"autofilter",item:e,subclass:"",sub:""}),$("body").append(r),(i=$("#"+t).width(150)).find(".jfgrid-cols-menuitem").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");"diysort"==e?$("#jfgridorderby").click():"asc"==e?jfgrid.sortSelection(!0):"desc"==e?jfgrid.sortSelection(!1):"filter"==e?0<$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).length?$("#jfgrid-filter-initial").click():jfgrid.createFilter():"clearfilter"==e&&$("#jfgrid-filter-initial").click()}));var a=$(this).outerWidth(),n=i.outerWidth(),o=$(this).offset().left;a<n&&n+o>$("#"+container).width()&&(o=o-n+a),mouseclickposition(i,o,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-seachmore").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",i=$("#"+t);0==i.length&&(e=_this.createButtonMenu([{text:"查找 ...",value:"search",example:'<i style="font-size:14px;" class="fa fa-search" aria-hidden="true"></i>'},{text:"替换 ...",value:"replace",example:'<i style="font-size:14px;" class="fa fa-files-o" aria-hidden="true"></i>'},{text:"转到 ...",value:"goto",example:'<i style="font-size:14px;" class="fa fa-arrow-right" aria-hidden="true"></i>'},{text:"",value:"split",example:""},{text:"定位条件 ...",value:"location",example:'<i style="font-size:14px;" class="fa fa-location-arrow" aria-hidden="true"></i>'},{text:"公式",value:"locationFormula",example:"定位"},{text:"日期",value:"locationConstantDate",example:"定位"},{text:"数字",value:"locationConstantNumber",example:"定位"},{text:"字符",value:"locationConstantString",example:"定位"},{text:"错误",value:"locationConstantError",example:"定位"},{text:"条件格式",value:"locationCF",example:"定位"},{text:"间隔行",value:"locationStepRow",example:"定位"},{text:"间隔列",value:"locationStepColumn",example:"定位"}]),r=jfgrid.replaceHtml(_this.menu,{id:"seachmore",item:e,subclass:"",sub:""}),$("body").append(r),(i=$("#"+t).width(150)).find(".jfgrid-cols-menuitem").click(function(){i.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if("search"==e||"replace"==e)"search"==e?jfgrid.searchReplace.createDialog(0):"replace"==e&&jfgrid.searchReplace.createDialog(1),jfgrid.searchReplace.init(),$("#jfgrid-search-replace #searchInput input").focus();else if("location"==e)jfgrid.locationCell.createDialog(),jfgrid.locationCell.init();else if("locationFormula"==e||"locationConstantDate"==e||"locationConstantNumber"==e||"locationConstantString"==e||"locationConstantError"==e||"locationCF"==e){r=0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1]&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1]?[{row:[0,jfgrid.flowdata.length-1],column:[0,jfgrid.flowdata[0].length-1]}]:$.extend(!0,[],jfgird_select_save),"locationFormula"==e?jfgrid.locationCell.apply(r,"locationFormula","all"):"locationConstantDate"==e?jfgrid.locationCell.apply(r,"locationConstant","d"):"locationConstantNumber"==e?jfgrid.locationCell.apply(r,"locationConstant","n"):"locationConstantString"==e?jfgrid.locationCell.apply(r,"locationConstant","s,g"):"locationConstantError"==e?jfgrid.locationCell.apply(r,"locationConstant","e"):"locationCF"==e&&jfgrid.locationCell.apply(r,"locationCF")}else if("locationStepRow"==e){if(0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].row[0]==jfgird_select_save[0].row[1])return void(jfgrid.isEditMode()?alert("请选择最少两行"):jfgrid.tooltip.info("提示","请选择最少两行"));var r=$.extend(!0,[],jfgird_select_save);jfgrid.locationCell.apply(r,"locationStepRow")}else if("locationStepColumn"==e){if(0==jfgird_select_save.length||1==jfgird_select_save.length&&jfgird_select_save[0].column[0]==jfgird_select_save[0].column[1])return void(jfgrid.isEditMode()?alert("请选择最少两列"):jfgrid.tooltip.info("提示","请选择最少两列"));r=$.extend(!0,[],jfgird_select_save);jfgrid.locationCell.apply(r,"locationStepColumn")}}));var a=$(this).outerWidth(),n=i.outerWidth(),o=$(this).offset().left;a<n&&n+o>$("#"+container).width()&&(o=o-n+a),mouseclickposition(i,o,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-function").click(function(){_this.autoSelectionFormula("SUM")}),$("#jfgrid-icon-function-menu").click(function(){var e,r,t=$(this).attr("id")+"-menuButton",u=$("#"+t);0==u.length&&(e=_this.createButtonMenu([{text:"求和",value:"SUM",example:"SUM"},{text:"平均值",value:"AVERAGE",example:"AVERAGE"},{text:"计数",value:"COUNT",example:"COUNT"},{text:"最大值",value:"MAX",example:"MAX"},{text:"最小值",value:"MIN",example:"MIN"},{text:"",value:"split",example:""},{text:"if公式生成器",value:"if",example:"IF"},{text:"函数查找 ...",value:"formula",example:""}]),r=jfgrid.replaceHtml(_this.menu,{id:"function-menu",item:e,subclass:"",sub:""}),$("body").append(r),(u=$("#"+t).width(150)).find(".jfgrid-cols-menuitem").click(function(){u.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if("if"==e){var r=null==(a=jfgird_select_save[jfgird_select_save.length-1]).row_focus?a.row[0]:a.row_focus,t=null==a.column_focus?a.column[0]:a.column_focus;if(jfgrid.flowdata[r]&&jfgrid.flowdata[r][t]&&jfgrid.flowdata[r][t].f){var i=jfgrid.flowdata[r][t].f.toString();if(-1==i.indexOf("=if("))return void(jfgrid.isEditMode()?alert("该单元格函数不属于if公式！"):jfgrid.tooltip.info("该单元格函数不属于if公式！",""));jfgrid.ifFormulaGenerator.ifFormulaDialog(i)}else jfgrid.ifFormulaGenerator.ifFormulaDialog();jfgrid.ifFormulaGenerator.init()}else if("formula"==e){if(0==jfgird_select_save.length)return void(jfgrid.isEditMode()?alert("请选择单元格插入函数"):jfgrid.tooltip.info("请选择单元格插入函数",""));var a,n=(a=jfgird_select_save[jfgird_select_save.length-1]).row_focus,o=a.column_focus,l=visibledatarow[n],d=n-1==-1?0:visibledatarow[n-1],f=visibledatacolumn[o],s=o-1==-1?0:visibledatacolumn[o-1];jfgrid.jfgridupdateCell(l,d,n,f,s,o,jfgrid.flowdata);var g,c=jfgrid.flowdata[n][o];null!=c&&null!=c.f?null!=(g=jfgrid.formula.getfunctionParam(c.f)).fn?jfgrid.insertFormula.formulaParmDialog(g.fn,g.param):jfgrid.insertFormula.formulaListDialog():($("#jfgrid-rich-text-editor").html('<span dir="auto" class="jfgrid-formula-text-color">=</span>'),$("#jfgrid-functionbox-cell").html($("#jfgrid-rich-text-editor").html()),jfgrid.insertFormula.formulaListDialog()),jfgrid.insertFormula.init()}else _this.autoSelectionFormula(e)}));var i=$(this).outerWidth(),a=u.outerWidth(),n=$(this).offset().left;i<a&&a+n>$("#"+container).width()&&(n=n-a+i),mouseclickposition(u,n-48,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-bold").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=jfgird_select_save[0].row_focus,t=jfgird_select_save[0].column_focus,i=1==(i=_this.checkstatus(e,r,t,"bl"))?0:1;_this.updateFormat(e,"bl",i),jfgrid.menuButton.menuButtonFocus(e,r,t)}),$("#jfgrid-icon-italic").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=jfgird_select_save[0].row_focus,t=jfgird_select_save[0].column_focus,i=1==(i=_this.checkstatus(e,r,t,"it"))?0:1;_this.updateFormat(e,"it",i),jfgrid.menuButton.menuButtonFocus(e,r,t)}),$("#jfgrid-icon-strikethrough").click(function(){var e=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),r=jfgird_select_save[0].row_focus,t=jfgird_select_save[0].column_focus,i=1==(i=_this.checkstatus(e,r,t,"cl"))?0:1;_this.updateFormat(e,"cl",i),jfgrid.menuButton.menuButtonFocus(e,r,t)}),$("#jfgrid-icon-conditionformat").click(function(){var menuButtonId=$(this).attr("id")+"-menuButton",$menuButton=$("#"+menuButtonId),itemdata,itemset,menu,subitemdata,subitemset,submenu,subitemdata2,subitemset2,submenu2,submenu3,submenu4,subitemdata6,subitemset6,submenu6;0==$menuButton.length&&(itemdata=[{text:"突出显示单元格规则",value:"highlightCellRule",example:"more"},{text:"项目选取规则",value:"projectSelectRule",example:"more"},{text:"数据条",value:"dataBar",example:"more"},{text:"色阶",value:"colorGradation",example:"more"},{text:"图标集",value:"icons",example:""},{text:"",value:"split",example:""},{text:"新建规则",value:"newRule",example:""},{text:"清除规则",value:"deleteRule",example:"more"},{text:"管理规则",value:"administerRule",example:""}],itemset=_this.createButtonMenu(itemdata),menu=jfgrid.replaceHtml(_this.menu,{id:"conditionformat",item:itemset,subclass:"",sub:""}),subitemdata=[{text:"大于",value:"greaterThan",example:">"},{text:"小于",value:"lessThan",example:"<"},{text:"介于",value:"betweenness",example:"[]"},{text:"等于",value:"equal",example:"="},{text:"文本包含",value:"textContains",example:"()"},{text:"发生日期",value:"occurrenceDate",example:"昨天"},{text:"重复值",value:"duplicateValue",example:"##"}],subitemset=_this.createButtonMenu(subitemdata),submenu=jfgrid.replaceHtml(_this.menu,{id:"highlightCellRule",item:subitemset,subclass:"jfgrid-menuButton-sub"}),subitemdata2=[{text:"前 10 项",value:"top10",example:"前10项"},{text:"前 10%",value:"top10%",example:"前10%"},{text:"最后 10 项",value:"last10",example:"后10项"},{text:"最后 10%",value:"last10%",example:"后10%"},{text:"高于平均值",value:"AboveAverage",example:"高于均值"},{text:"低于平均值",value:"SubAverage",example:"低于均值"}],subitemset2=_this.createButtonMenu(subitemdata2),submenu2=jfgrid.replaceHtml(_this.menu,{id:"projectSelectRule",item:subitemset2,subclass:"jfgrid-menuButton-sub"}),submenu3='<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-menuButton jfgrid-menuButton-sub jfgrid-mousedown-cancel" id="jfgrid-icon-dataBar-menuButton" style="width: 126px;padding: 5px;top: 118.5px;left: 1321.48px;display: none;"><div itemvalue="0" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="蓝-白渐变数据条"></div></div><div itemvalue="1" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="绿-白渐变数据条"></div></div><div itemvalue="2" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="红-白渐变数据条"></div></div><div itemvalue="3" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="橙-白渐变数据条"></div></div><div itemvalue="4" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="浅蓝-白渐变数据条"></div></div><div itemvalue="5" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="紫-白渐变数据条"></div></div><div itemvalue="6" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="蓝色数据条"></div></div><div itemvalue="7" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="绿色数据条"></div></div><div itemvalue="8" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="红色数据条"></div></div><div itemvalue="9" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: 0 -108px;" title="橙色数据条"></div></div><div itemvalue="10" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -38px -108px;" title="浅蓝色数据条"></div></div><div itemvalue="11" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -76px -108px;" title="紫色数据条"></div></div></div>',submenu4='<div class="jfgrid-cols-menu jfgrid-rightgclick-menu jfgrid-menuButton jfgrid-menuButton-sub jfgrid-mousedown-cancel" id="jfgrid-icon-colorGradation-menuButton" style="width: 126px;padding: 5px;top: 143.5px;left: 1321.48px;display: none;"><div itemvalue="0" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: 0 0;" title="绿-黄-红色阶"></div></div><div itemvalue="1" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -38px 0;" title="红-黄-绿色阶"></div></div><div itemvalue="2" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -76px 0;" title="绿-白-红色阶"></div></div><div itemvalue="3" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -114px 0;" title="红-白-绿色阶"></div></div><div itemvalue="4" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: 0 -36px;" title="蓝-白-红色阶"></div></div><div itemvalue="5" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -38px -36px;" title="红-白-蓝色阶"></div></div><div itemvalue="6" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -76px -36px;" title="白-红色阶"></div></div><div itemvalue="7" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -114px -36px;" title="红-白色阶"></div></div><div itemvalue="8" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: 0 -72px;" title="绿-白色阶"></div></div><div itemvalue="9" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -38px -72px;" title="白-绿色阶"></div></div><div itemvalue="10" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -76px -72px;" title="绿-黄色阶"></div></div><div itemvalue="11" class="jfgrid-cols-menuitem jfgrid-mousedown-cancel" style="width: 28px; height: 26px;padding: 5px;float: left;"><div class="jfgrid-mousedown-cancel bgImgBox" style="background-position: -114px -72px;" title="黄-绿色阶"></div></div></div>',subitemdata6=[{text:"清除整个工作表的规则",value:"delSheet",example:""}],subitemset6=_this.createButtonMenu(subitemdata6),submenu6=jfgrid.replaceHtml(_this.menu,{id:"deleteRule",item:subitemset6,subclass:"jfgrid-menuButton-sub"}),$("body").append(menu+submenu+submenu2+submenu3+submenu4+submenu6),$menuButton=$("#"+menuButtonId).width(190),$("#jfgrid-icon-highlightCellRule-menuButton").width(130),$("#jfgrid-icon-projectSelectRule-menuButton").width(170),$menuButton.find(".jfgrid-cols-menuitem").click(function(){$menuButton.hide(),$("#"+container).attr("tabindex",0).focus();var $t=$(this),itemvalue=$t.attr("itemvalue");if("icons"==itemvalue){if(0==jfgird_select_save.length)return void(jfgrid.isEditMode()?alert("请选择应用范围"):jfgrid.tooltip.info("请选择应用范围",""));jfgrid.conditionformat.CFiconsDialog(),jfgrid.conditionformat.init()}else if("newRule"==itemvalue){if(0==jfgird_select_save.length)return void(jfgrid.isEditMode()?alert("请选择应用范围"):jfgrid.tooltip.info("请选择应用范围",""));jfgrid.conditionformat.newConditionRuleDialog(0),jfgrid.conditionformat.init()}else if("administerRule"==itemvalue){var loadSheetUrl=jfgrid.server.loadSheetUrl,file=jfgrid.getjfgridfile();if(""!=loadSheetUrl&&null!=loadSheetUrl){for(var sheetindex=[],i=0;i<file.length;i++)sheetindex.push(file[i].index);$.post(loadSheetUrl,{gridKey:jfgrid.server.gridKey,index:sheetindex.join(",")},function(d){var dataset=eval("("+d+")"),otherfile;for(var item in setTimeout(function(){$("#jfgridloadingdata").fadeOut().remove()},500),dataset){item!=jfgrid.currentSheetIndex&&(otherfile=file[jfgrid.sheetmanage.getSheetIndex(item)],otherfile.celldata=dataset[item.toString()],otherfile.data=jfgrid.sheetmanage.buildGridData(otherfile))}jfgrid.setjfgridfile(file),jfgrid.conditionformat.fileClone=$.extend(!0,[],file),jfgrid.conditionformat.administerRuleDialog(),jfgrid.conditionformat.init()})}else jfgrid.conditionformat.fileClone=$.extend(!0,[],file),jfgrid.conditionformat.administerRuleDialog(),jfgrid.conditionformat.init()}}),$(document).off("click.CFhighlightCellRule").on("click.CFhighlightCellRule","#jfgrid-icon-highlightCellRule-menuButton .jfgrid-cols-menuitem",function(){$menuButton.hide(),$("#jfgrid-icon-highlightCellRule-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if(0!=jfgird_select_save.length){var r=jfgrid.conditionformat.textCellColorHtml;switch(e){case"greaterThan":var t="条件格式——大于",i='<div class="box" data-itemvalue="greaterThan"><div class="boxTitleOne">为大于以下值的单元格设置格式：</div><div class="inpbox range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"lessThan":t="条件格式——小于",i='<div class="box" data-itemvalue="lessThan"><div class="boxTitleOne">为小于以下值的单元格设置格式：</div><div class="inpbox range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"betweenness":t="条件格式——介于",i='<div class="box" data-itemvalue="betweenness"><div class="boxTitleOne">为介于以下值的单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div class="inpbox2 range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">到</div><div class="inpbox2 range"><input id="conditionVal2" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"equal":t="条件格式——等于",i='<div class="box" data-itemvalue="equal"><div class="boxTitleOne">为等于以下值的单元格设置格式：</div><div class="inpbox range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"textContains":t="条件格式——文本包含",i='<div class="box" data-itemvalue="textContains"><div class="boxTitleOne">为包含以下文本的单元格设置格式：</div><div class="inpbox range"><input id="conditionVal" class="formulaInputFocus"/><i class="fa fa-table" aria-hidden="true" title="点击选择单元格"></i></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"occurrenceDate":t="条件格式——发生日期",i='<div class="box" data-itemvalue="occurrenceDate"><div class="boxTitleOne">为包含以下日期的单元格设置格式：</div><div class="inpbox"><input id="daterange-btn" class="formulaInputFocus" readonly="readonly" placeholder="请选择日期"/></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"duplicateValue":t="条件格式——重复值",i='<div class="box" data-itemvalue="duplicateValue"><div class="boxTitleOne">为包含以下类型值的单元格设置格式：</div><select id="conditionVal" class="selectbox"><option value="0">重复</option><option value="1">唯一</option></select><span style="margin-left: 5px;">值</span><div style="margin:5px 0;">设置为：</div>'+r+"</div>"}jfgrid.conditionformat.conditionformatDialog(t,i)}else jfgrid.isEditMode()?alert("请选择条件格式的应用范围"):jfgrid.tooltip.info("请选择条件格式的应用范围","")}),$(document).off("click.CFprojectSelectRule").on("click.CFprojectSelectRule","#jfgrid-icon-projectSelectRule-menuButton .jfgrid-cols-menuitem",function(){$menuButton.hide(),$("#jfgrid-icon-projectSelectRule-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");if(0!=jfgird_select_save.length){var r=jfgrid.conditionformat.textCellColorHtml;switch(e){case"top10":var t="条件格式——前 10 项",i='<div class="box" data-itemvalue="top10"><div class="boxTitleOne">为值最大的那些单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">前</div><div class="inpbox2"><input id="conditionVal" class="formulaInputFocus" type="number" value="10"/></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">项</div></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"top10%":t="条件格式——前 10%",i='<div class="box" data-itemvalue="top10%"><div class="boxTitleOne">为值最大的那些单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">前</div><div class="inpbox2"><input id="conditionVal" class="formulaInputFocus" type="number" value="10"/></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"last10":t="条件格式——最后 10 项",i='<div class="box" data-itemvalue="last10"><div class="boxTitleOne">为值最小的那些单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">最后</div><div class="inpbox2"><input id="conditionVal" class="formulaInputFocus" type="number" value="10"/></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">项</div></div><div style="margin: 5px 0;">设置为：</div>'+r+"</div>";break;case"last10%":t="条件格式——最后 10%",i='<div class="box" data-itemvalue="last10%"><div class="boxTitleOne">为值最小的那些单元格设置格式：</div><div style="height: 30px;line-height: 30px;"><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">最后</div><div class="inpbox2"><input id="conditionVal" class="formulaInputFocus" type="number" value="10"/></div><div style="float: left;height: 30px;line-height: 30px;margin: 0 5px;">%</div></div><div style="margin:5px 0;">设置为：</div>'+r+"</div>";break;case"AboveAverage":t="条件格式——高于平均值",i='<div class="box" data-itemvalue="AboveAverage"><div class="boxTitleOne">为高于平均值的单元格设置格式：</div><div style="margin: 5px 0;">针对选定区域，设置为：</div>'+r+"</div>";break;case"SubAverage":t="条件格式——低于平均值",i='<div class="box" data-itemvalue="SubAverage"><div class="boxTitleOne">为低于平均值的单元格设置格式：</div><div style="margin: 5px 0;">针对选定区域，设置为：</div>'+r+"</div>"}jfgrid.conditionformat.conditionformatDialog(t,i)}else jfgrid.isEditMode()?alert("请选择条件格式的应用范围"):jfgrid.tooltip.info("请选择条件格式的应用范围","")}),$(document).off("click.CFdataBar").on("click.CFdataBar","#jfgrid-icon-dataBar-menuButton .jfgrid-cols-menuitem",function(){$menuButton.hide(),$("#jfgrid-icon-dataBar-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e,r,t=$(this).attr("itemvalue");0<jfgird_select_save.length&&(e=$.extend(!0,[],jfgird_select_save),r=jfgrid.conditionformat.dataBarList[t].format,jfgrid.conditionformat.updateItem("dataBar",e,r))}),$(document).off("click.CFcolorGradation").on("click.CFcolorGradation","#jfgrid-icon-colorGradation-menuButton .jfgrid-cols-menuitem",function(){$menuButton.hide(),$("#jfgrid-icon-colorGradation-menuButton").hide(),$("#"+container).attr("tabindex",0).focus();var e,r,t=$(this).attr("itemvalue");0<jfgird_select_save.length&&(e=$.extend(!0,[],jfgird_select_save),r=jfgrid.conditionformat.colorGradationList[t].format,jfgrid.conditionformat.updateItem("colorGradation",e,r))}),$(document).off("click.CFdeleteRule").on("click.CFdeleteRule","#jfgrid-icon-deleteRule-menuButton .jfgrid-cols-menuitem",function(){$menuButton.hide(),$("#jfgrid-icon-deleteRule-menuButton").hide(),$("#"+container).attr("tabindex",0).focus(),"delSheet"==$(this).attr("itemvalue")&&jfgrid.conditionformat.updateItem("delSheet")}));var userlen=$(this).outerWidth(),tlen=$menuButton.outerWidth(),menuleft=$(this).offset().left;userlen<tlen&&tlen+menuleft>$("#"+container).width()&&(menuleft=menuleft-tlen+userlen),mouseclickposition($menuButton,menuleft,$(this).offset().top+25,"lefttop")}),$("#jfgrid-icon-postil").click(function(){var e=$(this).attr("id")+"-menuButton",r=$("#"+e);r.remove(),jfgrid.postil.removeActivePs();var t=jfgird_select_save[jfgird_select_save.length-1],i=t.row_focus;null==i&&(i=t.row[0]);var a,n=t.column_focus;null==n&&(n=t.column[0]),a=null!=jfgrid.flowdata[i][n]&&null!=jfgrid.flowdata[i][n].ps?[{text:"编辑批注",value:"editPs",example:""},{text:"删除",value:"delPs",example:""},{text:"",value:"split",example:""},{text:"显示/隐藏批注",value:"showHidePs",example:""},{text:"显示/隐藏所有批注",value:"showHideAllPs",example:""}]:[{text:"新建批注",value:"newPs",example:""},{text:"",value:"split",example:""},{text:"显示/隐藏所有批注",value:"showHideAllPs",example:""}];var o=_this.createButtonMenu(a),l=jfgrid.replaceHtml(_this.menu,{id:"postil",item:o,subclass:"",sub:""});$("body").append(l),(r=$("#"+e).width(150)).find(".jfgrid-cols-menuitem").click(function(){r.hide(),$("#"+container).attr("tabindex",0).focus();var e=$(this).attr("itemvalue");"newPs"==e?jfgrid.postil.newPs(i,n):"editPs"==e?jfgrid.postil.editPs(i,n):"delPs"==e?jfgrid.postil.delPs(i,n):"showHidePs"==e?jfgrid.postil.showHidePs(i,n):"showHideAllPs"==e&&jfgrid.postil.showHideAllPs()});var d=$(this).outerWidth(),f=r.outerWidth(),s=$(this).offset().left;d<f&&f+s>$("#"+container).width()&&(s=s-f+d),mouseclickposition(r,s,$(this).offset().top+25,"lefttop")}),$("body").on("mouseover mouseleave",".jfgrid-menuButton .jfgrid-cols-submenu",function(e){var r,t,i,a,n,o,l,d,f,s=$(this),g=s.attr("itemvalue"),c=$("#jfgrid-icon-"+g+"-menuButton");"mouseover"===e.type?(r=s.parent(),t=$(window).width(),i=$(window).height(),a=r.width(),n=c.height()+25,o=c.width()+5,d=(l=s.offset()).top,t<(f=l.left+a)+o&&(f=l.left-o),i<d+n&&(d=i-n),c.css({top:d,left:f}).show(),_this.rightclickmenu=s):_this.submenuhide=setTimeout(function(){c.hide()},200)}).on("mouseover mouseleave",".jfgrid-menuButton-sub",function(e){"mouseover"===e.type?(_this.rightclickmenu.addClass("jfgrid-cols-menuitem-hover"),clearTimeout(_this.submenuhide)):(_this.rightclickmenu.removeClass("jfgrid-cols-menuitem-hover"),$(this).hide())})},fontarray:["微软雅黑","宋体","黑体","楷体","仿宋","新宋体","华文新魏","华文行楷","华文隶书","Arial","Times New Roman","Tahoma","Verdana"],fontjson:{"微软雅黑":0,"microsoft yahei":0,"宋体":1,simsun:1,"黑体":2,simhei:2,"楷体":3,kaiti:3,"仿宋":4,fangsong:4,"新宋体":5,nsimsun:5,"华文新魏":6,stxinwei:6,"华文行楷":7,stxingkai:7,"华文隶书":8,stliti:8,arial:9,"times new roman":10,tahoma:11,verdana:12},getQKBorder:function(e,r,t){var i=0;r=r.toLowerCase();var a="";-1<e.indexOf("pt")?(e=parseFloat(e))<1||(a=e<1.5?"Medium":"Thick"):(e=parseFloat(e))<2||(a=e<3?"Medium":"Thick");a="solid";return"double"==r?i=2:"dotted"==r?i="Medium"==a||"Thick"==a?3:10:"dashed"==r?i="Medium"==a||"Thick"==a?4:9:"solid"==r&&(i="Medium"==a?8:"Thick"==a?13:1),[i,t]},updateFormat:function(e,r,t){var i=document.createElement("canvas").getContext("2d"),a=$.extend(!0,{},config);null==a.rowlen&&(a.rowlen={});for(var n=0;n<jfgird_select_save.length;n++){var o=jfgird_select_save[n].row[0],l=jfgird_select_save[n].row[1],d=jfgird_select_save[n].column[0],f=jfgird_select_save[n].column[1];if("ct"==r){for(var s=o;s<=l;s++)if(null==config.rowhidden||null==config.rowhidden[s])for(var g=d;g<=f;g++){var c=e[s][g],u=null;u="object"==jfgrid.getObjType(c)?e[s][g].v:e[s][g],"@"!=t&&jfgrid.func_methods.isRealNum(u)&&(u=parseFloat(u));var m=jfgrid.mask.update(t,u),h="n";jfgrid.mask.is_date(t)||14===t||15===t||16===t||17===t||18===t||19===t||20===t||21===t||22===t||45===t||46===t||47===t?h="d":"@"==t||49===t?h="s":"General"!=t&&0!==t||(h="g"),"object"==jfgrid.getObjType(c)?(e[s][g].m=m,null==e[s][g].ct&&(e[s][g].ct={}),e[s][g].ct.fa=t,e[s][g].ct.t=h):e[s][g]={ct:{fa:t,t:h},v:u,m:m}}}else{"ht"==r?"left"==t?t="1":"center"==t?t="0":"right"==t&&(t="2"):"vt"==r?"top"==t?t="1":"middle"==t?t="0":"bottom"==t&&(t="2"):"tb"==r?"overflow"==t?t="1":"clip"==t?t="0":"wrap"==t&&(t="2"):"tr"==r&&("none"==t?t="0":"angleup"==t?t="2":"angledown"==t?t="1":"vertical"==t?t="3":"rotation-up"==t?t="5":"rotation-down"==t&&(t="4"));for(s=o;s<=l;s++)if(null==config.rowhidden||null==config.rowhidden[s])for(g=d;g<=f;g++){u=e[s][g];"object"==jfgrid.getObjType(u)||(e[s][g]={v:u}),e[s][g][r]=t,"tr"==r&&null!=e[s][g].tb&&(e[s][g].tb="0")}}if("tb"==r&&"2"==t){for(s=o;s<=l;s++)if(null==config.rowhidden||null==config.rowhidden[s]){var j=defaultrowlen;null!=a.rowlen[s]&&(j=a.rowlen[s]);for(g=d;g<=f;g++){if(null!=(c=e[s][g])&&!jfgrid.func_methods.isRealNull(c.v)){var p=jfgridfontformat(c),v=jfgrid.menuButton.getTextSize("田",p)[1];i.font=p;var b=c.m.toString(),_=i.measureText(b).width;if((R=jfgrid.colLocationByIndex(g)[1]-jfgrid.colLocationByIndex(g)[0]-8)<_){for(var w=[],y=1;y<=b.length;y++){var x=b.substring(w.join("").length,y);R<(k=i.measureText(x).width)?(w.push(b.substring(w.join("").length,y-1)),y-=2):k<=R&&y==b.length&&w.push(x)}j<(C=v*w.length)&&(j=C)}}}j!=defaultrowlen&&(a.rowlen[s]=j)}}else if("tr"==r){for(s=o;s<=l;s++)if(null==config.rowhidden||null==config.rowhidden[s]){j=defaultrowlen;null!=a.rowlen[s]&&(j=a.rowlen[s]);for(g=d;g<=f;g++){null==(c=e[s][g])||jfgrid.func_methods.isRealNull(c.v)||(p=jfgridfontformat(c),v=jfgrid.menuButton.getTextSize("田",p)[1],i.font=p,u=c.m.toString(),I=i.measureText(u).width,"0"==t?C=v:"1"==t||"2"==t?C=.707*(I+v)+4:"3"==t?C=u.length*v+4:"4"!=t&&"5"!=t||(C=I+4),j<(C=Math.round(C))&&(j=C))}j!=defaultrowlen&&(a.rowlen[s]=j)}}else if("fs"==r)for(s=o;s<=l;s++)if(null==config.rowhidden||null==config.rowhidden[s]){j=defaultrowlen;null!=a.rowlen[s]&&(j=a.rowlen[s]);for(g=d;g<=f;g++){if(null!=(c=e[s][g])){var C,T,I,p=jfgridfontformat(c),v=jfgrid.menuButton.getTextSize("田",p)[1];if(i.font=p,jfgrid.func_methods.isRealNull(c.v))C=v;else if("2"==c.tb){var R,b=c.m.toString(),_=i.measureText(b).width;if((R=jfgrid.colLocationByIndex(g)[1]-jfgrid.colLocationByIndex(g)[0]-8)<_){for(w=[],y=1;y<=b.length;y++){var k,x=b.substring(w.join("").length,y);R<(k=i.measureText(x).width)?(w.push(b.substring(w.join("").length,y-1)),y-=2):k<=R&&y==b.length&&w.push(x)}C=v*w.length}else C=v}else{C=null!=c.tr?(T=c.tr,u=c.m.toString(),I=i.measureText(u).width,"0"==T?C=v:"1"==T||"2"==T?C=.707*(I+v)+4:"3"==T?C=u.length*v+4:"4"!=T&&"5"!=T||(C=I+4),Math.round(C)):v}j<C&&(j=C)}}j!=defaultrowlen&&(a.rowlen[s]=j)}}"tb"==r&&"2"==t||"tr"==r||"fs"==r?jfgrid.jfrefreshgrid(e,jfgird_select_save,a,null,!0):jfgrid.jfrefreshgrid(e,jfgird_select_save)},updateFormat_mc:function(e,r){var t=$.extend(!0,{},config);if(null==t.merge&&(t.merge={}),"mergeCancel"==r)for(var i=0;i<jfgird_select_save.length;i++){var a=(j=jfgird_select_save[i]).row[0],n=j.row[1],o=j.column[0],l=j.column[1];if(a!=n||o!=l)for(var d={},f=a;f<=n;f++)for(var s=o;s<=l;s++){null!=(c=e[f][s])&&null!=c.mc&&(u=c.mc.r,m=c.mc.c,"rs"in c.mc?(delete c.mc,delete t.merge[u+"_"+m],d[u+"_"+m]=$.extend(!0,{},c)):(delete(h=d[u+"_"+m]).v,delete h.m,delete h.ct,delete h.f,delete h.spl,e[f][s]=h))}}else{for(var g=!1,i=0;i<jfgird_select_save.length;i++)for(a=(j=jfgird_select_save[i]).row[0],n=j.row[1],o=j.column[0],l=j.column[1],f=a;f<=n;f++)for(s=o;s<=l;s++){var c=e[f][s];if("object"==jfgrid.getObjType(c)&&"mc"in c){g=!0;break}}if(g)for(i=0;i<jfgird_select_save.length;i++){a=(j=jfgird_select_save[i]).row[0],n=j.row[1],o=j.column[0],l=j.column[1];if(a!=n||o!=l)for(d={},f=a;f<=n;f++)for(var u,m,h,s=o;s<=l;s++){null!=(c=e[f][s])&&null!=c.mc&&(u=c.mc.r,m=c.mc.c,"rs"in c.mc?(delete c.mc,delete t.merge[u+"_"+m],d[u+"_"+m]=$.extend(!0,{},c)):(delete(h=d[u+"_"+m]).v,delete h.m,delete h.ct,delete h.f,delete h.spl,e[f][s]=h))}}else for(i=0;i<jfgird_select_save.length;i++){var j,a=(j=jfgird_select_save[i]).row[0],n=j.row[1],o=j.column[0],l=j.column[1];if(a!=n||o!=l)if("mergeAll"==r){for(var d={},p=!1,f=a;f<=n;f++)for(s=o;s<=l;s++){null==(c=e[f][s])||jfgrid.func_methods.isRealNull(c.v)&&null==c.f||p||(d=$.extend(!0,{},c),p=!0),e[f][s]={mc:{r:a,c:o}}}e[a][o]=d,e[a][o].mc={r:a,c:o,rs:n-a+1,cs:l-o+1},t.merge[a+"_"+o]={r:a,c:o,rs:n-a+1,cs:l-o+1}}else if("mergeV"==r)for(s=o;s<=l;s++){for(d={},p=!1,f=a;f<=n;f++){null==(c=e[f][s])||jfgrid.func_methods.isRealNull(c.v)&&null==c.f||p||(d=$.extend(!0,{},c),p=!0),e[f][s]={mc:{r:a,c:s}}}e[a][s]=d,e[a][s].mc={r:a,c:s,rs:n-a+1,cs:1},t.merge[a+"_"+s]={r:a,c:s,rs:n-a+1,cs:1}}else if("mergeH"==r)for(f=a;f<=n;f++){for(d={},p=!1,s=o;s<=l;s++){null==(c=e[f][s])||jfgrid.func_methods.isRealNull(c.v)&&null==c.f||p||(d=$.extend(!0,{},c),p=!0),e[f][s]={mc:{r:f,c:o}}}e[f][o]=d,e[f][o].mc={r:f,c:o,rs:1,cs:l-o+1},t.merge[f+"_"+o]={r:f,c:o,rs:1,cs:l-o+1}}}}clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:"mergeChange",sheetIndex:jfgrid.currentSheetIndex,data:jfgrid.flowdata,curData:e,range:$.extend(!0,[],jfgird_select_save),config:$.extend(!0,{},config),curConfig:t})),clearjfundo=!1,jfgrid.jfrefreshgrid(e,jfgird_select_save,t),clearjfundo=!0},borderfix:function(e,r,t){return[-1,-1,2,2]},menuButtonFocus:function(e,r,t){for(var i=["bl","it","cl","ff","ht","vt","fs","tb","tr"],a=this,n=0;n<i.length;n++){var o,l,d,f,s=i[n],g=a.checkstatus(e,r,t,s);"bl"==s?"0"!=g?$("#jfgrid-icon-bold").addClass("jfgrid-toolbar-button-hover"):$("#jfgrid-icon-bold").removeClass("jfgrid-toolbar-button-hover"):"it"==s?"0"!=g?$("#jfgrid-icon-italic").addClass("jfgrid-toolbar-button-hover"):$("#jfgrid-icon-italic").removeClass("jfgrid-toolbar-button-hover"):"cl"==s?"0"!=g?$("#jfgrid-icon-strikethrough").addClass("jfgrid-toolbar-button-hover"):$("#jfgrid-icon-strikethrough").removeClass("jfgrid-toolbar-button-hover"):"ff"==s?(d=$("#jfgrid-icon-font-family-menuButton"),o="微软雅黑",f=0,null!=g&&(f=jfgrid.isdatatypemulti(g).num?parseInt(g):a.fontjson[g],o=a.fontarray[f]),a.focus(d,f),$("#jfgrid-icon-font-family").find(".jfgrid-toolbar-menu-button-caption").html(" "+o+" ")):"fs"==s?(d=$("#jfgrid-icon-font-size-menuButton"),f=g,l=$("#jfgrid-icon-font-size input"),a.focus(d,f),$("#jfgrid-icon-font-size").attr("itemvalue",f),l.val(f)):"ht"==s?(d=$("#jfgrid-icon-align-menu-menuButton"),$("jfgrid-icon-align"),f="left","0"==g?f="center":"2"==g&&(f="right"),a.focus(d,f),$("#jfgrid-icon-align").attr("type",f).find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-align-"+f),d.hide()):"vt"==s?(d=$("#jfgrid-icon-valign-menu-menuButton"),$("jfgrid-icon-valign"),f="bottom","1"==g?f="top":"0"==g&&(f="middle"),a.focus(d,f),$("#jfgrid-icon-valign").attr("type",f).find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-valign-"+f),d.hide()):"tb"==s?(d=$("#jfgrid-icon-textwrap-menu-menuButton"),$("jfgrid-icon-textwrap"),f="clip","1"==g?f="overflow":"2"==g&&(f="wrap"),a.focus(d,f),$("#jfgrid-icon-textwrap").attr("type",f).find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-textwrap-"+f),d.hide()):"tr"==s&&(d=$("#jfgrid-icon-rotation-menu-menuButton"),$("jfgrid-icon-rotation"),f="none","1"==g?f="angledown":"2"==g?f="angleup":"3"==g?f="vertical":"4"==g?f="rotation-down":"5"==g&&(f="rotation-up"),a.focus(d,f),$("#jfgrid-icon-rotation").attr("type",f).find(".jfgrid-icon-img-container").removeAttr("class").addClass("jfgrid-icon-img-container jfgrid-icon-img jfgrid-icon-rotation-"+f),d.hide())}},checkstatus:function(e,r,t,i){var a=e[r][t];return i in{bl:1,it:1,ff:1,cl:1}?null!=a&&null!=(a=a[i])||(a="0"):"fc"==i?null==a?a="#000000":(null==(a=a[i])&&(a="#000000"),-1<a.indexOf("rgba")&&(a=jfgrid.rgbTohex(a))):"bg"==i?null==a?a="#ffffff":(null==(a=a[i])&&(a="#ffffff"),-1<a.toString().indexOf("rgba")&&(a=jfgrid.rgbTohex(a))):"bs"==i.substr(0,2)?null!=a&&null!=(a=a[i])||(a="none"):"bc"==i.substr(0,2)?null!=a&&null!=(a=a[i])||(a="#000000"):"ht"==i?(null!=a&&null!=(a=a[i])||(a="1"),-1==["0","1","2"].indexOf(a)&&(a="1")):"vt"==i?(null!=a&&null!=(a=a[i])||(a="2"),-1==["0","1","2"].indexOf(a)&&(a="2")):"ct"==i?null!=a&&null!=(a=a[i])||(a=null):"fs"==i?null!=a&&null!=(a=a[i])||(a="10"):"tb"==i?null!=a&&null!=(a=a[i])||(a="0"):"tr"!=i||null!=a&&null!=(a=a[i])||(a="0"),a},setLineDash:function(e,r,t,i,a,n,o){r={0:"none",1:"Thin",2:"Hair",3:"Dotted",4:"Dashed",5:"DashDot",6:"DashDotDot",7:"Double",8:"Medium",9:"MediumDashed",10:"MediumDashDot",11:"MediumDashDotDot",12:"SlantedDashDot",13:"Thick"}[r.toString()];try{"Hair"==r?e.setLineDash([1,2]):-1<r.indexOf("DashDotDot")?e.setLineDash([2,2,5,2,2]):-1<r.indexOf("DashDot")?e.setLineDash([2,5,2]):-1<r.indexOf("Dotted")?e.setLineDash([2]):-1<r.indexOf("Dashed")?e.setLineDash([3]):e.setLineDash([0])}catch(e){}e.beginPath(),-1<r.indexOf("Medium")?("h"==t?(e.moveTo(i,a-.5),e.lineTo(n,o-.5)):(e.moveTo(i-.5,a),e.lineTo(n-.5,o)),e.lineWidth=2*devicePixelRatio):"Thick"==r?(e.moveTo(i,a),e.lineTo(n,o),e.lineWidth=3*devicePixelRatio):(e.moveTo(i,a),e.lineTo(n,o),e.lineWidth=devicePixelRatio)},moveMergeData:function(e,r,t){if(jfgrid.func_methods.isRealNull(e))return e;for(var i=[],a=[],n=!1,o=0;o<e.length;o++)for(var l=0;l<e[0].length;l++){var d=e[o][l];"object"==jfgrid.getObjType(d)&&"mc"in d&&(null!=d.mc.rs&&(i.push({rs:d.mc.rs,cs:d.mc.cs,r:d.mc.r,c:d.mc.c}),a.push({rs:d.mc.rs,cs:d.mc.cs,r:d.mc.r+r,c:d.mc.c+t}),n=!0),e[o][l].mc.r+=r,e[o][l].mc.c+=t)}return{deleMC:i,insertMC:a,hasMC:n}},getRangeInMerge:function(e,r,t,i,a){var n=[],o=null;if(null!=(o=null!=a?$.extend(!0,{},jfgrid.sheetmanage.getSheetConfig()):$.extend(!0,{},config))&&null!=o.merge)for(var l in o.merge){var d=o.merge[l];e+r-1<d.r||e>d.r+d.rs-1||t+i-1<d.c||t>d.c+d.cs-1||n.push(d)}return n},mergeborer:function(e,r,t){var i=e[r][t];if("object"==jfgrid.getObjType(i)&&"mc"in i){var a=i.mc;t=a.c;for(var n,o,l,d,f,s,g,c,u=e[r=a.r][t].mc.cs,m=e[r][t].mc.rs,h=($("#jfgrid-cell-main").scrollLeft(),$("#jfgrid-cell-main").scrollTop(),e[r][t].mc),j=r;j<h.rs+r;j++)n=0==j?-1:visibledatarow[j-1]-1,o=visibledatarow[j],null==l?(l=n,d=o):d+=o-n-1;for(var p=t;p<h.cs+t;p++)g=0==p?0:visibledatacolumn[p-1],c=visibledatacolumn[p],null==s?(s=g,f=c):f+=c-g;return{row:[l,d,r,r+m-1],column:[s,f,t,t+u-1]}}return null},mergeMoveData:{},mergeMoveMain:function(e,r,t,i,a,n,o){var l=jfgrid.sheetmanage.getSheetMerge();if(null!=l){var d=[];for(var f in l)d.push(f);r[0]>r[1]&&(r[1]=r[0]),e[0]>e[1]&&(e[1]=e[0]);[].concat(e),[].concat(r);var s=!0;for(this.mergeMoveData={};s;){s=!1;for(var g=0;g<d.length;g++){var c,u=l[f=d[g]];f in this.mergeMoveData||(null!=(c=this.mergeMove(u,e,r,t,i,a,n,o))?(this.mergeMoveData[f]=u,e=c[0],r=c[1],i=c[2],a=c[3],n=c[4],o=c[5],s=!0):delete this.mergeMoveData[f])}}return[e,r,i,a,n,o]}},mergeMove:function(e,r,t,i,a,n,o,l){var d,f,s,g,c,u=e.r,m=e.r+e.rs-1,h=e.c,j=e.c+e.cs-1,p=!1;return r[1]<r[0]&&(r[0]=r[1]),t[1]<t[0]&&(t[0]=t[1]),!(r[0]<=h&&r[1]>=j&&t[0]<=u&&t[1]>=m)&&(r[1]<h||r[0]>j||t[1]<u||t[0]>m)||(d=jfgrid.menuButton.mergeborer(jfgrid.flowdata,e.r,e.c))&&(f=d.row[1],s=d.row[0],d.row[2],g=d.column[1],c=d.column[0],d.column[2],0,r[1]<h||r[0]>j||(t[0]<=m&&t[0]>=u&&(n+=a-s,a=s,t[0]=u),t[1]>=u&&t[1]<=m&&(n=(i.row_focus>=u&&i.row_focus,f-a),t[1]=m)),t[1]<u||t[0]>m||(r[0]<=j&&r[0]>=h&&(l+=o-c,o=c,r[0]=h),r[1]>=h&&r[1]<=j&&(l=(i.column_focus>=h&&i.column_focus,g-o),r[1]=j)),p=!0),p?[r,t,a,n,o,l]:null},getCellRealSize:function(e,r,t){var i,a,n,o,l,d,f,s=jfgrid.defaultcollen,g=jfgrid.defaultrowlen,c=e[r][t];return c&&null!=c.mc?(i=c.mc,(a=jfgrid.menuButton.mergeborer(e,i.r,i.c))&&(n=a.row[1],o=a.row[0],a.row[2],a.row[3],l=a.column[1],d=a.column[0],a.column[2],a.column[3],s=l-d-1,g=n-o-1)):(null!=(f=jfgrid.getjfgridfile()[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config).columlen&&null!=f.columlen[t]&&(s=f.columlen[t]),null!=f.rowlen&&null!=f.rowlen[r]&&(g=f.rowlen[r])),[s,g]},getTextHeightCache:{},getTextSize:function(e,r){var t=r||"10pt 微软雅黑";if(t in this.getTextHeightCache)return this.getTextHeightCache[t];0==$("#jfgridTextSizeTest").length&&$('<span id="jfgridTextSizeTest" style="float:left;white-space:nowrap;visibility:hidden">'+e+"</span>").appendTo($("body"));var i=$("#jfgridTextSizeTest").text(e).css({font:t}),a=i.width(),n=i.height();return this.getTextHeightCache[t]=[a,n],[a,n]},activeFormulaInput:function(e,r,t,i,a,n){null==n&&(n=!1);var o,l,d,f,s,g,c=jfgrid.rowLocationByIndex(e),u=jfgrid.colLocationByIndex(r);jfgrid.jfgridupdateCell(c[1],c[0],e,u[1],u[0],r,jfgrid.flowdata,!0),n?(g='<span dir="auto" class="jfgrid-formula-text-color">=</span><span dir="auto" class="jfgrid-formula-text-color">'+a.toUpperCase()+'</span><span dir="auto" class="jfgrid-formula-text-color">(</span><span dir="auto" class="jfgrid-formula-text-color">)</span>',$("#jfgrid-rich-text-editor").html(g),window.getSelection(),o=$("#jfgrid-rich-text-editor").find("span"),jfgrid.formula.setCaretPosition(o.get(o.length-2),0,1)):(l=jfgrid.rowLocationByIndex(t[0])[0],d=jfgrid.rowLocationByIndex(t[1])[1],f=jfgrid.colLocationByIndex(i[0])[0],s=jfgrid.colLocationByIndex(i[1])[1],g='<span dir="auto" class="jfgrid-formula-text-color">=</span><span dir="auto" class="jfgrid-formula-text-color">'+a.toUpperCase()+'</span><span dir="auto" class="jfgrid-formula-text-color">(</span><span class="jfgrid-formula-functionrange-cell" rangeindex="0" dir="auto" style="color:'+jfgrid.jfcolor[0]+';">'+jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:t,column:i},jfgrid.currentSheetIndex)+'</span><span dir="auto" class="jfgrid-formula-text-color">)</span>',$("#jfgrid-rich-text-editor").html(g),jfgrid.formula.israngeseleciton(),jfgrid.formula.rangestart=!0,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,jfgrid.formula.rangechangeindex=0,jfgrid.formula.rangeSetValue({row:t,column:i}),jfgrid.formula.func_selectedrange={left:f,width:s-f-1,top:l,height:d-l-1,left_move:f,width_move:s-f-1,top_move:l,height_move:d-l-1,row:[e,e],column:[r,r]},$("#jfgrid-formula-functionrange-select").css({left:f,width:s-f-1,top:l,height:d-l-1}).show(),$("#jfgrid-formula-help-c").hide())},backFormulaInput:function(e,r,t,i,a,n){var o="="+n.toUpperCase()+"("+jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:i,column:a},jfgrid.currentSheetIndex)+")",l=jfgrid.formula.execfunction(o,r,t),d={v:l[1],f:l[2]};jfgrid.setcellvalue(r,t,e,d),jfgrid.formula.execFunctionExist.push({r:r,c:t,i:jfgrid.currentSheetIndex}),jfgrid.server.historyParam(e,jfgrid.currentSheetIndex,{row:[r,r],column:[t,t]})},checkNoNullValue:function(e){var r=e;return"object"==jfgrid.getObjType(r)&&(r=r.v),!(jfgrid.func_methods.isRealNull(r)||!jfgrid.isdatatypemulti(r).num||null!=e.ct&&null!=e.ct.t&&"n"!=e.ct.t&&"g"!=e.ct.t)},checkNoNullValueAll:function(e){var r=e;return"object"==jfgrid.getObjType(r)&&(r=r.v),!jfgrid.func_methods.isRealNull(r)},getNoNullValue:function(e,r,t,i){for(var a=null,n=0,o=0,l=t-1;0<=l;l--){var d="c"==i?e[r][l]:e[l][r];if(this.checkNoNullValue(d))a=l;else{if(null!=d&&null!=d.v&&""!=d.v)break;if(40<=++n){if(!(o<=0))break;o=1}}}return a},singleFormulaInput:function(e,r,t,i,a,n,o,l,d){null==o&&(o="r"),null==l&&(l=!0),null==d&&(d=!0);for(var f=this,s=!0,g=!1,c=i;c<=a;c++){var u=null;u="c"==o?e[c][t]:e[t][c],f.checkNoNullValue(u)?g=!(s=!1):f.checkNoNullValueAll(u)&&(s=!1)}if(s&&d){var m=f.getNoNullValue(e,r,t,o);if(null==m)"c"==o?f.activeFormulaInput(r,t,null,null,n,!0):f.activeFormulaInput(t,r,null,null,n,!0);else if(r==i)for(c=i;c<=a;c++){if(null==(m=f.getNoNullValue(e,c,t,o)))break;"c"==o?f.backFormulaInput(e,c,t,[c,c],[m,t-1],n):f.backFormulaInput(e,t,c,[m,t-1],[c,c],n)}else for(c=a;i<=c;c--){if(null==(m=f.getNoNullValue(e,c,t,o)))break;"c"==o?f.backFormulaInput(e,c,t,[c,c],[m,t-1],n):f.backFormulaInput(e,t,c,[m,t-1],[c,c],n)}}else{if(!g||!l)return!0;u=null;if(null!=(u="c"==o?e[a][t]:e[t][a])&&null!=u.v&&0<u.v.toString().length){c=a;for(u="c"==o?e[a][t]:e[t][a];null!=u&&null!=u.v&&0<u.v.toString().length;){c++;if(("c"==o?e.length:e[0].length)<=c)return;u="c"==o?e[c][t]:e[t][c]}"c"==o?f.backFormulaInput(e,c,t,[i,a],[t,t],n):f.backFormulaInput(e,t,c,[t,t],[i,a],n)}else"c"==o?f.backFormulaInput(e,a,t,[i,a],[t,t],n):f.backFormulaInput(e,t,a,[t,t],[i,a],n)}},autoSelectionFormula:function(r){var t=this,i=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),e=!0;jfgrid.formula.execFunctionExist=[];function a(){var e=t.getNoNullValue(i,l,s,"c");null==e?t.activeFormulaInput(l,f,null,null,r,!0):t.activeFormulaInput(l,f,[l,d],[e,s-1],r)}function n(){var e=t.getNoNullValue(i,f,d,"r");null==e?a():t.activeFormulaInput(l,f,[e,d-1],[f,s],r)}for(var o=0;o<jfgird_select_save.length;o++){var l=jfgird_select_save[o].row[0],d=jfgird_select_save[o].row[1],f=jfgird_select_save[o].column[0],s=jfgird_select_save[o].column[1],g=jfgird_select_save[o].row_focus,c=jfgird_select_save[o].column_focus;if(l==d&&f==s){if(d-1<0&&s-1<0)return void t.activeFormulaInput(l,f,null,null,r,!0);(!(0<=d-1&&t.checkNoNullValue(i[d-1][f]))&&0<=s-1&&t.checkNoNullValue(i[l][s-1])?a:n)()}else if(l==d)e=t.singleFormulaInput(i,c,l,f,s,r,"r");else if(f==s)e=t.singleFormulaInput(i,g,f,l,d,r,"c");else{for(var u=!0,m=l;m<=d;m++)u=t.singleFormulaInput(i,c,m,f,s,r,"r",!0,!1)&&u;for(var h=!0,j=f;j<=s;j++)h=t.singleFormulaInput(i,g,j,l,d,r,"c",!0,!1)&&h;e=!!u&&!!h}e=e&&e}e||(jfgrid.formula.execFunctionExist.reverse(),jfgrid.formula.execFunctionGroup(null,null,null,null,i),jfgrid.jfrefreshgrid(i,[{row:[l,d],column:[f,s]}]),clearTimeout(jfcountfuncTimeout),jfcountfuncTimeout=setTimeout(function(){jfgrid.jfcountfunc()},500))},getStyleByCell:function(e,r,t){var i="",a=jfgrid.alternateformat.getComputeMap(),n=jfgrid.alternateformat.checksAF(r,t,a),o=jfgrid.conditionformat.getComputeMap(),l=jfgrid.conditionformat.checksCF(r,t,o),d=e[r][t];for(var f in d){var s,g=jfgrid.menuButton.checkstatus(e,r,t,f);(null!=n||null!=l&&null!=l.cellColor)&&(null!=l&&null!=l.cellColor?i+="background: "+l.cellColor+";":null!=n&&(i+="background: "+n[1]+";")),"object"!=jfgrid.getObjType(g)&&(("bg"==f||null!=n||null!=l&&null!=l.cellColor)&&(null!=l&&null!=l.cellColor?i+="background: "+l.cellColor+";":i+=null!=n?"background: "+n[1]+";":"background: "+g+";"),"bl"==f&&"0"!=g&&(i+="font-weight: bold;"),"it"==f&&"0"!=g&&(i+="font-style:italic;"),"ff"==f&&"0"!=g&&(s=g,isNaN(parseInt(g))||(s=jfgrid.menuButton.fontarray[parseInt(g)]),i+="font-family: "+s+";"),"fs"==f&&"10"!=g&&(i+="font-size: "+g+"pt;"),("fc"==f&&"#000000"!=g||null!=n||null!=l&&null!=l.textColor)&&(null!=l&&null!=l.textColor?i+="color: "+l.textColor+";":i+=null!=n?"color: "+n[0]+";":"color: "+g+";"),"ht"==f&&"1"!=g&&("0"==g?i+="text-align: center;":"2"==g&&(i+="text-align: right;")),"vt"==f&&"0"!=g&&("1"==g?i+="vertical-align: top;":"2"==g&&(i+="vertical-align: bottom;")))}return i}},jfgrid.server={gridKey:null,loadUrl:null,updateUrl:null,updateImageUrl:null,title:null,historyParam:function(e,r,t){var i=t.row[0],a=t.row[1],n=t.column[0],o=t.column[1];if(i==a&&n==o){var l=e[i][n];this.saveParam("v",r,l,{r:i,c:n})}else for(var d=a-i+1,f=o-n+1,s=Math.floor(1e3/f),g=Math.ceil(d/s),c=0;c<g;c++){var u,m=i+s*c;u=c==g-1?a:i+s*(c+1)-1;for(var l=[],h=m;h<=u;h++){for(var j=[],p=n;p<=o;p++)j.push(e[h][p]);l.push(j)}this.saveParam("rv",r,l,{range:{row:[m,u],column:[n,o]}}),c==g-1&&this.saveParam("rv_end",r,null)}},saveParam:function(e,r,t,i){var a,n;jfgrid.server.allowUpdate&&(null==t&&(t=null),(a={}).t=e,a.i=r,a.v=t,"rv"==e?a.range=i.range:"v"==e||"fu"==e||"fm"==e?(a.r=i.r,a.c=i.c):"fc"==e?(a.op=i.op,a.pos=i.pos):"drc"==e||"arc"==e||"h"==e||"wh"==e?a.rc=i.rc:"c"==e?(a.cid=i.cid,a.op=i.op):"f"==e?(a.op=i.op,a.pos=i.pos):"s"==e||("sh"==e?(a.op=i.op,null!=i.cur&&(a.cur=i.cur)):"cg"!=e&&"all"!=e||(a.k=i.k)),n=pako.gzip(encodeURIComponent(JSON.stringify(a)),{to:"string"}),jfgrid.server.websocket.send(n))},websocket:null,wxErrorCount:0,openWebSocket:function(){"WebSocket"in window?(jfgrid.server.websocket=new WebSocket(jfgrid.server.updateUrl+"?t=111&g="+encodeURIComponent(jfgrid.server.gridKey)),jfgrid.server.websocket.onopen=function(){jfgrid.jfhideloading(),jfgrid.server.wxErrorCount=0,setInterval(function(){jfgrid.server.websocket.send("rub")},6e4)},jfgrid.server.websocket.onmessage=function(result){var data=eval("("+result.data+")"),type=data.type;if(1!=type)if(2==type){var item=JSON.parse(data.data);jfgrid.server.wsUpdateMsg(item)}else if(3==type){var id=data.id,username=data.username,item=JSON.parse(data.data),type=item.t,index=item.i,value=item.v,r,c;"array"!=jfgrid.getObjType(value)&&(value=JSON.parse(value)),index==jfgrid.currentSheetIndex&&(r=value[value.length-1].row[0],c=value[value.length-1].column[0],jfgrid.server.multipleRangeShow(id,username,r,c))}else if(4==type)for(var items=JSON.parse(data.data),i=0;i<items.length;i++)jfgrid.server.wsUpdateMsg(item[i])},jfgrid.server.websocket.onerror=function(){jfgrid.server.wxErrorCount++,3<jfgrid.server.wxErrorCount?jfgrid.jfshowloading("WebSocket连接发生错误, 请刷新页面！"):(jfgrid.jfshowloading("WebSocket连接发生错误, 请耐心等待！"),jfgrid.server.openWebSocket())},jfgrid.server.websocket.onclose=function(){alert("服务器通信发生错误，请刷新页面后再试，如若不行请联系管理员！")}):alert("当前浏览器 Not Support WebSocket")},wsUpdateMsg:function(item){var type=item.t,index=item.i,value=item.v,file=jfgridfile[jfgrid.sheetmanage.getSheetIndex(index)];if(null!=file)if("v"==type){if(null==file.data||0==file.data.length)return;var r=item.r,c=item.c;file.data[r][c]=value,index==jfgrid.currentSheetIndex&&(jfgrid.flowdata=file.data,null!=value&&null!=value.ps?jfgrid.postil.buildPs(r,c,value.ps):jfgrid.postil.buildPs(r,c,null),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1))}else if("rv"==type){if(null==file.data||0==file.data.length)return;for(var r1=item.range.row[0],r2=item.range.row[1],c1=item.range.column[0],c2=item.range.column[1],r=r1;r<=r2;r++)for(var c=c1;c<=c2;c++)file.data[r][c]=value[r-r1][c-c1];if(index==jfgrid.currentSheetIndex){jfgrid.flowdata=file.data;for(var r=r1;r<=r2;r++)for(var c=c1;c<=c2;c++)null!=value[r-r1][c-c1]&&null!=value[r-r1][c-c1].ps?jfgrid.postil.buildPs(r,c,value[r-r1][c-c1].ps):jfgrid.postil.buildPs(r,c,null);setTimeout(function(){jfgrid.jfgridrefreshgrid()},1)}}else if("cg"==type){var k=item.k;if("borderInfo"==k)file.config.borderInfo=value;else for(var key in k in file.config||(file.config[k]={}),value)file.config[k][key]=value[key];index==jfgrid.currentSheetIndex&&(config=file.config,"rowlen"!=k&&"columlen"!=k&&"rowhidden"!=k||jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1))}else if("all"==type){var k=item.k,jfgridcurrentSheetitem;file[k]=value,"name"==k?$("#jfgrid-sheet-container-c #jfgrid-sheets-item"+index).find("span.jfgrid-sheets-item-name").html(value):"color"==k?(jfgridcurrentSheetitem=$("#jfgrid-sheet-container-c #jfgrid-sheets-item"+index),jfgridcurrentSheetitem.find(".jfgrid-sheets-item-color").remove(),null==value&&""==value||jfgridcurrentSheetitem.append('<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+value+';"></div>')):"pivotTable"==k||("freezen"==k?index==jfgrid.currentSheetIndex&&(null==file.freezen.horizontal?($("#jfgrid-freezen-btn-horizontal").html('<i class="fa fa-list-alt"></i> 冻结首行'),jfgrid.freezen.freezenhorizontaldata=null,$("#jfgrid-freezebar-horizontal").hide()):jfgrid.freezen.createFreezenHorizontal(file.freezen.horizontal.freezenhorizontaldata,file.freezen.horizontal.top),null==file.freezen.vertical?($("#jfgrid-freezen-btn-vertical").html('<i class="fa fa-indent"></i> 冻结首列'),jfgrid.freezen.freezenverticaldata=null,$("#jfgrid-freezebar-vertical").hide()):jfgrid.freezen.createFreezenVertical(file.freezen.vertical.freezenverticaldata,file.freezen.vertical.left),jfgrid.freezen.createAssistCanvas()):"filter_select"==k?index==jfgrid.currentSheetIndex&&jfgrid.createFilterOptions(value):"filter"==k?index==jfgrid.currentSheetIndex&&jfgrid.createFilterOptions(file.filter_select,value):"jfgrid_conditionformat_save"==k||"jfgrid_alternateformat_save"==k?index==jfgrid.currentSheetIndex&&setTimeout(function(){jfgrid.jfgridrefreshgrid()},1):"config"==k?index==jfgrid.currentSheetIndex&&(config=value,jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length)):"dynamicArray"==k&&index==jfgrid.currentSheetIndex&&setTimeout(function(){jfgrid.jfgridrefreshgrid()},1))}else if("fc"==type){var op=item.op,pos=item.pos;"object"!=jfgrid.getObjType(value)&&(value=eval("("+value+")"));var r=value.r,c=value.c,func=value.func,calcChain=null==file.calcChain?[]:file.calcChain;if("add"==op)calcChain.push(value);else if("del"==op)for(var a=0;a<calcChain.length;a++)r==calcChain[a].r&&c==calcChain[a].c&&index==calcChain[a].index&&calcChain.splice(a,1);else if("update"==op)for(var a=0;a<calcChain.length;a++)r==calcChain[a].r&&c==calcChain[a].c&&index==calcChain[a].index&&(calcChain[a].func=func);setTimeout(function(){jfgrid.jfgridrefreshgrid()},1)}else if("drc"==type){if(null==file.data||0==file.data.length)return;var rc=item.rc,st_i=value.index,len=value.len,mc=value.mc,borderInfo=value.borderInfo,data=file.data;if("r"==rc){file.row-=len,data.splice(st_i,len);for(var row=[],c=0;c<data[0].length;c++)row.push(null);for(var r=0;r<len;r++)data.push(row)}else{file.column-=len;for(var addcol=[],r=0;r<len;r++)addcol.push(null);for(var i=0;i<data.length;i++)data[i].splice(st_i,len),data[i]=data[i].concat(addcol)}for(x in mc){var r=mc[x].r,c=mc[x].c;data[r][c].mc=mc[x]}file.config.merge=mc,file.config.borderInfo=borderInfo,index==jfgrid.currentSheetIndex&&(jfgrid.flowdata=data,config.merge=mc,config.borderInfo=borderInfo,setTimeout(function(){jfgrid.jfgridrefreshgrid()},1))}else if("arc"==type){if(null==file.data||0==file.data.length)return;var rc=item.rc,st_i=value.index,len=value.len,addData=value.data,mc=value.mc,borderInfo=value.borderInfo,data=file.data;if("r"==rc){file.row+=len;for(var arr=[],i=0;i<len;i++)arr.push(JSON.stringify(addData[i]));eval("data.splice("+st_i+", 0, "+arr.join(",")+")")}else{file.column+=len;for(var i=0;i<data.length;i++)data[i].splice(st_i,0,addData[i])}for(x in mc){var r=mc[x].r,c=mc[x].c;data[r][c].mc=mc[x]}file.config.merge=mc,file.config.borderInfo=borderInfo,index==jfgrid.currentSheetIndex&&(jfgrid.flowdata=data,config.merge=mc,config.borderInfo=borderInfo,setTimeout(function(){jfgrid.jfgridrefreshgrid()},1))}else if("f"==type){var op=item.op,pos=item.pos,filter=file.filter;null==filter&&(filter={}),"upOrAdd"==op?filter[pos]=value:"del"==op&&delete filter[pos],index==jfgrid.currentSheetIndex&&jfgrid.createFilterOptions(file.filter_select,filter)}else if("fsc"==type)file.filter=null,file.filter_select=null,index==jfgrid.currentSheetIndex&&($("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex+", #jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex).remove(),$("#jfgrid-filter-menu, #jfgrid-filter-submenu").hide());else if("fsr"==type)file.filter=value.filter,file.filter_select=value.filter_select,index==jfgrid.currentSheetIndex&&jfgrid.createFilterOptions(file.filter_select,file.filter);else if("sha"==type){jfgridfile.push(value);var colorset="";null!=value.color&&(colorset='<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+value.color+';"></div>'),$("#jfgrid-sheet-container-c").append(jfgrid.replaceHtml(sheetHTML,{index:value.index,active:"",name:value.name,style:"",colorset:colorset})),$("#jfgrid-cell-main").append('<div id="jfgrid-datavisual-selection-set-'+value.index+'" class="jfgrid-datavisual-selection-set"></div>')}else if("shc"==type){var copyindex=value.copyindex,name=value.name,copyarrindex=jfgrid.sheetmanage.getSheetIndex(copyindex),copyjson=$.extend(!0,{},jfgridfile[copyarrindex]);copyjson.index=index,copyjson.name=name,jfgridfile.splice(copyarrindex+1,0,copyjson);var copyobject=$("#jfgrid-sheets-item"+copyindex);$("#jfgrid-sheet-container-c").append(jfgrid.replaceHtml(sheetHTML,{index:copyjson.index,active:"",name:copyjson.name,style:"",colorset:""})),$("#jfgrid-sheets-item"+copyjson.index).insertAfter(copyobject),$("#jfgrid-cell-main").append('<div id="jfgrid-datavisual-selection-set-'+copyjson.index+'" class="jfgrid-datavisual-selection-set"></div>')}else if("shd"==type){for(var i=0;i<jfgridfile.length;i++)if(jfgridfile[i].index==value.deleIndex){jfgrid.server.sheetDeleSave.push(jfgridfile[i]),jfgridfile.splice(i,1);break}$("#jfgrid-sheets-item"+value.deleIndex).remove(),$("#jfgrid-datavisual-selection-set-"+value.deleIndex).remove()}else if("shr"==type)for(x in value)jfgridfile[jfgrid.sheetmanage.getSheetIndex(x)].order=value[x];else if("shre"==type){for(var i=0;i<jfgrid.server.sheetDeleSave.length;i++)if(jfgrid.server.sheetDeleSave[i].index==value.reIndex){var datav=jfgrid.server.sheetDeleSave[i];jfgridfile.push(datav);var colorset="";null!=value.color&&(colorset='<div class="jfgrid-sheets-item-color" style=" position: absolute; width: 100%; height: 3px; bottom: 0px; left: 0px; background-color: '+datav.color+';"></div>'),$("#jfgrid-sheet-container-c").append(jfgrid.replaceHtml(sheetHTML,{index:datav.index,active:"",name:datav.name,style:"",colorset:colorset})),$("#jfgrid-cell-main").append('<div id="jfgrid-datavisual-selection-set-'+datav.index+'" class="jfgrid-datavisual-selection-set"></div>');break}}else if("sh"==type){var op=item.op,cur=item.cur;"hide"==op?(file.hide=1,$("#jfgrid-sheets-item"+index).hide(),index==jfgrid.currentSheetIndex&&($("#jfgrid-sheets-item"+cur).addClass("jfgrid-sheets-item-active"),jfgrid.sheetmanage.changeSheetExec(cur))):"show"==op&&(file.hide=0,$("#jfgrid-sheets-item"+index).show())}else if("c"==type){var op=item.op,cid=item.cid;if("add"==op)file.chart.push(value),jfgrid.insertChartTosheet(value.sheetIndex,value.dataSheetIndex,value.option,value.chartType,value.selfOption,value.defaultOption,value.row,value.column,value.chart_selection_color,value.chart_id,value.chart_selection_id,value.chartStyle,value.rangeConfigCheck,value.rangeRowCheck,value.rangeColCheck,value.chartMarkConfig,value.chartTitleConfig,value.winWidth,value.winHeight,value.scrollLeft1,value.scrollTop1,value.chartTheme,value.myWidth,value.myHeight,value.myLeft,value.myTop,value.myindexrank1,!0);else if("xy"==op||"wh"==op||"update"==op)for(var i=0;i<file.chart.length;i++){var chartjson=file.chart[i];if(chartjson.chart_id==cid){for(var item in chartjson)for(var vitem in value)item==vitem&&(chartjson[item]=value[vitem]);return void jfgrid.sheetmanage.saveChart(chartjson)}}else if("del"==op)for(var i=0;i<file.chart.length;i++){var chartjson=file.chart[i];if(chartjson.chart_id==cid)return file.chart.splice(i,1),$("#"+cid).remove(),void jfgrid.sheetmanage.delChart($("#"+cid).attr("chart_id"),$("#"+cid).attr("sheetIndex"))}}else"na"==type&&$("#jfgrid_info_detail_input").val(value).css("width",10*jfgrid.getByteLen(value))},multipleIndex:0,multipleRangeShow:function(e,r,t,i){var a,n=r2=t,o=c2=i,l=visibledatarow[r2],d=n-1==-1?0:visibledatarow[n-1],f=visibledatacolumn[c2],s=o-1==-1?0:visibledatacolumn[o-1],g=jfgrid.menuButton.mergeborer(jfgrid.flowdata,n,o);g&&(l=g.row[1],d=g.row[0],f=g.column[1],s=g.column[0]),0<$("#jfgrid-multipleRange-show-"+e).length?$("#jfgrid-multipleRange-show-"+e).css({position:"absolute",left:s-1,width:f-s-1,top:d-1,height:l-d-1}):(a='<div id="jfgrid-multipleRange-show-'+e+'" data-color="'+jfgrid.jfcolor[jfgrid.server.multipleIndex]+'" title="'+r+'" style="position: absolute;left: '+(s-1)+"px;width: "+(f-s-1)+"px;top: "+(d-1)+"px;height: "+(l-d-1)+"px;border: 1px solid "+jfgrid.jfcolor[jfgrid.server.multipleIndex]+';z-index: 15;"><div style="width: 100%;height: 100%;position: absolute;top: 0;right: 0;bottom: 0;left: 0;opacity: 0.03;background-color: '+jfgrid.jfcolor[jfgrid.server.multipleIndex]+'"></div></div>',$(a).appendTo($("#jfgrid-cell-main #jfgrid-multipleRange-show")),jfgrid.server.multipleIndex++)},sheetDeleSave:[],submitInterval:1e3,imagesubmitInterval:5e3,submitdatalimit:50,submitcompresslimit:1e3,checksubmit:function(e){var r=this;r.submitTimeout(),clearTimeout(r.imageRequestTimeout),r.imageRequestTimeout=setTimeout(function(){r.imageRequest()},r.imagesubmitInterval)},submitTimeout:function(){var e=this;clearTimeout(e.requestTimeOut),!e.requestLock&&null!=e.requestlast&&e.requestlast.clone().add(1,"seconds").isBefore(moment())&&e.request(),e.requestTimeOut=setTimeout(function(){e.submitTimeout()},e.submitInterval)},requestLock:!1,requestlast:null,firstchange:!0,requestTimeOut:null,request:function(){var _this=this,key=this.gridKey,cahce_key=key+"__qkcache";_this.cachelocaldata(function(cahce_key,params){var compressBeginLen,iscommpress;0!=params.length&&(params=encodeURIComponent(JSON.stringify(params)),compressBeginLen=params.length,iscommpress=!1,_this.requestLock=!0,""!=_this.updateUrl&&$.post(_this.updateUrl,{compress:iscommpress,gridKey:_this.gridKey,data:params},function(data){var re=eval("("+data+")");re.status?($("#jfgrid_info_detail_update").html("最近存档时间:"+moment().format("M-D H:m:s")),$("#jfgrid_info_detail_save").html("同步成功"),_this.clearcachelocaldata()):($("#jfgrid_info_detail_save").html("<span style='color:#ff2121'>同步失败</span>"),_this.restorecachelocaldata()),_this.requestlast=moment(),_this.requestLock=!1}))})},imageRequestLast:null,imageRequestLock:!1,imageRequestTimeout:null,imageRequest:function(){var _this=this;html2canvas($("#"+container).find(".jfgrid-grid-window").get(0),{onrendered:function(canvas){var old=$(canvas).appendTo("body");old.hide();var newwidth=old.width(),newheight=old.height(),imageData=old.get(0).getContext("2d").getImageData(0,0,newwidth,newheight),cutW=newwidth,cutH=newheight;cutH<.54*cutW?cutW=cutH/.54:cutH=.54*cutW;var newCanvas=$("<canvas>").attr("width",cutW).attr("height",cutH)[0];newCanvas.getContext("2d").putImageData(imageData,0,0),old.attr("width",350),old.attr("height",189),old.get(0).getContext("2d").drawImage(newCanvas,0,0,350,189);var base64=old.get(0).toDataURL("image/jpeg",.9),curindex=jfgrid.sheetmanage.getCurSheetnoset();_this.imageRequestLock=!0;var data1=encodeURIComponent(JSON.stringify({t:"thumb",img:base64,curindex:curindex}));old.remove(),""!=_this.updateImageUrl&&$.post(_this.updateImageUrl,{compress:!1,gridKey:_this.gridKey,data:data1},function(data){var re=eval("("+data+")");re.status?imageRequestLast=moment():$("#jfgrid_info_detail_save").html("<span style='color:#ff2121'>网络不稳定</span>"),_this.imageRequestLock=!0})}})},localdata:[],matchOpt:function(e,r){for(var t in e){if("t"==t&&e.t in{drc:1,arc:1,sha:1,shc:1,shd:1})return!1;if("v"!=t){if(!(t in r))return!1;if(r[t]!=e[t])return!1}}return!0},deleteRepeatOpt:function(e,r){var t=e;if(r instanceof Array)for(var i=0;i<r.length;i++)for(var a=r[i],n=0;n<t.length;n++){var o=e[i];this.matchOpt(a,o)&&delete t[n]}else for(n=0;n<t.length;n++){o=t[n];this.matchOpt(r,o)&&delete t[n]}for(var l=[],i=0;i<t.length;i++)null!=t[i]&&l.push(t[i]);return l},setlocaldata:function(r,t){this.gridKey;var i=this;i.getlocaldata(function(e){null==e&&(e=[]),r instanceof Array?e=e.concat(r):e.push(r),i.localdata=e,t(i.localdata)})},getlocaldata:function(e){this.gridKey;e(this.localdata)},clearlocaldata:function(e){this.gridKey;this.localdata=[],e()},cachelocaldata:function(e){var r=this.gridKey+"__qkcache",t=this.localdata,i=t.length;if(1<i){var a=[];a[0]=t[0];for(var n=1;n<i;n++){for(var o=t[n],l=!0,d=0;d<a.length;d++){var f=a[d];if(this.matchOpt(o,f)){a.splice(d,1,o),l=!1;break}}l&&(a=a.concat(o))}t=a}null!=t&&0!=t.length&&this.clearlocaldata(function(){localforage.setItem(r,t).then(function(){e(r,t)})})},clearcachelocaldata:function(t){var e=this.gridKey+"__qkcache";localforage.removeItem(e,function(e,r){t&&"function"==typeof t&&t()})},restorecachelocaldata:function(i){var e=this.gridKey+"__qkcache",a=this;localforage.getItem(e).then(function(e){var t=e;a.getlocaldata(function(e){null==e&&(e=[]);var r=t.concat(e);a.localdata=r,i instanceof Function&&i(a.localdata)})})}},jfgrid.method={addDataAjax:function(e,r,t,i){null==r&&(r=jfgrid.currentSheetIndex),null==t&&(t=jfgrid.server.loadSheetUrl),$("#jfgrid-grid-window-1").append(jfgridlodingHTML),e.currentPage++;jfgridfile[jfgrid.sheetmanage.getSheetIndex(r)];var a=sessionStorage.getItem("x-auth-token");$.ajax({method:"POST",url:t,headers:{"x-auth-token":a},data:JSON.stringify(e),contentType:"application/json;charset=UTF-8",success:function(e){"string"==typeof e&&(e=JSON.parse(e));var r=e.data,t=r.celldata;jfgrid.jfgridextendData(r.row,t),setTimeout(function(){$("#jfgridloadingdata").fadeOut().remove()},500),i&&"function"==typeof i&&i(r)}})},reload:function(param,index,url,func){var _this=this;null==index&&(index=jfgrid.currentSheetIndex),null==url&&(url=jfgrid.server.loadSheetUrl),$("#jfgrid-grid-window-1").append(jfgridlodingHTML);var arg={gridKey:jfgrid.server.gridKey,index:index};param=$.extend(!0,param,arg);var file=jfgridfile[jfgrid.sheetmanage.getSheetIndex(index)];$.post(url,param,function(d){var dataset=eval("("+d+")");file.celldata=dataset[index.toString()];var data=jfgrid.sheetmanage.buildGridData(file);setTimeout(function(){$("#jfgridloadingdata").fadeOut().remove()},500),file.data=data,jfgrid.flowdata=data,jfgrid.editor.webWorkerFlowDataCache(data),jfgrid.jfgridcreatesheet(data[0].length,data.length,data,null,!1),file.load="1",jfgird_select_save=[],jfgrid_selection_range=[],jfgrid.server.saveParam("shs",null,jfgrid.currentSheetIndex),jfgrid.sheetmanage.changeSheet(index),func&&"function"==typeof func&&func()})},clearSheetByIndex:function(e){var r=jfgrid.sheetmanage.getSheetIndex(e),t=jfgridfile[r];t.isPivotTable?delete t:(t.data=[],t.row=defaultrowNum,t.column=defaultcolumnNum,t.chart=[],t.config=null,t.filter=null,t.filter_select=null,t.celldata=[],t.pivotTable={},t.calcChain=[],t.status=0,t.load=0,jfgrid.flowdata=[],jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata),$("#"+container+" .jfgrid-data-visualization-chart").remove(),$("#"+container+" .jfgrid-datavisual-selection-set").remove(),$("#jfgrid-row-count-show, #jfgrid-formula-functionrange-select, #jfgrid-row-count-show, #jfgrid-column-count-show, #jfgrid-change-size-line, #jfgrid-cell-selected-focus, #jfgrid-selection-copy, #jfgrid-cell-selected-extend, #jfgrid-cell-selected-move, #jfgrid-cell-selected").hide(),delete t.load)},clear:function(e){if("all"==e)for(var r=0;r<jfgridfile.length;r++){var t=jfgridfile[r];this.clearSheetByIndex(t.index)}else null==e&&(e=jfgrid.currentSheetIndex),this.clearSheetByIndex(e);jfgrid.sheetmanage.changeSheet(jfgridfile[0].index)},destroy:function(){$("#"+container).empty(),$("body > .jfgrid-cols-menu").remove(),$("#jfgrid-modal-dialog-mask, #jfgridTextSizeTest, #jfgrid-icon-morebtn-div").remove(),$("#jfgrid-input-box").parent().remove(),$("#jfgrid-formula-help-c").remove(),jfgrid.jfredo=[],jfgrid.jfundo=[],jfgrid.freezen.initialHorizontal=!0,jfgrid.freezen.initialVertical=!0,jfgridConfigsetting.pointEdit=!1},editorChart:function(e){jfgridfile[0];var r=jfgrid.jfcolor[0],t="jfgridEditMode-datav-chart";e.chart_id=t;var i=null==(i=e.chartTheme)?"default0000":i;jfgrid.insertChartTosheet(e.sheetIndex,e.dataSheetIndex,e.option,e.chartType,e.selfOption,e.defaultOption,e.row,e.column,r,t,"jfgridEditMode-datav-chart_selection",e.chartStyle,e.rangeConfigCheck,e.rangeRowCheck,e.rangeColCheck,e.chartMarkConfig,e.chartTitleConfig,e.winWidth,e.winHeight,e.scrollLeft,e.scrollTop,i,e.myWidth,e.myHeight,null!=e.myLeft?parseFloat(e.myLeft):null,null!=e.myTop?parseFloat(e.myTop):null,e.myindexrank,!0),$("#"+t).find(".jfgrid-modal-controll-update").click()}},jfgrid.jfrefreshchartall=function(e,r,t,i,a){window.generator&&generator.changeChartCellDataHook(e,r,t,i,a)},jfgrid.jfrefreshchart=function($obj,flowdata1,r_st,r_ed,c_st,c_ed){var row=eval("("+$obj.attr("row")+")"),column=eval("("+$obj.attr("column")+")"),type,style,selfOption,defaultOption,chartMarkConfig,chartTitleConfig,chartTheme;r_st>row[1]||r_ed<row[0]||c_st>column[1]||c_ed<column[0]||(type=$obj.attr("chartType"),style=$obj.attr("chartStyle"),selfOption=$obj.attr("selfOption"),defaultOption=$obj.attr("defaultOption"),chartMarkConfig=$obj.attr("chartMarkConfig"),chartTitleConfig=$obj.attr("chartTitleConfig"),chartTheme=$obj.attr("chartTheme"),jfgrid.chartparam.jgridCurrentChartSelection={row:row,column:column},jfgrid.chartparam.jgridCurrentChartData=jfgrid.getdatabyselectionD(flowdata1,jfgrid.chartparam.jgridCurrentChartSelection),rangeConfigCheck=!(jfgrid.chartparam.jgridCurrentChartData.length>=jfgrid.chartparam.jgridCurrentChartData[0].length),rangeRowCheck=1!=jfgrid.chartparam.jgridCurrentChartData.length,rangeColCheck=1!=jfgrid.chartparam.jgridCurrentChartData[0].length,jfgrid.range_config(rangeConfigCheck,rangeRowCheck,rangeColCheck),jfgrid.chartparam.jfgridcurrentChart=echarts.getInstanceById($obj.find(".jfgrid-modal-dialog-content").attr("_echarts_instance_")),"object"!=jfgrid.getObjType(chartMarkConfig)&&(chartMarkConfig=eval("("+chartMarkConfig+")")),"object"!=jfgrid.getObjType(chartTitleConfig)&&(chartTitleConfig=eval("("+chartTitleConfig+")")),"object"!=jfgrid.getObjType(selfOption)&&(selfOption=eval("("+selfOption+")")),jfgrid.chartparam.jfgrid_chart_mark_config=chartMarkConfig,jfgrid.chartparam.jfgrid_chart_title_config=chartTitleConfig,jfgrid.chartparam.jfgrid_chart_self_config=null==selfOption?{}:selfOption,jfgrid.jfgrid_datavisual_item_active("datachange",type,style),"function"==typeof jfgrid.jfgridConfigsetting.chartConfigChange&&jfgrid.jfgridConfigsetting.chartConfigChange({sheetIndex:$obj.attr("sheetIndex"),dataSheetIndex:$obj.attr("dataSheetIndex"),option:jfgrid.chartparam.jfgridcurrentChart.getOption(),chartType:type,selfOption:selfOption,defaultOption:defaultOption,row:row,column:column,chart_id:$obj.attr("chart_id"),chart_selection_color:$obj.attr("chart_selection_color"),chart_selection_id:$obj.attr("chart_selection_id"),chartStyle:style,rangeConfigCheck:rangeConfigCheck,rangeRowCheck:rangeRowCheck,rangeColCheck:rangeColCheck,chartMarkConfig:chartMarkConfig,chartTitleConfig:chartTitleConfig,chartTheme:chartTheme}))},jfgrid.getcellvalue=function(e,r,t,i){var a;if(null==i&&(i="v"),null==t&&(t=jfgrid.flowdata),null!=e&&null!=r)a=t[e][r];else if(null!=e)a=t[e];else{if(null==r)return t;a=t[r]}var n=a;return"object"==jfgrid.getObjType(a)&&(n=a[i],"f"==i&&null!=n?n=jfgrid.formula.functionHTMLGenerate(n):"f"==i?n=a.v:a&&a.ct&&"yyyy-MM-dd"==a.ct.fa&&(n=a.m)),null==n&&(n=null),n},jfgrid.setAccuracy=function(e,r){var t,i,a="0.";if("TRUE"==e){if(null==r)return"w";if(0==(i=parseInt(r)))return"w0";a="w0.";for(var n=0;n<i;n++)a+="0";t=a}else{if(null==r)return"General";if(0==(i=parseInt(r)))return"0";for(n=0;n<i;n++)a+="0";t=a}return t.toString()},jfgrid.setcellvalue=function(e,r,t,i){var a,n,o,l,d,f,s=t[e][r];if(a="object"==jfgrid.getObjType(i)?(null!=(s=i).f&&(s.f=i.f),null!=i.spl&&(s.spl=i.spl),"object"==jfgrid.getObjType(i.v)?i.v.v:i.v):i,jfgrid.func_methods.isRealNull(a))return"object"==jfgrid.getObjType(s)?(delete s.m,delete s.v):s=null,void(t[e][r]=s);jfgrid.func_methods.isRealNull(s)&&(s={}),"'"==a.toString().substr(0,1)?(s.m=a.toString().substr(1),s.ct={fa:"@",t:"s"},s.v=a.toString().substr(1)):"TRUE"===a.toString().toUpperCase()?(s.m="TRUE",s.ct={fa:"General",t:"b"},s.v=!0):"FALSE"===a.toString().toUpperCase()?(s.m="FALSE",s.ct={fa:"General",t:"b"},s.v=!1):jfgrid.func_methods.valueIsError(a)?(s.m=a.toString(),s.ct={fa:"General",t:"e"},s.v=a):null!=s.f&&jfgrid.func_methods.isRealNum(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a)?(s.v=parseFloat(a),s.ct={fa:"General",t:"n"},s.v==1/0||s.v==-1/0?s.m=s.v.toString():-1<s.v.toString().indexOf("e")?(5<(n=s.v.toString().split(".")[1].split("e")[0].length)&&(n=5),s.m=s.v.toExponential(n).toString()):(o=jfgrid.mask.genarate(Math.round(1e9*s.v)/1e9),s.m=o[0].toString())):null!=s.ct&&"@"==s.ct.fa?(s.m=a.toString(),s.v=a):null!=s.ct&&null!=s.ct.fa&&"General"!=s.ct.fa?(jfgrid.func_methods.isRealNum(a)&&(a=parseFloat(a)),(o=jfgrid.mask.update(s.ct.fa,a))===a?(o=jfgrid.mask.genarate(a),s.m=o[0].toString(),s.ct=o[1],s.v=o[2]):(s.m=o.toString(),s.v=a)):jfgrid.func_methods.isRealNum(a)&&!/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(a)?(a=parseFloat(a),s.v=parseFloat(a),s.ct={fa:"General",t:"n"},s.v==1/0||s.v==-1/0?s.m=s.v.toString():(o=jfgrid.mask.genarate(s.v),s.m=o[0].toString())):(o=jfgrid.mask.genarate(a),s.m=o[0].toString(),s.ct=o[1],s.v=o[2]),jfgrid.server.allowUpdate||jfgridConfigsetting.pointEdit||null!=s.ct&&0==/^(w|W)((0?)|(0\.0+))$/.test(s.ct.fa)&&"n"==s.ct.t&&null!=s.v&&4<parseInt(s.v).toString().length&&(l="",l=jfgrid.rptSetting&&jfgrid.rptSetting.autoFormatw?jfgrid.rptSetting.autoFormatw.toString().toUpperCase():jfgridConfigsetting.autoFormatw.toString().toUpperCase(),d=jfgrid.rptSetting&&jfgrid.rptSetting.accuracy?jfgrid.rptSetting.accuracy:jfgridConfigsetting.accuracy,"General"!=(f=jfgrid.setAccuracy(l,d))&&(s.ct.fa=f,s.m=jfgrid.mask.update(f,s.v))),t[e][r]=s},jfgrid.jfrefreshcell=function(e,r,t){var i;clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:"cellchange",sheetIndex:jfgrid.currentSheetIndex,value:jfgrid.flowdata[r][t],curvalue:$.extend(!0,{},e),uprow:r,upcolumn:t})),sourcechange&&((i=[].concat(jfgrid.flowdata[r]))[t]=e,jfgrid.flowdata[r]=i);var a=jfgrid.flowdata,n=$("#jfgridTableContent").get(0).getContext("2d"),o=$("#jfgrid-cell-main").scrollLeft(),l=$("#jfgrid-cell-main").scrollTop(),d=0==r?0:visibledatarow[r-1]-l-1,f=visibledatarow[r]-l,s=0==t?0:visibledatacolumn[t-1]-o,g=visibledatacolumn[t]-o;if(0<$("#jfgrid-data-visualization").length&&$("#jfgrid-data-visualization").is(":visible")&&(jfgrid.chartparam.jgridCurrentChartData=jfgrid.getdatabyselectionD(jfgrid.flowdata,jfgrid.chartparam.jgridCurrentChartSelection),jfgrid.jfgrid_datavisual_item_active()),null!=a[r]&&null!=a[r][t]){var e=jfgrid.getcellvalue(r,t,a),c=defaultcollen;if(null!=config.columlen&&null!=config.columlen[t]&&(c=config.columlen[t]),c<n.measureText(e).width){for(var u="",m=e.toString().split(""),h=0;h<m.length&&!(n.measureText(u+""+m[h]).width+12>c);h++)u+=m[h];e=u+"..."}n.clearRect(s+rowHeaderWidth-1,d+columeHeaderHeight-1,g-s-1,f-d-2),n.fillText(null==e?"":e,s+4+rowHeaderWidth,columeHeaderHeight+d+(f-d)/2-1);var j=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[r]&&(j=config.rowlen[r]),n.clearRect(s+rowHeaderWidth-1+c-1,d+columeHeaderHeight-1,3,f-d-2),jfgridcurrentisPivotTable||(n.beginPath(),n.moveTo(s+rowHeaderWidth-1+c,d+columeHeaderHeight-1),n.lineTo(s+rowHeaderWidth-1+c,d+columeHeaderHeight-1+j),n.lineWidth=devicePixelRatio,n.strokeStyle=jfgriddefaultstyle.strokeStyle,n.closePath(),n.stroke())}jfgrid.server.saveParam("v",jfgrid.currentSheetIndex,e,{r:r,c:t}),jfgrid.jfrefreshchartall(jfgrid.flowdata,r,r,t,t),jfgridConfigsetting.pointEdit&&jfgrid.pointEdit_updateData()},jfgrid.jfrefreshrange=function(e,r,t){jfgrid.formula.execFunctionExist=[];for(var i=0;i<r.length;i++)for(var a=r[i].row[0];a<=r[i].row[1];a++)for(var n=r[i].column[0];n<=r[i].column[1];n++)jfgrid.formula.execFunctionExist.push({r:a,c:n,i:jfgrid.currentSheetIndex});jfgrid.formula.execFunctionExist.reverse(),jfgrid.formula.execFunctionGroup(null,null,null,null,e),jfgrid.formula.execFunctionGroupData=null,clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:"rangechange",data:jfgrid.flowdata,curdata:e,range:r,sheetIndex:jfgrid.currentSheetIndex,cdformat:$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save),curCdformat:t})),jfgrid.flowdata=e,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].data=jfgrid.flowdata,null!=t&&(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save=t),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1);for(i=0;i<r.length;i++)jfgrid.server.historyParam(jfgrid.flowdata,jfgrid.currentSheetIndex,r[i]),jfgrid.jfrefreshchartall(jfgrid.flowdata,r[i].row[0],r[i].row[1],r[i].column[0],r[i].column[1]);jfgridConfigsetting.pointEdit&&jfgrid.pointEdit_updateData()},jfgrid.jfrefreshgrid=function(data,range,cfg,cdformat,RowlChange){jfgrid.formula.execFunctionExist=[];for(var s=0,curConfig,curConfig,curCdformat,curCdformat;s<range.length;s++)for(var r=range[s].row[0];r<=range[s].row[1];r++)for(var c=range[s].column[0];c<=range[s].column[1];c++)jfgrid.formula.execFunctionExist.push({r:r,c:c,i:jfgrid.currentSheetIndex});jfgrid.formula.execFunctionExist.reverse(),jfgrid.formula.execFunctionGroup(null,null,null,null,data),jfgrid.formula.execFunctionGroupData=null,clearjfundo&&(jfgrid.jfundo=[],curConfig=null==cfg?$.extend(!0,{},config):$.extend(!0,{},cfg),curCdformat=null==cdformat?$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save):cdformat,jfgrid.jfredo.push({type:"datachange",data:jfgrid.flowdata,curdata:data,sheetIndex:jfgrid.currentSheetIndex,range:range,config:$.extend(!0,{},config),curConfig:curConfig,cdformat:$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save),curCdformat:curCdformat,RowlChange:RowlChange})),jfgrid.flowdata=data,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].data=jfgrid.flowdata,null!=cfg&&(config=cfg,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,cfg,{k:"config"}),null!=RowlChange&&jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length)),null!=cdformat&&(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save=cdformat,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,cdformat,{k:"jfgrid_conditionformat_save"}));for(var s=0;s<range.length;s++){var r1=range[s].row[0],c1=range[s].column[0],fp,sparklines;null!=jfgrid.flowdata[r1][c1]&&null!=jfgrid.flowdata[r1][c1].spl&&(window.jfgridCurrentRow=r1,window.jfgridCurrentColumn=c1,window.jfgridCurrentFunction=jfgrid.flowdata[r1][c1].f,fp=$.trim(jfgrid.formula.functionParser(jfgrid.flowdata[r1][c1].f)),sparklines=eval(fp),jfgrid.flowdata[r1][c1].spl=sparklines),jfgrid.server.allowUpdate&&jfgrid.server.historyParam(jfgrid.flowdata,jfgrid.currentSheetIndex,range[s]),jfgrid.jfrefreshchartall(jfgrid.flowdata,range[s].row[0],range[s].row[1],range[s].column[0],range[s].column[1])}setTimeout(function(){jfgrid.jfgridrefreshgrid()},1),window.jfgrid_getcelldata_cache=null,jfgridConfigsetting.pointEdit&&jfgrid.pointEdit_updateData()},jfgrid.pointEdit_updateData=function(){var e=[];null!=jfgrid.flowdata&&0<jfgrid.flowdata.length&&(e=jfgrid.dataToCelldata(jfgrid.flowdata));var r=$.extend(!0,[],jfgrid.getjfgridfile());r[0].celldata=e,r[0].row=jfgrid.flowdata.length,r[0].column=jfgrid.flowdata[0].length,delete r[0].data,jfgridConfigsetting.pointEditUpdate(r)},jfgrid.dataToCelldata=function(e){for(var r=[],t=0;t<e.length;t++)for(var i=0;i<e[0].length;i++){var a,n=e[t][i];null!=n&&(a={r:t,c:i,v:n},r.push(a))}return r},jfgrid.jfrefreshgridall=function(e,r,t,i,a,n,o,l,d){var f={};if("cellRowChange"==n){f.type="cellRowChange",f.config=$.extend(!0,{},config),f.curconfig=$.extend(!0,{},i),f.range=$.extend(!0,[],jfgird_select_save),f.currange=a,f.ctrlType=n,f.ctrlValue=o;var s=i.rowlen;null==s&&(s={}),jfgrid.server.saveParam("cg",jfgrid.currentSheetIndex,s,{k:"rowlen"})}else if(-1<n.indexOf("extend"))f.type="extend",f.config=$.extend(!0,{},config),f.curconfig=$.extend(!0,{},i),f.range=$.extend(!0,[],jfgird_select_save),f.currange=a,f.ctrlType=n,f.ctrlValue=o,jfgrid.server.saveParam("arc",jfgrid.currentSheetIndex,{index:o.index,len:o.len,direction:o.direction,mc:i.merge},{rc:o.type});else if(-1<n.indexOf("dele"))f.type="dele",f.config=$.extend(!0,{},config),f.curconfig=$.extend(!0,{},i),f.range=$.extend(!0,[],jfgird_select_save),f.currange=a,f.ctrlType=n,f.ctrlValue=o,jfgrid.server.saveParam("drc",jfgrid.currentSheetIndex,{index:o.index,len:o.len,mc:i.merge,borderInfo:i.borderInfo},{rc:o.type});else{jfgrid.formula.execFunctionExist=[];for(var g=0;g<a.length;g++)for(var c=a[g].row[0];c<=a[g].row[1];c++)for(var u=a[g].column[0];u<=a[g].column[1];u++)jfgrid.formula.execFunctionExist.push({r:c,c:u,i:jfgrid.currentSheetIndex});jfgrid.formula.execFunctionExist.reverse(),jfgrid.formula.execFunctionGroup(null,null,null,null,t),jfgrid.formula.execFunctionGroupData=null,f.type="datachangeAll",f.range=$.extend(!0,[],jfgird_select_save),f.currange=a,f.ctrlType=n,f.ctrlValue=o;for(g=0;g<a.length;g++)jfgrid.server.historyParam(t,jfgrid.currentSheetIndex,a[g])}if(clearjfundo&&(jfgrid.jfundo=[],f.data=jfgrid.flowdata,f.curdata=t,f.sheetIndex=jfgrid.currentSheetIndex,f.cdformat=$.extend(!0,[],jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save),f.curCdformat=l,jfgrid.jfredo.push(f)),jfgrid.flowdata=t,jfgrid.editor.webWorkerFlowDataCache(t),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].data=jfgrid.flowdata,null!=i&&(config=i,jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config=config,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,i,{k:"config"})),null!=l&&(jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].jfgrid_conditionformat_save=l,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,l,{k:"jfgrid_conditionformat_save"})),0<(jfgird_select_save=$.extend(!0,[],a)).length&&jfgrid.selectHightlightShow(),jfgrid.jfrefreshgrid_rhcw(r,e),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1),jfgrid.sheetmanage.storeSheetParamALL(),null==i)for(g=0;g<a.length;g++)jfgrid.jfrefreshchartall(jfgrid.flowdata,a[g].row[0],a[g].row[1],a[g].column[0],a[g].column[1]);window.jfgrid_getcelldata_cache=null,jfgridConfigsetting.pointEdit&&jfgrid.pointEdit_updateData()},jfgrid.jfrefreshgrid_adRC=function(e,r,t,i,a,n,o,l,d){var f=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)],s=[];for(var g in r.merge)for(var c=r.merge[g],u=c.r;u<=c.r+c.rs-1;u++)for(var m=c.c;m<=c.c+c.cs-1;m++)null==e[u][m]&&(e[u][m]={}),u==c.r&&m==c.c?e[u][m].mc=c:e[u][m].mc={r:c.r,c:c.c},s.push({r:u,c:m});var h=[];if(0<a.length){jfgrid.formula.execFunctionGroupData=e;for(var j=0;j<a.length;j++){var p=a[j],v=p.r,b=p.c,_=(p.index,p.func[2]),w=jfgrid.formula.execfunction(_,v,b,null,!0);p.func=w,e[v][b].f==_&&(jfgrid.setcellvalue(v,b,e,w[1]),h.push({r:v,c:b}))}}clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:t,sheetIndex:jfgrid.currentSheetIndex,data:jfgrid.flowdata,curData:e,config:$.extend(!0,{},config),curConfig:r,ctrlValue:i,mcData:s,calc:$.extend(!0,[],f.calcChain),curCalc:a,funcData:h,filterObj:{filter_select:$.extend(!0,{},f.filter_select),filter:$.extend(!0,{},f.filter)},curFilterObj:n,cf:$.extend(!0,[],f.jfgrid_conditionformat_save),curCf:o,af:$.extend(!0,[],f.jfgrid_alternateformat_save),curAf:l,freezen:{freezenhorizontaldata:jfgrid.freezen.freezenhorizontaldata,freezenverticaldata:jfgrid.freezen.freezenverticaldata},curFreezen:d}));var y=i.index,x=i.len,C=i.rc;if("addRC"==t){var T,I,R=i.direction,k=[];if(i.restore)if("r"==C){"lefttop"==R?T=y:"rightbottom"==R&&(T=y+1);for(var S=T+x-1,u=T;u<=S;u++){for(var A=[],m=0;m<e[0].length;m++){var F=e[u][m];A.push(F)}k.push(A)}}else if("c"==C){"lefttop"==R?I=y:"rightbottom"==R&&(I=y+1);for(var N=I+x-1,u=0;u<e.length;u++){for(A=[],m=I;m<=N;m++){F=e[u][m];A.push(F)}k.push(A)}}jfgrid.server.saveParam("arc",jfgrid.currentSheetIndex,{index:y,len:x,direction:R,data:k},{rc:C})}else"delRC"==t&&jfgrid.server.saveParam("drc",jfgrid.currentSheetIndex,{index:y,len:x},{rc:C});jfgrid.flowdata=e,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata),f.data=e,config=r,f.config=config,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,r,{k:"config"});for(j=0;j<s.length;j++){var M=s[j].r,E=s[j].c;jfgrid.server.saveParam("v",jfgrid.currentSheetIndex,jfgrid.flowdata[M][E],{r:M,c:E})}f.calcChain=a,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,a,{k:"calcChain"});for(j=0;j<h.length;j++){var O=h[j].r,z=h[j].c;jfgrid.server.saveParam("v",jfgrid.currentSheetIndex,jfgrid.flowdata[O][z],{r:O,c:z})}null!=n?(f.filter_select=n.filter_select,f.filter=n.filter):(f.filter_select=null,f.filter=null),jfgrid.createFilterOptions(f.filter_select,f.filter),jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,f.filter_select,{k:"filter_select"}),jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,f.filter,{k:"filter"}),f.jfgrid_conditionformat_save=o,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,f.jfgrid_conditionformat_save,{k:"jfgrid_conditionformat_save"}),f.jfgrid_alternateformat_save=l,jfgrid.server.saveParam("all",jfgrid.currentSheetIndex,f.jfgrid_alternateformat_save,{k:"jfgrid_alternateformat_save"}),null!=d?(jfgrid.freezen.freezenhorizontaldata=d.freezenhorizontaldata,jfgrid.freezen.freezenverticaldata=d.freezenverticaldata):(jfgrid.freezen.freezenhorizontaldata=null,jfgrid.freezen.freezenverticaldata=null),jfgrid.jfrefreshgrid_rhcw(jfgrid.flowdata.length,jfgrid.flowdata[0].length)},jfgrid.jfrefreshgrid_rhcw=function(rowheight,colwidth){if(null!=rowheight){visibledatarow=[],rh_height=0;for(var i=0;i<rowheight;i++){var rowlen=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[i]&&(rowlen=config.rowlen[i]),null==config.rowhidden||null==config.rowhidden[i]?(rh_height+=rowlen+1,visibledatarow.push(rh_height)):(rowlen=config.rowhidden[i],visibledatarow.push(rh_height))}jfgridConfigsetting.pointEdit||(rh_height+=110)}if(null!=colwidth){visibledatacolumn=[],ch_width=0;for(var maxColumlen=120,i=0;i<colwidth;i++){var firstcolumlen=defaultcollen;null!=config.columlen&&null!=config.columlen[i]?firstcolumlen=config.columlen[i]:null!=jfgrid.flowdata[0]&&null!=jfgrid.flowdata[0][i]&&(300<firstcolumlen?firstcolumlen=300:firstcolumlen<defaultcollen&&(firstcolumlen=defaultcollen),firstcolumlen!=defaultcollen&&(null==config.columlen&&(config.columlen={}),config.columlen[i]=firstcolumlen)),ch_width+=firstcolumlen+1,visibledatacolumn.push(ch_width),maxColumlen<firstcolumlen+1&&(maxColumlen=firstcolumlen+1)}jfgridConfigsetting.pointEdit||(ch_width+=maxColumlen)}jfgrid.sheetmanage.storeSheetParam();var calcChain=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].calcChain,row_st,col_st,scrollTop,scrollLeft,top,freezenhorizontaldata,left,freezenverticaldata,row_st,scrollTop,top,freezenhorizontaldata,col_st,scrollLeft,left,freezenverticaldata,jfgird_filter_save,r1,r2,c1,c2,row,row_pre,col,col_pre;if(null!=calcChain&&0<calcChain.length){null==config.rowlen&&(config.rowlen={}),null==config.columlen&&(config.columlen={});for(var i=0;i<calcChain.length;i++){var r=calcChain[i].r,c=calcChain[i].c,index=calcChain[i].index,fp,sparklines;index==jfgrid.currentSheetIndex&&null!=jfgrid.flowdata[r][c]&&null!=jfgrid.flowdata[r][c].spl&&(r in config.rowlen||c in config.columlen)&&(window.jfgridCurrentRow=r,window.jfgridCurrentColumn=c,window.jfgridCurrentFunction=jfgrid.flowdata[r][c].f,fp=$.trim(jfgrid.formula.functionParser(jfgrid.flowdata[r][c].f)),sparklines=eval(fp),jfgrid.flowdata[r][c].spl=sparklines,jfgrid.server.saveParam("v",jfgrid.currentSheetIndex,jfgrid.flowdata[r][c],{r:r,c:c}))}jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].data=jfgrid.flowdata}jfgrid.postil.positionSync(),jfgrid.selectHightlightShow(),$(".jfgrid-selection-copy").is(":visible")&&jfgrid.selectionCopyShow(),$("#jfgrid-dropCell-icon").is(":visible")&&$("#jfgrid-dropCell-icon").remove(),null!=jfgrid.freezen.freezenhorizontaldata&&null!=jfgrid.freezen.freezenverticaldata?(row_st=jfgrid.freezen.freezenhorizontaldata[1]-1,col_st=jfgrid.freezen.freezenverticaldata[1]-1,scrollTop=jfgrid.freezen.freezenhorizontaldata[2],scrollLeft=jfgrid.freezen.freezenverticaldata[2],top=visibledatarow[row_st]-2-scrollTop+columeHeaderHeight,freezenhorizontaldata=[visibledatarow[row_st],row_st+1,scrollTop,jfgrid.freezen.cutVolumn(visibledatarow,row_st+1),top],left=visibledatacolumn[col_st]-2-scrollLeft+rowHeaderWidth,freezenverticaldata=[visibledatacolumn[col_st],col_st+1,scrollLeft,jfgrid.freezen.cutVolumn(visibledatacolumn,col_st+1),left],jfgrid.freezen.saveFreezen(freezenhorizontaldata,top,freezenverticaldata,left),jfgrid.freezen.createFreezenHorizontal(freezenhorizontaldata,top),jfgrid.freezen.createFreezenVertical(freezenverticaldata,left),jfgrid.freezen.createAssistCanvas()):null!=jfgrid.freezen.freezenhorizontaldata?(row_st=jfgrid.freezen.freezenhorizontaldata[1]-1,scrollTop=jfgrid.freezen.freezenhorizontaldata[2],top=visibledatarow[row_st]-2-scrollTop+columeHeaderHeight,freezenhorizontaldata=[visibledatarow[row_st],row_st+1,scrollTop,jfgrid.freezen.cutVolumn(visibledatarow,row_st+1),top],jfgrid.freezen.saveFreezen(freezenhorizontaldata,top,null,null),jfgrid.freezen.createFreezenHorizontal(freezenhorizontaldata,top),jfgrid.freezen.createAssistCanvas()):null!=jfgrid.freezen.freezenverticaldata?(col_st=jfgrid.freezen.freezenverticaldata[1]-1,scrollLeft=jfgrid.freezen.freezenverticaldata[2],left=visibledatacolumn[col_st]-2-scrollLeft+rowHeaderWidth,freezenverticaldata=[visibledatacolumn[col_st],col_st+1,scrollLeft,jfgrid.freezen.cutVolumn(visibledatacolumn,col_st+1),left],jfgrid.freezen.saveFreezen(null,null,freezenverticaldata,left),jfgrid.freezen.createFreezenVertical(freezenverticaldata,left),jfgrid.freezen.createAssistCanvas()):0<$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").length&&$("#jfgrid-filter-options-sheet"+jfgrid.currentSheetIndex+" .jfgrid-filter-options").each(function(e,r){var t=$(r).data("str"),i=$(r).data("cindex"),a=visibledatacolumn[i]-20,n=t-1==-1?0:visibledatarow[t-1];$(r).css({left:a,top:n})}),0<$("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex).length&&(jfgird_filter_save=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].filter_select,r1=jfgird_filter_save.row[0],r2=jfgird_filter_save.row[1],c1=jfgird_filter_save.column[0],c2=jfgird_filter_save.column[1],row=visibledatarow[r2],row_pre=r1-1==-1?0:visibledatarow[r1-1],col=visibledatacolumn[c2],col_pre=c1-1==-1?0:visibledatacolumn[c1-1],$("#jfgrid-filter-selected-sheet"+jfgrid.currentSheetIndex).css({left:col_pre,width:col-col_pre-1,top:row_pre,height:row-row_pre-1})),jfgrid.sheetmanage.showSheet(),setTimeout(function(){jfgrid.jfgridrefreshgrid()},1),jfgridConfigsetting.pointEdit&&jfgrid.pointEdit_updateData()},jfgrid.jfrefreshgrid_pastcut=function(e,r,t){var i={};jfgrid.formula.execFunctionExist=[];for(var a=e.range.row[0];a<=e.range.row[1];a++)for(var n=e.range.column[0];n<=e.range.column[1];n++)a+"_"+n+"_"+e.sheetIndex in i||(i[a+"_"+n+"_"+e.sheetIndex]=0,jfgrid.formula.execFunctionExist.push({r:a,c:n,i:e.sheetIndex}));for(var o,a=r.range.row[0];a<=r.range.row[1];a++)for(n=r.range.column[0];n<=r.range.column[1];n++)a+"_"+n+"_"+r.sheetIndex in i||(i[a+"_"+n+"_"+r.sheetIndex]=0,jfgrid.formula.execFunctionExist.push({r:a,c:n,i:r.sheetIndex}));if(jfgrid.formula.execFunctionExist.reverse(),jfgrid.formula.execFunctionGroup(null,null,null,null,r.curData),jfgrid.formula.execFunctionGroupData=null,clearjfundo&&(jfgrid.jfundo=[],jfgrid.jfredo.push({type:"pasteCut",source:e,target:r,RowlChange:t})),jfgrid.currentSheetIndex==e.sheetIndex?(config=e.curConfig,o=e.curData.length,jfgridfile[jfgrid.sheetmanage.getSheetIndex(r.sheetIndex)].config=r.curConfig):jfgrid.currentSheetIndex==r.sheetIndex&&(config=r.curConfig,o=r.curData.length,jfgridfile[jfgrid.sheetmanage.getSheetIndex(e.sheetIndex)].config=e.curConfig),t){visibledatarow=[];for(var l,d=rh_height=0;d<o;d++){var f=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[d]&&(f=config.rowlen[d]),null==config.rowhidden||null==config.rowhidden[d]?(rh_height+=f+1,visibledatarow.push(rh_height)):(f=config.rowhidden[d],visibledatarow.push(rh_height))}rh_height+=110,jfgrid.sheetmanage.showSheet(),jfgrid.currentSheetIndex==e.sheetIndex?(l=jfgrid.computeRowlenArr(r.curData.length,r.curConfig),jfgridfile[jfgrid.sheetmanage.getSheetIndex(r.sheetIndex)].visibledatarow=l):jfgrid.currentSheetIndex==r.sheetIndex&&(l=jfgrid.computeRowlenArr(e.curData.length,e.curConfig),jfgridfile[jfgrid.sheetmanage.getSheetIndex(e.sheetIndex)].visibledatarow=l)}jfgrid.currentSheetIndex==e.sheetIndex?(jfgrid.flowdata=e.curData,jfgridfile[jfgrid.sheetmanage.getSheetIndex(r.sheetIndex)].data=r.curData):jfgrid.currentSheetIndex==r.sheetIndex&&(jfgrid.flowdata=r.curData,jfgridfile[jfgrid.sheetmanage.getSheetIndex(e.sheetIndex)].data=e.curData),jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata),jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].data=jfgrid.flowdata,0<(jfgird_select_save=jfgrid.currentSheetIndex==r.sheetIndex?[{row:r.range.row,column:r.range.column}]:[{row:e.range.row,column:e.range.column}]).length&&jfgrid.selectHightlightShow(),jfgridfile[jfgrid.sheetmanage.getSheetIndex(e.sheetIndex)].jfgrid_conditionformat_save=e.curCdformat,jfgridfile[jfgrid.sheetmanage.getSheetIndex(r.sheetIndex)].jfgrid_conditionformat_save=r.curCdformat,setTimeout(function(){jfgrid.jfgridrefreshgrid()},1),jfgrid.sheetmanage.storeSheetParamALL(),jfgrid.jfrefreshchartall(jfgrid.flowdata,0,jfgrid.flowdata.length-1,0,jfgrid.flowdata[0].length-1),jfgrid.server.saveParam("all",e.sheetIndex,e.curConfig,{k:"config"}),jfgrid.server.saveParam("all",r.sheetIndex,r.curConfig,{k:"config"}),jfgrid.server.historyParam(e.curData,e.sheetIndex,{row:e.range.row,column:e.range.column}),jfgrid.server.historyParam(r.curData,r.sheetIndex,{row:r.range.row,column:r.range.column}),jfgridConfigsetting.pointEdit&&jfgrid.pointEdit_updateData()},jfgrid.jfgridcreatesheet=function(e,r,t,i,a){null==a&&(a=!0),visibledatarow=[],visibledatacolumn=[],rowsplit=[],colsplit=[],config=null!=i?i:{},(rh_height=ch_width=0)==t.length?jfgrid.flowdata=jfgrid.datagridgrowth(t,r,e):t.length<r&&t[0].length<e?jfgrid.flowdata=jfgrid.datagridgrowth(t,r-t.length,e-t[0].length):t.length<r?jfgrid.flowdata=jfgrid.datagridgrowth(t,r-t.length,0):t[0].length<e?jfgrid.flowdata=jfgrid.datagridgrowth(t,0,e-t[0].length):jfgrid.flowdata=t,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata);for(var n=0;n<e;n++){var o=defaultcollen;null!=config.columlen&&null!=config.columlen[n]?o=config.columlen[n]:null!=t[0]&&null!=t[0][n]&&(300<(o=Math.ceil(11.5*jfgrid.getByteLen(t[0][n])))?o=300:o<defaultcollen&&(o=defaultcollen),o!=defaultcollen&&(null==config.columlen&&(config.columlen={}),config.columlen[n]=o)),ch_width+=o+1,visibledatacolumn.push(ch_width)}for(n=0;n<r;n++){var l=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[n]&&(l=config.rowlen[n]),null==config.rowhidden||null==config.rowhidden[n]?(rh_height+=l+1,visibledatarow.push(rh_height)):(l=config.rowhidden[n],visibledatarow.push(rh_height))}rh_height+=110,ch_width+=120,a&&(jfgrid.sheetmanage.showSheet(),setTimeout(function(){jfgrid.sheetmanage.restoreCache(),jfgrid.formula.execFunctionGroup(),jfgrid.sheetmanage.restoreSheetAll(jfgrid.currentSheetIndex),jfgrid.jfgridrefreshgrid()},1))},jfgrid.jfgridrefreshgrid=function(e,r){var t,i,a,n,o,l;jfgrid.formula.groupValuesRefresh(),null==e&&(e=$("#jfgrid-cell-main").scrollLeft()),null==r&&(r=$("#jfgrid-cell-main").scrollTop()),null!=jfgrid.freezen.freezenverticaldata||null!=jfgrid.freezen.freezenhorizontaldata?(o=jfgridTableContentHW[0],l=jfgridTableContentHW[1],null!=jfgrid.freezen.freezenverticaldata&&null!=jfgrid.freezen.freezenhorizontaldata?(t=jfgrid.freezen.freezenhorizontaldata[0],jfgrid.freezen.freezenhorizontaldata[1],i=jfgrid.freezen.freezenhorizontaldata[2],a=jfgrid.freezen.freezenverticaldata[0],jfgrid.freezen.freezenverticaldata[1],jfgridDrawMain(n=jfgrid.freezen.freezenverticaldata[2],i,a,t,1,1,null,null,"freezen_3"),jfgridDrawMain(e+a-n,i,o-a+n,t,1,1,null,null,"freezen_4"),jfgridDrawMain(n,r+t-i,a,l-t+i,1,1,null,null,"freezen_7"),jfgridDrawMain(e+a-n,r+t-i,o-a+n,l-t+i,a-n+rowHeaderWidth,t-i+columeHeaderHeight),jfgridDrawgridColumnTitle(e+a-n,o-a+n,a-n+rowHeaderWidth),jfgridDrawgridColumnTitle(n,a,rowHeaderWidth),jfgridDrawgridRowTitle(r+t-i,l-t+i,t-i+columeHeaderHeight),jfgridDrawgridRowTitle(i,t,columeHeaderHeight)):null!=jfgrid.freezen.freezenhorizontaldata?(t=jfgrid.freezen.freezenhorizontaldata[0],jfgrid.freezen.freezenhorizontaldata[1],jfgridDrawMain(e,i=jfgrid.freezen.freezenhorizontaldata[2],o,t,1,1,null,null,"freezen_h"),jfgridDrawMain(e,r+t-i,o,l-t+i,null,t-i+columeHeaderHeight),jfgridDrawgridColumnTitle(e,o,null),jfgridDrawgridRowTitle(r+t-i,l-t+i,t-i+columeHeaderHeight),jfgridDrawgridRowTitle(i,t,columeHeaderHeight)):null!=jfgrid.freezen.freezenverticaldata&&(a=jfgrid.freezen.freezenverticaldata[0],jfgrid.freezen.freezenverticaldata[1],jfgridDrawMain(n=jfgrid.freezen.freezenverticaldata[2],r,a,l,1,1,null,null,"freezen_v"),jfgridDrawMain(e+a-n,r,o-a+n,l,a-n+rowHeaderWidth,null),jfgridDrawgridRowTitle(r,l,null),jfgridDrawgridColumnTitle(e+a-n,o-a+n,a-n+rowHeaderWidth),jfgridDrawgridColumnTitle(n,a,rowHeaderWidth))):jfgridDrawgrid(e,r)},jfgrid.jfgridDrawMain=jfgridDrawMain,jfgrid.jfgridcreatedom=function(e,r,t,i,a){jfgridConfigsetting.pointEdit||(r<30&&(r=30),e<22&&(e=22));var n=gridHTML,n=jfgrid.replaceHtml(n,{logotitle:a});n=jfgrid.replaceHtml(n,{menu:menuToolBar}),0==t.length?jfgrid.flowdata=jfgrid.datagridgrowth(t,r,e):t.length<r&&t[0].length<e?jfgrid.flowdata=jfgrid.datagridgrowth(t,r-t.length,e-t[0].length):t.length<r?jfgrid.flowdata=jfgrid.datagridgrowth(t,r-t.length,0):t[0].length<e?jfgrid.flowdata=jfgrid.datagridgrowth(t,0,e-t[0].length):jfgrid.flowdata=t,jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata);var o=flow;null==config&&(config={}),visibledatacolumn=[];for(var l=ch_width=0;l<e;l++){var d=defaultcollen;null!=config.columlen&&null!=config.columlen[l]?d=config.columlen[l]:null!=t[0]&&null!=t[0][l]&&(300<(d=Math.ceil(11.5*jfgrid.getByteLen(t[0][l].v)))?d=300:d<defaultcollen&&(d=defaultcollen),d!=defaultcollen&&(null==config.columlen&&(config.columlen={}),config.columlen[l]=d)),ch_width+=d+1,visibledatacolumn.push(ch_width)}visibledatarow=[];for(var f,s,g,c,l=rh_height=0;l<r;l++){var u=defaultrowlen;null!=config.rowlen&&null!=config.rowlen[l]&&(u=config.rowlen[l]),null==config.rowhidden||null==config.rowhidden[l]?(rh_height+=u+1,visibledatarow.push(rh_height)):(u=config.rowhidden[l],visibledatarow.push(rh_height))}jfgridConfigsetting.pointEdit||(rh_height+=110,ch_width+=120,f=' <span id="jfgrid-bottom-page-info" style="font-size: 14px;color: #f34141;">共'+jfgridConfigsetting.total+"条，"+jfgridConfigsetting.pageInfo.totalPage+"页，当前已显示"+jfgridConfigsetting.pageInfo.currentPage+'页</span> <button id="jfgrid-bottom-page-next" class="btn btn-danger" style="">下一页</button>',s=' <span id="jfgrid-bottom-page-info" style="font-size: 14px;color: #f34141;">共'+jfgridConfigsetting.total+"条，"+jfgridConfigsetting.pageInfo.totalPage+"页，当前已显示"+jfgridConfigsetting.pageInfo.currentPage+"页</span>",g="",jfgridConfigsetting.enableAddRow&&(g+='<button id="jfgrid-bottom-add-row" class="btn btn-default">添加</button><input id="jfgrid-bottom-add-row-input" type="text" class="jfgrid-datavisual-config-input jfgrid-mousedown-cancel" placeholder="100"><span style="font-size: 14px;">行</span><span style="font-size: 14px;color: #9c9c9c;">(在底部添加)</span>'),jfgridConfigsetting.enablePage&&(1==parseInt(jfgridConfigsetting.pageInfo.totalPage)?g+=s:g+=f),g+=' <button id="jfgrid-bottom-bottom-top" class="btn btn-default" style="">回到顶部</button>',c=jfgrid.replaceHtml('<div id="jfgridcoltable_0" class="jfgrid-cell-flow-col"> <div id ="jfgrid-sheettable_0" class="jfgrid-cell-sheettable" style="height:${height}px;width:${width}px;"></div><div id="jfgrid-bottom-controll-row" class="jfgrid-bottom-controll-row"> '+g+" </div> </div>",{height:rh_height,width:ch_width-1}));var m=jfgrid.replaceHtml(columnHeaderHTML,{width:ch_width,index:0,column:""}),o=jfgrid.replaceHtml(o,{width:ch_width,flow:c,index:0});n=jfgrid.replaceHtml(n,{flow:o,rowHeader:"<div style='height:"+rh_height+"px' id='jfgridrowHeader_0' class='jfgridsheetchange'></div>",columnHeader:m,functionButton:jfgridConfigsetting.functionButton}),$("#"+container).append(n),$("#jfgrid-scrollbar-x div").width(ch_width),$("#jfgrid-scrollbar-y div").height(rh_height-30),$("body").append(maskHTML),$("body").append(colsmenuHTML),$("body").append(rightclickHTML),$("body").append(inputHTML),$("body").append(jfgrid.replaceHtml(filtermenuHTML,{menuid:"filter"})),$("body").append(jfgrid.replaceHtml(filtersubmenuHTML,{menuid:"filter"})),$("body").append(sheetconfigHTML),jfgrid.postil.buildAllPs(jfgrid.flowdata)},function(){function e(){function e(){this.init.apply(this,arguments)}var r;return 1<arguments.length?(arguments[0]?(e.prototype=$.extend(new arguments[0],arguments[arguments.length-1]),e._super=arguments[0].prototype):e.prototype=arguments[arguments.length-1],2<arguments.length&&((r=Array.prototype.slice.call(arguments,1,-1)).unshift(e.prototype),$.extend.apply($,r))):e.prototype=arguments[0],e.prototype.cls=e}var t=e({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(e,r){this.format=e,this.fclass=r},render:function(e,r,t){var i,a,n,o,l,d=this,f=e;return this.format.replace(this.fre,function(){return a=arguments[1],n=arguments[3],(i=d.precre.exec(a))?(l=i[2],a=i[1]):l=!1,void 0===(o=f[a])?"":n&&r&&r[n]?r[n].get?r[n].get(o)||o:r[n][o]||o:(s(o)&&(o=t.get("numberFormatter")?t.get("numberFormatter")(o):g(o,l,t.get("numberDigitGroupCount"),t.get("numberDigitGroupSep"),t.get("numberDecimalMark"))),o)})}});$.spformat=function(e,r){return new t(e,r)};function M(e,r,t){return e<r?r:t<e?t:e}function y(e,r){var t;return 2===r?(t=Math.floor(e.length/2),e.length%2?e[t]:(e[t-1]+e[t])/2):e.length%2?(t=(e.length*r+r)/4)%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1]:(t=(e.length*r+2)/4)%1?(e[Math.floor(t)]+e[Math.floor(t)-1])/2:e[t-1]}function E(e){var r;switch(e){case"undefined":e=void 0;break;case"null":e=null;break;case"true":e=!0;break;case"false":e=!1;break;default:e==(r=parseFloat(e))&&(e=r)}return e}function O(e){for(var r=[],t=e.length;t--;)r[t]=E(e[t]);return r}function x(e,r,t){for(var i=r.length;i--;)if((!t||null!==r[i])&&r[i]!==e)return!1;return!0}function z(e,r){for(var t=[],i=0,a=e.length;i<a;i++)e[i]!==r&&t.push(e[i]);return t}var s=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},g=function(e,r,t,i,a){var n,o;for(e=(!1===r?parseFloat(e).toString():e.toFixed(r)).split(""),(n=(n=$.inArray(".",e))<0?e.length:n)<e.length&&(e[n]=a),o=n-t;0<o;o-=t)e.splice(o,0,i);return e.join("")},D=e({init:function(e){var r,t,i=[];for(r in e)e.hasOwnProperty(r)&&"string"==typeof r&&-1<r.indexOf(":")&&((t=r.split(":"))[0]=0===t[0].length?-1/0:parseFloat(t[0]),t[1]=0===t[1].length?1/0:parseFloat(t[1]),t[2]=e[r],i.push(t));this.map=e,this.rangelist=i||!1},get:function(e){var r,t,i,a=this.rangelist;if(void 0!==(i=this.map[e]))return i;if(a)for(r=a.length;r--;)if((t=a[r])[0]<=e&&t[1]>=e)return t[2]}});$.range_map=function(e){return new D(e)},jfgrid.sparkline={defaultOption:{common:{type:"line",lineColor:"#2ec7c9",fillColor:"#CCF3F4",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!0,disableInteraction:!0,offsetX:0,offsetY:0},line:{spotColor:0,highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:0,maxSpotColor:0,lineWidth:1,normalRangeMin:void 0,normalRangeMax:void 0,normalRangeColor:"#ccc",drawNormalOnTop:!0,chartRangeMin:void 0,chartRangeMax:void 0,chartRangeMinX:void 0,chartRangeMaxX:void 0},bar:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},column:{barColor:"#fc5c5c",negBarColor:"#97b552",stackedBarColor:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],zeroColor:void 0,nullColor:void 0,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1,colorMap:void 0},tristate:{barWidth:4,barSpacing:1,posBarColor:"#fc5c5c",negBarColor:"#97b552",zeroBarColor:"#999",colorMap:{}},discrete:{lineHeight:"auto",thresholdColor:"#fc5c5c",thresholdValue:0,chartRangeMax:void 0,chartRangeMin:void 0,chartRangeClip:!1},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff","#6D87FF","#5876FF","#4465FF","#2F54FF","#1A43FF","#0532FF"],base:void 0},pie:{offset:0,sliceColors:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],borderWidth:0,borderColor:"#000"},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#5E5E5E",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:void 0,targetColor:"#4a2",chartRangeMax:void 0,chartRangeMin:void 0}},line:{type:"line",init:function(e,r,t,i,a){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null},getRegion:function(e,r,t){for(var i=this.regionMap,a=i.length;a--;)if(null!==i[a]&&r>=i[a][0]&&r<=i[a][1])return i[a][2]},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:null===this.yvalues[e],x:this.xvalues[e],y:this.yvalues[e],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:e}},renderHighlight:function(){var e,r,t=this.currentRegion,i=this.target,a=this.vertices[t],n=this.options,o=n.get("spotRadius"),l=n.get("highlightSpotColor"),d=n.get("highlightLineColor");a&&(o&&l&&(e=i.drawCircle(a[0],a[1],o,void 0,l),this.highlightSpotId=e.id,i.insertAfterShape(this.lastShapeId,e)),d&&(r=i.drawLine(a[0],this.canvasTop,a[0],this.canvasTop+this.canvasHeight,d),this.highlightLineId=r.id,i.insertAfterShape(this.lastShapeId,r)))},removeHighlight:function(){var e=this.target;this.highlightSpotId&&(e.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(e.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){for(var e,r,t,i,a=this.values,n=a.length,o=this.xvalues,l=this.yvalues,d=this.yminmax,f=0;f<n;f++)e=a[f],r="string"==typeof a[f],t="object"==typeof a[f]&&a[f]instanceof Array,i=r&&a[f].split(":"),r&&2===i.length?(o.push(Number(i[0])),l.push(Number(i[1])),d.push(Number(i[1]))):t?(o.push(e[0]),l.push(e[1]),d.push(e[1])):(o.push(f),null===a[f]||"null"===a[f]?l.push(null):(l.push(Number(e)),d.push(Number(e))));this.options.get("xvalues")&&(o=this.options.get("xvalues")),this.maxy=this.maxyorg=Math.max.apply(Math,d),this.miny=this.minyorg=Math.min.apply(Math,d),this.maxx=Math.max.apply(Math,o),this.minx=Math.min.apply(Math,o),this.xvalues=o,this.yvalues=l,this.yminmax=d},processRangeOptions:function(){var e=this.options,r=e.get("normalRangeMin"),t=e.get("normalRangeMax");void 0!==r&&(r<this.miny&&(this.miny=r),t>this.maxy&&(this.maxy=t)),void 0!==e.get("chartRangeMin")&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.miny)&&(this.miny=e.get("chartRangeMin")),void 0!==e.get("chartRangeMax")&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.maxy)&&(this.maxy=e.get("chartRangeMax")),void 0!==e.get("chartRangeMinX")&&(e.get("chartRangeClipX")||e.get("chartRangeMinX")<this.minx)&&(this.minx=e.get("chartRangeMinX")),void 0!==e.get("chartRangeMaxX")&&(e.get("chartRangeClipX")||e.get("chartRangeMaxX")>this.maxx)&&(this.maxx=e.get("chartRangeMaxX"))},drawNormalRange:function(e,r,t,i,a){var n=this.options.get("normalRangeMin"),o=this.options.get("normalRangeMax"),l=r+Math.round(t-t*((o-this.miny)/a)),d=Math.round(t*(o-n)/a);0==d&&n==o&&(d=1),this.target.drawRect(e,l,i,d,void 0,this.options.get("normalRangeColor")).append()},render:function(e,r){this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.values=r;var t,i,a,n,o,l,d,f,s,g,c,u,m,h,j,p,v,b,_,w,y,x,C,T,I=this.options,R=this.target,k=e.mergedOptions.width,S=e.mergedOptions.height,A=this.vertices,F=I.get("spotRadius"),N=this.regionMap;if(this.scanValues(),this.processRangeOptions(),x=this.xvalues,C=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2)){for(n=o=0,t=this.maxx-this.minx==0?1:this.maxx-this.minx,i=this.maxy-this.miny==0?1:this.maxy-this.miny,a=this.yvalues.length-1,F&&(k<4*F||S<4*F)&&(F=0),F&&(((w=I.get("highlightSpotColor")&&!I.get("disableInteraction"))||I.get("minSpotColor")||I.get("spotColor")&&C[a]===this.miny)&&(S-=Math.ceil(F)),(w||I.get("maxSpotColor")||I.get("spotColor")&&C[a]===this.maxy)&&(S-=Math.ceil(F),n+=Math.ceil(F)),!w&&(!I.get("minSpotColor")&&!I.get("maxSpotColor")||C[0]!==this.miny&&C[0]!==this.maxy)||(o+=Math.ceil(F),k-=Math.ceil(F)),(w||I.get("spotColor")||I.get("minSpotColor")||I.get("maxSpotColor")&&(C[a]===this.miny||C[a]===this.maxy))&&(k-=Math.ceil(F))),S--,void 0===I.get("normalRangeMin")||I.get("drawNormalOnTop")||this.drawNormalRange(o,n,S,k,i),f=[d=[]],m=h=null,j=C.length,T=0;T<j;T++)s=x[T],c=x[T+1],g=C[T],h=(u=o+Math.round((s-this.minx)*(k/t)))+((T<j-1?o+Math.round((c-this.minx)*(k/t)):k)-u)/2,N[T]=[m||0,h,T],m=h,null===g?T&&(null!==C[T-1]&&(d=[],f.push(d)),A.push(null)):(g<this.miny&&(g=this.miny),g>this.maxy&&(g=this.maxy),d.length||d.push([u,n+S]),l=[u,n+Math.round(S-S*((g-this.miny)/i))],d.push(l),A.push(l));for(p=[],v=[],b=f.length,T=0;T<b;T++)(d=f[T]).length&&(I.get("fillColor")&&(d.push([d[d.length-1][0],n+S]),v.push(d.slice(0)),d.pop()),2<d.length&&(d[0]=[d[0][0],d[1][1]]),p.push(d));for(b=v.length,T=0;T<b;T++)R.drawShape(v[T],I.get("fillColor"),I.get("fillColor")).append();for(b=p.length,T=0;T<b;T++)R.drawShape(p[T],I.get("lineColor"),void 0,I.get("lineWidth")).append();if(void 0!==I.get("normalRangeMin")&&I.get("drawNormalOnTop")&&this.drawNormalRange(o,n,S,k,i),F&&I.get("valueSpots"))for(void 0===(_=I.get("valueSpots")).get&&(_=new D(_)),T=0;T<j;T++)(y=_.get(C[T]))&&R.drawCircle(o+Math.round((x[T]-this.minx)*(k/t)),n+Math.round(S-S*((C[T]-this.miny)/i)),F,void 0,y).append();F&&I.get("spotColor")&&null!==C[a]&&R.drawCircle(o+Math.round((x[x.length-1]-this.minx)*(k/t)),n+Math.round(S-S*((C[a]-this.miny)/i)),F,void 0,I.get("spotColor")).append(),this.maxy!==this.minyorg&&(F&&I.get("minSpotColor")&&(s=x[$.inArray(this.minyorg,C)],R.drawCircle(o+Math.round((s-this.minx)*(k/t)),n+Math.round(S-S*((this.minyorg-this.miny)/i)),F,void 0,I.get("minSpotColor")).append()),F&&I.get("maxSpotColor")&&(s=x[$.inArray(this.maxyorg,C)],R.drawCircle(o+Math.round((s-this.minx)*(k/t)),n+Math.round(S-S*((this.maxyorg-this.miny)/i)),F,void 0,I.get("maxSpotColor")).append()))}}},bar:{type:"bar",init:function(e,r){var t=this.options,i=e.mergedOptions.height;e.mergedOptions.width;this.canvasWidth=e.mergedOptions.height,this.canvasHeight=e.mergedOptions.width;parseInt(t.get("barWidth"),10);var a,n,o,l,d,f,s,g,c,u,m,h,j,p,v,b,_,w,y,x=parseInt(t.get("barSpacing"),10),C=t.get("chartRangeMin"),T=t.get("chartRangeMax"),I=t.get("chartRangeClip"),R=1/0,k=-1/0;for(F=0,N=(this.values=r).length;F<N;F++)((a="string"==typeof(w=r[F])&&-1<w.indexOf(":"))||$.isArray(w))&&(j=!0,a&&(w=r[F]=O(w.split(":"))),w=z(w,null),(n=Math.min.apply(Math,w))<R&&(R=n),k<(o=Math.max.apply(Math,w))&&(k=o));this.stacked=j,this.regionShapes={},this.barWidth=Math.floor(i/r.length)-x,this.barSpacing=x,this.totalBarWidth=this.barWidth+x,this.width=i,I&&(m=void 0===C?-1/0:C,h=void 0===T?1/0:T),d=[],l=j?[]:d;for(var S=[],A=[],F=0,N=r.length;F<N;F++)if(j)for(p=r[F],r[F]=_=[],S[F]=0,l[F]=A[F]=0,v=0,b=p.length;v<b;v++)null!==(w=_[v]=I?M(p[v],m,h):p[v])&&(0<w&&(S[F]+=w),R<0&&0<k?w<0?A[F]+=Math.abs(w):l[F]+=w:l[F]+=Math.abs(w),d.push(w));else w=I?M(r[F],m,h):r[F],null!==(w=r[F]=E(w))&&d.push(w);this.max=u=Math.max.apply(Math,d),this.min=c=Math.min.apply(Math,d),this.stackMax=k=j?Math.max.apply(Math,S):u,this.stackMin=R=j?Math.min.apply(Math,d):c,void 0!==t.get("chartRangeMin")&&(t.get("chartRangeClip")||t.get("chartRangeMin")<c)&&(c=t.get("chartRangeMin")),void 0!==t.get("chartRangeMax")&&(t.get("chartRangeClip")||t.get("chartRangeMax")>u)&&(u=t.get("chartRangeMax")),this.zeroAxis=s=t.get("zeroAxis",!0),g=c<=0&&0<=u&&s?0:0==s?c:0<c?0:u,this.xaxisOffset=g,f=j?Math.max.apply(Math,l)+Math.max.apply(Math,A):u-g,this.canvasHeightEf=s&&c<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,c<g?(y=Math.floor(this.canvasHeight/2),this.isNeg=!0,y!==Math.ceil(y)&&(this.canvasHeightEf-=2,y=Math.ceil(y))):y=0,this.yoffset=y,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new D(this.colorMapByValue))),this.range=f},getRegion:function(e,r,t){var i=Math.floor(r/this.totalBarWidth);return i<0||i>=this.values.length?void 0:i},getCurrentRegionFields:function(){for(var e,r=this.currentRegion,t=ensureArray(this.values[r]),i=[],a=t.length;a--;)e=t[a],i.push({isNull:null===e,value:e,color:this.calcColor(a,e,r),offset:r});return i},calcColor:function(e,r,t){var i,a=this.colorMapByIndex,n=this.colorMapByValue,o=this.options,l=this.stacked?o.get("stackedBarColor"):r<0?o.get("negBarColor"):o.get("barColor");return 0===r&&void 0!==o.get("zeroColor")&&(l=o.get("zeroColor")),n&&(i=n.get(r))?l=i:a&&a.length>t&&(l=a[t]),$.isArray(l)?l[e%l.length]:l},renderRegion:function(e,r){var t,i,a,n,o,l,d=this.values[e],f=this.options,s=this.xaxisOffset,g=[],c=this.range,u=this.stacked,m=this.target,h=e*this.totalBarWidth,j=this.canvasHeightEf,p=this.yoffset,v=(d=$.isArray(d)?d:[d]).length,b=d[0],_=x(null,d),w=x(s,d,!0);if(_)return f.get("nullColor")?(a=r?f.get("nullColor"):this.calcHighlightColor(f.get("nullColor"),f),t=0<p?p-1:p,m.drawRect(t,h,0,this.barWidth-1,a,a)):void 0;for(n=p,this.isNeg&&(j=Math.floor(j/2)),o=0;o<v;o++){if(b=d[o],u&&b===s){if(!w||l)continue;l=!0}i=0<c?Math.floor(j*(Math.abs(b-s)/c)):j,b<s||b===s&&0===p?(t=n-i,n+=i):u?(t=p,p+=i):(t=p,p-=i),a=this.calcColor(o,b,e),r&&(a=this.calcHighlightColor(a,f)),g.push(m.drawRect(t,h,i-1,this.barWidth-1,a,a))}return 1===g.length?g[0]:g}},column:{type:"column",init:function(e,r){var t=this.options,i=e.mergedOptions.width;e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;parseInt(t.get("barWidth"),10);var a,n,o,l,d,f,s,g,c,u,m,h,j,p,v,b,_,w,y,x=parseInt(t.get("barSpacing"),10),C=t.get("chartRangeMin"),T=t.get("chartRangeMax"),I=t.get("chartRangeClip"),R=1/0,k=-1/0;for(F=0,N=(this.values=r).length;F<N;F++)((a="string"==typeof(w=r[F])&&-1<w.indexOf(":"))||$.isArray(w))&&(j=!0,a&&(w=r[F]=O(w.split(":"))),w=z(w,null),(n=Math.min.apply(Math,w))<R&&(R=n),k<(o=Math.max.apply(Math,w))&&(k=o));this.stacked=j,this.regionShapes={},this.barWidth=Math.floor(i/r.length)-x,this.barSpacing=x,this.totalBarWidth=this.barWidth+x,this.width=i,I&&(m=void 0===C?-1/0:C,h=void 0===T?1/0:T),d=[],l=j?[]:d;for(var S=[],A=[],F=0,N=r.length;F<N;F++)if(j)for(p=r[F],r[F]=_=[],S[F]=0,l[F]=A[F]=0,v=0,b=p.length;v<b;v++)null!==(w=_[v]=I?M(p[v],m,h):p[v])&&(0<w&&(S[F]+=w),R<0&&0<k?w<0?A[F]+=Math.abs(w):l[F]+=w:l[F]+=Math.abs(w),d.push(w));else w=I?M(r[F],m,h):r[F],null!==(w=r[F]=E(w))&&d.push(w);this.max=u=Math.max.apply(Math,d),this.min=c=Math.min.apply(Math,d),this.stackMax=k=j?Math.max.apply(Math,S):u,this.stackMin=R=j?Math.min.apply(Math,d):c,void 0!==t.get("chartRangeMin")&&(t.get("chartRangeClip")||t.get("chartRangeMin")<c)&&(c=t.get("chartRangeMin")),void 0!==t.get("chartRangeMax")&&(t.get("chartRangeClip")||t.get("chartRangeMax")>u)&&(u=t.get("chartRangeMax")),this.zeroAxis=s=t.get("zeroAxis",!0),g=c<=0&&0<=u&&s?0:0==s?c:0<c?0:u,this.xaxisOffset=g,f=j?Math.max.apply(Math,l)+Math.max.apply(Math,A):u-g,this.canvasHeightEf=s&&c<0?this.canvasHeight-2:this.canvasHeight-1,this.isNeg=!1,c<g?(y=Math.floor(this.canvasHeight/2),this.isNeg=!0,y!==Math.ceil(y)&&(this.canvasHeightEf-=2,y=Math.ceil(y))):y=this.canvasHeight,this.yoffset=y,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new D(this.colorMapByValue))),this.range=f},getRegion:function(e,r,t){var i=Math.floor(r/this.totalBarWidth);return i<0||i>=this.values.length?void 0:i},getCurrentRegionFields:function(){for(var e,r=this.currentRegion,t=ensureArray(this.values[r]),i=[],a=t.length;a--;)e=t[a],i.push({isNull:null===e,value:e,color:this.calcColor(a,e,r),offset:r});return i},calcColor:function(e,r,t){var i,a=this.colorMapByIndex,n=this.colorMapByValue,o=this.options,l=this.stacked?o.get("stackedBarColor"):r<0?o.get("negBarColor"):o.get("barColor");return 0===r&&void 0!==o.get("zeroColor")&&(l=o.get("zeroColor")),n&&(i=n.get(r))?l=i:a&&a.length>t&&(l=a[t]),$.isArray(l)?l[e%l.length]:l},renderRegion:function(e,r){var t,i,a,n,o,l,d=this.values[e],f=this.options,s=this.xaxisOffset,g=[],c=this.range,u=this.stacked,m=this.target,h=e*this.totalBarWidth,j=this.canvasHeightEf,p=this.yoffset,v=(d=$.isArray(d)?d:[d]).length,b=d[0],_=x(null,d),w=x(s,d,!0);if(_)return f.get("nullColor")?(a=r?f.get("nullColor"):this.calcHighlightColor(f.get("nullColor"),f),t=0<p?p-1:p,m.drawRect(h,t,this.barWidth-1,0,a,a)):void 0;for(n=p,this.isNeg&&(j=Math.floor(j/2)),o=0;o<v;o++){if(b=d[o],u&&b===s){if(!w||l)continue;l=!0}i=0<c?Math.floor(j*(Math.abs(b-s)/c)):j,b<s||b===s&&0===p?(t=n,n+=i):(t=p-i,p-=i),a=this.calcColor(o,b,e),r&&(a=this.calcHighlightColor(a,f)),g.push(m.drawRect(h,t,this.barWidth-1,i-1,a,a))}return 1===g.length?g[0]:g}},tristate:{type:"tristate",init:function(e,r){var t=this.options;e.mergedOptions.width,e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;var i=parseInt(t.get("barWidth"),10),a=parseInt(t.get("barSpacing"),10);this.regionShapes={},this.barWidth=i,this.barSpacing=a,this.totalBarWidth=i+a,this.values=$.map(r,Number),this.width=r.length*i+(r.length-1)*a,$.isArray(t.get("colorMap"))?(this.colorMapByIndex=t.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=t.get("colorMap"),this.colorMapByValue&&void 0===this.colorMapByValue.get&&(this.colorMapByValue=new D(this.colorMapByValue)))},getRegion:function(e,r,t){return Math.floor(r/this.totalBarWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],color:this.calcColor(this.values[e],e),offset:e}},calcColor:function(e,r){var t,i=this.values,a=this.options,n=this.colorMapByIndex,o=this.colorMapByValue,l=o&&(t=o.get(e))?t:n&&n.length>r?n[r]:i[r]<0?a.get("negBarColor"):0<i[r]?a.get("posBarColor"):a.get("zeroBarColor");return l},renderRegion:function(e,r){var t,i=this.values,a=this.options,n=this.target,o=this.canvasHeight,l=Math.round(o/2),d=e*this.totalBarWidth,f=i[e]<0?(t=l)-1:0<i[e]?(t=0,l-1):(t=l-1,2),s=this.calcColor(i[e],e);if(null!==s)return r&&(s=this.calcHighlightColor(s,a)),n.drawRect(d,t,this.barWidth-1,f-1,s,s)}},discrete:{type:"discrete",init:function(e,r){var t=this.options,i=e.mergedOptions.width;e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.regionShapes={},this.values=r=$.map(r,Number),this.min=Math.min.apply(Math,r),this.max=Math.max.apply(Math,r),this.range=this.max-this.min,this.width=i,this.interval=Math.floor(i/r.length),this.itemWidth=i/r.length,void 0!==t.get("chartRangeMin")&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.min)&&(this.min=t.get("chartRangeMin")),void 0!==t.get("chartRangeMax")&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.max)&&(this.max=t.get("chartRangeMax")),this.target&&(this.lineHeight="auto"===t.get("lineHeight")?Math.round(.3*this.canvasHeight):t.get("lineHeight"))},getRegion:function(e,r,t){return Math.floor(r/this.itemWidth)},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],offset:e}},renderRegion:function(e,r){var t=this.values,i=this.options,a=this.min,n=this.max,o=this.range,l=this.interval,d=(this.target,this.canvasHeight),f=this.lineHeight,s=d-f,g=M(t[e],a,n),c=e*l,u=Math.round(s-(g-a)/o*s),m=i.get("thresholdColor")&&g<i.get("thresholdValue")?i.get("thresholdColor"):i.get("lineColor");return r&&(m=this.calcHighlightColor(m,i)),this.target.drawRect(c,u,l<=2?1:l-2,f,m,m)}},bullet:{type:"bullet",init:function(e,r){var t,i,a,n=this.options,o=e.mergedOptions.width;e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=r=O(r),(a=r.slice())[0]=null===a[0]?a[2]:a[0],a[1]=null===r[1]?a[2]:a[1],t=Math.min.apply(Math,r),i=Math.max.apply(Math,r),t=void 0===n.get("base")?t<0?t:0:n.get("base"),this.min=t,this.max=i,this.range=i-t,this.shapes={},this.valueShapes={},this.regiondata={},this.width=o,r.length||(this.disabled=!0)},getRegion:function(e,r,t){var i=this.target.getShapeAt(e,r,t);return void 0!==i&&void 0!==this.shapes[i]?this.shapes[i]:void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{fieldkey:e.substr(0,1),value:this.values[e.substr(1)],region:e}},changeHighlight:function(e){var r,t=this.currentRegion,i=this.valueShapes[t];switch(delete this.shapes[i],t.substr(0,1)){case"r":r=this.renderRange(t.substr(1),e);break;case"p":r=this.renderPerformance(e);break;case"t":r=this.renderTarget(e)}this.valueShapes[t]=r.id,this.shapes[r.id]=t,this.target.replaceWithShape(i,r)},renderRange:function(e,r){var t=this.values[e],i=Math.round(this.canvasWidth*((t-this.min)/this.range)),a=this.options.get("rangeColors")[e-2];return r&&(a=this.calcHighlightColor(a,this.options)),this.target.drawRect(0,0,i-1,this.canvasHeight-1,a,a)},renderPerformance:function(e){var r=this.values[1],t=Math.round(this.canvasWidth*((r-this.min)/this.range)),i=this.options.get("performanceColor");return e&&(i=this.calcHighlightColor(i,this.options)),this.target.drawRect(0,Math.round(.3*this.canvasHeight),t-1,Math.round(.4*this.canvasHeight)-1,i,i)},renderTarget:function(e){var r=this.values[0],t=Math.round(this.canvasWidth*((r-this.min)/this.range)-this.options.get("targetWidth")/2),i=Math.round(.1*this.canvasHeight),a=this.canvasHeight-2*i,n=this.options.get("targetColor");return e&&(n=this.calcHighlightColor(n,this.options)),this.target.drawRect(t,i,this.options.get("targetWidth")-1,a-1,n,n)},render:function(e,r){this.init(e,r);for(var t,i=this.values.length,a=(this.target,2);a<i;a++)t=this.renderRange(a).append(),this.shapes[t.id]="r"+a,this.valueShapes["r"+a]=t.id;null!==this.values[1]&&(t=this.renderPerformance().append(),this.shapes[t.id]="p1",this.valueShapes.p1=t.id),null!==this.values[0]&&(t=this.renderTarget().append(),this.shapes[t.id]="t0",this.valueShapes.t0=t.id)}},pie:{type:"pie",init:function(e,r){var t=this.options;e.mergedOptions.width,e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height;var i,a=0;if(this.shapes={},this.valueShapes={},this.values=r=$.map(r,Number),"auto"===t.get("width")&&(this.width=this.height),0<r.length)for(i=r.length;i--;)a+=r[i];this.total=a,this.radius=Math.floor(Math.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(e,r,t){var i=this.target.getShapeAt(e,r,t);return void 0!==i&&void 0!==this.shapes[i]?this.shapes[i]:void 0},getCurrentRegionFields:function(){var e=this.currentRegion;return{isNull:void 0===this.values[e],value:this.values[e],percent:this.values[e]/this.total*100,color:this.options.get("sliceColors")[e%this.options.get("sliceColors").length],offset:e}},changeHighlight:function(e){var r=this.currentRegion,t=this.renderSlice(r,e),i=this.valueShapes[r];delete this.shapes[i],this.target.replaceWithShape(i,t),this.valueShapes[r]=t.id,this.shapes[t.id]=r},renderSlice:function(e,r){for(var t,i,a,n=this.target,o=this.options,l=this.radius,d=o.get("borderWidth"),f=o.get("offset"),s=2*Math.PI,g=this.values,c=this.total,u=f?2*Math.PI*(f/360):0,m=g.length,h=0;h<m;h++){if(i=t=u,0<c&&(i=u+s*(g[h]/c)),e===h)return a=o.get("sliceColors")[h%o.get("sliceColors").length],r&&(a=this.calcHighlightColor(a,o)),n.drawPieSlice(l,l,l-d,t,i,void 0,a);u=i}},render:function(e,r){this.init(e,r);var t,i,a=this.target,n=this.values,o=this.options,l=this.radius,d=o.get("borderWidth");for(d&&a.drawCircle(l,l,Math.floor(l-d/2),o.get("borderColor"),void 0,d).append(),i=n.length;i--;)n[i]&&(t=this.renderSlice(i).append(),this.valueShapes[i]=t.id,this.shapes[t.id]=i)}},box:{type:"box",init:function(e,r){var t=this.options,i=e.mergedOptions.width;e.mergedOptions.height;this.canvasWidth=e.mergedOptions.width,this.canvasHeight=e.mergedOptions.height,this.values=$.map(r,Number),this.width="auto"===t.get("width")?"4.0em":i,this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var e=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return void 0!==this.loutlier&&e.push({field:"lo",value:this.loutlier}),void 0!==this.routlier&&e.push({field:"ro",value:this.routlier}),void 0!==this.lwhisker&&e.push({field:"lw",value:this.lwhisker}),void 0!==this.rwhisker&&e.push({field:"rw",value:this.rwhisker}),e},render:function(e,r){this.init(e,r);var t,i,a,n,o,l,d,f,s,g,c,u=this.target,m=this.values,h=m.length,j=this.options,p=this.canvasWidth,v=this.canvasHeight,b=void 0===j.get("chartRangeMin")?Math.min.apply(Math,m):j.get("chartRangeMin"),_=void 0===j.get("chartRangeMax")?Math.max.apply(Math,m):j.get("chartRangeMax"),w=0;if(j.get("raw"))j.get("showOutliers")&&5<m.length?(i=m[0],t=m[1],n=m[2],o=m[3],l=m[4],d=m[5],f=m[6]):(t=m[0],n=m[1],o=m[2],l=m[3],d=m[4]);else if(m.sort(function(e,r){return e-r}),n=y(m,1),o=y(m,2),a=(l=y(m,3))-n,j.get("showOutliers")){for(t=d=void 0,s=0;s<h;s++)void 0===t&&m[s]>n-a*j.get("outlierIQR")&&(t=m[s]),m[s]<l+a*j.get("outlierIQR")&&(d=m[s]);i=m[0],f=m[h-1]}else t=m[0],d=m[h-1];this.quartiles=[n,o,l],this.lwhisker=t,this.rwhisker=d,this.loutlier=i,this.routlier=f,c=p/(_-b+1),j.get("showOutliers")&&(w=Math.ceil(j.get("spotRadius")),c=(p-=2*Math.ceil(j.get("spotRadius")))/(_-b+1),i<t&&u.drawCircle((i-b)*c+w,v/2,j.get("spotRadius"),j.get("outlierLineColor"),j.get("outlierFillColor")).append(),d<f&&u.drawCircle((f-b)*c+w,v/2,j.get("spotRadius"),j.get("outlierLineColor"),j.get("outlierFillColor")).append()),u.drawRect(Math.round((n-b)*c+w),Math.round(.1*v),Math.round((l-n)*c),Math.round(.8*v),j.get("boxLineColor"),j.get("boxFillColor")).append(),u.drawLine(Math.round((t-b)*c+w),Math.round(v/2),Math.round((n-b)*c+w),Math.round(v/2),j.get("lineColor")).append(),u.drawLine(Math.round((t-b)*c+w),Math.round(v/4),Math.round((t-b)*c+w),Math.round(v-v/4),j.get("whiskerColor")).append(),u.drawLine(Math.round((d-b)*c+w),Math.round(v/2),Math.round((l-b)*c+w),Math.round(v/2),j.get("lineColor")).append(),u.drawLine(Math.round((d-b)*c+w),Math.round(v/4),Math.round((d-b)*c+w),Math.round(v-v/4),j.get("whiskerColor")).append(),u.drawLine(Math.round((o-b)*c+w),Math.round(.1*v),Math.round((o-b)*c+w),Math.round(.9*v),j.get("medianColor")).append(),j.get("target")&&(g=Math.ceil(j.get("spotRadius")),u.drawLine(Math.round((j.get("target")-b)*c+w),Math.round(v/2-g),Math.round((j.get("target")-b)*c+w),Math.round(v/2+g),j.get("targetColor")).append(),u.drawLine(Math.round((j.get("target")-b)*c+w-g),Math.round(v/2),Math.round((j.get("target")-b)*c+w+g),Math.round(v/2),j.get("targetColor")).append())}},shapeCount:0,shapes:{},shapeseq:[],lastShapeId:null,mergedOptions:null,init:function(e,r){var r=r||{},t=this,i=this.defaultOption,a=i.common,n=i[r.type||a.type];return t.shapeCount=0,t.shapes={},t.shapeseq=[],t.lastShapeId=null,t.mergedOptions=$.extend({},a,n,r),t.mergedOptions.width=devicePixelRatio*t.mergedOptions.width,t.mergedOptions.height=devicePixelRatio*t.mergedOptions.height,t[t.mergedOptions.type].render(t,e),{shapes:t.shapes,shapeseq:t.shapeseq,offsetX:t.mergedOptions.offsetX,offsetY:t.mergedOptions.offsetY,pixelWidth:t.mergedOptions.width,pixelHeight:t.mergedOptions.height}},_getContext:function(e,r,t){var i;return i=null!=this.ctx?this.ctx:$("#"+this._canvasID).get(0).getContext("2d"),void 0!==e&&(i.strokeStyle=e),i.lineWidth=void 0===t?1:t,void 0!==r&&(i.fillStyle=r),i},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=void 0},_drawShape:function(e,r,t,i,a){var n,o,l=this._getContext(t,i,a);for(l.beginPath(),l.moveTo(r[0][0]+.5+this.offsetX,r[0][1]+.5+this.offsetY),n=1,o=r.length;n<o;n++)l.lineTo(r[n][0]+.5+this.offsetX,r[n][1]+.5+this.offsetY);void 0!==t&&l.stroke(),void 0!==i&&l.fill(),void 0!==this.targetX&&void 0!==this.targetY&&l.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawCircle:function(e,r,t,i,a,n,o){var l=this._getContext(a,n,o);l.beginPath(),r+=this.offsetX,t+=this.offsetY,l.arc(r,t,i,0,2*Math.PI,!1),void 0!==this.targetX&&void 0!==this.targetY&&l.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e),void 0!==a&&l.stroke(),void 0!==n&&l.fill()},_drawPieSlice:function(e,r,t,i,a,n,o,l){var d=this._getContext(o,l);r+=this.offsetX,t+=this.offsetY,d.beginPath(),d.moveTo(r,t),d.arc(r,t,i,a,n,!1),d.lineTo(r,t),d.closePath(),void 0!==o&&d.stroke(),l&&d.fill(),void 0!==this.targetX&&void 0!==this.targetY&&d.isPointInPath(this.targetX+this.offsetX,this.targetY+this.offsetY)&&(this.currentTargetShapeId=e)},_drawRect:function(e,r,t,i,a,n,o){return this._drawShape(e,[[r,t],[r+i,t],[r+i,t+a],[r,t+a],[r,t]],n,o)},appendShape:function(e){return this.shapes[e.id]=e,this.shapeseq.push(e.id),this.lastShapeId=e.id,e.id},replaceWithShape:function(e,r){var t,i=this.shapeseq;for(this.shapes[r.id]=r,t=i.length;t--;)i[t]==e&&(i[t]=r.id);delete this.shapes[e]},replaceWithShapes:function(e,r){for(var t,i,a=this.shapeseq,n={},o=e.length;o--;)n[e[o]]=!0;for(o=a.length;o--;)n[t=a[o]]&&(a.splice(o,1),delete this.shapes[t],i=o);for(o=r.length;o--;)a.splice(i,0,r[o].id),this.shapes[r[o].id]=r[o]},insertAfterShape:function(e,r){for(var t=this.shapeseq,i=t.length;i--;)if(t[i]===e)return t.splice(i+1,0,r.id),void(this.shapes[r.id]=r)},removeShapeId:function(e){for(var r=this.shapeseq,t=r.length;t--;)if(r[t]===e){r.splice(t,1);break}delete this.shapes[e]},getShapeAt:function(e,r,t){return this.targetX=r,this.targetY=t,this.render(),this.currentTargetShapeId},_canvasID:"jfgridTableContent",render:function(e,r,t,i,a,n,o,l){null==o&&(o="jfgridTableContent"),this._canvasID=o,null!=l&&(this.ctx=l);var d,f,s=e.length;this._getContext();for(this.offsetX=t,this.offsetY=i,this.pixelWidth=a,this.pixelHeight=n,f=0;f<s;f++)this["_draw"+(d=r[e[f]]).type].apply(this,d.args)},drawLine:function(e,r,t,i,a,n){return this.drawShape([[e,r],[t,i]],a,n)},drawShape:function(e,r,t,i){return this._genShape("Shape",[e,r,t,i])},drawCircle:function(e,r,t,i,a,n){return this._genShape("Circle",[e,r,t,i,a,n])},drawPieSlice:function(e,r,t,i,a,n,o){return this._genShape("PieSlice",[e,r,t,i,a,n,o])},drawRect:function(e,r,t,i,a,n){return this._genShape("Rect",[e,r,t,i,a,n])},_genShape:function(e,r){var t=this.shapeCount++;r.unshift(t);var i={id:t,type:e,args:r};return this.shapes[t]=i,this.shapeseq.push(t),this.lastShapeId=t,{append:function(){return i},get:function(){return t}}}};var r=function(e){var r,t=this.currentRegion,i=this.target,a=this.regionShapes[t];a&&(r=this.renderRegion(t,e),$.isArray(r)||$.isArray(a)?(i.replaceWithShapes(a,r),this.regionShapes[t]=$.map(r,function(e){return e.id})):(i.replaceWithShape(a,r),this.regionShapes[t]=r.id))},i=function(e,r){this.init(e,r);for(var t,i,a,n=this.values,o=(this.target,this.regionShapes),l=n.length;l--;)if(t=this.renderRegion(l))if($.isArray(t)){for(i=[],a=t.length;a--;)t[a].append(),i.push(t[a].id);o[l]=i}else t.append(),o[l]=t.id;else o[l]=null},a={get:function(e){return jfgrid.sparkline.mergedOptions[e]}},n={drawLine:function(e,r,t,i,a,n){return jfgrid.sparkline.drawLine(e,r,t,i,a,n)},drawShape:function(e,r,t,i){return jfgrid.sparkline.drawShape(e,r,t,i)},drawCircle:function(e,r,t,i,a,n){return jfgrid.sparkline.drawCircle(e,r,t,i,a,n)},drawPieSlice:function(e,r,t,i,a,n,o){return jfgrid.sparkline.drawPieSlice(e,r,t,i,a,n,o)},drawRect:function(e,r,t,i,a,n){return jfgrid.sparkline.drawRect(e,r,t,i,a,n)}};for(item in jfgrid.sparkline)item in{line:null,bar:null,column:null,tristate:null,discrete:null,bullet:null,pie:null,box:null}&&(jfgrid.sparkline[item].options=a,jfgrid.sparkline[item].target=n),item in{bar:null,column:null,tristate:null,discrete:null}&&(jfgrid.sparkline[item].changeHighlight=r,jfgrid.sparkline[item].render=i)}(),window.jfgrid=jfgrid,window.jfgridConfigsetting=jfgridConfigsetting}(),function(jfgrid){window.jfgrid_compareWith=function(){var sp=arguments[1],data_fp=arguments[0],fp;"object"==jfgrid.getObjType(data_fp)&&null!=data_fp.startCell?(fp="&"==sp?jfgrid.func_methods.getCellDataDyadicArr(data_fp,"text"):jfgrid.func_methods.getCellDataDyadicArr(data_fp,"number"),1==fp.length&&1==fp[0].length&&(fp=fp[0][0])):fp=data_fp;var data_tp=arguments[2],tp,result,result,result,result,result,result,result,result;if("object"==jfgrid.getObjType(data_tp)&&null!=data_tp.startCell?(tp="&"==sp?jfgrid.func_methods.getCellDataDyadicArr(data_tp,"text"):jfgrid.func_methods.getCellDataDyadicArr(data_tp,"number"),1==tp.length&&1==tp[0].length&&(tp=tp[0][0])):tp=data_tp,jfgrid.func_methods.valueIsError(fp))return fp;if(jfgrid.func_methods.valueIsError(tp))return tp;if("array"==jfgrid.getObjType(fp)&&"array"==jfgrid.getObjType(fp[0])&&!jfgrid.func_methods.isDyadicArr(fp))return jfgrid.formula.error.v;if("array"==jfgrid.getObjType(tp)&&"array"==jfgrid.getObjType(tp[0])&&!jfgrid.func_methods.isDyadicArr(tp))return jfgrid.formula.error.v;function booleanOperation(e,r,t){return jfgrid.func_methods.isRealNum(e)&&(e=parseFloat(e)),jfgrid.func_methods.isRealNum(t)&&(t=parseFloat(t)),"=="==r?e==t:"!="==r?e!=t:">="==r?t<=e:"<="==r?e<=t:">"==r?t<e:"<"==r?e<t:void 0}function booleanToNum(e){return null==e?e:"true"==e.toString().toLowerCase()?1:"false"==e.toString().toLowerCase()?0:e}if("<>"==sp&&(sp="!="),"="==sp&&(sp="=="),"-"==sp&&null==fp&&(fp=0),"*"==sp){if("array"==jfgrid.getObjType(fp)&&"array"==jfgrid.getObjType(tp)){var result=[];if("array"==jfgrid.getObjType(fp[0])&&"array"==jfgrid.getObjType(tp[0]))if(fp.length==tp.length&&fp[0].length==tp[0].length)for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp[m][n])?parseFloat(fp[m][n])*parseFloat(tp[m][n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else if(fp[0].length==tp.length)for(var rowlen=fp.length,collen=tp[0].length,m=0;m<rowlen;m++){for(var rowArr=[],n=0;n<collen;n++){for(var value=0,p=0;p<fp[0].length;p++)fp[m][p]=booleanToNum(fp[m][p]),tp[p][n]=booleanToNum(tp[p][n]),jfgrid.func_methods.isRealNum(fp[m][p])&&jfgrid.func_methods.isRealNum(tp[p][n])?value+=parseFloat(fp[m][p])*parseFloat(tp[p][n]):value+=jfgrid.formula.error.v;"NaN"==value.toString()&&(value=jfgrid.formula.error.v),rowArr.push(value)}result.push(rowArr)}else{if(fp.length!=tp[0].length)return jfgrid.formula.error.na;for(var rowlen=tp.length,collen=fp[0].length,m=0;m<rowlen;m++){for(var rowArr=[],n=0;n<collen;n++){for(var value=0,p=0;p<tp[0].length;p++)fp[p][n]=booleanToNum(fp[p][n]),tp[m][p]=booleanToNum(tp[m][p]),jfgrid.func_methods.isRealNum(tp[m][p])&&jfgrid.func_methods.isRealNum(fp[p][n])?value+=parseFloat(tp[m][p])*parseFloat(fp[p][n]):value+=jfgrid.formula.error.v;"NaN"==value.toString()&&(value=jfgrid.formula.error.v),rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(fp[0]))if(fp[0].length==tp.length)for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp[n])?parseFloat(fp[m][n])*parseFloat(tp[n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(1!=fp[0].length)return jfgrid.formula.error.na;for(var rowlen=fp.length,collen=tp.length,m=0;m<rowlen;m++){for(var rowArr=[],n=0,value,value;n<collen;n++){fp[m][0]=booleanToNum(fp[m][0]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[m][0])&&jfgrid.func_methods.isRealNum(tp[n])?parseFloat(fp[m][0])*parseFloat(tp[n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(tp[0]))if(tp[0].length==fp.length)for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value;n<tp[m].length;n++){fp[n]=booleanToNum(fp[n]),tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[m][n])?parseFloat(fp[n])*parseFloat(tp[m][n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(1!=tp[0].length)return jfgrid.formula.error.na;for(var rowlen=tp.length,collen=fp.length,m=0;m<rowlen;m++){for(var rowArr=[],n=0,value,value;n<collen;n++){fp[n]=booleanToNum(fp[n]),tp[m][0]=booleanToNum(tp[m][0]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[m][0])?parseFloat(fp[n])*parseFloat(tp[m][0]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return jfgrid.formula.error.na;for(var n=0,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[n])?parseFloat(fp[n])*parseFloat(tp[n]):jfgrid.formula.error.v,result.push(value)}}return result}if("array"==jfgrid.getObjType(fp)){tp=booleanToNum(tp);var result=[];if("array"==jfgrid.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp)?parseFloat(fp[m][n])*parseFloat(tp):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp)?parseFloat(fp[n])*parseFloat(tp):jfgrid.formula.error.v,result.push(value)}return result}if("array"==jfgrid.getObjType(tp)){fp=booleanToNum(fp);var result=[];if("array"==jfgrid.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value;n<tp[m].length;n++){tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp[m][n])?parseFloat(fp)*parseFloat(tp[m][n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value;n<tp.length;n++){tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp[n])?parseFloat(fp)*parseFloat(tp[n]):jfgrid.formula.error.v,result.push(value)}return result}var result,result,fp=booleanToNum(fp),tp=booleanToNum(tp);return result=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp)?parseFloat(fp)*parseFloat(tp):jfgrid.formula.error.v,result}if("/"==sp){if("array"==jfgrid.getObjType(fp)&&"array"==jfgrid.getObjType(tp)){var result=[];if("array"==jfgrid.getObjType(fp[0])&&"array"==jfgrid.getObjType(tp[0]))if(fp.length==tp.length&&fp[0].length==tp[0].length)for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp[m][n])?0==parseFloat(tp[m][n])?jfgrid.formula.error.d:parseFloat(fp[m][n])/parseFloat(tp[m][n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(fp[0].length!=tp.length)return jfgrid.formula.error.na;for(var tp_inverse=jfgrid.matrix_methods.inverse(tp),rowlen=fp.length,collen=tp_inverse[0].length,m=0;m<rowlen;m++){for(var rowArr=[],n=0;n<collen;n++){for(var value=0,p=0;p<fp[0].length;p++)fp[m][p]=booleanToNum(fp[m][p]),tp_inverse[p][n]=booleanToNum(tp_inverse[p][n]),jfgrid.func_methods.isRealNum(fp[m][p])&&jfgrid.func_methods.isRealNum(tp_inverse[p][n])?value+=parseFloat(fp[m][p])*parseFloat(tp_inverse[p][n]):value+=jfgrid.formula.error.v;"NaN"==value.toString()&&(value=jfgrid.formula.error.v),rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(fp[0]))if(fp[0].length==tp.length)for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp[n])?0==parseFloat(tp[n])?jfgrid.formula.error.d:parseFloat(fp[m][n])/parseFloat(tp[n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(1!=fp[0].length)return jfgrid.formula.error.na;for(var rowlen=fp.length,collen=tp.length,m=0;m<rowlen;m++){for(var rowArr=[],n=0,value,value,value;n<collen;n++){fp[m][0]=booleanToNum(fp[m][0]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[m][0])&&jfgrid.func_methods.isRealNum(tp[n])?0==parseFloat(tp[n])?jfgrid.formula.error.d:parseFloat(fp[m][0])/parseFloat(tp[n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(tp[0]))if(tp[0].length==fp.length)for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value,value;n<tp[m].length;n++){fp[n]=booleanToNum(fp[n]),tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[m][n])?0==parseFloat(tp[m][n])?jfgrid.formula.error.d:parseFloat(fp[n])/parseFloat(tp[m][n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else{if(1!=tp[0].length)return jfgrid.formula.error.na;for(var rowlen=tp.length,collen=fp.length,m=0;m<rowlen;m++){for(var rowArr=[],n=0,value,value,value;n<collen;n++){fp[n]=booleanToNum(fp[n]),tp[m][0]=booleanToNum(tp[m][0]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[m][0])?0==parseFloat(tp[m][0])?jfgrid.formula.error.d:parseFloat(fp[n])/parseFloat(tp[m][0]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return jfgrid.formula.error.na;for(var n=0,value,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[n])?0==parseFloat(tp[n])?jfgrid.formula.error.d:parseFloat(fp[n])/parseFloat(tp[n]):jfgrid.formula.error.v,result.push(value)}}return result}if("array"==jfgrid.getObjType(fp)){tp=booleanToNum(tp);var result=[];if("array"==jfgrid.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp)?0==parseFloat(tp)?jfgrid.formula.error.d:parseFloat(fp[m][n])/parseFloat(tp):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp)?0==parseFloat(tp)?jfgrid.formula.error.d:parseFloat(fp[n])/parseFloat(tp):jfgrid.formula.error.v,result.push(value)}return result}if("array"!=jfgrid.getObjType(tp))return fp=booleanToNum(fp),tp=booleanToNum(tp),result=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp)?0==parseFloat(tp)?jfgrid.formula.error.d:parseFloat(fp)/parseFloat(tp):jfgrid.formula.error.v,result;fp=booleanToNum(fp);var result=[];if("array"==jfgrid.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value,value;n<tp[m].length;n++){tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp[m][n])?0==parseFloat(tp[m][n])?jfgrid.formula.error.d:parseFloat(fp)/parseFloat(tp[m][n]):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value,value;n<tp.length;n++){tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp[n])?0==parseFloat(tp[n])?jfgrid.formula.error.d:parseFloat(fp)/parseFloat(tp[n]):jfgrid.formula.error.v,result.push(value)}return result}if("+"==sp||"-"==sp||"%"==sp){if("array"==jfgrid.getObjType(fp)&&"array"==jfgrid.getObjType(tp)){var result=[];if("array"==jfgrid.getObjType(fp[0])&&"array"==jfgrid.getObjType(tp[0])){if(fp.length!=tp.length&&fp[0].length!=tp[0].length)return jfgrid.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp[m][n])?"%"==sp&&0==parseFloat(tp[m][n])?jfgrid.formula.error.d:eval(parseFloat(fp[m][n])+sp+parseFloat(tp[m][n])):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(fp[0])){if(fp[0].length!=tp.length)return jfgrid.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp[n])?"%"==sp&&0==parseFloat(tp[n])?jfgrid.formula.error.d:eval(parseFloat(fp[m][n])+sp+parseFloat(tp[n])):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(tp[0])){if(tp[0].length!=fp.length)return jfgrid.formula.error.na;for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value,value;n<tp[m].length;n++){fp[n]=booleanToNum(fp[n]),tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[m][n])?"%"==sp&&0==parseFloat(tp[m][n])?jfgrid.formula.error.d:eval(parseFloat(fp[n])+sp+parseFloat(tp[m][n])):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return jfgrid.formula.error.na;for(var n=0,value,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[n])?"%"==sp&&0==parseFloat(tp[n])?jfgrid.formula.error.d:eval(parseFloat(fp[n])+sp+parseFloat(tp[n])):jfgrid.formula.error.v,result.push(value)}}return result}if("array"==jfgrid.getObjType(fp)){tp=booleanToNum(tp);var result=[];if("array"==jfgrid.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp)?"%"==sp&&0==parseFloat(tp)?jfgrid.formula.error.d:eval(parseFloat(fp[m][n])+sp+parseFloat(tp)):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp)?"%"==sp&&0==parseFloat(tp)?jfgrid.formula.error.d:eval(parseFloat(fp[n])+sp+parseFloat(tp)):jfgrid.formula.error.v,result.push(value)}return result}if("array"!=jfgrid.getObjType(tp))return fp=booleanToNum(fp),tp=booleanToNum(tp),result=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp)?"%"==sp&&0==parseFloat(tp)?jfgrid.formula.error.d:eval(parseFloat(fp)+sp+parseFloat(tp)):jfgrid.formula.error.v,result;fp=booleanToNum(fp);var result=[];if("array"==jfgrid.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value,value;n<tp[m].length;n++){tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp[m][n])?"%"==sp&&0==parseFloat(tp[m][n])?jfgrid.formula.error.d:eval(parseFloat(fp)+sp+parseFloat(tp[m][n])):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value,value;n<tp.length;n++){tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp[n])?"%"==sp&&0==parseFloat(tp[n])?jfgrid.formula.error.d:eval(parseFloat(fp)+sp+parseFloat(tp[n])):jfgrid.formula.error.v,result.push(value)}return result}if("=="==sp||"!="==sp||">="==sp||"<="==sp||">"==sp||"<"==sp){if("array"==jfgrid.getObjType(fp)&&"array"==jfgrid.getObjType(tp)){var result=[];if("array"==jfgrid.getObjType(fp[0])&&"array"==jfgrid.getObjType(tp[0])){if(fp.length!=tp.length&&fp[0].length!=tp[0].length)return jfgrid.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++){var value=booleanOperation(fp[m][n],sp,tp[m][n]);rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(fp[0])){if(fp[0].length!=tp.length)return jfgrid.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++){var value=booleanOperation(fp[m][n],sp,tp[n]);rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(tp[0])){if(tp[0].length!=fp.length)return jfgrid.formula.error.na;for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0;n<tp[m].length;n++){var value=booleanOperation(fp[n],sp,tp[m][n]);rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return jfgrid.formula.error.na;for(var n=0;n<fp.length;n++){var value=booleanOperation(fp[n],sp,tp[n]);result.push(value)}}return result}if("array"==jfgrid.getObjType(fp)){var result=[];if("array"==jfgrid.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++){var value=booleanOperation(fp[m][n],sp,tp);rowArr.push(value)}result.push(rowArr)}else for(var n=0;n<fp.length;n++){var value=booleanOperation(fp[n],sp,tp);result.push(value)}return result}if("array"!=jfgrid.getObjType(tp))return booleanOperation(fp,sp,tp);var result=[];if("array"==jfgrid.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0;n<tp[m].length;n++){var value=booleanOperation(fp,sp,tp[m][n]);rowArr.push(value)}result.push(rowArr)}else for(var n=0;n<tp.length;n++){var value=booleanOperation(fp,sp,tp[n]);result.push(value)}return result}if("&"==sp){if("array"==jfgrid.getObjType(fp)&&"array"==jfgrid.getObjType(tp)){var result=[];if("array"==jfgrid.getObjType(fp[0])&&"array"==jfgrid.getObjType(tp[0])){if(fp.length!=tp.length&&fp[0].length!=tp[0].length)return jfgrid.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++)rowArr.push(fp[m][n]+""+tp[m][n]);result.push(rowArr)}}else if("array"==jfgrid.getObjType(fp[0])){if(fp[0].length!=tp.length)return jfgrid.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++)rowArr.push(fp[m][n]+""+tp[n]);result.push(rowArr)}}else if("array"==jfgrid.getObjType(tp[0])){if(tp[0].length!=fp.length)return jfgrid.formula.error.na;for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0;n<tp[m].length;n++)rowArr.push(fp[n]+""+tp[m][n]);result.push(rowArr)}}else{if(fp.length!=tp.length)return jfgrid.formula.error.na;for(var n=0;n<fp.length;n++)result.push(fp[n]+""+tp[n])}return result}if("array"==jfgrid.getObjType(fp)){var result=[];if("array"==jfgrid.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0;n<fp[m].length;n++)rowArr.push(fp[m][n]+""+tp);result.push(rowArr)}else for(var n=0;n<fp.length;n++)result.push(fp[n]+""+tp);return result}if("array"!=jfgrid.getObjType(tp))return fp+""+tp;var result=[];if("array"==jfgrid.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0;n<tp[m].length;n++)rowArr.push(fp+""+tp[m][n]);result.push(rowArr)}else for(var n=0;n<tp.length;n++)result.push(fp+""+tp[n]);return result}if("^"==sp){if("array"==jfgrid.getObjType(fp)&&"array"==jfgrid.getObjType(tp)){var result=[];if("array"==jfgrid.getObjType(fp[0])&&"array"==jfgrid.getObjType(tp[0])){if(fp.length!=tp.length&&fp[0].length!=tp[0].length)return jfgrid.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp[m][n])?Math.pow(parseFloat(fp[m][n]),parseFloat(tp[m][n])):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(fp[0])){if(fp[0].length!=tp.length)return jfgrid.formula.error.na;for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp[n])?Math.pow(parseFloat(fp[m][n]),parseFloat(tp[n])):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else if("array"==jfgrid.getObjType(tp[0])){if(tp[0].length!=fp.length)return jfgrid.formula.error.na;for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value;n<tp[m].length;n++){fp[n]=booleanToNum(fp[n]),tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[m][n])?Math.pow(parseFloat(fp[n]),parseFloat(tp[m][n])):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}}else{if(fp.length!=tp.length)return jfgrid.formula.error.na;for(var n=0,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp[n])?Math.pow(parseFloat(fp[n]),parseFloat(tp[n])):jfgrid.formula.error.v,result.push(value)}}return result}if("array"==jfgrid.getObjType(fp)){tp=booleanToNum(tp);var result=[];if("array"==jfgrid.getObjType(fp[0]))for(var m=0;m<fp.length;m++){for(var rowArr=[],n=0,value,value;n<fp[m].length;n++){fp[m][n]=booleanToNum(fp[m][n]),value=jfgrid.func_methods.isRealNum(fp[m][n])&&jfgrid.func_methods.isRealNum(tp)?Math.pow(parseFloat(fp[m][n]),parseFloat(tp)):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value;n<fp.length;n++){fp[n]=booleanToNum(fp[n]),value=jfgrid.func_methods.isRealNum(fp[n])&&jfgrid.func_methods.isRealNum(tp)?Math.pow(parseFloat(fp[n]),parseFloat(tp)):jfgrid.formula.error.v,result.push(value)}return result}if("array"!=jfgrid.getObjType(tp))return fp=booleanToNum(fp),tp=booleanToNum(tp),result=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp)?Math.pow(parseFloat(fp),parseFloat(tp)):jfgrid.formula.error.v,result;fp=booleanToNum(fp);var result=[];if("array"==jfgrid.getObjType(tp[0]))for(var m=0;m<tp.length;m++){for(var rowArr=[],n=0,value,value;n<tp[m].length;n++){tp[m][n]=booleanToNum(tp[m][n]),value=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp[m][n])?Math.pow(parseFloat(fp),parseFloat(tp[m][n])):jfgrid.formula.error.v,rowArr.push(value)}result.push(rowArr)}else for(var n=0,value,value;n<tp.length;n++){tp[n]=booleanToNum(tp[n]),value=jfgrid.func_methods.isRealNum(fp)&&jfgrid.func_methods.isRealNum(tp[n])?Math.pow(parseFloat(fp),parseFloat(tp[n])):jfgrid.formula.error.v,result.push(value)}return result}},window.jfgrid_getarraydata=function(){var e=arguments[0],r=[];if(-1<(e=e.replace("{","").replace("}","").replace(/\"/g,"")).indexOf(";")){r=e.split(";");for(var t=0;t<r.length;t++)r[t]=r[t].split(",")}else r=e.split(",");return r},window.jfgrid_getcelldata=function(e){if(null==window.jfgrid_getcelldata_cache&&(window.jfgrid_getcelldata_cache={}),e in window.jfgrid_getcelldata_cache)return window.jfgrid_getcelldata_cache[e];var r=jfgrid.getjfgridfile(),t=e.split("!"),i="",a="",n=-1,o=null;if(1<t.length){for(var l in i=t[0],a=t[1],r)if(i==r[l].name){n=r[l].index,o=r[l].data;break}-1==n&&(n=0)}else{var d=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),i=r[d].name,n=r[d].index,o=jfgrid.flowdata,a=t[0];null!=jfgrid.formula.execFunctionGroupData&&(o=jfgrid.formula.execFunctionGroupData)}if(-1==a.indexOf(":")){var f=parseInt(a.replace(/[^0-9]/g,""))-1,s=jfgrid.jfgridABCatNum(a.replace(/[^A-Za-z]/g,""));if(isNaN(f)||isNaN(s))return[];var g={sheetName:i,startCell:a,rowl:u=1,coll:m=1,data:c=jfgrid.getdatabyselectionD(o,{row:[f,f],column:[s,s]})[0][0]};return window.jfgrid_getcelldata_cache[e]=g}a=a.split(":");s=[];if((f=[])[0]=parseInt(a[0].replace(/[^0-9]/g,""))-1,f[1]=parseInt(a[1].replace(/[^0-9]/g,""))-1,isNaN(f[0])&&(f[0]=0),isNaN(f[1])&&(f[1]=o.length-1),f[0]>f[1])return jfgrid.tooltip.info("选择失败","输入范围错误！"),[];if(s[0]=jfgrid.jfgridABCatNum(a[0].replace(/[^A-Za-z]/g,"")),s[1]=jfgrid.jfgridABCatNum(a[1].replace(/[^A-Za-z]/g,"")),isNaN(s[0])&&(s[0]=0),isNaN(s[1])&&(s[1]=o[0].length-1),s[0]>s[1])return jfgrid.tooltip.info("选择失败","输入范围错误！"),[];var c=jfgrid.getdatabyselectionD(o,{row:f,column:s}),u=f[1]-f[0]+1,m=s[1]-s[0]+1,g={sheetName:i,startCell:a[0],rowl:u,coll:m,data:c};return window.jfgrid_getcelldata_cache[e]=g},window.jfgrid_parseData=function(e){if("object"==typeof e){return null==e?"":Array.isArray(e)?jfgrid.mask.genarate(e[0])[2]:Array.isArray(e.data)?jfgrid.formula.error.v:void 0===e.data.v?"":e.data.v}else{if(!jfgrid.formula.isCompareOperator(e).flag)return jfgrid.mask.genarate(e)[2];if("string"==typeof e||"number"==typeof e)return e}return jfgrid.formula.error.v},window.jfgrid_getValue=function(){for(var e=arguments[0],r=0;r<e.length;r++){var t=e[r];"object"==typeof t?t=null==t?"":Array.isArray(t)?jfgrid.mask.genarate(t[0])[2]:Array.isArray(t.data)?t.data:void 0===t.data.v?"":t.data.v:jfgrid.formula.isCompareOperator(t).flag||(t=jfgrid.mask.genarate(t)[2]),e[r]=t}},jfgrid.formula={error:{v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},errorInfo:function(e){return e},errorParamCheck:function(e,r,t){var i;return"o"==(t<e.length?(i=e[t].type,e[t].require):(i=e[e.length-1].type,e[e.length-1].require))&&(null==r||""==r)||-1<i.indexOf("all")||-1<i.indexOf("range")&&("object"==jfgrid.getObjType(r)||"array"==jfgrid.getObjType(r))||-1<i.indexOf("number")&&(jfgrid.func_methods.isRealNum(r)||"boolean"==jfgrid.getObjType(r))||-1<i.indexOf("string")&&"string"==jfgrid.getObjType(r)||-1<i.indexOf("date")&&jfgrid.datecontroll.isdatetime(r)?[!0,"成功"]:[!1,"参数类型错误"]},getPureValueByData:function(e){if(0==e.length)return[];var r=[];if("array"==jfgrid.getObjType(e))if("array"==jfgrid.getObjType(e[0]))for(var t=0;t<e.length;t++){for(var i=[],a=0;a<e[0].length;a++){var n=e[t][a];"object"==jfgrid.getObjType(n)?i.push(n.v):i.push(n)}r.push(i)}else for(var o=0;o<e.length;o++){n=e[o];"object"==jfgrid.getObjType(n)?r.push(n.v):r.push(n)}else{n=e;"object"==jfgrid.getObjType(n)?r.push(n.v):r.push(n)}return r},readCellDataToOneArray:function(rangeValue){if(null==rangeValue)return[];if("object"!=jfgrid.getObjType(rangeValue))return[rangeValue];var dataformat=[],data=[];if(null==rangeValue||null==rangeValue.data)return null==rangeValue||jfgrid.func_methods.isRealNull(rangeValue.v)?[]:[rangeValue.v];if(data=rangeValue.data,"array"==jfgrid.getObjType(data))data=jfgrid.formula.getPureValueByData(data);else{if("object"==jfgrid.getObjType(data))return data=data.v,[data];/\{.*?\}/.test(data)&&(data=data.replace(/\{/g,"[").replace(/\}/g,"]")),data=eval("("+data+")")}if("array"==jfgrid.getObjType(data[0]))for(var i=0;i<data.length;i++)dataformat=dataformat.concat(data[i]);else dataformat=data;return dataformat},getValueByFuncData:function(e,r){if(null==e)return null;return"array"==jfgrid.getObjType(e)?"avg"==r?window.jfgrid_function.AVERAGE.f.apply(window.jfgrid_function.AVERAGE,e):"sum"==r?window.jfgrid_function.SUM.f.apply(window.jfgrid_function.SUM,e):"object"==jfgrid.getObjType(e[0])?jfgrid.mask.getValueByFormat(e[0]):e[0]:"object"==jfgrid.getObjType(e)?jfgrid.mask.getValueByFormat(e):e},sparklinesColorMap:function(arguments,e){var r=null;null==e&&(e=5);if(arguments.length>e)for(var t=e;t<arguments.length;t++){for(var i=arguments[t],a=jfgrid.formula.readCellDataToOneArray(i),n=0;n<a.length;n++){var o,l=a[n];-1<l.indexOf(":")?(r=r||{},2==(o=l.split(":")).length?r[o[0]]=o[1]:1<o.length&&(r[o[0]+":"+o[1]]=o[2])):(r=r||[]).push(l)}0}return r},colorList:["#2ec7c9","#fc5c5c","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],classlist:{province:{11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"}},oldvalue:null,dontupdate:function(){jfgridCellUpdate=[],$("#jfgrid-functionbox-cell, #jfgrid-rich-text-editor").html(this.oldvalue),this.cancelNormalSelected(),jfgrid.formula.rangetosheet!=jfgrid.currentSheetIndex&&jfgrid.sheetmanage.changeSheetExec(jfgrid.formula.rangetosheet)},fucntionboxshow:function(e,r){var t=jfgrid.flowdata,i="";null!=t[e]&&null!=t[e][r]&&null!=t[e][r].v&&(i=null!=t[e][r].f?jfgrid.getcellvalue(e,r,t,"f"):jfgrid.mask.valueShowEs(e,r,t)),this.oldvalue=i,$("#jfgrid-functionbox-cell").html(i)},cellOffset:function(e,r,t,i,a){var n=e.startCell,o=(e.rowl,e.coll,parseInt(n.replace(/[^0-9]/g,""))),l=jfgrid.jfgridABCatNum(n.replace(/[^A-Za-z]/g,"")),d=[],f=[];d[0]=o+r,f[0]=l+t,d[1]=d[0]+i-1,f[1]=f[0]+a-1,f[0]=jfgrid.jfgridchatatABC(f[0]),f[1]=jfgrid.jfgridchatatABC(f[1]);var s=f[0]+d[0],g=f[1]+d[1];return s==g?e.sheetName+"!"+s:e.sheetName+"!"+s+":"+g},parseDatetoNum:function(e){if("object"==typeof e&&"number"==typeof e.v)e=e.v;else if("num"==jfgrid.isdatatype(e))e=parseFloat(e);else{if("date"!=jfgrid.isdatatype(e))return jfgrid.formula.error.v;e=jfgrid.mask.genarate(e)[2]}return e},getRangeArray:function(e){var r=[],t="General";if(1==e.length)for(var i=0;i<e[0].length;i++){null!=e[0][i]&&e[0][i].v?(r.push(e[0][i].v),n=e[0][i].ct.fa,t="General"==t?n:t):r.push(null)}else if(1==e[0].length)for(var a=0;a<e.length;a++){null!=e[a][0]&&e[a][0].v?(r.push(e[a][0].v),n=e[a][0].ct.fa,t="General"==t?n:t):r.push(null)}else for(a=0;a<e.length;a++)for(var n,i=0;i<e[a].length;i++){null!=e[a][i]&&e[a][i].v?(r.push(e[a][i].v),n=e[a][i].ct.fa,t="General"==t?n:t):r.push(null)}return[e=r,t]},getRangeArrayTwo:function(e){var r=$.extend(!0,[],e);if(1==r.length)for(var t=0;t<r[0].length;t++)r[0][t]instanceof Object&&(null!=r[0][t]&&r[0][t]instanceof Object&&r[0][t].m?r[0][t]=r[0][t].m:null!=r[0][t]&&r[0][t]instanceof Object&&r[0][t].v?r[0][t]=r[0][t].v:r[0][t]=null);else if(1==r[0].length)for(var i=0;i<r.length;i++)r[i][0]instanceof Object&&(null!=r[i][0]&&r[i][0]instanceof Object&&r[i][0].m?r[i][0]=r[i][0].m:null!=r[i][0]&&r[i][0]instanceof Object&&r[i][0].v?r[i][0]=r[i][0].v:r[i][0]=null);else for(i=0;i<r.length;i++)for(t=0;t<r[i].length;t++)r[i][t]instanceof Object&&(null!=r[i][t]&&r[i][t]instanceof Object&&r[i][t].m?r[i][t]=r[i][t].m:null!=r[i][t]&&r[i][t]instanceof Object&&r[i][t].v?r[i][t]=r[i][t].v:r[i][t]=null);return r},isWildcard:function(e,r){e=e.toString(),r=r.toString(),jfgrid.formula.isCompareOperator(r).flag&&(r=jfgrid.formula.isCompareOperator(r).num);for(var t="",i=0;i<r.length;i++){var a=r.charAt(i);"*"==a?t+=".*":"?"==a?t+=".":"~"==a?"*"==r.charAt(i+1)?(t+="\\*",i++):"?"==r.charAt(i+1)?(t+="\\?",i++):t+="~":t+=a}var n=new RegExp("^"+t+"$","g");return!!e.match(n)},isCompareOperator:function(e){var r="",t="",i=(e=e.toString()).substr(0,1),a=e.substr(1,1),n=!1;return">"==i?"="==a?(r=e.substr(0,2),t=e.substr(2),n=!0):"="!=a&&(r=e.substr(0,1),t=e.substr(1),n=!0):"<"==i?"="==a||">"==a?(r=e.substr(0,2),t=e.substr(2),n=!0):"="!=a&&">"!=a&&(r=e.substr(0,1),t=e.substr(1),n=!0):"="==i&&"="!=a&&(r=e.substr(0,1),t=e.substr(1),n=!0),{flag:n,ope:r,num:t}},acompareb:function(e,r){var t,i,a=!1;if(jfgrid.func_methods.isRealNum(r))a=jfgrid_compareWith(e,"==",r);else if("string"==typeof r){if(-1!=r.indexOf("*")||-1!=r.indexOf("?"))return jfgrid.formula.isWildcard(e,r);a=jfgrid.formula.isCompareOperator(r).flag?(t=jfgrid.formula.isCompareOperator(r).ope,i=jfgrid.formula.isCompareOperator(r).num,jfgrid_compareWith(e,t,i)):jfgrid_compareWith(e,"==",r)}return a},compareParams:function(e,r,t){var i=!1,a=toString.call(e),n=toString.call(r);if(">"==t?r<e&&(i=!0):">="==t?r<=e&&(i=!0):"<"==t?e<r&&(i=!0):"<="==t?e<=r&&(i=!0):"="==t?e==r&&(i=!0):"<>"==t&&e!=r&&(i=!0),"[object Object]"!=a||"[object Object]"!=n)return"[object Array]"==a&&"[object Array]"==n?e.toString()==r.toString():i;var o=Object.getOwnPropertyNames(e),l=Object.getOwnPropertyNames(r);if(o.length!=l.length)return!1;for(var d=0;d<o.length;d++){var f=o[d];if(e[f]!==r[f])return!1}return!0},parseDecimal:function(e){var e=parseFloat(e),r=parseInt(e,10);return 0==r?e:e%=r},getcellrange:function(e){var r=e.split("!"),t="",i="",a=-1,n=null,o=jfgrid.getjfgridfile();if(1<r.length){for(var l in t=r[0],i=r[1],o)if(t==o[l].name){a=o[l].index,n=o[l].data;break}}else var d=jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex),t=o[d].name,a=o[d].index,n=jfgrid.flowdata,i=r[0];if(-1==i.indexOf(":")){var f=parseInt(i.replace(/[^0-9]/g,""))-1,s=jfgrid.jfgridABCatNum(i.replace(/[^A-Za-z]/g,""));return isNaN(f)||isNaN(s)?null:{row:[f,f],column:[s,s],sheetIndex:a}}i=i.split(":");s=[];return(f=[])[0]=parseInt(i[0].replace(/[^0-9]/g,""))-1,f[1]=parseInt(i[1].replace(/[^0-9]/g,""))-1,isNaN(f[0])&&(f[0]=0),isNaN(f[1])&&(f[1]=n.length-1),f[0]>f[1]?null:(s[0]=jfgrid.jfgridABCatNum(i[0].replace(/[^A-Za-z]/g,"")),s[1]=jfgrid.jfgridABCatNum(i[1].replace(/[^A-Za-z]/g,"")),isNaN(s[0])&&(s[0]=0),isNaN(s[1])&&(s[1]=n[0].length-1),s[0]>s[1]?null:{row:f,column:s,sheetIndex:a})},rangeHightlightHTML:'<div id="jfgrid-formula-functionrange-highlight-${id}" rangeindex="${id}"  class="jfgrid-selection-highlight jfgrid-formula-functionrange-highlight"><div data-type="top" class="jfgrid-selection-copy-top jfgrid-copy"></div><div data-type="right" class="jfgrid-selection-copy-right jfgrid-copy"></div><div data-type="bottom" class="jfgrid-selection-copy-bottom jfgrid-copy"></div><div data-type="left" class="jfgrid-selection-copy-left jfgrid-copy"></div><div class="jfgrid-selection-copy-hc"></div><div data-type="lt" class="jfgrid-selection-highlight-topleft jfgrid-highlight"></div><div data-type="rt" class="jfgrid-selection-highlight-topright jfgrid-highlight"></div><div data-type="lb" class="jfgrid-selection-highlight-bottomleft jfgrid-highlight"></div><div data-type="rb" class="jfgrid-selection-highlight-bottomright jfgrid-highlight"></div></div>',createRangeHightlight:function(){var e=$("#jfgrid-rich-text-editor").find("span.jfgrid-formula-functionrange-cell");$("#jfgrid-formula-functionrange .jfgrid-formula-functionrange-highlight").remove(),e.each(function(){var e=$(this).attr("rangeindex"),r=$(this).text();$("#jfgrid-formula-functionrange").append(jfgrid.replaceHtml(jfgrid.formula.rangeHightlightHTML,{id:e}));var t=jfgrid.formula.getcellrange(r),i="jfgrid-formula-functionrange-highlight-"+e;null==t||(t.sheetIndex==jfgrid.currentSheetIndex||-1==t.sheetIndex&&jfgrid.formula.rangetosheet==jfgrid.currentSheetIndex)&&($("#"+i).data("range",t).find(".jfgrid-copy").css({background:jfgrid.jfcolor[e]}).end().find(".jfgrid-highlight").css({background:jfgrid.jfcolor[e]}).end().find(".jfgrid-selection-copy-hc").css({background:jfgrid.jfcolor[e]}),jfgrid.seletedHighlistByindex(i,t.row[0],t.row[1],t.column[0],t.column[1]))}),$("#jfgrid-formula-functionrange .jfgrid-formula-functionrange-highlight").show()},searchHTML:'<div id="jfgrid-formula-search-c" class="jfgrid-formula-search-c"></div>',helpHTML:'<div id="jfgrid-formula-help-c" class="jfgrid-formula-help-c"> <div class="jfgrid-formula-help-close" title="关闭"><i class="fa fa-times" aria-hidden="true"></i></div> <div class="jfgrid-formula-help-collapse" title="收起"><i class="fa fa-angle-up" aria-hidden="true"></i></div> <div class="jfgrid-formula-help-title"><div class="jfgrid-formula-help-title-formula"> <span class="jfgrid-arguments-help-function-name">SUM</span> <span class="jfgrid-arguments-paren">(</span> <span class="jfgrid-arguments-parameter-holder"> <span class="jfgrid-arguments-help-parameter jfgrid-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="jfgrid-arguments-help-parameter" dir="auto">101</span> </span> <span class="jfgrid-arguments-paren">)</span> </div></div> <div class="jfgrid-formula-help-content"> <div class="jfgrid-formula-help-content-example"> <div class="jfgrid-arguments-help-section-title">示例</div> <div class="jfgrid-arguments-help-formula"> <span class="jfgrid-arguments-help-function-name">SUM</span> <span class="jfgrid-arguments-paren">(</span> <span class="jfgrid-arguments-parameter-holder"> <span class="jfgrid-arguments-help-parameter jfgrid-arguments-help-parameter-active" dir="auto">A2:A100</span>, <span class="jfgrid-arguments-help-parameter" dir="auto">101</span> </span> <span class="jfgrid-arguments-paren">)</span> </div> </div> <div class="jfgrid-formula-help-content-detail"> <div class="jfgrid-arguments-help-section"> <div class="jfgrid-arguments-help-section-title jfgrid-arguments-help-parameter-name">摘要</div> <span class="jfgrid-arguments-help-parameter-content">${detail}</span> </div> </div> <div class="jfgrid-formula-help-content-param"> ${param} </div> </div> <div class="jfgrid-formula-help-foot"></div></div>',getrangeseleciton:function(){var e=window.getSelection(),r=$(e.anchorNode),t=e.anchorOffset;if(r.parent().is("span")&&0!=t){if(0==(a=$.trim(r.text())).length&&0<r.parent().prev().length){var i=r.parent().prev();return(a=$.trim(i.text())).substr(a.length-1,1),i}return a.substr(t-1,1),r.parent()}if(r.is("#jfgrid-rich-text-editor")||r.is("#jfgrid-functionbox-cell")){if(0==(a=$.trim(r.find("span").last().text())).length&&1<r.find("span").length){i=r.find("span");return a=$.trim(i.eq(i.length-2).text()),i}return r.find("span").last()}if((r.parent().is("#jfgrid-rich-text-editor")||r.parent().is("#jfgrid-functionbox-cell")||0==t)&&(0==t&&(r=r.parent()),0<r.prev().length)){var a;(a=$.trim(r.prev().text())).substr(a.length-1,1);return r.prev()}return null},searchFunctionPosition:function(e,r,t,i,a){var n=$(window).height(),o=$(window).width(),l=e.outerWidth(),d=e.outerHeight();null==a&&(a=!1);var f=i,s=t,s=o<t+l?t-l+r.outerWidth():t;n<i+d?f=i-d:(f=i+r.outerHeight(),a||e.html(e.find(".jfgrid-formula-search-item").get().reverse())),f<0&&(f=0),s<0&&(s=0),e.css({top:f,left:s}).show()},searchFunctionCell:null,searchFunction:function(e){var r=this.getrangeseleciton();if(null!=(this.searchFunctionCell=r)&&null!=e){var t=r.text().toUpperCase();if(/^[a-zA-Z]|[a-zA-Z_]+$/.test(t)){for(var i={f:[],s:[],t:[]},a=0,n=0;n<jfgrid.functionlist.length;n++){var o=jfgrid.functionlist[n],l=o.n;if(l==t?(i.f.unshift(o),a++):l.substr(0,t.length)==t?(i.s.unshift(o),a++):-1<l.indexOf(t)&&(i.t.unshift(o),a++),10<=a)break}var d,f,s,g=i.t.concat(i.s.concat(i.f));g.length<=0||(d=this.searchFunctionHTML(g),$("#jfgrid-formula-search-c").html(d).show(),$("#jfgrid-formula-help-c").hide(),s=(f=e.parent()).offset(),this.searchFunctionPosition($("#jfgrid-formula-search-c"),f,s.left,s.top))}}},searchFunctionEnter:function(e){var r=e.data("func");jfgrid.formula.searchFunctionCell.text(r).after('<span dir="auto" class="jfgrid-formula-text-color">(</span>'),jfgrid.formula.setCaretPosition(jfgrid.formula.searchFunctionCell.next().get(0),0,1),$("#jfgrid-formula-search-c").hide(),this.helpFunctionExe(jfgrid.formula.searchFunctionCell.closest("div"),jfgrid.formula.searchFunctionCell.next())},searchFunctionHTML:function(e){0==$("#jfgrid-formula-search-c").length&&($("body").append(this.searchHTML),$("#jfgrid-formula-search-c").on("mouseover",".jfgrid-formula-search-item",function(){$("#jfgrid-formula-search-c").find(".jfgrid-formula-search-item").removeClass("jfgrid-formula-search-item-active"),$(this).addClass("jfgrid-formula-search-item-active")}).on("mouseout",".jfgrid-formula-search-item",function(){}).on("click",".jfgrid-formula-search-item",function(){null!=jfgrid.formula.searchFunctionCell&&jfgrid.formula.searchFunctionEnter($(this))}));for(var r='<div data-func="${n}" class="jfgrid-formula-search-item ${class}"><div class="jfgrid-formula-search-func">${n}</div><div class="jfgrid-formula-search-detail">${a}</div></div>',t="",i=0;i<e.length;i++){var a=e[i];i==e.length-1?t+=jfgrid.replaceHtml(r,{class:"jfgrid-formula-search-item-active",n:a.n,a:a.a}):t+=jfgrid.replaceHtml(r,{class:"",n:a.n,a:a.a})}return t},functionlistPosition:{},helpFunction:function(e,r,t){var i=jfgrid.functionlist[this.functionlistPosition[$.trim(r).toUpperCase()]];if(null!=i){$("#jfgrid-formula-help-c .jfgrid-arguments-help-function-name").html(i.n),$("#jfgrid-formula-help-c .jfgrid-arguments-help-parameter-content").html(i.d);for(var a,n="",o="",l="",d=0;d<i.p.length;d++){var f=i.p[d],s=f.name,g=f.name;"y"==f.repeat&&(s+=", ...",g+='<span class="jfgrid-arguments-help-argument-info">...-可重复</span>'),"o"==f.require&&(s="["+s+"]",g+='<span class="jfgrid-arguments-help-argument-info">-[可选]</span>'),n+='<span class="jfgrid-arguments-help-parameter" dir="auto">'+s+"</span>, ",o+='<span class="jfgrid-arguments-help-parameter" dir="auto">'+f.example+"</span>, ",l+=jfgrid.replaceHtml('<div class="jfgrid-arguments-help-section"><div class="jfgrid-arguments-help-section-title">${param}</div><span class="jfgrid-arguments-help-parameter-content">${content}</span></div>',{param:g,content:f.detail})}n=n.substr(0,n.length-2),o=o.substr(0,o.length-2),$("#jfgrid-formula-help-c .jfgrid-formula-help-title .jfgrid-arguments-parameter-holder").html(n),$("#jfgrid-formula-help-c .jfgrid-arguments-help-formula .jfgrid-arguments-parameter-holder").html(o),$("#jfgrid-formula-help-c .jfgrid-formula-help-content-param").html(l),null==t?$("#jfgrid-formula-help-c .jfgrid-formula-help-title-formula .jfgrid-arguments-help-function-name").css("font-weight","bold"):($("#jfgrid-formula-help-c .jfgrid-formula-help-title-formula .jfgrid-arguments-help-function-name").css("font-weight","normal"),a=t>=i.p.length?i.p.length-1:t,$("#jfgrid-formula-help-c .jfgrid-formula-help-title .jfgrid-arguments-parameter-holder .jfgrid-arguments-help-parameter").removeClass("jfgrid-arguments-help-parameter-active"),$("#jfgrid-formula-help-c .jfgrid-formula-help-title .jfgrid-arguments-parameter-holder .jfgrid-arguments-help-parameter").eq(a).addClass("jfgrid-arguments-help-parameter-active"),$("#jfgrid-formula-help-c .jfgrid-arguments-help-formula .jfgrid-arguments-parameter-holder .jfgrid-arguments-help-parameter").removeClass("jfgrid-arguments-help-parameter-active"),$("#jfgrid-formula-help-c .jfgrid-arguments-help-formula .jfgrid-arguments-parameter-holder .jfgrid-arguments-help-parameter").eq(a).addClass("jfgrid-arguments-help-parameter-active"),$("#jfgrid-formula-help-c .jfgrid-formula-help-content-param .jfgrid-arguments-help-section").removeClass("jfgrid-arguments-help-parameter-active"),$("#jfgrid-formula-help-c .jfgrid-formula-help-content-param .jfgrid-arguments-help-section").eq(a).addClass("jfgrid-arguments-help-parameter-active"));var c=e.parent(),u=c.offset();this.searchFunctionPosition($("#jfgrid-formula-help-c"),c,u.left,u.top,!0)}},helpFunctionExe:function(e,r){if(0==$("#jfgrid-formula-help-c").length){$("body").after(this.helpHTML),$("#jfgrid-formula-help-c .jfgrid-formula-help-close").click(function(){$("#jfgrid-formula-help-c").hide()}),$("#jfgrid-formula-help-c .jfgrid-formula-help-collapse").click(function(){var e=$("#jfgrid-formula-help-c .jfgrid-formula-help-content");e.slideToggle(100,function(){var e=jfgrid.formula.rangeResizeTo.parent(),r=e.offset();jfgrid.formula.searchFunctionPosition($("#jfgrid-formula-help-c"),e,r.left,r.top,!0)}),e.is(":hidden")?$(this).html('<i class="fa fa-angle-up" aria-hidden="true"></i>'):$(this).html('<i class="fa fa-angle-down" aria-hidden="true"></i>')});for(var t=0;t<jfgrid.functionlist.length;t++)this.functionlistPosition[jfgrid.functionlist[t].n]=t}if(r){var i=r,a=(e.length,e.find("span")),n=r.index(),t=n;if(null!=i){var o=null,l=null;if(a.eq(t).is(".jfgrid-formula-text-func"))o=a.eq(t).text();else for(var d=null,f=[-1,-1];0<--t;)if((d=a.eq(t)).is(".jfgrid-formula-text-func")||$.trim(d.text()).toUpperCase()in this.functionlistPosition){o=d.text();for(var s=!(l=null),g=t;g<=n;g++)if(l=l||0,!(g>=f[0]&&g<=f[1])){if((d=a.eq(g)).is(".jfgrid-formula-text-rpar")){o=null,s=!(f=[t,g]);break}d.is(".jfgrid-formula-text-comma")&&l++}if(s)break}null!=o&&this.helpFunction(e,o,l)}}},rangeHightlightselected:function(e,r){var t,i=this.getrangeseleciton();$("#jfgrid-formula-search-c, #jfgrid-formula-help-c").hide(),$("#jfgrid-formula-functionrange .jfgrid-formula-functionrange-highlight .jfgrid-selection-copy-hc").css("opacity","0.03"),$("#jfgrid-formula-search-c, #jfgrid-formula-help-c").hide(),this.helpFunctionExe(e,i),0!=$(i).closest(".jfgrid-formula-functionrange-cell").length?(t=$(i).closest(".jfgrid-formula-functionrange-cell").attr("rangeindex"),$("#"+("jfgrid-formula-functionrange-highlight-"+t)).find(".jfgrid-selection-copy-hc").css({opacity:"0.13"})):this.searchFunction(e)},updatecell:function(e,r){var t=$("#jfgrid-rich-text-editor").text();jfgrid.formula.rangetosheet!=jfgrid.currentSheetIndex&&jfgrid.sheetmanage.changeSheetExec(jfgrid.formula.rangetosheet);var i=jfgrid.flowdata[e][r];if(jfgrid.func_methods.isRealNull(t)){if(null==i||jfgrid.func_methods.isRealNull(i.v))return void this.cancelNormalSelected()}else{if("object"==jfgrid.getObjType(i)&&(t==i.f||t==i.v||t==i.m))return void this.cancelNormalSelected();if(t==i)return void this.cancelNormalSelected()}"="==t.slice(0,1)&&1<t.length||"object"!=jfgrid.getObjType(i)||null==i.ct||null==i.ct.fa||"@"==i.ct.fa||jfgrid.func_methods.isRealNull(t)||(delete i.m,null!=i.f&&(delete i.f,delete i.spl)),window.jfgrid_getcelldata_cache=null;var a,n,o=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);"object"==jfgrid.getObjType(i)?("string"==jfgrid.getObjType(t)&&"="==t.slice(0,1)&&1<t.length?(a=this.execfunction(t,e,r,!0),(i=this.execFunctionGroupData[e][r]).f=a[2],4==a.length&&"sparklines"==a[3].type&&(delete i.m,delete i.v,n=a[3].data,"array"==jfgrid.getObjType(n)&&"object"!=jfgrid.getObjType(n[0])?i.v=n[0]:i.spl=a[3].data)):(this.delFunctionGroup(e,r),this.execFunctionGroup(e,r,t),delete(i=this.execFunctionGroupData[e][r]).f,delete i.spl),t=i):"string"==jfgrid.getObjType(t)&&"="==t.slice(0,1)&&1<t.length?(t={v:(a=this.execfunction(t,e,r,!0))[1],f:a[2]},4==a.length&&"sparklines"==a[3].type&&(n=a[3].data,"array"==jfgrid.getObjType(n)&&"object"!=jfgrid.getObjType(n[0])?t.v=n[0]:t.spl=a[3].data)):(this.delFunctionGroup(e,r),this.execFunctionGroup(e,r,t)),jfgrid.setcellvalue(e,r,o,t),this.cancelNormalSelected();var l=!1;if("2"==o[e][r].tb&&null!=o[e][r].v){var d=$.extend(!0,{},jfgrid.getjfgridfile()[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].config);null==d.rowlen&&(d.rowlen={});var f=$("#jfgridTableContentF").get(0).getContext("2d"),s=jfgrid.jfgridfontformat(o[e][r]);f.font=s;var g=19;null!=d.rowlen[e]&&(g=d.rowlen[e]);var c=jfgrid.getcellvalue(e,r,o).toString(),u=f.measureText(c).width,m=jfgrid.colLocationByIndex(r)[1]-jfgrid.colLocationByIndex(r)[0]-8;if(m<u){for(var h=[],j=1;j<=c.length;j++){var p=c.substring(h.join("").length,j),v=f.measureText(p).width;m<v?(h.push(c.substring(h.join("").length,j-1)),j-=2):v<=m&&j==c.length&&h.push(p)}g=jfgrid.menuButton.getTextSize("田",s)[1]*h.length}19!=g&&(d.rowlen[e]=g,l=!0)}l?jfgrid.jfrefreshgrid(o,[{row:[e,e],column:[r,r]}],d,null,l):jfgrid.jfrefreshgrid(o,[{row:[e,e],column:[r,r]}]),jfgridCellUpdate=[],this.execFunctionGroupData=null},cancelNormalSelected:function(){this.canceFunctionrangeSelected(),$("#jfgrid-formula-functionrange .jfgrid-formula-functionrange-highlight").remove(),$("#jfgrid-input-box").removeAttr("style"),$("#jfgrid-input-box-index").hide(),$("#jfgrid-wa-functionbox-cancel, #jfgrid-wa-functionbox-confirm").removeClass("jfgrid-wa-calculate-active"),jfgrid.formula.rangestart=!1,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1},canceFunctionrangeSelected:function(){$("#jfgrid-formula-functionrange-select").hide(),$("#jfgrid-row-count-show, #jfgrid-column-count-show").hide(),$("#jfgrid-formula-search-c, #jfgrid-formula-help-c").hide()},iscellformat:function(e){},iscelldata:function(e){var r=e.split("!"),t=1<r.length?r[1]:r[0],i=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(-1==t.indexOf(":")){var a=parseInt(t.replace(/[^0-9]/g,""))-1,n=jfgrid.jfgridABCatNum(t.replace(/[^A-Za-z]/g,""));return!(isNaN(a)||isNaN(n)||!t.toString().match(/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g))||(isNaN(a)&&isNaN(n),!1)}i=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,t=t.split(":");n=[];return(a=[])[0]=parseInt(t[0].replace(/[^0-9]/g,""))-1,a[1]=parseInt(t[1].replace(/[^0-9]/g,""))-1,!(a[0]>a[1])&&(n[0]=jfgrid.jfgridABCatNum(t[0].replace(/[^A-Za-z]/g,"")),n[1]=jfgrid.jfgridABCatNum(t[1].replace(/[^A-Za-z]/g,"")),!(n[0]>n[1])&&!(!t[0].toString().match(i)||!t[1].toString().match(i)))},operator:"==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",operatorjson:null,functionCopy:function(e,r,t){if(null==jfgrid.formula.operatorjson){for(var i=jfgrid.formula.operator.split("|"),a={},n=0;n<i.length;n++)a[i[n].toString()]=1;jfgrid.formula.operatorjson=a}null==r&&(r="down"),null==t&&(t=1),"="==e.substr(0,1)&&(e=e.substr(1));for(var o=e.split(""),n=0,l="",d="",f={bracket:0,comma:0,squote:0,dquote:0};n<o.length;){var s=o[n];if("("==s&&0==f.dquote)f.bracket+=1,0<l.length?d+=l+"(":d+="(",l="";else if(")"==s&&0==f.dquote)--f.bracket,d+=jfgrid.formula.functionCopy(l,r,t)+")",l="";else if('"'==s&&0==f.squote)0<f.dquote?(d+=l+'"',--f.dquote,l=""):(f.dquote+=1,l+='"');else if(","==s&&0==f.dquote)d+=jfgrid.formula.functionCopy(l,r,t)+",",l="";else if("&"==s&&0==f.dquote)0<l.length?(d+=jfgrid.formula.functionCopy(l,r,t)+"&",l=""):d+="&";else if(s in jfgrid.formula.operatorjson&&0==f.dquote){var g="";n+1<o.length&&(g=o[n+1]);var c=n-1,u=null;if(0<=c)for(;u=o[c--],0<=c&&" "==u;);s+g in jfgrid.formula.operatorjson?(0<l.length?(d+=jfgrid.formula.functionCopy(l,r,t)+s+g,l=""):d+=s+g,n++):!/[^0-9]/.test(g)&&"-"==s&&("("==u||null==u||","==u||" "==u||u in jfgrid.formula.operatorjson)?l+=s:0<l.length?(d+=jfgrid.formula.functionCopy(l,r,t)+s,l=""):d+=s}else l+=s;n==o.length-1&&(jfgrid.formula.iscelldata($.trim(l))?"down"==r?d+=jfgrid.formula.downparam($.trim(l),t):"up"==r?d+=jfgrid.formula.upparam($.trim(l),t):"left"==r?d+=jfgrid.formula.leftparam($.trim(l),t):"right"==r&&(d+=jfgrid.formula.rightparam($.trim(l),t)):d+=$.trim(l)),n++}return d},isfreezonFuc:function(e){var r=e.replace(/[^0-9]/g,""),t=e.replace(/[^A-Za-z]/g,""),i=e.substr(e.indexOf(r)-1,1),a=e.substr(e.indexOf(t)-1,1),n=[!1,!1];return"$"==i&&(n[0]=!0),"$"==a&&(n[1]=!0),n},setfreezonFuceExe:function(e){var r=parseInt(e.replace(/[^0-9]/g,"")),t=jfgrid.jfgridABCatNum(e.replace(/[^A-Za-z]/g,""));this.isfreezonFuc(e);return isNaN(r)||isNaN(t)?isNaN(r)?isNaN(t)?txt:"$"+jfgrid.jfgridchatatABC(t):"$"+r:"$"+jfgrid.jfgridchatatABC(t)+"$"+r},setfreezonFuc:function(e){var r,t,i,a,n,o,l,d,f,s,g=this.getrangeseleciton();this.iscelldata(g.text())&&(r=g.text(),t=window.getSelection().anchorOffset,a="",1<(i=r.split("!")).length?(s=i[1],a=i[0]+"!"):s=i[0],l=o="",l=-1==(n=s.indexOf(":"))?(o=a+this.setfreezonFuceExe(s)).length:(s=s.split(":"),n<t?(o=f=a+s[0]+":"+this.setfreezonFuceExe(s[1]),f.length):(o=f=(d=a+this.setfreezonFuceExe(s[0]))+":"+s[1],d.length)),g.text(a+o),this.setCaretPosition(g.get(0),0,l))},updateparam:function(e,r,t){var i,a=r.split("!"),n="";if(1<a.length?(i=a[1],n=a[0]+"!"):i=a[0],-1==i.indexOf(":")){var o=parseInt(i.replace(/[^0-9]/g,"")),l=jfgrid.jfgridABCatNum(i.replace(/[^A-Za-z]/g,"")),d=this.isfreezonFuc(i),f=d[0]?"$":"",s=d[1]?"$":"";return"u"!=e||d[0]?"r"!=e||d[1]?"l"!=e||d[1]?d[0]||(o+=t):l-=t:l+=t:o-=t,o[0]<0||l[0]<0?jfgrid.formula.error.r:isNaN(o)||isNaN(l)?isNaN(o)?isNaN(l)?r:n+s+jfgrid.jfgridchatatABC(l):n+f+o:n+s+jfgrid.jfgridchatatABC(l)+f+o}i=i.split(":");l=[];(o=[])[0]=parseInt(i[0].replace(/[^0-9]/g,"")),o[1]=parseInt(i[1].replace(/[^0-9]/g,""));var g=this.isfreezonFuc(i[0]);if(o[0]>o[1])return r;var c=this.isfreezonFuc(i[1]);if(l[0]=jfgrid.jfgridABCatNum(i[0].replace(/[^A-Za-z]/g,"")),l[1]=jfgrid.jfgridABCatNum(i[1].replace(/[^A-Za-z]/g,"")),l[0]>l[1])return r;var u=g[0]?"$":"",m=g[1]?"$":"",h=c[0]?"$":"",j=c[1]?"$":"";return"u"==e?(g[0]||(o[0]-=t),c[0]||(o[1]-=t)):"r"==e?(g[1]||(l[0]+=t),c[1]||(l[1]+=t)):"l"==e?(g[1]||(l[0]-=t),c[1]||(l[1]-=t)):(g[0]||(o[0]+=t),c[0]||(o[1]+=t)),o[0]<0||l[0]<0?jfgrid.formula.error.r:isNaN(l[0])&&isNaN(l[1])?n+u+o[0]+":"+h+o[1]:isNaN(o[0])&&isNaN(o[1])?n+m+jfgrid.jfgridchatatABC(l[0])+":"+j+jfgrid.jfgridchatatABC(l[1]):n+m+jfgrid.jfgridchatatABC(l[0])+u+o[0]+":"+j+jfgrid.jfgridchatatABC(l[1])+h+o[1]},downparam:function(e,r){return this.updateparam("d",e,r)},upparam:function(e,r){return this.updateparam("u",e,r)},leftparam:function(e,r){return this.updateparam("l",e,r)},rightparam:function(e,r){return this.updateparam("r",e,r)},functionStrChange:function(e,r,t,i,a,n){if(null==jfgrid.formula.operatorjson){for(var o=jfgrid.formula.operator.split("|"),l={},d=0;d<o.length;d++)l[o[d].toString()]=1;jfgrid.formula.operatorjson=l}"="==e.substr(0,1)&&(e=e.substr(1));for(var f=e.split(""),d=0,s="",g="",c={bracket:0,comma:0,squote:0,dquote:0};d<f.length;){var u=f[d];if("("==u&&0==c.dquote)c.bracket+=1,0<s.length?g+=s+"(":g+="(",s="";else if(")"==u&&0==c.dquote)--c.bracket,g+=jfgrid.formula.functionStrChange(s,r,t,i,a,n)+")",s="";else if('"'==u&&0==c.squote)0<c.dquote?(g+=s+'"',--c.dquote,s=""):(c.dquote+=1,s+='"');else if(","==u&&0==c.dquote)g+=jfgrid.formula.functionStrChange(s,r,t,i,a,n)+",",s="";else if("&"==u&&0==c.dquote)0<s.length?(g+=jfgrid.formula.functionStrChange(s,r,t,i,a,n)+"&",s=""):g+="&";else if(u in jfgrid.formula.operatorjson&&0==c.dquote){var m="";d+1<f.length&&(m=f[d+1]);var h=d-1,j=null;if(0<=h)for(;j=f[h--],0<=h&&" "==j;);u+m in jfgrid.formula.operatorjson?(0<s.length?(g+=jfgrid.formula.functionStrChange(s,r,t,i,a,n)+u+m,s=""):g+=u+m,d++):!/[^0-9]/.test(m)&&"-"==u&&("("==j||null==j||","==j||" "==j||j in jfgrid.formula.operatorjson)?s+=u:0<s.length?(g+=jfgrid.formula.functionStrChange(s,r,t,i,a,n)+u,s=""):g+=u}else s+=u;d==f.length-1&&(jfgrid.formula.iscelldata($.trim(s))?g+=jfgrid.formula.functionStrChange_range($.trim(s),r,t,i,a,n):g+=$.trim(s)),d++}return g},functionStrChange_range:function(e,r,t,i,a,n){var o,l,d,f,s,g=e.split("!"),c="";if(1<g.length?(o=g[1],c=g[0]+"!"):o=g[0],-1==o.indexOf(":")){l=d=parseInt(o.replace(/[^0-9]/g,""))-1,f=s=jfgrid.jfgridABCatNum(o.replace(/[^A-Za-z]/g,""));var u=this.isfreezonFuc(o),m=v=u[0]?"$":"",h=b=u[1]?"$":""}else{if(o=o.split(":"),l=parseInt(o[0].replace(/[^0-9]/g,""))-1,(d=parseInt(o[1].replace(/[^0-9]/g,""))-1)<l)return e;if(f=jfgrid.jfgridABCatNum(o[0].replace(/[^A-Za-z]/g,"")),(s=jfgrid.jfgridABCatNum(o[1].replace(/[^A-Za-z]/g,"")))<f)return e;var j=this.isfreezonFuc(o[0]);m=j[0]?"$":"",h=j[1]?"$":"";var p=this.isfreezonFuc(o[1]),v=p[0]?"$":"",b=p[1]?"$":""}if("del"==r){if("row"==t){if(a<=l&&d<=a+n-1)return jfgrid.formula.error.r;a+n-1<l?l-=n:a<=l&&(l=a),a+n-1<d?d-=n:a<=d&&(d=a-1),l<0&&(l=0),d<l&&(d=l)}else if("col"==t){if(a<=f&&s<=a+n-1)return jfgrid.formula.error.r;a+n-1<f?f-=n:a<=f&&(f=a),a+n-1<s?s-=n:a<=s&&(s=a-1),f<0&&(f=0),s<f&&(s=f)}return l==d&&f==s?isNaN(l)||isNaN(f)?isNaN(l)?isNaN(f)?e:c+h+jfgrid.jfgridchatatABC(f):c+m+(l+1):c+h+jfgrid.jfgridchatatABC(f)+m+(l+1):isNaN(f)&&isNaN(s)?c+m+(l+1)+":"+v+(d+1):isNaN(l)&&isNaN(d)?c+h+jfgrid.jfgridchatatABC(f)+":"+b+jfgrid.jfgridchatatABC(s):c+h+jfgrid.jfgridchatatABC(f)+m+(l+1)+":"+b+jfgrid.jfgridchatatABC(s)+v+(d+1)}if("add"==r)return"row"==t?"lefttop"==i?(a<=l&&(l+=n),a<=d&&(d+=n)):"rightbottom"==i&&(a<l&&(l+=n),a<d&&(d+=n)):"col"==t&&("lefttop"==i?(a<=f&&(f+=n),a<=s&&(s+=n)):"rightbottom"==i&&(a<f&&(f+=n),a<s&&(s+=n))),l==d&&f==s?isNaN(l)||isNaN(f)?isNaN(l)?isNaN(f)?e:c+h+jfgrid.jfgridchatatABC(f):c+m+(l+1):c+h+jfgrid.jfgridchatatABC(f)+m+(l+1):isNaN(f)&&isNaN(s)?c+m+(l+1)+":"+v+(d+1):isNaN(l)&&isNaN(d)?c+h+jfgrid.jfgridchatatABC(f)+":"+b+jfgrid.jfgridchatatABC(s):c+h+jfgrid.jfgridchatatABC(f)+m+(l+1)+":"+b+jfgrid.jfgridchatatABC(s)+v+(d+1)},israngeseleciton:function(e){if(null==jfgrid.formula.operatorjson){for(var r=jfgrid.formula.operator.split("|"),t={},i=0;i<r.length;i++)t[r[i].toString()]=1;jfgrid.formula.operatorjson=t}null==e&&(e=!1);var a=window.getSelection(),n=$(a.anchorNode),o=a.anchorOffset;if(n.parent().is("span")&&0!=o){var l="";if(0==(f=$.trim(n.text())).length&&0<n.parent().prev().length?(d=n.parent().prev(),l=(f=$.trim(d.text())).substr(f.length-1,1),this.rangeSetValueTo=d):(l=f.substr(o-1,1),this.rangeSetValueTo=n.parent()),e&&("("==l||","==l)||!e&&("("==l||","==l||"="==l||l in jfgrid.formula.operatorjson||"&"==l))return!0}else if(n.is("#jfgrid-rich-text-editor")||n.is("#jfgrid-functionbox-cell")){var d,f=$.trim(n.find("span").last().text());if(this.rangeSetValueTo=n.find("span").last(),0==f.length&&1<n.find("span").length&&(d=n.find("span"),f=$.trim(d.eq(d.length-2).text()),this.rangeSetValueTo=d),l=f.substr(f.length-1,1),e&&("("==l||","==l)||!e&&("("==l||","==l||"="==l||l in jfgrid.formula.operatorjson||"&"==l))return!0}else if((n.parent().is("#jfgrid-rich-text-editor")||n.parent().is("#jfgrid-functionbox-cell")||0==o)&&(0==o&&(n=n.parent()),0<n.prev().length)){l=(f=$.trim(n.prev().text())).substr(f.length-1,1);if(this.rangeSetValueTo=n.prev(),e&&("("==l||","==l)||!e&&("("==l||","==l||"="==l||l in jfgrid.formula.operatorjson||"&"==l))return!0}return!1},rangechangeindex:null,rangestart:!1,rangetosheet:null,rangeSetValueTo:null,func_selectedrange:{},rangeSetValue:function(selected,obj){var range=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,selected,this.rangetosheet),$editor;if(jfgrid.formula.rangestart||jfgrid.formula.rangedrag_column_start||jfgrid.formula.rangedrag_row_start)if($("#jfgrid-search-formula-parm").is(":visible")||$("#jfgrid-search-formula-parm-select").is(":visible")){$editor=$("#jfgrid-rich-text-editor"),$("#jfgrid-search-formula-parm-select-input").val(range),$("#jfgrid-search-formula-parm .parmBox").eq(jfgrid.formula.data_parm_index).find(".txt input").val(range);var txtdata=window.jfgrid_getcelldata(range).data;if(txtdata instanceof Array){for(var txtArr=[],i=0;i<txtdata.length;i++)for(var j=0;j<txtdata[i].length;j++)null==txtdata[i][j]?txtArr.push(null):txtArr.push(txtdata[i][j].v);$("#jfgrid-search-formula-parm .parmBox").eq(jfgrid.formula.data_parm_index).find(".val").text(" = {"+txtArr.join(",")+"}")}else $("#jfgrid-search-formula-parm .parmBox").eq(jfgrid.formula.data_parm_index).find(".val").text(" = {"+txtdata.v+"}");var isVal=!0,parmValArr=[],lvi=-1;if($("#jfgrid-search-formula-parm .parmBox").each(function(e,r){var t=$(r).find(".txt input").val();""==t&&"m"==$(r).find(".txt input").attr("data_parm_require")&&(isVal=!1),""!=t&&(lvi=e)}),-1==lvi)var functionHtmlTxt="="+$("#jfgrid-search-formula-parm .jfgrid-modal-dialog-title-text").text()+"()";else if(0==lvi)var functionHtmlTxt="="+$("#jfgrid-search-formula-parm .jfgrid-modal-dialog-title-text").text()+"("+$("#jfgrid-search-formula-parm .parmBox").eq(0).find(".txt input").val()+")";else{for(var j=0;j<=lvi;j++)parmValArr.push($("#jfgrid-search-formula-parm .parmBox").eq(j).find(".txt input").val());var functionHtmlTxt="="+$("#jfgrid-search-formula-parm .jfgrid-modal-dialog-title-text").text()+"("+parmValArr.join(",")+")"}var function_str=jfgrid.formula.functionHTMLGenerate(functionHtmlTxt),fp,result;$("#jfgrid-rich-text-editor").html(function_str),$("#jfgrid-functionbox-cell").html($("#jfgrid-rich-text-editor").html()),1==isVal&&(fp=$.trim(jfgrid.formula.functionParser($("#jfgrid-rich-text-editor").text())),result=eval(fp),$("#jfgrid-search-formula-parm .result span").text(result))}else{var currSelection=window.getSelection(),anchorOffset=currSelection.anchorNode,$editor=$(anchorOffset).closest("div"),$span=$editor.find("span[rangeindex='"+this.rangechangeindex+"']").html(range);jfgrid.formula.setCaretPosition($span.get(0),0,range.length)}else{var function_str='<span class="jfgrid-formula-functionrange-cell" rangeindex="'+this.functionHTMLIndex+'" dir="auto" style="color:'+jfgrid.jfcolor[this.functionHTMLIndex]+';">'+range+"</span>",$t=$(function_str).insertAfter(this.rangeSetValueTo);this.rangechangeindex=this.functionHTMLIndex,$editor=$(this.rangeSetValueTo).closest("div"),jfgrid.formula.setCaretPosition($editor.find("span[rangeindex='"+jfgrid.formula.rangechangeindex+"']").get(0),0,range.length),this.functionHTMLIndex++}"jfgrid-rich-text-editor"==$editor.attr("id")?$("#jfgrid-functionbox-cell").html($("#jfgrid-rich-text-editor").html()):$("#jfgrid-rich-text-editor").html($("#jfgrid-functionbox-cell").html())},rangedrag:function(e){var r=jfgrid.mouseposition(e.pageX,e.pageY),t=r[0]+$("#jfgrid-cell-main").scrollLeft(),i=r[1]+$("#jfgrid-cell-main").scrollTop(),a=jfgrid.rowLocation(i),n=a[1],o=a[0],l=a[2],d=jfgrid.colLocation(t),f=d[1],s=d[0],g=d[2],c=0,u=0,m=[],m=this.func_selectedrange.top>o?(c=o,u=this.func_selectedrange.top+this.func_selectedrange.height-o,[l,this.func_selectedrange.row[1]]):this.func_selectedrange.top==o?(c=o,u=this.func_selectedrange.top+this.func_selectedrange.height-o,[l,this.func_selectedrange.row[0]]):(c=this.func_selectedrange.top,u=n-this.func_selectedrange.top-1,[this.func_selectedrange.row[0],l]),h=0,j=0,p=[],p=this.func_selectedrange.left>s?(h=s,j=this.func_selectedrange.left+this.func_selectedrange.width-s,[g,this.func_selectedrange.column[1]]):this.func_selectedrange.left==s?(h=s,j=this.func_selectedrange.left+this.func_selectedrange.width-s,[g,this.func_selectedrange.column[0]]):(h=this.func_selectedrange.left,j=f-this.func_selectedrange.left-1,[this.func_selectedrange.column[0],g]);m[0]=jfgrid.freezen.changeFreezenIndex(m[0],"h"),m[1]=jfgrid.freezen.changeFreezenIndex(m[1],"h"),p[0]=jfgrid.freezen.changeFreezenIndex(p[0],"v"),p[1]=jfgrid.freezen.changeFreezenIndex(p[1],"v");var v,b=jfgrid.menuButton.mergeMoveMain(p,m,this.func_selectedrange,c,u,h,j);null!=b&&(p=b[0],m=b[1],c=b[2],u=b[3],h=b[4],j=b[5]),this.func_selectedrange.row=m,this.func_selectedrange.column=p,this.func_selectedrange.left_move=h,this.func_selectedrange.width_move=j,this.func_selectedrange.top_move=c,this.func_selectedrange.height_move=u,jfgrid.jfgrid_count_show(h,c,j,u,m,p),$("#jfgrid-formula-functionrange-select").css({left:h,width:j,top:c,height:u}).show(),$("#jfgrid-ifFormulaGenerator-multiRange-dialog").is(":visible")?(v=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,{row:m,column:p},jfgrid.currentSheetIndex),$("#jfgrid-ifFormulaGenerator-multiRange-dialog input").val(v)):this.rangeSetValue({row:m,column:p}),setTimeout(function(){jfgridautoadjustmousedown=1},1),jfgrid.freezen.scrollFreezen(m,p)},rangedrag_column_start:!1,rangedrag_row_start:!1,rangedrag_column:function(e){var r=jfgrid.mouseposition(e.pageX,e.pageY),t=r[0]+$("#jfgrid-cell-main").scrollLeft(),i=(r[1],$("#jfgrid-cell-main").scrollTop(),jfgrid.getvisibledatarow()),a=i.length-1,n=i[a],o=jfgrid.colLocation(t),l=o[1],d=o[0],f=o[2],s=0,g=0,c=[];(c=this.func_selectedrange.left>d?(s=d,g=this.func_selectedrange.left+this.func_selectedrange.width-d,[f,this.func_selectedrange.column[1]]):this.func_selectedrange.left==d?(s=d,g=this.func_selectedrange.left+this.func_selectedrange.width-d,[f,this.func_selectedrange.column[0]]):(s=this.func_selectedrange.left,g=l-this.func_selectedrange.left-1,[this.func_selectedrange.column[0],f]))[0]=jfgrid.freezen.changeFreezenIndex(c[0],"v"),c[1]=jfgrid.freezen.changeFreezenIndex(c[1],"v");var u=jfgrid.menuButton.mergeMoveMain(c,[0,a],this.func_selectedrange,0,n-1,s,g);null!=u&&(c=u[0],s=u[4],g=u[5]),this.func_selectedrange.column=c,this.func_selectedrange.left_move=s,this.func_selectedrange.width_move=g,jfgrid.jfgrid_count_show(s,0,g,n-1,[0,a],c),this.rangeSetValue({row:[null,null],column:c}),$("#jfgrid-formula-functionrange-select").css({left:s,width:g,top:0,height:n-1}).show(),setTimeout(function(){jfgridautoadjustmousedown=1},1),jfgrid.freezen.scrollFreezen([0,a],c)},rangedrag_row:function(e){var r=jfgrid.mouseposition(e.pageX,e.pageY),t=(r[0],$("#jfgrid-cell-main").scrollLeft(),r[1]+$("#jfgrid-cell-main").scrollTop()),i=jfgrid.rowLocation(t),a=i[1],n=i[0],o=i[2],l=jfgrid.getvisibledatacolumn(),d=l.length-1,f=l[d],s=0,g=0,c=[];(c=this.func_selectedrange.top>n?(s=n,g=this.func_selectedrange.top+this.func_selectedrange.height-n,[o,this.func_selectedrange.row[1]]):this.func_selectedrange.top==n?(s=n,g=this.func_selectedrange.top+this.func_selectedrange.height-n,[o,this.func_selectedrange.row[0]]):(s=this.func_selectedrange.top,g=a-this.func_selectedrange.top-1,[this.func_selectedrange.row[0],o]))[0]=jfgrid.freezen.changeFreezenIndex(c[0],"h"),c[1]=jfgrid.freezen.changeFreezenIndex(c[1],"h");var u=jfgrid.menuButton.mergeMoveMain([0,d],c,this.func_selectedrange,s,g,0,f-1);null!=u&&(c=u[1],s=u[2],g=u[3]),this.func_selectedrange.row=c,this.func_selectedrange.top_move=s,this.func_selectedrange.height_move=g,jfgrid.jfgrid_count_show(0,s,f-1,g,c,[0,d]),this.rangeSetValue({row:c,column:[null,null]}),$("#jfgrid-formula-functionrange-select").css({left:0,width:f-1,top:s,height:g}).show(),setTimeout(function(){jfgridautoadjustmousedown=1},1),jfgrid.freezen.scrollFreezen(c,[0,d])},rangedragged:function(){},rangeResizeObj:null,rangeResize:null,rangeResizeIndex:null,rangeResizexy:null,rangeResizeWinH:null,rangeResizeWinW:null,rangeResizeTo:null,rangeResizeDraging:function(e,r,t,i,a,n,o,l){var d=$("#jfgrid-scrollbar-y").scrollTop(),f=$("#jfgrid-scrollbar-x").scrollLeft(),s=jfgrid.mouseposition(e.pageX,e.pageY),g=s[0]+f,c=s[1]+d,u=jfgrid.rowLocation(c),m=u[1],h=u[0],j=(u[2],jfgrid.colLocation(g)),p=j[1],v=j[0];j[2];if(g<0||c<0)return!1;r.height(),r.width();var b=h-t[1],_=v-t[0],w=t[5],y=t[3],x=t[4],C=t[2];if("lt"==i||"lb"==i){if(t[0]+t[2]<v)return;x=v,C=t[2]-_,x>t[2]+t[4]-p+v?(x=t[2]+t[4]-p+v,C=t[2]-(t[2]+t[4]-p+v-t[0])):x<=0&&(x=0,C=t[2]+t[0])}if("rt"==i||"rb"==i){if(t[6]-t[2]>p)return;(C=t[2]+p-t[6])<p-v-1?C=p-v-1:o-x<=C&&(C=o-x)}if("lt"==i||"rt"==i){if(t[1]+t[3]<h)return;w=h,y=t[3]-b,w>t[3]+t[5]-m+h?(w=t[3]+t[5]-m+h,y=t[3]-(t[3]+t[5]-m+h-t[1])):w<=0&&(w=0,y=t[3]+t[1])}if("lb"==i||"rb"==i){if(t[7]-t[3]>m)return;(y=t[3]+m-t[7])<m-h-1?y=m-h-1:l-w<=y&&(y=l-w)}var T=jfgrid.formula.rangeResizeIndex,I={top:w,left:x,height:y,width:C},R=this.getSelectedFromRange(I),k=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,R,this.rangetosheet);jfgrid.formula.rangeResizeTo.find("span[rangeindex='"+T+"']").html(k);jfgrid.jfgridRangeLast(jfgrid.formula.rangeResizeTo[0]),r.css(I).data("range",R)},getSelectedFromRange:function(e){var r=e.top+2,t=e.top+e.height-2,i=e.left+2,a=e.left+e.width-2,n={row:[],column:[]},o=jfgrid.rowLocation(r),l=(o[1],o[0],o[2]),d=jfgrid.colLocation(i),f=(d[1],d[0],d[2]);n.row[0]=l,n.column[0]=f;(o=jfgrid.rowLocation(t))[1],o[0];l=o[2],(d=jfgrid.colLocation(a))[1],d[0],f=d[2];return n.row[1]=l,n.column[1]=f,n},rangeResizeDragged:function(e,r,t,i,a,n){jfgrid.formula.rangeResize=null,$("#jfgrid-formula-functionrange-highlight-"+jfgrid.formula.rangeResizeIndex).find(".jfgrid-selection-copy-hc").css("opacity",.03)},rangeMovexy:null,rangeMove:!1,rangeMoveObj:null,rangeMoveIndex:null,rangeMoveRangedata:null,rangeMoveDraging:function(e,r,t,i,a,n){var o=jfgrid.mouseposition(e.pageX,e.pageY),l=$("#jfgrid-scrollbar-x").scrollLeft(),d=$("#jfgrid-scrollbar-y").scrollTop(),f=o[0]+l,s=o[1]+d,g=$(window).height()+d-a-n,c=$(window).width()+l,u=jfgrid.rowLocation(s),m=u[1],h=u[0],j=u[2],p=jfgrid.colLocation(f),v=p[1],b=p[0],_=p[2],w=r[0],y=r[1],x=t.row[0]-w+j,C=t.row[1]-w+j,T=t.column[0]-y+_,I=t.column[1]-y+_;(x<0||s<0)&&(x=0,C=t.row[1]-t.row[0]),(T<0||f<0)&&(T=0,I=t.column[1]-t.column[0]);var R=jfgrid.getvisibledatarow();(C>=R[R.length-1]||g<s)&&(x=R.length-1-t.row[1]+t.row[0],C=R.length-1);var k=jfgrid.getvisibledatacolumn();(I>=k[k.length-1]||c<f)&&(T=k.length-1-t.column[1]+t.column[0],I=k.length-1);var b=T-1==-1?0:k[T-1],v=k[I],h=x-1==-1?0:R[x-1],m=R[C],S=jfgrid.formula.rangeMoveIndex,A={left:b,width:v-b-2,top:h,height:m-h-2,display:"block"},F=this.getSelectedFromRange(A),N=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,F,this.rangetosheet);jfgrid.formula.rangeResizeTo.find("span[rangeindex='"+S+"']").html(N);jfgrid.jfgridRangeLast(jfgrid.formula.rangeResizeTo[0]),jfgrid.formula.rangeMoveRangedata=F,i.css(A)},rangeMoveDragged:function(e){jfgrid.formula.rangeMove=!1,$("#jfgrid-formula-functionrange-highlight-"+jfgrid.formula.rangeMoveIndex).data("range",jfgrid.formula.rangeMoveRangedata).find(".jfgrid-selection-copy-hc").css("opacity",.03)},functionHTMLIndex:0,functionRangeIndex:null,findrangeindex:function(e,r){var t=/<span.*?>/g,i=e.replace(t,""),a=r.replace(t,""),i=i.split("</span>"),a=a.split("</span>");i.pop(),a.pop();var n=jfgrid.formula.functionRangeIndex,o=0,l=(a.length>i.length?i.length:a.length,a.length),d=i.length;if(l==d){var f=a[o=n[0]],s=i[o];if(null==f)return a.length<=o?n=[a.length-1,a.length-1]:i.length<=o&&(n=[i.length-1,i.length-1]),n;if(f.length==s.length)return null!=a[o+1]&&null!=i[o+1]&&a[o+1].length<i[o+1].length&&(n[0]=n[0]+1,n[1]=1),n;if(f.length>s.length)return null!=f&&null!=i[o+1]&&'"'==i[o+1].substr(0,1)&&(-1<f.indexOf("{")||-1<f.indexOf("}"))&&(n[0]=n[0]+1,n[1]=1),n;if(f.length<s.length)return n[1]>s.length&&(n[1]=s.length),n}else{if(d<l){var g,f=a[o=n[0]];if(null==(s=i[o])){-1<i[o-1].indexOf("{")?(n[0]=n[0]-1,g=i[o-1].search("{"),n[1]=n[1]+g):(n[0]=0,n[1]=0)}else{if(f.length==s.length)return null==i[o+1]||'"'!=i[o+1].substr(0,1)&&"{"!=i[o+1].substr(0,1)&&"}"!=i[o+1].substr(0,1)?null!=f&&2<f.length&&'"'==f.substr(0,1)&&'"'==f.substr(f.length-1,1)||(null!=i[o]&&'")'==i[o]||null!=i[o]&&'"}'==i[o]||null!=i[o]&&"{)"==i[o]?n[1]=1:n[1]=s.length):(n[0]=n[0]+1,n[1]=1),n;if(f.length>s.length)return null==i[o+1]||'"'!=i[o+1].substr(0,1)&&"{"!=i[o+1].substr(0,1)&&"}"!=i[o+1].substr(0,1)||(n[0]=n[0]+1,n[1]=1),n;if(f.length<s.length)return n}return n}if(l<d){var f=a[o=n[0]],s=i[o];if(null==f)n[0]=i.length-1,n[1]=null!=s?s.length:1;else{if(f.length==s.length)return null==a[o+1]||'"'!=a[o+1].substr(0,1)&&"{"!=a[o+1].substr(0,1)&&"}"!=a[o+1].substr(0,1)?null==i[o+1]||'"'!=i[o+1].substr(0,1)||"{"!=i[o+1].substr(0,1)&&"}"!=i[o+1].substr(0,1)?null!=s&&'"'==s.substr(0,1)&&'"'==s.substr(s.length-1,1)&&'"'==f.substr(0,1)&&")"==f.substr(f.length-1,1)||null!=s&&"{"==s.substr(0,1)&&"}"==s.substr(s.length-1,1)&&"{"==f.substr(0,1)&&")"==f.substr(f.length-1,1)?n[1]=s.length:(n[0]=n[0]+d-l,i.length>a.length?n[1]=i[o+1].length:n[1]=1):(n[0]=n[0]+1,n[1]=1):n[1]=s.length,n;if(f.length>s.length)return null!=f&&'"'==f.substr(0,1)?n[1]=s.length:null!=i[o+1]&&/{.*?}/.test(i[o+1])?(n[0]=n[0]+1,n[1]=i[o+1].length):null!=f&&'"'==i[o+1].substr(0,1)&&(-1<f.indexOf("{")||-1<f.indexOf("}"))?(n[0]=n[0]+1,n[1]=1):null!=f&&(-1<f.indexOf("{")||-1<f.indexOf("}"))||(n[0]=n[0]+d-l-1,n[1]=i[o-1].length),n;if(f.length<s.length)return n}return n}}return null},setCaretPosition:function(e,r,t){var i=e,a=document.createRange(),n=window.getSelection();a.setStart(i.childNodes[r],t),a.collapse(!0),n.removeAllRanges(),n.addRange(a),i.focus()},functionRange:function(e,r,t){var i,a;window.getSelection?(i=window.getSelection(),null==(a=jfgrid.formula.findrangeindex(r,t))?(i.selectAllChildren(e.get(0)),i.collapseToEnd()):this.setCaretPosition(e.find("span").get(a[0]),0,a[1])):document.selection&&(jfgrid.formula.functionRangeIndex.moveToElementText(e),jfgrid.formula.functionRangeIndex.collapse(!1),jfgrid.formula.functionRangeIndex.select())},functionInputHanddler:function(e,r,a){var n,o,l,d;jfgrid.jfgridConfigsetting.editMode||(n=e,l=(o=r).html(),d=o.text(),setTimeout(function(){var e,r,t,i=o.text();0<i.length&&"="==i.substr(0,1)&&229!=a&&(i=jfgrid.formula.functionHTMLGenerate(i),l=jfgrid.formula.functionHTMLGenerate(d),window.getSelection?(e=window.getSelection(),$(e.anchorNode).is("div")?(r=$("#jfgrid-rich-text-editor span").length,jfgrid.formula.functionRangeIndex=[r-1,$("#jfgrid-rich-text-editor").find("span").eq(r-1).text().length]):jfgrid.formula.functionRangeIndex=[$(e.anchorNode).parent().index(),e.anchorOffset]):(t=document.selection.createRange(),jfgrid.formula.functionRangeIndex=t),o.html(i),jfgrid.formula.functionRange(o,i,l),jfgrid.formula.canceFunctionrangeSelected(),jfgrid.formula.createRangeHightlight()),jfgrid.formula.rangestart=!1,jfgrid.formula.rangedrag_column_start=!1,jfgrid.formula.rangedrag_row_start=!1,n.html(i),jfgrid.formula.rangeHightlightselected(o,a)},1))},functionHTMLGenerate:function(e){return 0==e.length||"="!=e.substr(0,1)?e:(this.functionHTMLIndex=0,'<span dir="auto" class="jfgrid-formula-text-color">=</span>'+this.functionHTML(e))},functionHTML:function(e){if(null==jfgrid.formula.operatorjson){for(var r=jfgrid.formula.operator.split("|"),t={},i=0;i<r.length;i++)t[r[i].toString()]=1;jfgrid.formula.operatorjson=t}"="==e.substr(0,1)&&(e=e.substr(1));for(var a=e.split(""),i=0,n="",o="",l={bracket:0,comma:0,squote:0,dquote:0,braces:0};i<a.length;){var d,f,s,g,c=a[i];if("("==c&&0==l.dquote&&0==l.braces)l.bracket+=1,0<n.length?o+='<span dir="auto" class="jfgrid-formula-text-func">'+n+'</span><span dir="auto" class="jfgrid-formula-text-lpar">(</span>':o+='<span dir="auto" class="jfgrid-formula-text-lpar">(</span>',n="";else if(")"==c&&0==l.dquote&&0==l.braces)--l.bracket,o+=jfgrid.formula.functionHTML(n)+'<span dir="auto" class="jfgrid-formula-text-rpar">)</span>',n="";else if("{"==c&&0==l.dquote)n+="{",l.braces+=1;else if("}"==c&&0==l.dquote)n+="}",--l.braces;else if('"'==c&&0==l.squote)n=(0<l.dquote?(0<n.length?o+=n+'"</span>':o+='"</span>',--l.dquote):(l.dquote+=1,0<n.length?o+=jfgrid.formula.functionHTML(n)+'<span dir="auto" class="jfgrid-formula-text-string">"':o+='<span dir="auto" class="jfgrid-formula-text-string">"'),"");else if(","==c&&0==l.dquote&&0==l.braces)o+=jfgrid.formula.functionHTML(n)+'<span dir="auto" class="jfgrid-formula-text-comma">,</span>',n="";else if("&"==c&&0==l.dquote&&0==l.braces)0<n.length?(o+=jfgrid.formula.functionHTML(n)+'<span dir="auto" class="jfgrid-formula-text-calc">&</span>',n=""):o+='<span dir="auto" class="jfgrid-formula-text-calc">&</span>';else if(c in jfgrid.formula.operatorjson&&0==l.dquote&&0==l.braces){var u="";i+1<a.length&&(u=a[i+1]);var m=i-1,h=null;if(0<=m)for(;h=a[m--],0<=m&&" "==h;);c+u in jfgrid.formula.operatorjson?(0<n.length?(o+=jfgrid.formula.functionHTML(n)+'<span dir="auto" class="jfgrid-formula-text-calc">'+c+u+"</span>",n=""):o+='<span dir="auto" class="jfgrid-formula-text-calc">'+c+u+"</span>",i++):!/[^0-9]/.test(u)&&"-"==c&&("("==h||null==h||","==h||" "==h||h in jfgrid.formula.operatorjson)?n+=c:0<n.length?(o+=jfgrid.formula.functionHTML(n)+'<span dir="auto" class="jfgrid-formula-text-calc">'+c+"</span>",n=""):o+='<span dir="auto" class="jfgrid-formula-text-calc">'+c+"</span>"}else n+=c;i==a.length-1&&(jfgrid.formula.iscelldata($.trim(n))?(o+='<span class="jfgrid-formula-functionrange-cell" rangeindex="'+this.functionHTMLIndex+'" dir="auto" style="color:'+jfgrid.jfcolor[this.functionHTMLIndex]+';">'+n+"</span>",this.functionHTMLIndex++):0<l.dquote?o+=n+"</span>":-1==n.indexOf("</span>")&&0<n.length&&((d=/{.*?}/).test($.trim(n))?(f=d.exec(n)[0],g="",0<(s=n.search(d))&&(g+='<span dir="auto" class="jfgrid-formula-text-color">'+n.substr(0,s)+"</span>"),g+='<span dir="auto" style="color:#959a05" class="jfgrid-formula-text-array">'+f+"</span>",s+f.length<n.length&&(g+='<span dir="auto" class="jfgrid-formula-text-color">'+n.substr(s+f.length,n.length)+"</span>"),o+=g):o+='<span dir="auto" class="jfgrid-formula-text-color">'+n+"</span>")),i++}return o},getfunctionParam:function(e){if(null==jfgrid.formula.operatorjson){for(var r=jfgrid.formula.operator.split("|"),t={},i=0;i<r.length;i++)t[r[i].toString()]=1;jfgrid.formula.operatorjson=t}"="==e.substr(0,1)&&(e=e.substr(1));for(var a=e.split(""),i=0,n="",o={bracket:0,comma:0,squote:0,dquote:0,compare:0},l=null,d=[],f=[];i<a.length;){var s=a[i];if("("==s&&0==o.dquote)0<n.length&&0==f.length?(l=n.toUpperCase(),f.push(1),n=""):0==f.length?(f.push(0),n=""):(f.push(0),n+=s);else if(")"==s&&0==o.dquote){f.pop();0==f.length?(d.push(n),n=""):n+=s}else if('"'==s)n+='"',0<o.dquote?(--o.dquote,n=""):o.dquote+=1;else if(","==s&&0==o.dquote)f.length<=1?(d.push(n),n=""):n+=",";else if(s in jfgrid.formula.operatorjson&&0==o.dquote){var g="";i+1<a.length&&(g=a[i+1]);var c=i-1,u=null;if(0<=c)for(;u=a[c--],0<=c&&" "==u;);!/[^0-9]/.test(g)&&"-"==s&&("("==u||null==u||","==u||" "==u||u in jfgrid.formula.operatorjson)?0==o.dquote?n+=$.trim(s):n+=s:n=""}else 0==o.dquote?n+=$.trim(s):n+=s;i++}return{fn:l,param:d}},functionParser1:function(e){if(null==jfgrid.formula.operatorjson){for(var r=jfgrid.formula.operator.split("|"),t={},i=0;i<r.length;i++)t[r[i].toString()]=1;jfgrid.formula.operatorjson=t}"="==e.substr(0,1)&&(e=e.substr(1));for(var a=e.split(""),i=0,n="",o="",l={bracket:0,comma:0,squote:0,dquote:0,compare:0};i<a.length;){var d,f=a[i];"("==f&&0==l.dquote?(l.bracket+=1,0<n.length?o+="jfgrid_function."+n.toUpperCase()+".f(":o+="(",n=""):")"==f&&0==l.dquote?(--l.bracket,o+=jfgrid.formula.functionParser(n),1==l.compare?(o+="))",l.compare=0):o+=")",n=""):'"'==f&&0==l.squote?0<l.dquote?(o+=n+'"',--l.dquote,n=""):(l.dquote+=1,n+='"'):","==f&&0==l.dquote?(o+=jfgrid.formula.functionParser(n),1==l.compare?(o+="),",l.compare=0):o+=",",n=""):f in jfgrid.formula.operatorjson&&0==l.dquote?(d="",i+1<a.length&&(d=a[i+1]),f+d in jfgrid.formula.operatorjson?(0<n.length?(l.compare=1,o+="jfgrid_compareWith("+jfgrid.formula.functionParser(n)+",'"+f+d+"', ",n=""):o+=f+d,i++):0<n.length?(l.compare=1,o+="jfgrid_compareWith("+jfgrid.formula.functionParser(n)+",'"+f+"', ",n=""):o+=f):n+=f,i==a.length-1&&(jfgrid.formula.iscelldata($.trim(n))?o+="jfgrid_getcelldata('"+$.trim(n)+"')":o+=$.trim(n)),i++}return o},calPostfixExpression:function(e){if(0==e.length)return"";for(var r=[],t=e.length-1;0<=t;t--){var i,a,n=e[t];n in jfgrid.formula.operatorjson?(i=r.pop(),a="jfgrid_compareWith("+r.pop()+",'"+n+"', "+i+")",r.push(a)):r.push(n)}return 0<r.length?r[0]:""},checkBracketNum:function(e){var r=e.match(/\(/g),t=e.match(/\)/g),i=e.match(/(['"])(?:(?!\1).)*?\1/g);bra_tr_txt=e.match(/(['"])(?:(?!\1).)*?\1/g);var a=0,n=0;null!=r&&(a+=r.length),null!=t&&(n+=t.length);var o=0,l=0;if(null!=i)for(var d=0;d<i.length;d++){var f=i[d].match(/\(/g);null!=f&&(o+=f.length)}if(null!=bra_tr_txt)for(d=0;d<bra_tr_txt.length;d++){var s=bra_tr_txt[d].match(/\)/g);null!=s&&(l+=s.length)}return(a-=o)==(n-=l)},operatorPriority:{"^":0,"%":1,"*":1,"/":1,"+":2,"-":2},functionParser:function(e){if(null==jfgrid.formula.operatorjson){for(var r=jfgrid.formula.operator.split("|"),t={},i=0;i<r.length;i++)t[r[i].toString()]=1;jfgrid.formula.operatorjson=t}"="==e.substr(0,1)&&(e=e.substr(1));for(var a=e.split(""),i=0,n="",o="",l={bracket:0,comma:0,squote:0,dquote:0,compare:0,braces:0},d=[],f=[],s=[];i<a.length;){var g=a[i];if("("==g&&0==l.dquote&&0==l.braces)0<n.length&&0==s.length?(o+="jfgrid_function."+n.toUpperCase()+".f(",s.push(1),n=""):0==s.length?(o+="(",s.push(0),n=""):(s.push(0),n+=g);else if(")"==g&&0==l.dquote&&0==l.braces){s.pop();0==s.length?(o+=jfgrid.formula.functionParser(n)+")",n=""):n+=g}else if("{"==g&&0==l.dquote)n+="{",l.braces+=1;else if("}"==g&&0==l.dquote)n+="}",--l.braces;else if('"'==g)n+='"',0<l.dquote?--l.dquote:l.dquote+=1;else if(","==g&&0==l.dquote&&0==l.braces)s.length<=1?(o+=jfgrid.formula.functionParser(n)+",",n=""):n+=",";else if(g in jfgrid.formula.operatorjson&&0==l.dquote&&0==l.braces){var c="",t=jfgrid.formula.operatorPriority;if(i+1<a.length&&(c=a[i+1]),g+c in jfgrid.formula.operatorjson){if(0==s.length){if(0<$.trim(n).length?f.unshift(jfgrid.formula.functionParser($.trim(n))):0<$.trim(o).length&&f.unshift($.trim(o)),d[0]in jfgrid.formula.operatorjson)for(var u=t[d[0]];0<d.length&&null!=u;)f.unshift(d.shift()),u=t[d[0]];d.unshift(g+c),n=o=""}else n+=g+c;i++}else if(0==s.length){if(0<$.trim(n).length?f.unshift(jfgrid.formula.functionParser($.trim(n))):0<$.trim(o).length&&f.unshift($.trim(o)),d[0]in jfgrid.formula.operatorjson){u=null==(u=t[d[0]])?1e3:u;for(var m=null==(m=t[g])?1e3:m;0<d.length&&u<=m;)f.unshift(d.shift()),u=null==(u=t[d[0]])?1e3:u}d.unshift(g),n=o=""}else n+=g}else 0==l.dquote?n+=$.trim(g):n+=g;if(i==a.length-1){var h,j,p,v="";if(jfgrid.formula.iscelldata($.trim(n))?v="jfgrid_getcelldata('"+$.trim(n)+"')":(n=$.trim(n),(h=/{.*?}/).test(n)&&'"'!=n.substr(0,1)&&'"'!=n.substr(n.length-1,1)?(j=h.exec(n)[0],0<(p=n.search(h))&&(v+=n.substr(0,p)),v+="jfgrid_getarraydata('"+j+"')",p+j.length<n.length&&(v+=n.substr(p+j.length,n.length))):v=n),0<v.length&&f.unshift(v),0<d.length)for(0<o.length&&(f.unshift(o),o="");0<d.length;)f.unshift(d.shift());0<f.length?o=jfgrid.formula.calPostfixExpression(f):o+=v}i++}return o},addFunctionGroup:function(e,r,t,i){null==i&&(i=jfgrid.currentSheetIndex);var a=jfgrid.getjfgridfile(),n=a[jfgrid.sheetmanage.getSheetIndex(i)];null==n.calcChain&&(n.calcChain=[]);var o={r:e,c:r,index:i,func:t};n.calcChain.push(o),jfgrid.server.saveParam("fc",i,JSON.stringify(o),{op:"add",pos:n.calcChain.length-1}),jfgrid.setjfgridfile(a)},getFunctionGroup:function(e){null==e&&(e=jfgrid.currentSheetIndex);var r=jfgrid.getjfgridfile()[jfgrid.sheetmanage.getSheetIndex(e)];return null==r.calcChain?[]:r.calcChain},updateFunctionGroup:function(e,r,t,i){null==i&&(i=jfgrid.currentSheetIndex);var a=jfgrid.getjfgridfile(),n=a[jfgrid.sheetmanage.getSheetIndex(i)].calcChain;if(null!=n)for(var o=0;o<n.length;o++){var l=n[o];if(l.r==e&&l.c==r&&l.index==i){n[o].func=t,jfgrid.server.saveParam("fc",i,JSON.stringify(l),{op:"update",pos:o});break}}jfgrid.setjfgridfile(a)},insertUpdateFunctionGroup:function(e,r,t,i){if(null==i&&(i=jfgrid.currentSheetIndex),null!=t){var a=jfgrid.getjfgridfile(),n=a[jfgrid.sheetmanage.getSheetIndex(i)],o=n.calcChain;null==o&&(o=[]);for(var l=0;l<o.length;l++){var d=o[l];if(d.r==e&&d.c==r&&d.index==i)return d.func=t,void jfgrid.server.saveParam("fc",i,JSON.stringify(d),{op:"update",pos:l})}var f={r:e,c:r,index:i,func:t};o.push(f),n.calcChain=o,jfgrid.server.saveParam("fc",i,JSON.stringify(f),{op:"add",pos:n.calcChain.length-1}),jfgrid.setjfgridfile(a)}else this.delFunctionGroup(e,r,i)},isFunctionRangeSave:!1,isFunctionRange:function(e,r,t){if(null==jfgrid.formula.operatorjson){for(var i=jfgrid.formula.operator.split("|"),a={},n=0;n<i.length;n++)a[i[n].toString()]=1;jfgrid.formula.operatorjson=a}"="==e.substr(0,1)&&(e=e.substr(1));for(var o=e.split(""),n=0,l="",d="",f={bracket:0,comma:0,squote:0,dquote:0},s=jfgrid.getjfgridfile(),g=null==s[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].dynamicArray_compute?{}:s[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)].dynamicArray_compute;n<o.length;){var c,u=o[n];if("("==u&&0==f.dquote?(f.bracket+=1,0<l.length?d+="jfgrid_function."+l.toUpperCase()+".f(":d+="(",l=""):")"==u&&0==f.dquote?(--f.bracket,d+=jfgrid.formula.isFunctionRange(l,r,t)+")",l=""):","==u&&0==f.dquote?(d+=jfgrid.formula.isFunctionRange(l,r,t)+",",l=""):u in jfgrid.formula.operatorjson&&0==f.dquote?(c="",n+1<o.length&&(c=o[n+1]),u+c in jfgrid.formula.operatorjson?(0<l.length?(d+=jfgrid.formula.isFunctionRange(l,r,t)+u+c,l=""):d+=u+c,n++):0<l.length?(d+=jfgrid.formula.isFunctionRange(l,r,t)+u,l=""):d+=u):l+=u,n==o.length-1&&jfgrid.formula.iscelldata($.trim(l)))if(null!=r&&null!=t){var m=this.getcellrange($.trim(l)),h=m.row,j=m.column;if(r+"_"+t in g){for(var p=!1,v=h[0];v<=h[1];v++)for(var b=j[0];b<=j[1];b++)v+"_"+b in g&&g[v+"_"+b].r==r&&g[v+"_"+b].c==t&&(p=!0);this.isFunctionRangeSave=p?this.isFunctionRangeSave||!0:this.isFunctionRangeSave||!1}else r>=h[0]&&r<=h[1]&&t>=j[0]&&t<=j[1]?this.isFunctionRangeSave=this.isFunctionRangeSave||!0:this.isFunctionRangeSave=this.isFunctionRangeSave||!1}else{1<$.trim(l).split("!").length?this.isFunctionRangeSave=this.isFunctionRangeSave||!0:this.isFunctionRangeSave=this.isFunctionRangeSave||!1}n++}return d},execvertex:{},execFunctionGroupData:null,execFunctionExist:null,execFunctionGroup:function(origin_r,origin_c,value,index,data){null==data&&(data=jfgrid.flowdata),this.execFunctionGroupData=$.extend(!0,[],data),null!=value&&jfgrid.setcellvalue(origin_r,origin_c,this.execFunctionGroupData,value),null==index&&(index=jfgrid.currentSheetIndex);var group=this.getFunctionGroup(index),vertex1={},stack=[],count=0;if(this.execvertex={},null==this.execFunctionExist)for(var jfgridfile=jfgrid.getjfgridfile(),i=0;i<group.length;i++){var item=group[i],cell=jfgridfile[jfgrid.sheetmanage.getSheetIndex(item.index)].data[item.r][item.c];null!=cell&&null!=cell.f&&cell.f==item.func[2]&&(item instanceof Object||(item=eval("("+item+")")),item.color="w",item.parent=null,item.chidren={},item.times=0,vertex1["r"+item.r.toString()+"c"+item.c.toString()]=item,this.isFunctionRangeSave=!1,null!=origin_r&&null!=origin_c?this.isFunctionRange(item.func[2],origin_r,origin_c):this.isFunctionRange(item.func[2]),this.isFunctionRangeSave&&(stack.push(item),this.execvertex["r"+item.r.toString()+"c"+item.c.toString()]=item,count++))}else for(var x=0;x<this.execFunctionExist.length;x++){var cell=this.execFunctionExist[x];if(!("r"+cell.r.toString()+"c"+cell.c.toString()in vertex1))for(var i=0;i<group.length;i++){var item=group[i];item.color="w",item.parent=null,item.chidren={},item.times=0,vertex1["r"+item.r.toString()+"c"+item.c.toString()]=item,this.isFunctionRangeSave=!1,this.isFunctionRange(item.func[2],cell.r,cell.c),this.isFunctionRangeSave&&(stack.push(item),this.execvertex["r"+item.r.toString()+"c"+item.c.toString()]=item,count++)}}for(var x=0,x1=0;0<stack.length;){var u=stack.shift(),v;for(var name in vertex1){u.r==vertex1[name].r&&u.c==vertex1[name].c||(this.isFunctionRangeSave=!1,this.isFunctionRange(vertex1[name].func[2],u.r,u.c),this.isFunctionRangeSave&&(v=vertex1[name],name in this.execvertex||(stack.push(v),this.execvertex[name]=v),count++,this.execvertex[name].chidren["r"+u.r.toString()+"c"+u.c.toString()]=1))}}this.groupValuesRefreshData=[];for(var i=0;i<count;)for(var name in this.execvertex){var u=this.execvertex[name];"w"==u.color?this.functionDFS(u):"b"==u.color&&i++}this.execFunctionExist=null},functionDFS:function(u){for(var chd in u.color="g",u.times+=1,u.chidren){var v=this.execvertex[chd];"w"==v.color&&(v.parent="r"+u.r.toString()+"c"+u.c.toString(),this.functionDFS(v))}u.color="b",window.jfgrid_getcelldata_cache=null;var v=jfgrid.formula.execfunction(u.func[2],u.r,u.c),value=this.execFunctionGroupData[u.r][u.c],fp,sparklines;null==value&&(value={}),value.v=v[1],value.f=v[2],null!=value.spl&&(window.jfgridCurrentRow=u.r,window.jfgridCurrentColumn=u.c,window.jfgridCurrentFunction=this.execFunctionGroupData[u.r][u.c].f,fp=$.trim(jfgrid.formula.functionParser(this.execFunctionGroupData[u.r][u.c].f)),sparklines=eval(fp),value.spl=sparklines),this.groupValuesRefreshData.push({r:u.r,c:u.c,v:value,i:jfgrid.currentSheetIndex}),this.execFunctionGroupData[u.r][u.c]=value},groupValuesRefreshData:[],groupValuesRefresh:function(){if(0<this.groupValuesRefreshData.length){for(var e=0;e<this.groupValuesRefreshData.length;e++){var r=this.groupValuesRefreshData[e];r.i==jfgrid.currentSheetIndex&&(jfgrid.setcellvalue(r.r,r.c,jfgrid.flowdata,r.v),jfgrid.server.saveParam("v",jfgrid.currentSheetIndex,r.v,{r:r.r,c:r.c}))}jfgrid.editor.webWorkerFlowDataCache(jfgrid.flowdata)}},delFunctionGroup:function(e,r,t){null==t&&(t=jfgrid.currentSheetIndex);var i=jfgrid.getjfgridfile(),a=i[jfgrid.sheetmanage.getSheetIndex(t)].calcChain;if(null!=a)for(var n=0;n<a.length;n++){var o=a[n];if(o.r==e&&o.c==r&&o.index==t){a.splice(n,1),jfgrid.server.saveParam("fc",t,null,{op:"del",pos:n});break}}jfgrid.setjfgridfile(i)},execfunction1:function(txt,r,c,isrefresh){var fp=$.trim(this.functionParser(txt)),funcf=fp.match(/jfgrid_function/g),funcg=fp.match(/jfgrid_getcelldata/g),funcc=fp.match(/jfgrid_compareWith/g),funclen=0;null==isrefresh&&(isrefresh=!1),null!=funcf&&(funclen+=funcf.length),null!=funcg&&(funclen+=funcg.length),null!=funcc&&(funclen+=funcc.length);var quota1=fp.match(/\(/g),quota2=fp.match(/\)/g),quotalen=0;if(null!=quota1&&(quotalen+=quota1.length),null!=quota2&&(quotalen+=quota2.length),"jfgrid_function."!=fp.substr(0,16)&&"jfgrid_compareWith"!=fp.substr(0,18)||funclen==quotalen/2||(fp+=")","jfgrid_function."==fp.substr(0,16)&&(txt+=")"),this.functionHTMLIndex=0,$("#jfgrid-functionbox-cell").html('<span dir="auto" class="jfgrid-formula-text-color">=</span>'+this.functionHTML(txt))),!this.testFunction(txt,fp))return jfgrid.tooltip.info("提示","公式存在错误"),[!1,this.error.n,txt];var result=null;window.jfgridCurrentRow=r,window.jfgridCurrentColumn=c,window.jfgridCurrentFunction=txt;try{result=eval(fp)}catch(e){var err=e;err=jfgrid.formula.errorInfo(err),result=[jfgrid.formula.error.n,err]}return result instanceof Array?result=result[0]:result instanceof Object&&(result=result.data,result instanceof Array&&(result=result[0])),window.jfgridCurrentRow=null,window.jfgridCurrentColumn=null,window.jfgridCurrentFunction=null,"jfgrid_getcelldata("==fp.substr(0,19)&&(result instanceof Array?result=result.join(","):result instanceof Object&&(result=result.v)),null!=r&&null!=c&&(isrefresh&&this.execFunctionGroup(r,c,result),this.insertUpdateFunctionGroup(r,c,[!0,result,txt])),[!0,result,txt]},execfunction:function(txt,r,c,isrefresh,notInsertFunc){if(-1<txt.indexOf(this.error.r))return[!1,this.error.r,txt];this.checkBracketNum(txt)||(txt+=")");var fp=$.trim(this.functionParser(txt));if("jfgrid_function."!=fp.substr(0,16)&&"jfgrid_compareWith"!=fp.substr(0,18)||(this.functionHTMLIndex=0),!this.testFunction(txt,fp)||""==fp)return jfgrid.tooltip.info("提示","公式存在错误"),[!1,this.error.n,txt];var result=null;window.jfgridCurrentRow=r,window.jfgridCurrentColumn=c,window.jfgridCurrentFunction=txt;var sparklines=null,isErr,jfgridfile,file,dynamicArray,result;try{if(-1<fp.indexOf("jfgrid_getcelldata"))for(var funcg=fp.split("jfgrid_getcelldata('"),i=1;i<funcg.length;i++){var funcgStr=funcg[i].split("')")[0],funcgRange=jfgrid.formula.getcellrange(funcgStr);if(funcgRange.row[0]<0||funcgRange.column[0]<0)return[!0,jfgrid.formula.error.r,txt];if(funcgRange.sheetIndex==jfgrid.currentSheetIndex&&r>=funcgRange.row[0]&&r<=funcgRange.row[1]&&c>=funcgRange.column[0]&&c<=funcgRange.column[1])return jfgrid.jfgridConfigsetting.editMode?alert("公式不可引用其本身的单元格"):jfgrid.tooltip.info("公式不可引用其本身的单元格，会导致计算结果不准确",""),[!1,0,txt]}result=eval(fp),-1<fp.indexOf("SPLINES")&&(sparklines=result,result="")}catch(e){var err=e;err=jfgrid.formula.errorInfo(err),result=[jfgrid.formula.error.n,err]}return"object"==jfgrid.getObjType(result)&&null!=result.startCell&&(result="array"==jfgrid.getObjType(result.data)?jfgrid.formula.error.v:null==result.data||jfgrid.func_methods.isRealNull(result.data.v)?0:result.data.v),"array"==jfgrid.getObjType(result)&&(isErr=!1,"array"!=jfgrid.getObjType(result[0])&&2==result.length&&(isErr=jfgrid.func_methods.valueIsError(result[0])),result=isErr?result[0]:"array"==jfgrid.getObjType(result[0])&&1==result.length&&1==result[0].length?result[0][0]:(jfgridfile=jfgrid.getjfgridfile(),file=jfgridfile[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)],dynamicArray=null==file.dynamicArray?[]:file.dynamicArray,dynamicArray.push({r:r,c:c,f:txt,data:result}),file.dynamicArray=dynamicArray,jfgrid.setjfgridfile(jfgridfile),"")),window.jfgridCurrentRow=null,window.jfgridCurrentColumn=null,window.jfgridCurrentFunction=null,null!=r&&null!=c&&(isrefresh&&this.execFunctionGroup(r,c,result),notInsertFunc||this.insertUpdateFunctionGroup(r,c,[!0,result,txt])),sparklines?[!0,result,txt,{type:"sparklines",data:sparklines}]:[!0,result,txt]},testFunction:function(e,r){return"="==e.substr(0,1)},functionResizeData:{},functionResizeStatus:!1,functionResizeTimeout:null,data_parm_index:0},jfgrid.functionlist=[{n:"SUMIF",t:0,d:"对范围中符合指定条件的值求和。",a:"对范围中符合指定条件的值求和。",m:[2,3],p:[{name:"范围",detail:"要根据条件进行检测的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件",detail:"要应用于范围的模式或测试条件。\n\n如果范围包含的是要检测的文本，则条件必须为字符串。条件可以包含通配符，包括用于匹配单个字符的?或用于匹配零个或连续多个字符的*。要匹配问号星号本身，请在该字符前面加上波浪号(~)前缀（即~?和~*）。字符串条件必须用引号括起来。函数会检查范围中的每个单元格与条件是否相等或匹配（如果使用了通配符）。\n\n如果范围包含的是要检测的数字，则条件可以是字符串也可以是数字。如果给定的条件是一个数字，则检查范围中的每个单元格是否等于条件。另外，条件也可能是包含数字的字符串（也将对其进行相等检测），或者带有以下前缀的数字：=（检查是否相等）、>（检查范围单元格的值是否大于条件值）或<（检查范围单元格的值是否小于条件值）",example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"求和范围",detail:"要求和的范围（如果与范围不同）。",example:"B1:B10",require:"o",repeat:"n",type:"range"}]},{n:"TAN",t:0,d:"返回已知角度的正切值。",a:"返回已知角度的正切值。",m:[1,1],p:[{name:"角度",detail:"要求其正切值的角度，以弧度表示。",example:"45*PI()/180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TANH",t:0,d:"返回给定实数的双曲正切值。",a:"返回给定实数的双曲正切值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲正切值的实数。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CEILING",t:0,d:"将数值向上取整为最接近的指定因数的倍数。",a:"将数值向上取整为最接近的指定因数的倍数。",m:[2,2],p:[{name:"值",detail:"要向上舍入的数值。",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"因数",detail:"要将值舍入到此数的整数倍。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN",t:0,d:"返回数值的反正切值，以弧度表示。",a:"返回数值的反正切值",m:[1,1],p:[{name:"值",detail:"要计算其反正切值的数值。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ASINH",t:0,d:"返回数值的反双曲正弦值。",a:"返回数值的反双曲正弦值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲正弦值的数值。",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ABS",t:0,d:"返回数值的绝对值。",a:"返回数值的绝对值。",m:[1,1],p:[{name:"value",detail:"要返回其绝对值的数。",example:"-2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOS",t:0,d:"返回数值的反余弦值，以弧度表示。",a:"返回数值的反余弦值",m:[1,1],p:[{name:"值",detail:"要计算其反余弦值的数值。必须介于-1和1之间，包括两端值。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ACOSH",t:0,d:"返回数值的反双曲余弦值。",a:"返回数值的反双曲余弦值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲余弦值的数值。必须大于等于1。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTINOMIAL",t:0,d:"返回参数和的阶乘除以各参数阶乘的乘积后得到的值。",a:"返回参数和的阶乘除以各参数阶乘的乘积后得到的值。",m:[1,255],p:[{name:"值1",detail:"用于计算的第一项数值或范围。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"用于计算的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"ATANH",t:0,d:"返回数值的反双曲正切值。",a:"返回数值的反双曲正切值。",m:[1,1],p:[{name:"值",detail:"要计算其反双曲正切值的数值。必须介于-1和1之间（不包括-1和1）。",example:"0.9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ATAN2",t:0,d:"以弧度为单位返回 x 轴与从原点 (0,0) 到指定坐标点 (`x`,`y`) 之间连线的夹角。",a:"以弧度为单位返回 x 轴与从原点 (0,0) 到指定坐标点 (`x`,`y`) 之间连线的夹角。",m:[2,2],p:[{name:"x",detail:"要计算其与x轴夹角大小的线段的终点x坐标。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"y",detail:"要计算其与x轴夹角大小的线段的终点y坐标。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTBLANK",t:1,d:"返回给定范围内的空单元格数。",a:"返回给定范围内的空单元格数。",m:[1,1],p:[{name:"范围",detail:"要统计空白单元格数量的范围。",example:"A2:C100",require:"m",repeat:"n",type:"range"}]},{n:"COSH",t:0,d:"返回给定实数的双曲余弦值。",a:"返回给定实数的双曲余弦值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲余弦值的实数值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"INT",t:0,d:"将数值向下取整为小于或等于该数的最接近的整数。",a:"将数值向下取整为小于或等于该数的最接近的整数。",m:[1,1],p:[{name:"值",detail:"要向下取整为最接近的整数的数值。",example:"99.44",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISEVEN",t:0,d:"检查所提供的数值是否为偶数。",a:"检查所提供的数值是否为偶数。",m:[1,1],p:[{name:"值",detail:"要验证其是否为偶数的数值。\n\n如果值为偶数或指向包含偶数的单元格的引用，ISEVEN将返回TRUE，否则返回FALSE。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ISODD",t:0,d:"检查所提供的数值是否为奇数。",a:"检查所提供的数值是否为奇数。",m:[1,1],p:[{name:"值",detail:"要验证其是否为奇数的数值。\n\n如果值为奇数或指向包含奇数的单元格，ISODD将返回TRUE，否则返回FALSE。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LCM",t:0,d:"返回一个或多个整数的最小公倍数。",a:"返回一个或多个整数的最小公倍数。",m:[1,255],p:[{name:"值1",detail:"要在求最小公倍数数的计算中检查其因数的第一项数值或范围。",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"[可选] - 在求最小公倍数时要考虑其因数的其他数值或范围。",example:"3",require:"o",repeat:"y",type:"rangeall"}]},{n:"LN",t:0,d:"返回数值以 e（欧拉数）为底的对数。",a:"返回数值以 e（欧拉数）为底的对数。",m:[1,1],p:[{name:"值",detail:"要以 e 为底数计算其对数的值。\n\n值必须为正数。",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOG",t:0,d:"根据指定底数返回数字的对数。",a:"根据指定底数返回数字的对数。",m:[1,2],p:[{name:"值",detail:"想要计算其对数的正实数。",example:"128",require:"m",repeat:"n",type:"rangenumber"},{name:"底数",detail:"[可选] - 对数的底数。",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"LOG10",t:0,d:"返回数值以10为底的对数。",a:"返回数值以10为底的对数。",m:[1,1],p:[{name:"值",detail:"要计算其以10为底的对数的数值。\n\n值必须为正值。",example:"100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MOD",t:0,d:"返回两数相除的余数, 结果的符号与除数相同。",a:"返回两数相除的余数。",m:[2,2],p:[{name:"被除数",detail:"要将其相除以得到余数的数值。",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"除数",detail:"用于除其他数的数值。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MROUND",t:0,d:"将数值取整为另一整数最接近的整数倍。",a:"将数值取整为另一整数最接近的整数倍。",m:[2,2],p:[{name:"值",detail:"要取整为另一整数最接近的整数倍的数值。",example:"21",require:"m",repeat:"n",type:"rangenumber"},{name:"因数",detail:"值将取此因数的整数倍。",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ODD",t:0,d:"将数值向上取整为最接近的奇整数。",a:"将数值向上取整为最接近的奇整数。",m:[1,1],p:[{name:"值",detail:"要向上取整的数值，取整值为大于此值的最接近的奇数。\n\n如果值为负数，则将其取整为绝对值大于该值的相邻负奇数。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMSQ",t:0,d:"返回一组数值和/或单元格的平方总和。",a:"返回一组数值和/或单元格的平方总和。",m:[1,255],p:[{name:"值1",detail:"要将其平方相加的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 要将其平方与值1的平方相加的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMBIN",t:0,d:"给定集合中的对象总数和要选择的对象数量，返回共有多少种不同选择方式。",a:"给定集合中的对象总数和要选择的对象数量",m:[2,2],p:[{name:"n",detail:"要从中进行选择的对象集合的大小。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"要选择的对象数量。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUM",t:0,d:"返回一组数值和/或单元格的总和。",a:"返回一组数值和/或单元格的总和。",m:[1,255],p:[{name:"值1",detail:"要相加的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"[可选] - 要相加的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SUBTOTAL",t:0,d:"使用指定的汇总函数，返回一系列纵向单元格的分类汇总。",a:"使用指定的汇总函数",m:[2,256],p:[{name:"函数代码",detail:"用于计算分类汇总的函数。\n\n1代表AVERAGE\n\n2代表COUNT\n\n3代表COUNTA\n\n4代表MAX\n\n5代表MIN\n\n6代表PRODUCT\n\n7代表STDEV\n\n8代表STDEVP\n\n9代表SUM\n\n10代表VAR\n\n11代表VARP\n\n通过在这些2位代码前附加10（对于1位代码）或1（对于2位代码），可以将隐藏值忽略。例如，102代表忽略隐藏单元格的COUNT，而110则代表忽略隐藏值的VAR。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"范围1",detail:"要计算分类汇总的第一个范围。",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"范围2",detail:"[可选] - 要计算分类汇总的其他范围。",example:"B2:B8",require:"o",repeat:"y",type:"range"}]},{n:"ASIN",t:0,d:"返回数值的反正弦值，以弧度表示。",a:"返回数值的反正弦值",m:[1,1],p:[{name:"值",detail:"要计算其反正弦值的数值。必须介于-1和1之间，包括两端值。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUNTIF",t:1,d:"返回范围内满足某个条件的单元格的数量。",a:"返回范围内满足某个条件的单元格的数量。",m:[2,2],p:[{name:"范围",detail:"要根据条件进行检测的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件",detail:"要应用于范围的模式或测试条件。\n\n如果范围包含的是要检测的文本，则条件必须为字符串。条件可以包含通配符，包括用于匹配单个字符的?或用于匹配零个或连续多个字符的*。要匹配问号星号本身，请在该字符前面加上波浪号(~)前缀（即~?和~*）。字符串条件必须用引号括起来。函数会检查范围中的每个单元格与条件是否相等或匹配（如果使用了通配符）。\n\n如果范围包含的是要检测的数字，则条件可以是字符串也可以是数字。如果给定的条件是一个数字，则检查范围中的每个单元格是否等于条件。另外，条件也可能是包含数字的字符串（也将对其进行相等检测），或者带有以下前缀的数字：=、>、>=、<或<=，这些条件将分别用于检查范围中的单元格是否等于、大于、大于等于、小于、小于等于条件值。",example:'">20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"RADIANS",t:0,d:"将以度表示的角度值转换为弧度。",a:"将以度表示的角度值转换为弧度。",m:[1,1],p:[{name:"角度",detail:"要从度转换为弧度的角度。",example:"180",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RAND",t:0,d:"返回一个介于0和1之间（包括0但不包括1）的随机数。",a:"返回一个介于0和1之间（包括0但不包括1）的随机数。",m:[0,0],p:[]},{n:"COUNTUNIQUE",t:0,d:"计算一列指定值和范围中不重复数值的个数。",a:"计算一列指定值和范围中不重复数值的个数。",m:[1,255],p:[{name:"值1",detail:"要检查其是否唯一的第一个值或范围。",example:"A1:C100",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"[可选] - 要检查是否唯一的其他值或范围。",example:"1",require:"o",repeat:"n",type:"rangeall"}]},{n:"DEGREES",t:0,d:"将以弧度表示的角度值转换为度。",a:"将以弧度表示的角度值转换为度。",m:[1,1],p:[{name:"角度",detail:"要从弧度转换为度的角度。",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ERFC",t:9,d:"返回数值的互补高斯误差函数。",a:"返回数值的互补高斯误差函数。",m:[1,1],p:[{name:"z",detail:"要为其计算互补高斯误差函数的数值。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EVEN",t:0,d:"将数值向上取整为最接近的偶整数。",a:"将数值向上取整为最接近的偶整数。",m:[1,1],p:[{name:"值",detail:"要向上取整的数值，取整值为大于此值的最接近的偶数。\n\n如果值为负数，则将其取整为绝对值大于该值的相邻负偶数。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EXP",t:0,d:"返回欧拉数 e (~2.718) 的指定次幂。",a:"返回欧拉数 e (~2.718) 的指定次幂。",m:[1,1],p:[{name:"指数",detail:"指定e的自乘幂次值。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACT",t:0,d:"返回数值的阶乘。",a:"返回数值的阶乘。",m:[1,1],p:[{name:"值",detail:"要计算并返回其阶乘的数字或对数字（所在单元格）的引用。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FACTDOUBLE",t:0,d:"返回数值的“双阶乘”。",a:"返回数值的“双阶乘”。",m:[1,1],p:[{name:"值",detail:"要计算并返回其双阶乘的数字或对数字（所在单元格）的引用。",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PI",t:0,d:"返回带有14位小数的 PI 值。",a:"返回带有14位小数的 PI 值。",m:[0,0],p:[]},{n:"FLOOR",t:0,d:"将数值向下取整为指定因数的最接近的整数倍。",a:"将数值向下取整为指定因数的最接近的整数倍。",m:[2,2],p:[{name:"值",detail:"要向下舍入为因数的最接近整数倍的数值。",example:"23.25",require:"m",repeat:"n",type:"rangenumber"},{name:"因数",detail:"要将值舍入到此数的整数倍。\n\n因数不得为0。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GCD",t:0,d:"返回一个或多个整数的最大公约数。",a:"返回一个或多个整数的最大公约数。",m:[1,255],p:[{name:"值1",detail:"要在查找最大公约数的计算中检查其因数的第一项数值或范围。",example:"A2:A5",require:"m",repeat:"n",type:"rangeall"},{name:"值2",detail:"[可选] - 在求最大公约数时要考虑其因数的其他数值或范围。",example:"96",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANDBETWEEN",t:0,d:"返回介于两个整数之间（包括这两个整数）的随机数。",a:"返回介于两个整数之间（包括这两个整数）的随机数。",m:[2,2],p:[{name:"下界",detail:"随机值范围的下界。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"上界",detail:"随机值范围的上界。",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUND",t:0,d:"将数字四舍五入到指定的位数。",a:"将数字四舍五入到指定的位数。",m:[2,2],p:[{name:"值",detail:"要四舍五入的数字。",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"位数",detail:"要进行四舍五入运算的位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDDOWN",t:0,d:"朝着零的方向将数字进行向下舍入。",a:"朝着零的方向将数字进行向下舍入。",m:[2,2],p:[{name:"值",detail:"需要向下舍入的任意实数。",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"位数",detail:"要通过舍入达到的小数位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ROUNDUP",t:0,d:"朝着远离 0（零）的方向将数字进行向上舍入。",a:"朝着远离 0（零）的方向将数字进行向上舍入。",m:[2,2],p:[{name:"值",detail:"要将其舍入为位数位数字的值，始终向上舍入。",example:"99.44",require:"m",repeat:"n",type:"rangenumber"},{name:"位数",detail:"要通过舍入达到的小数位数。\n\n位数可以取负值，在这种情况下会将值的小数点左侧部分舍入到指定的位数。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SERIESSUM",t:0,d:"给定参数 x、n、m 和 a，返回幂级数的和 a1xn + a2x(n+m) + ... + aix(n+(i-1)m)，其中 i 为范围 a 中的项数。",a:"给定参数 x、n、m 和 a",m:[4,4],p:[{name:"x",detail:"幂级数的输入值。随相应的近似类型而变，有可能为角度、指数或其他一些值。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"在幂级数中x的初始自乘幂次。",example:"0",require:"m",repeat:"n",type:"rangenumber"},{name:"m",detail:"x的幂次中的附加增量。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"a",detail:"包含幂级数系数的数组或范围。",example:"{FACT(0)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIGN",t:0,d:"给定输入数值，如果为负返回-1；如果为正返回1；如果为零则返回0。",a:"给定输入数值",m:[1,1],p:[{name:"值",detail:"要返回其符号的数值。",example:"-42",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SIN",t:0,d:"给定角度（以弧度表示），返回其正弦值。",a:"给定角度（以弧度表示）",m:[1,1],p:[{name:"角度",detail:"要返回其正弦值的角度，以弧度表示。",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SINH",t:0,d:"返回给定实数的双曲正弦值。",a:"返回给定实数的双曲正弦值。",m:[1,1],p:[{name:"值",detail:"要计算其双曲正弦值的实数值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRT",t:0,d:"返回一个正数的正平方根。",a:"返回一个正数的正平方根。",m:[1,1],p:[{name:"值",detail:"要计算其正平方根的数值。\n\n值必须为正数；如果为负，SQRT 将返回 #NUM! 错误。",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SQRTPI",t:0,d:"返回 PI 与给定正数乘积的正平方根。",a:"返回 PI 与给定正数乘积的正平方根。",m:[1,1],p:[{name:"值",detail:"要将其与 PI 相乘并返回该乘积的平方根的数值\n\n值必须为正数；如果为负数，SQRTPI 将返回 #NUM! 错误。",example:"9",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GAMMALN",t:1,d:"返回指定伽玛函数的以 e（欧拉数）为底的对数。",a:"返回指定伽玛函数的以 e（欧拉数）为底的对数。",m:[1,1],p:[{name:"值",detail:"伽玛函数的输入值。返回的将是伽玛 (值) 的自然对数。\n\n值必须为正数。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COS",t:0,d:"返回给定角度的余弦值（角度以弧度表示）。",a:"返回给定角度的余弦值（角度以弧度表示）。",m:[1,1],p:[{name:"角度",detail:"要取其余弦值的角度，以弧度表示。",example:"PI()",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRUNC",t:0,d:"截除指定有效位之外的部分，取数据的指定有效位。",a:"截除指定有效位之外的部分",m:[1,2],p:[{name:"值",detail:"要截取的数据。",example:"3.141592654",require:"m",repeat:"n",type:"rangenumber"},{name:"位数",detail:"[可选 - 默认值为0] - 小数点右侧要保留的有效位数。\n\n如果位数大于值中的有效位数，则将“值”原样返回。\n\n位数可以取负值，在这种情况下会将小数点左侧指定位数的值更改为零。小数点右侧的所有位数都会被舍弃。如果值的所有位都被更改为零，则TRUNC会返回0。",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUOTIENT",t:0,d:"返回以一个数除以另一个数所得的结果，不包含余数。",a:"返回以一个数除以另一个数所得的结果",m:[2,2],p:[{name:"被除数",detail:"要被除的数值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"除数",detail:"用于除其他数的数值。\n\n除数不得为0。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POWER",t:0,d:"返回数值的指定次幂。",a:"返回数值的指定次幂。",m:[2,2],p:[{name:"底数",detail:"要计算其指数次幂的数值。\n\n如果底数为负，则指数必须为整数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"指数",detail:"指定底数的自乘幂次值。",example:"0.5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMIFS",t:0,d:"根据多项条件返回范围之和。",a:"根据多项条件返回范围之和。",m:[3,257],p:[{name:"求和范围",detail:"要对其求和的范围。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件范围1",detail:"要在哪个范围内检查条件1。",example:" B1:B10",require:"m",repeat:"n",type:"range"},{name:"条件1",detail:"要应用于条件范围1的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"条件范围2, 条件2...",detail:"[ 可选 ] - 要检查的其他范围和条件。",example:" C1:C10",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTIFS",t:1,d:"根据多项条件返回范围中的单元格数量。",a:"根据多项条件返回范围中的单元格数量。",m:[2,256],p:[{name:"条件范围1",detail:"要在哪个范围内检查条件1。",example:"A1:A10",require:"m",repeat:"n",type:"range"},{name:"条件1",detail:"要应用于条件范围1的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"条件范围2, 条件2...",detail:"[ 可选 ] - 要检查的其他范围和条件，可重复。",example:" B1:B10",require:"o",repeat:"y",type:"rangeall"}]},{n:"PRODUCT",t:0,d:"返回将一组数相乘所得的结果。",a:"返回将一组数相乘所得的结果。",m:[1,255],p:[{name:"乘数1",detail:"用于计算乘积的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"乘数2 ... 乘数30",detail:"[可选] - 要相乘的其他数值。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HARMEAN",t:1,d:"计算数据集的调和平均值。",a:"计算数据集的调和平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"HYPGEOMDIST",t:1,d:"返回超几何分布。 如果已知样本量、总体成功次数和总体大小，则 HYPGEOM.DIST 返回样本取得已知成功次数的概率。",a:"返回超几何分布。",m:[5,5],p:[{name:"Sample_s",detail:"样本中成功的次数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_sample",detail:"样本量。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"Population_s",detail:"总体中成功的次数。",example:"20",require:"m",repeat:"n",type:"rangenumber"},{name:"Number_pop",detail:"总体大小。",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果 cumulative 为 TRUE()，则 HYPGEOM.DIST 返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"INTERCEPT",t:1,d:"计算数据集的线性回归方程直线与 Y 轴的相交点 (x=0) 的 y 值。",a:"计算数据集的线性回归方程直线与 Y 轴的相交点 (x=0) 的 y 值。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"KURT",t:1,d:"计算数据集的峭度，该指标指示数据集（分布）的形态，尤其是该形态的陡峭程度。",a:"计算数据集的峭度",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LARGE",t:1,d:"返回数据集中第 n 个最大元素，n 由用户指定。",a:"返回数据集中第 n 个最大元素",m:[2,2],p:[{name:"数据",detail:"包含相关数据集的数组或范围。",example:"A2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"n",detail:"要返回的元素的排行位置（从大到小顺序）。\n\n例如，将n设为4将使LARGE返回数据中排名第4的最大元素。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STDEVA",t:1,d:"基于样本计算标准偏差，将文本取值为0。",a:"基于样本计算标准偏差",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2,…",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STDEVP",t:1,d:"基于样本总体计算标准偏差。",a:"基于样本总体计算标准偏差。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"GEOMEAN",t:1,d:"计算数据集的几何平均值。",a:"计算数据集的几何平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"RANK_EQ",t:1,d:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回其中的最高排名。",a:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回其中的最高排名。",m:[2,3],p:[{name:"number",detail:"要确定其排名的值。",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[可选 - 默认为按降序 (FALSE()) ] - 要按升序还是按降序考虑“data”中的值。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANK_AVG",t:1,d:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回这些项排名的平均值。",a:"返回指定值在数据集中的排名。如果相同的值在数据集中存在多项，则返回这些项排名的平均值。",m:[2,3],p:[{name:"number",detail:"要确定其排名的值。",example:"A10",require:"m",repeat:"n",type:"rangenumber"},{name:"ref",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"range"},{name:"order",detail:"[可选 - 默认为按降序 (FALSE()) ] - 要按升序还是按降序考虑“data”中的值。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"PERCENTRANK_EXC",t:1,d:"以百分数形式返回指定值在给定数据集中的百分比排名（介于0和1之间，不包括两端值）。",a:"以百分数形式返回指定值在给定数据集中的百分比排名（介于0和1之间，不包括两端值）。",m:[2,3],p:[{name:"data",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"要确定其百分比排位的值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[可选 - 默认值为 3] - 要在计算中使用的有效位数。",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PERCENTRANK_INC",t:1,d:"以百分比形式返回指定值在给定数据集中的百分比排名（介于0和1之间，包括两端值）。",a:"以百分比形式返回指定值在给定数据集中的百分比排名（介于0和1之间，包括两端值）。",m:[2,3],p:[{name:"data",detail:"包含相关数据集的数组或范围。",example:"A1:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"x",detail:"要确定其百分比排位的值。",example:" A2",require:"m",repeat:"n",type:"rangenumber"},{name:"significance",detail:"[可选 - 默认值为 3] - 要在计算中使用的有效位数。",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FORECAST",t:1,d:"基于数据集的线性回归，计算指定 x 的预期 y 值。",a:"基于数据集的线性回归",m:[3,3],p:[{name:"x",detail:"x轴上用于预测的值。",example:"A1",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHERINV",t:1,d:"返回指定数值的 Fisher 逆变换。",a:"返回指定数值的 Fisher 逆变换。",m:[1,1],p:[{name:"y",detail:"要计算其Fisher逆变换的数值。",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FISHER",t:1,d:"返回指定数值的 Fisher 变换。",a:"返回指定数值的 Fisher 变换。",m:[1,1],p:[{name:"x",detail:"要计算其Fisher变换的数值。",example:"0.962",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MODE_SNGL",t:1,d:"返回数据集中出现次数最多的值。",a:"返回数据集中出现次数最多的值。",m:[1,255],p:[{name:"值1",detail:"计算模式时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 在计算模式时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"WEIBULL_DIST",t:1,d:"给定形状和尺度，返回韦伯分布函数（或韦伯累积分布函数）的值。",a:"给定形状和尺度",m:[4,4],p:[{name:"x",detail:"WEIBULL 分布函数的输入值。",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"Weibull 分布函数的形状参数。\n\nalpha 值必须大于 0。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"beta",detail:"Weibull 分布函数的尺度参数。\n\nbeta 值必须大于 0。",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"TRUE() 表示使用累积分布函数，FALSE() 则表示使用概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"COUNT",t:1,d:"返回数据集中数值的个数。",a:"返回数据集中数值的个数。",m:[1,255],p:[{name:"值1",detail:"计数时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 在计数时要检查的其他值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"COUNTA",t:1,d:"返回数据集中值的数量。",a:"返回数据集中值的数量。",m:[1,255],p:[{name:"值1",detail:"计数时要检查的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 在计数时要检查的其他值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVEDEV",t:1,d:"计算数据与数据集均值之间的偏差大小的平均值。",a:"计算数据与数据集均值之间的偏差大小的平均值。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"AVERAGE",t:1,d:"返回数据集的算术平均值，对文本忽略不计。",a:"返回数据集的算术平均值",m:[1,255],p:[{name:"值1",detail:"计算平均值时用到的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 在计算平均值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"AVERAGEA",t:1,d:"返回数据集的算术平均值。",a:"返回数据集的算术平均值。",m:[1,255],p:[{name:"值1",detail:"计算平均值时用到的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 在计算平均值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangeall"}]},{n:"BINOM_DIST",t:1,d:"返回一元二项式分布的概率。",a:"返回一元二项式分布的概率。",m:[4,4],p:[{name:"number_s",detail:"试验的成功次数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"trials",detail:"独立检验的次数。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"任一给定检验的成功概率。",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"是否使用二项式累积分布。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"BINOM_INV",t:1,d:"计算累积二项式分布大于或等于指定条件的最小值。",a:"计算累积二项式分布大于或等于指定条件的最小值。",m:[3,3],p:[{name:"trials",detail:"贝努利试验次数。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"任一次给定检验的成功概率。",example:"0.005",require:"m",repeat:"n",type:"rangenumber"},{name:"alpha",detail:"期望的临界概率。",example:"0.8",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONFIDENCE_NORM",t:1,d:"计算正态分布的置信区间的一半宽度。",a:"计算正态分布的置信区间的一半宽度。",m:[3,3],p:[{name:"alpha",detail:"用来计算置信水平的显著性水平。\n\n置信水平等于 100*(1 - alpha)%，亦即，如果 alpha 为 0.05，则置信水平为 95%。",example:"0.05",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"数据区域的总体标准偏差。",example:"1.6",require:"m",repeat:"n",type:"rangenumber"},{name:"size",detail:"样本总量的大小。",example:"250",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CORREL",t:1,d:"计算给定数据集的皮尔逊积矩相关系数 r。",a:"计算给定数据集的皮尔逊积矩相关系数 r。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_P",t:1,d:"计算数据集的总体协方差。",a:"计算数据集的总体协方差。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COVARIANCE_S",t:1,d:"计算数据集的样本协方差。",a:"计算数据集的样本协方差。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DEVSQ",t:1,d:"基于样本计算其偏差的平方和。",a:"基于样本计算其偏差的平方和。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"EXPON_DIST",t:1,d:"返回带有指定 Lambda 和指定值的指数分布函数的值。",a:"返回带有指定 Lambda 和指定值的指数分布函数的值。",m:[3,3],p:[{name:"x",detail:"指数分布函数的输入值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"lambda",detail:"用于指定指数分布函数的 lambda 值。",example:"0.5",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"是否使用指数累积分布。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIF",t:1,d:"根据条件返回范围的平均值。",a:"根据条件返回范围的平均值。",m:[2,3],p:[{name:"criteria_range",detail:"要对其检查 criterion 的范围。",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion",detail:'要应用于 criteria_range 的模式或测试条件。\n\n等于："文本" 或 1 或 "=文本" 或 "=1"\n\n大于：">1"\n\n大于等于：">=1"\n\n小于："<1"\n\n小于等于："<=1"\n\n不等于："<>1"或"<>文本"',example:'">20"',require:"m",repeat:"n",type:"rangeall"},{name:"average_range",detail:"[可选] - 要计算平均值的范围。如果未提供此参数，则改用 criteria_range 来计算平均值。",example:"B1:B10",require:"o",repeat:"n",type:"rangeall"}]},{n:"AVERAGEIFS",t:1,d:"根据多项条件返回范围的平均值。",a:"根据多项条件返回范围的平均值。",m:[2,255],p:[{name:"average_range",detail:"要计算平均值的范围。",example:"A1:A10",require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range1",detail:"要对其检查 criterion1 的范围。",example:" B1:B10",require:"m",repeat:"n",type:"rangeall"},{name:"criterion1",detail:"要应用于 criteria_range1 的模式或测试条件。",example:' ">20"',require:"m",repeat:"n",type:"rangeall"},{name:"criteria_range2, criterion2, ...",detail:"[可选] - 要检查的其他范围和条件。",example:" C1:C10",require:"m",repeat:"n",type:"rangeall"}]},{n:"PERMUT",t:1,d:"返回可从数字对象中选择的给定数目对象的排列数。",a:"返回可从数字对象中选择的给定数目对象的排列数。",m:[2,2],p:[{name:"number",detail:"表示对象个数的整数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_chosen",detail:"表示每个排列中对象个数的整数。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRIMMEAN",t:1,d:"在排除数据集高低两端的部分数据之后计算所得的均值。",a:"在排除数据集高低两端的部分数据之后计算所得的均值。",m:[2,2],p:[{name:"数据",detail:"包含相关数据集的数组或范围。",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"排除比例",detail:"要从数据集的极值部分排除的数据占数据集的比例。\n\n排除比例必须大于等于0且小于1。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_EXC",t:1,d:"返回数组的 K 百分点值，K 介于 0 到 1 之间，不含 0 与 1。",a:"返回数组的 K 百分点值，K 介于 0 到 1 之间，不含 0 与 1。",m:[2,2],p:[{name:"array",detail:"定义相对位置的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0 到 1 之间的百分点值，不包含 0 和 1。",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PERCENTILE_INC",t:1,d:"返回数组的 K 百分点值，K 介于 0 到 1 之间，包含 0 与 1。",a:"返回数组的 K 百分点值，K 介于 0 到 1 之间，包含 0 与 1。",m:[2,2],p:[{name:"array",detail:"定义相对位置的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"k",detail:"0 到 1 之间的百分点值，包含 0 和 1。",example:"0.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PEARSON",t:1,d:"返回皮尔生(Pearson)乘积矩相关系数 r。",a:"返回皮尔生(Pearson)乘积矩相关系数 r。",m:[2,2],p:[{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_INV",t:1,d:"返回标准正态累积分布函数的反函数值。 该分布的平均值为 0，标准偏差为 1。",a:"返回标准正态累积分布函数的反函数值。 该分布的平均值为 0，标准偏差为 1。",m:[1,1],p:[{name:"probability",detail:"对应于正态分布的概率。",example:"0.75",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_S_DIST",t:1,d:"返回标准正态分布函数（该分布的平均值为 0，标准偏差为 1）。",a:"返回标准正态分布函数（该分布的平均值为 0，标准偏差为 1）。",m:[2,2],p:[{name:"z",detail:"需要计算其分布的数值。",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NORM_INV",t:1,d:"返回指定平均值和标准偏差的正态累积分布函数的反函数值。",a:"返回指定平均值和标准偏差的正态累积分布函数的反函数值。",m:[3,3],p:[{name:"probability",detail:"对应于正态分布的概率。",example:"0.75",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"分布的算术平均值。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NORM_DIST",t:1,d:"返回指定平均值和标准偏差的正态分布函数。",a:"返回指定平均值和标准偏差的正态分布函数。",m:[4,4],p:[{name:"x",detail:"需要计算其分布的数值。",example:"2.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"分布的算术平均值。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"NEGBINOM_DIST",t:1,d:"返回负二项式分布。",a:"返回负二项式分布。",m:[4,4],p:[{name:"number_f",detail:"要模拟的失败次数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"number_s",detail:"要模拟的成功次数。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"probability_s",detail:"任一次给定检验的成功概率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINA",t:1,d:"返回数据集中的最小数值。",a:"返回数据集中的最小数值。",m:[1,255],p:[{name:"值1",detail:"计算最小值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2",detail:"[可选] - 在计算最小值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MIN",t:1,d:"返回数值数据集中的最小值。",a:"返回数值数据集中的最小值。",m:[1,255],p:[{name:"值1",detail:"计算最小值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2",detail:"[可选] - 在计算最小值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MEDIAN",t:1,d:"返回数值数据集中的中值。",a:"返回数值数据集中的中值。",m:[1,255],p:[{name:"值1",detail:"计算中值时所用的第一个数值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2",detail:"[可选] - 在计算中值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAXA",t:1,d:"返回数据集中的最大数值。",a:"返回数据集中的最大数值。",m:[1,255],p:[{name:"值1",detail:"计算最大值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 在计算最大值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"MAX",t:1,d:"返回数值数据集中的最大值。",a:"返回数值数据集中的最大值。",m:[1,255],p:[{name:"值1",detail:"计算最大值时所用的第一个值或范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"值2",detail:"[可选] - 在计算最大值时要考虑的其他数值或范围。",example:"B2:B100",require:"o",repeat:"y",type:"rangenumber"}]},{n:"LOGNORM_INV",t:1,d:"返回 x 的对数累积分布函数的反函数值。",a:"返回 x 的对数累积分布函数的反函数值。",m:[3,3],p:[{name:"probability",detail:"与对数分布相关的概率，介于 0 与 1 之间（不含 0 与 1）。",example:"0.4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) 的平均值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) 的标准偏差，正数。",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LOGNORM_DIST",t:1,d:"返回 x 的对数分布函数。",a:"返回 x 的对数分布函数。",m:[4,4],p:[{name:"x",detail:"用来计算函数的值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"ln(x) 的平均值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"ln(x) 的标准偏差，正数。",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"决定函数形式的逻辑值。\n\n如果为 TRUE()，则返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"Z_TEST",t:1,d:"返回 z 检验的单尾 P 值。",a:"返回 z 检验的单尾 P 值。",m:[2,3],p:[{name:"array",detail:"用来检验 x 的数组或数据区域。",example:"A2:A100",require:"m",repeat:"n",type:"range"},{name:"x",detail:"要测试的值。",example:"B2",require:"m",repeat:"n",type:"rangenumber"},{name:"sigma",detail:"[可选] - 总体（已知）标准偏差。 如果省略，则使用样本标准偏差。",example:"3",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PROB",t:1,d:"返回区域中的数值落在指定区间内的概率。",a:"返回区域中的数值落在指定区间内的概率。",m:[3,4],p:[{name:"x_range",detail:"具有各自相应概率值的 x 数值区域。",example:"A3:A6",require:"m",repeat:"n",type:"range"},{name:"prob_range",detail:"与 x_range 中的值相关联的一组概率值。",example:"2",require:"m",repeat:"n",type:"range"},{name:"lower_limit",detail:"要计算其概率的数值下界。",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"upper_limit",detail:"[可选 - 默认值为下界] - 要计算其概率的可选数值上界。\n\n如果省略上界，PROB则计算随机选取相应值的次数恰好等于下界的概率。",example:"4",require:"o",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_EXC",t:1,d:"基于 0 到 1 之间（不包括 0 和 1）的百分点值返回数据集的四分位数。",a:"基于 0 到 1 之间（不包括 0 和 1）的百分点值返回数据集的四分位数。",m:[2,2],p:[{name:"array",detail:"要求得四分位数值的数组或数字型单元格区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:"要返回第几个四分位值。\n\n1返回数据中最靠近第一个四分位值的值（25%标记）。\n\n2返回数据中最接近中值的值（50%标记）。\n\n3返回数据中最接近第三个四分位值的值（75%标记）。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"QUARTILE_INC",t:1,d:"根据 0 到 1 之间的百分点值（包含 0 和 1）返回数据集的四分位数。",a:"根据 0 到 1 之间的百分点值（包含 0 和 1）返回数据集的四分位数。",m:[2,2],p:[{name:"array",detail:"要求得四分位数值的数组或数字型单元格区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"quart",detail:"要返回第几个四分位值。\n\n0返回数据中的最小值（0%标记）。\n\n1返回数据中最靠近第一个四分位值的值（25%标记）。\n\n2返回数据中最接近中值的值（50%标记）。\n\n3返回数据中最接近第三个四分位值的值（75%标记）。\n\n4返回数据中的最大值（100%标记）。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"POISSON_DIST",t:1,d:"返回泊松分布。",a:"返回泊松分布。",m:[3,3],p:[{name:"x",detail:"事件数。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"期望值。非负数",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"一逻辑值，确定所返回的概率分布的形式。\n\n如果为 TRUE()，则返回发生的随机事件数在零（含零）和 x（含 x）之间的累积泊松概率；\n\n如果为 FALSE()，则返回发生的事件数正好是 x 的泊松概率密度函数。",example:"FALSE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"RSQ",t:1,d:"返回皮尔生(Pearson)乘积矩相关系数 r 的平方。",a:"返回皮尔生(Pearson)乘积矩相关系数 r 的平方。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST",t:1,d:"返回学生的左尾 t 分布。",a:"返回学生的左尾 t 分布。",m:[3,3],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"决定函数形式的逻辑值。\n\n如果 cumulative 为 TRUE()，则 HYPGEOM.DIST 返回累积分布函数；\n\n如果为 FALSE()，则返回概率密度函数。",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"T_DIST_2T",t:1,d:"返回学生的双尾 t 分布。",a:"返回学生的双尾 t 分布。",m:[2,2],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_DIST_RT",t:1,d:"返回学生的右尾 t 分布。",a:"返回学生的右尾 t 分布。",m:[2,2],p:[{name:"x",detail:"T-分布函数的输入。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom",detail:"自由度数值。",example:"30",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV",t:1,d:"返回学生的 t 分布的左尾反函数。",a:"返回学生的 t 分布的左尾反函数。",m:[2,2],p:[{name:"probability",detail:"与学生的 t 分布相关的概率。\n\n必须大于 0 且小于 1。",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:"自由度数值。\n\n如果所提供的参数不是整数，将截取其整数部分。\n\n必须大于等于 1。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_INV_2T",t:1,d:"返回学生 t 分布的双尾反函数。",a:"返回学生 t 分布的双尾反函数。",m:[2,2],p:[{name:"probability",detail:"与学生的 t 分布相关的概率。\n\n必须大于 0 且小于1。",example:"0.35",require:"m",repeat:"n",type:"rangenumber"},{name:"deg_freedom",detail:"自由度数值。\n\n如果所提供的参数不是整数，将截取其整数部分。\n\n必须大于等于 1。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"T_TEST",t:1,d:"返回与t-检验相关的概率。用于判断两个样本是否可能是出自平均值相同的两个样本总体。",a:"返回与t-检验相关的概率。用于判断两个样本是否可能是出自平均值相同的两个样本总体。",m:[4,4],p:[{name:"array1",detail:"将用于 t 检验的第一个数据样本或第一组单元格。",example:"A1:A4",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"将用于 t 检验的第二个数据样本或第二组单元格。",example:"B1:B4",require:"m",repeat:"n",type:"rangenumber"},{name:"tails",detail:"指定分布的尾数。\n\n如果为 1：使用单尾分布。\n\n如果为 2：使用双尾分布。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"指定 t 检验的类型。\n\n如果为 1：执行配对检验。\n\n如果为 2：执行双样本等方差（同方差）检验。\n\n如果为3：执行双样本不等方差（异方差）检验。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"F_DIST",t:1,d:"给定输入值 x，计算两个数据集的左尾 F 概率分布（差异程度）。此分布也称为 Fisher-Snedecor 分布或 Snedecor F 分布。",a:"给定输入值 x",m:[4,4],p:[{name:"x",detail:"用来计算函数的值。",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"分子自由度。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"分母自由度。",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"cumulative",detail:"用于确定函数形式的逻辑值。默认值为 FALSE。\n\n如果为 TRUE()：F.DIST 将返回累积分布函数值。\n\n如果为 FALSE()：F.DIST 将返回概率密度函数值。",example:"TRUE()",require:"m",repeat:"n",type:"rangeall"}]},{n:"F_DIST_RT",t:1,d:"给定输入x，计算两个数据集的右尾F概率分布（差异程度）。 此分布也称为Fisher-Snedecor分布或Snedecor F分布。",a:"给定输入x",m:[3,3],p:[{name:"x",detail:"用来计算函数的值。",example:"15.35",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom1",detail:"分子自由度。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"degrees_freedom2",detail:"分母自由度。",example:"6",require:"m",repeat:"n",type:"rangenumber"}]},{n:"VAR_P",t:1,d:"基于样本总体计算方差。",a:"基于样本总体计算方差。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, …",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VAR_S",t:1,d:"基于样本计算方差。",a:"基于样本计算方差。",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, …",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARA",t:1,d:"基于样本计算方差，将文本取值为0。",a:"基于样本计算方差",m:[1,255],p:[{name:"value1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"value2, ...",detail:"[可选] - 样本中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"VARPA",t:1,d:"基于样本总体计算方差，将文本取值为0。",a:"基于样本总体计算方差",m:[1,255],p:[{name:"值1",detail:"样本中的第一项值或范围。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他数值或范围。",example:"2",require:"o",repeat:"y",type:"rangenumber"}]},{n:"STEYX",t:1,d:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差。",a:"返回通过线性回归法预测每个 x 的 y 值时所产生的标准误差。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"STANDARDIZE",t:1,d:"给定分布的均值和标准偏差，计算一个随机变量正态化的相应值。",a:"给定分布的均值和标准偏差，计算一个随机变量正态化的相应值。",m:[3,3],p:[{name:"x",detail:"要正态化的随机变量值。",example:"96",require:"m",repeat:"n",type:"rangenumber"},{name:"mean",detail:"分布的均值。",example:"80",require:"m",repeat:"n",type:"rangenumber"},{name:"standard_dev",detail:"分布的标准偏差。",example:"6.7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SMALL",t:1,d:"返回数据集中的第 k 个最小值。",a:"返回数据集中的第 k 个最小值。",m:[2,2],p:[{name:"array",detail:"需要找到第 k 个最小值的数组或数值数据区域。",example:"A2:B100",require:"m",repeat:"n",type:"range"},{name:"k",detail:"要返回的数据在数组或数据区域里的位置（从小到大）。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SLOPE",t:1,d:"计算通过数据集的线性回归得到的直线的斜率。",a:"计算通过数据集的线性回归得到的直线的斜率。",m:[2,2],p:[{name:"数据_y",detail:"代表因变量数据数组或矩阵的范围。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"数据_x",detail:"代表自变量数据数组或矩阵的范围。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SKEW",t:1,d:"返回分布的偏斜度。 偏斜度表明分布相对于平均值的不对称程度。 正偏斜度表明分布的不对称尾部趋向于更多正值。 负偏斜度表明分布的不对称尾部趋向于更多负值。",a:"返回分布的偏斜度。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"SKEW_P",t:1,d:"返回基于样本总体的分布不对称度：表明分布相对于平均值的不对称程度。",a:"返回基于样本总体的分布不对称度：表明分布相对于平均值的不对称程度。",m:[1,255],p:[{name:"值1",detail:"数据集中的第一个值或范围。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"值2, ...",detail:"[可选] - 数据集中包含的其他值或范围。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"VLOOKUP",t:2,d:"纵向查找。在范围的第一列中自上而下搜索某个键值，并返回所找到的行中指定单元格的值。",a:"纵向查找。在范围的第一列中自上而下搜索某个键值",m:[3,4],p:[{name:"搜索键值",detail:'要搜索的值，如 42、"Cats" 或 I24。',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"范围",detail:"要进行搜索的范围。VLOOKUP 将在该范围的第一列中搜索搜索键值中指定的键值。",example:"A2:B26",require:"m",repeat:"n",type:"rangeall"},{name:"索引",detail:"要返回的值的列索引，范围中的第一列编号为 1。\n\n如果索引不是介于 1 和范围中的列数之间，将返回 #VALUE! 。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"已排序",detail:"[默认值为 TRUE() ] - 指示要搜索的列（指定范围的第一列）是否已排序。大多数情况下，建议设为 FALSE()。\n\n建议将已排序设为 FALSE。如果设为 FALSE，将返回完全匹配项。如果存在多个匹配值，将返回找到的第一个值对应的单元格的内容，如果找不到匹配值，则返回 #N/A。\n\n如果将已排序设为 TRUE 或省略，将返回（小于或等于搜索键值的）最接近的匹配项。如果搜索的列中所有的值均大于搜索键值，则返回 #N/A。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"HLOOKUP",t:2,d:"横向查找。在范围的第一行中搜索某个键值，并返回所找到的列中指定单元格的值。",a:"横向查找。在范围的第一行中搜索某个键值",m:[3,4],p:[{name:"搜索键值",detail:'要搜索的值。例如，42、"Cats"或I24。',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"范围",detail:"要进行搜索的范围。将在该范围的第一行中搜索在搜索键值中指定的键值。",example:"A2:Z6",require:"m",repeat:"n",type:"rangeall"},{name:"索引",detail:"要返回的值的行索引，范围中的第一行编号为1。\n\n如果索引不是介于1和范围中的行数之间，将返回#VALUE!。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"已排序",detail:"[可选 - 默认值为TRUE()] - 指示要搜索的行（指定范围的第一行）是否已排序。\n\n如果将已排序设为TRUE或省略，将返回最接近的匹配值（小于或等于搜索键值）。如果在搜索的行中所有的值均大于搜索键值，则返回#N/A。\n\n如果将已排序设为TRUE或将其省略，而范围的首行并非处于已排序状态，则返回值可能会是错误的。\n\n如果将已排序设为FALSE，则仅返回完全匹配。如果存在多个匹配值，将返回与找到的第一个值对应的单元格的内容，如果找不到匹配值则返回#N/A。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOOKUP",t:2,d:"在行或列中查找相应键，并将相应单元格的值返回到与搜索行或列所在位置相同的结果范围中。",a:"在行或列中查找相应键",m:[2,3],p:[{name:"搜索键值",detail:'要在行或列中搜索的值。例如，42、"Cats" 或 I24。',example:"10003",require:"m",repeat:"n",type:"rangeall"},{name:"搜索范围 | 搜索结果数组",detail:"使用 LOOKUP 的一种方法是给定单行或单列形式的搜索范围进行搜索查找，这种方式要用到另一个参数结果范围。另一种方式是将这两个参数合并为一个搜索结果数组，其中第一行或第一列用于搜索，并将返回值放在该数组的最后一行或最后一列中。",example:"A1:A100",require:"m",repeat:"n",type:"rangeall"},{name:"结果范围",detail:"[ 可选 ] - 用于存放返回结果的范围。返回值对应于在搜索范围中找到搜索键值的位置。此范围必须仅为单行或单列，而如果您使用的是搜索结果数组方式，则不应提供此参数。",example:"B1:B100",require:"o",repeat:"n",type:"rangeall"}]},{n:"ADDRESS",t:2,d:"返回字符串形式的单元格引用。",a:"返回字符串形式的单元格引用。",m:[2,5],p:[{name:"row_num",detail:"一个数值，指定要在单元格引用中使用的行号。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:"一个数值，指定要在单元格引用中使用的列号（而非名称）。A列的编号为1。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"abs_num",detail:"[可选 - 默认值为1] - 一个数值，指定要返回的引用类型。\n\n1 表示行列均采用绝对值（例如$A$1）；\n\n2 表示采用绝对行号，相对列标（例如A$1）；\n\n3 表示采用相对行号，绝对列标（例如$A1）；\n\n4 表示行列均采用相对值（例如A1）。",example:"4",require:"o",repeat:"n",type:"rangenumber"},{name:"A1",detail:"[可选 - 默认值为TRUE()] - 一个布尔值，指示采用A1标记形式(TRUE)还是R1C1标记形式(FALSE)。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"},{name:"sheet_text",detail:"[可选 - 默认缺省] - 用于指定地址所指向的工作表名称。",example:'"Sheet2"',require:"o",repeat:"n",type:"rangeall"}]},{n:"INDIRECT",t:2,d:"返回以字符串指定的单元格引用。",a:"返回以字符串指定的单元格引用。",m:[1,2],p:[{name:"ref_text",detail:"以带引号的字符串形式提供的单元格引用。",example:'"Sheet2!"&B10',require:"m",repeat:"n",type:"rangeall"},{name:"A1",detail:"[可选 - 默认值为TRUE()] - 一个布尔值，指示采用A1标记形式(TRUE)还是R1C1标记形式(FALSE)。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROW",t:2,d:"返回指定单元格的行号",a:"返回指定单元格的行号",m:[0,1],p:[{name:"reference",detail:"[可选 - 默认为此公式所在的单元格] - 要返回其行号的单元格。\n\n如果单元格引用指向的范围其宽度大于一个单元格，而此公式不是用作数组公式的，这时会仅返回单元格引用中首行的编号值。",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"ROWS",t:2,d:"返回指定数组或范围中的行数。",a:"返回指定数组或范围中的行数。",m:[1,1],p:[{name:"array",detail:"要返回其行数的范围。",example:"A9:A62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COLUMN",t:2,d:"按照 `A=1` 的规则返回指定单元格的列号。",a:"按照 `A=1` 的规则返回指定单元格的列号。",m:[0,1],p:[{name:"reference",detail:"[可选 - 默认为包含此公式的单元格] - 要返回其列号的单元格。A列对应的编号为1。\n\n如果单元格引用是宽度超过一个单元格的范围，而此公式不是作为数组公式来使用的，因此将返回单元格引用中的第一列的位置。",example:"A9",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNS",t:2,d:"返回指定数组或范围中的列数。",a:"返回指定数组或范围中的列数。",m:[1,1],p:[{name:"array",detail:"要返回其列数的范围。",example:"A9:W62",require:"m",repeat:"n",type:"rangenumber"}]},{n:"OFFSET",t:2,d:"给定某范围的起始单元格引用以及该范围涵盖的行列数量，返回该范围的引用。",a:"给定某范围的起始单元格引用以及该范围涵盖的行列数量，返回该范围的引用。",m:[3,5],p:[{name:"reference",detail:"用于计算行列偏移量的起点。",example:"A2",require:"m",repeat:"n",type:"range"},{name:"rows",detail:"要偏移的行数。\n\n行偏移量必须是整数，但也可以是负数。如果提供的参数带有小数，小数部分将被截去。",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"要偏移的列数。\n\n列偏移量必须是整数，但也可以是负数。如果提供的参数带有小数，小数部分将被截去。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"height",detail:"[可选] - 要从偏移目标开始返回的范围的高度。",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"width",detail:"[可选] - 要从偏移目标开始返回的范围的宽度。",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MATCH",t:2,d:"在单元格中搜索指定项，然后返回该项在单元格区域中的相对位置。",a:"在单元格中搜索指定项，然后返回该项在单元格区域中的相对位置。",m:[2,3],p:[{name:"lookup_value",detail:"要在 lookup_array 中匹配的值。",example:'"Sunday"',require:"m",repeat:"n",type:"rangeall"},{name:"lookup_array",detail:"要搜索的单元格区域。\n\n如果所用的范围的高度和宽度均大于1，MATCH将返回#N/A!。",example:"A2:A9",require:"m",repeat:"n",type:"range"},{name:"match_type",detail:"[可选 - 默认值为1] - 要采用的搜索方式。\n\n1为默认类型，此时MATCH会假设范围已按升序排序，并返回小于等于搜索键值的最大值。\n\n0表示完全匹配，在范围未排序的情况下需要使用此方式。\n\n-1让MATCH假设范围是按降序排序的，并返回大于等于搜索键值的最小值。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INDEX",t:2,d:"返回表格或中的元素值，此元素由行号和列号的索引值给定。",a:"返回表格或中的元素值，此元素由行号和列号的索引值给定。",m:[3,3],p:[{name:"array",detail:"单元格区域或数组常量。",example:"A1:C20",require:"m",repeat:"n",type:"range"},{name:"row_num",detail:"选择数组中的某行，函数从该行返回数值。",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"column_num",detail:"选择数组中的某列，函数从该列返回数值。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GETPIVOTDATA",t:2,d:"从与指定行和列标题对应的数据透视表中提取汇总值。",a:"从与指定行和列标题对应的数据透视表中提取汇总值。",m:[2,254],p:[{name:"data_field",detail:"您想从数据透视表中获取其数据的值名称。\n值名称必须括在引号中或是指向包含相关文本的任何单元格的引用。\n如果有多个值字段，则必须使用数据透视表中显示的确切名称（如“销售总额”）。",example:'"SUM of number of units"',require:"m",repeat:"n",type:"rangeall"},{name:"pivot_table",detail:"目标数据透视表中的任何单元格的引用（推荐位于顶角的单元格）。",example:"'Pivot table'!A1",require:"m",repeat:"n",type:"rangeall"},{name:"field1",detail:"[可选] - 源数据集（不是数据透视表）中列的名称。",example:'"division"',require:"o",repeat:"y",type:"rangeall"},{name:"item1",detail:"[可选] - 数据透视表中显示的与您要检索的字段名称 1 相对应的行或列的名称。",example:'"east"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CHOOSE",t:2,d:"基于索引返回选项列表中的元素。",a:"基于索引返回选项列表中的元素。",m:[2,255],p:[{name:"index_num",detail:"指定要返回哪一项。\n\n如果索引为零、负值或大于提供的选择数量，将返回#VALUE!错误。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"一项可能的返回值。必须提供。可以是单元格引用或单独的值。",example:'"A"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"[可选] - 其他可以选择的值。选择",example:'"B"',require:"o",repeat:"y",type:"rangeall"}]},{n:"HYPERLINK",t:2,d:"在单元格内创建一个超链接。",a:"在单元格内创建一个超链接。",p:[{name:"网址",detail:"以引号括住的链接位置的完整网址，或对包含这种网址的单元格的引用。\n\n仅允许某些链接类型。其中包括：http://、https://、mailto:、aim:、ftp://、gopher://、telnet://和news://，明确禁用使用其他协议。如果指定的是其他协议，将会在单元格中显示链接标签，但该标签不会以链接形式呈现。\n\n如果未指定协议，则假设使用http://，并将其作为网址的前缀。",example:'"http://www.google.com/"',require:"m",repeat:"n",type:"rangeall"},{name:"链接标签",detail:'[可选 - 默认为网址] - 要在单元格中作为链接显示的文本（用引号括起来的），或者指向包含这种标签的单元格的引用。\n\n如果链接标签是指向某个空单元格的引用，如果网址有效，就将其作为链接显示，否则作为纯文本显示。\n\n如果链接标签为空字符串常量("")，所在单元格显示的内容将为空白，但通过点击该单元格或转入该单元格仍然可以访问链接。',example:'"Google"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TIME",t:6,d:"将给定的小时、分钟和秒转换为时间。",a:"将给定的小时、分钟和秒转换为时间。",m:[3,3],p:[{name:"小时",detail:"0（零）到 32767 之间的数字，代表小时。\n\n任何大于 23 的值都会除以 24，余数将作为小时值。",example:"11",require:"m",repeat:"n",type:"rangenumber"},{name:"分钟",detail:"0（零）到 32767 之间的数字，代表分钟。\n\n任何大于 59 的值将转换为小时和分钟。",example:"40",require:"m",repeat:"n",type:"rangenumber"},{name:"秒",detail:"0（零）到 32767 之间的数字，代表秒。\n\n任何大于 59 的值将转换为小时、分钟和秒。",example:"59",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TIMEVALUE",t:6,d:"按一天24小时返回该时间的分数表示。",a:"按一天24小时返回该时间的分数表示。",m:[1,1],p:[{name:"time_text",detail:"用于表示时间的字符串。",example:'"2:15 PM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EOMONTH",t:6,d:"返回某个月份最后一天的序列号，该月份在另一个日期之前或之后的数个月（月数由参数指定）。",a:"返回某个月份最后一天的序列号",m:[2,2],p:[{name:"start_date",detail:"用于计算结果的参照日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"用于计算的起始日期之前（负）或之后（正）的月数。返回的是计算所得月份的最后那天。",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"EDATE",t:6,d:"返回表示某个日期的序列号，该日期在另一个日期的数月之前/之后。",a:"返回表示某个日期的序列号",m:[2,2],p:[{name:"start_date",detail:"用于计算结果的参照日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"months",detail:"用于计算的起始日期之前（负）或之后（正）的月数。",example:"7",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SECOND",t:6,d:"返回时间值的秒数。 秒数是 0（零）到 59 范围内的整数。",a:"返回时间值的秒数。 秒数是 0（零）到 59 范围内的整数。",m:[1,1],p:[{name:"时间",detail:"用于计算秒钟部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"MINUTE",t:6,d:"以数字格式返回特定时间的分钟部分。",a:"以数字格式返回特定时间的分钟部分。",m:[1,1],p:[{name:"时间",detail:"用于计算分钟部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"HOUR",t:6,d:"以数字格式返回特定时间的小时部分。",a:"以数字格式返回特定时间的小时部分。",m:[1,1],p:[{name:"时间",detail:"用于计算小时部分的时间。必须为以下值之一：指向包含日期/时间值的单元格的引用、返回日期/时间的函数或者数字。",example:"TIME(11",require:"m",repeat:"n",type:"rangeall"}]},{n:"NOW",t:6,d:"以日期值格式返回当前日期和时间。",a:"以日期值格式返回当前日期和时间。",m:[0,0],p:[]},{n:"NETWORKDAYS",t:6,d:"返回所提供的两个日期之间的净工作日天数。",a:"返回所提供的两个日期之间的净工作日天数。",m:[2,3],p:[{name:"start_date",detail:"用于计算净工作日天数的时间段开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"用于计算净工作日天数的时间段结束日期。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[可选] - 一个范围或数组常量，其中包含作为节假日的日期序号。\n\n在节假日数组中提供的值必须是日期序号值（例如由N所返回的值）或日期值（例如由DATE、DATEVALUE或TO_DATE返回的值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"NETWORKDAYS_INTL",t:6,d:"返回给定的两个日期之间的净工作日天数（排除指定的周末和节假日）。",a:"返回给定的两个日期之间的净工作日天数（排除指定的周末和节假日）。",m:[2,4],p:[{name:"start_date",detail:"用于计算净工作日天数的时间段开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"用于计算净工作日天数的时间段结束日期。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"weekend",detail:"[可选 - 默认值为1] - 用于表示哪些天为周末的数字或字符串。\n字符串方式：可以使用由0和1组成的字符串来指定周末，串中的第一个数字字符代表周一，最后一个则代表周日。零表示这一天是工作日，1表示这一天为周末。例如，“0000011”表示将周六和周日作为周末。\n数字方式：这种方式不使用上述字符串形式，而是使用一个数字。1 =周六/周日为周末，2 =周日/周一为周末，依此类推则7 =周五/周六。11 =周日为唯一周末，12 =周一为唯一周末，依此类推则17 =周六为唯一周末。",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[ 可选 ] - 这是一个范围或数组常量，其中包含作为节假日的日期。\n在节假日数组内提供的值必须为日期序数值（例如N的返回值）或日期值（例如DATE、DATEVALUE或TO_DATE的返回值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"ISOWEEKNUM",t:6,d:"返回给定日期在全年中的 ISO 周数。",a:"返回给定日期在全年中的 ISO 周数。",m:[1,1],p:[{name:"date",detail:"用于日期和时间计算的日期-时间代码。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"WEEKNUM",t:6,d:"返回特定日期的周数。",a:"返回特定日期的周数。",m:[1,2],p:[{name:"serial_number",detail:"要确定其位于第几周的日期，必须是对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[可选 - 默认值为 1 ] - 代表一周起始日的数字，系统也使用该数字来确定一年的第一周（1=周日，2=周一）。",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"WEEKDAY",t:6,d:"返回一个数字，对应于给定日期所在的星期几。",a:"返回一个数字，对应于给定日期所在的星期几。",m:[1,2],p:[{name:"serial_number",detail:"要为其确定星期几的日期。必须是对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"return_type",detail:"[可选 - 默认值为 1] - 以数字指示使用哪种编号顺序来表示星期几。默认情况下，按星期日 (= 1) 开始计算。\n\n如果类型为 1，则星期值将从星期日开始算起，并且星期日的值为 1，因此星期六的值就是 7。\n\n如果类型为 2，则星期值将从星期一开始算起，并且星期一的值为 1，因此星期日的值就是 7。\n\n如果类型为 3，则星期值将从星期一算起，并且星期一的值为 0，因此星期日的值就是 6。",example:"7",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DAY",t:6,d:"以数字格式返回特定日期所在的当月几号。",a:"以数字格式返回特定日期所在的当月几号。",m:[1,1],p:[{name:"serial_number",detail:"要从中提取具体几号的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS",t:6,d:"返回两个日期之间的天数。",a:"返回两个日期之间的天数。",m:[2,2],p:[{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"2011-3-15",require:"m",repeat:"n",type:"rangeall"},{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"2011-2-1",require:"m",repeat:"n",type:"rangeall"}]},{n:"DAYS360",t:6,d:"按照每年360天，返回两个日期之间的差（用于计算利息）。",a:"按照每年360天，返回两个日期之间的差（用于计算利息）。",m:[2,3],p:[{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"method",detail:"[可选 - 默认为FALSE()] - 指示要使用哪种天数计算方法。\n\nFALSE - 采用美国 (NASD) 方法时，如果起始日期为某月的最后一天，为便于计算，会将起始日期的当月几号更改为30。此外，如果结束日期是所在月份的最后一天，而且起始日期在其所在月的30号之前，则将结束日期更改为结束日期之后那个月的第一天，否则将结束日期更改为该月的30号。\n\nTRUE - 采用欧洲方法时，会将所有日期在31号的起始日期或结束日期更改为当月的30号。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"DATE",t:6,d:"将提供的年、月、日转换为日期。",a:"将提供的年、月、日转换为日期。",m:[3,3],p:[{name:"year",detail:"日期的年份部分，包含一到四位数字。\n\n介于 0（零）到 1899 之间，会将该值与 1900 相加来计算年份；\n\n介于 1900 到 9999 之间，将使用该数值作为年份；\n\n小于 0 或大于等于 10000，返回 错误值 #NUM!。",example:"1969",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"日期的月份部分，一个正整数或负整数。\n\n如果 month 大于 12，则 month 会将该月份数与指定年中的第一个月相加。\n\n如果 month 小于 1，month 则从指定年份的一月份开始递减该月份数，然后再加上 1 个月。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"day",detail:"日期的日部分，一个正整数或负整数。\n\n如果 day 大于月中指定的天数，则 day 会将天数与该月中的第一天相加。\n\n如果 day 小于 1，则 day 从指定月份的第一天开始递减该天数，然后再加上 1 天。",example:"20",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DATEVALUE",t:6,d:"将提供的日期字符串转换为日期的序列号。",a:"将提供的日期字符串转换为日期的序列号。",m:[1,1],p:[{name:"date_text",detail:"表示日期的字符串。",example:'"1969-7-20"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DATEDIF",t:6,d:"计算两个日期之间的天数、月数或年数。",a:"计算两个日期之间的天数、月数或年数。",m:[3,3],p:[{name:"起始日期",detail:"计算中要使用的开始日期。必须是对包含DATE值的单元格的引用、返回DATE类型的函数或数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"结束日期",detail:"计算中要使用的结束日期。必须是对包含DATE值的单元格的引用、返回DATE类型的函数或数字。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"单位",detail:'时间单位的缩写文字。例如 "M" 代表月。有效值包括："Y"、"M"、"D"、"MD"、"YM" 和 "YD"。\n\n"Y"：返回起始日期和结束日期之间的整年数。\n\n"M"：返回起始日期和结束日期之间的整月数。\n\n"D"：返回起始日期和结束日期之间的天数。\n\n"MD"：返回起始日期和结束日期之间的天数（不计整月数）。\n\n"YM"：返回起始日期和结束日期之间的整月数（不计整年数）。\n\n"YD"：返回起始日期和结束日期之间的天数（假设起始日期和结束日期的间隔不超过一年）。',example:"16)",require:"m",repeat:"n",type:"rangeall"}]},{n:"WORKDAY",t:6,d:"指定工作日天数，计算结束日期。",a:"指定工作日天数，计算结束日期。",m:[2,3],p:[{name:"start_date",detail:"计算的开始日期。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:"start_date 之前或之后不含周末及节假日的天数。\n\n为正值将生成未来日期；\n\n为负值生成过去日期。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"holidays",detail:"[可选] - 一个范围或数组常量，其中包含作为节假日的日期序号。\n\n在节假日数组中提供的值必须是日期序号值（例如由N所返回的值）或日期值（例如由DATE、DATEVALUE或TO_DATE返回的值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"16)",require:"o",repeat:"n",type:"rangeall"}]},{n:"WORKDAY_INTL",t:6,d:"返回指定的若干个工作日之前或之后的日期的序列号（使用自定义周末参数）。 ",a:"返回指定的若干个工作日之前或之后的日期的序列号（使用自定义周末参数）。 ",m:[2,4],p:[{name:"start_date",detail:"开始日期（将被截尾取整）。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"days",detail:"start_date 之前或之后的工作日的天数。\n\n正值表示未来日期；\n\n负值表示过去日期；\n\n零值表示开始日期。",example:"7",require:"m",repeat:"n",type:"rangenumber"},{name:"weekend",detail:"[可选 - 默认值为1] - 用于表示哪些天为周末的数字或字符串。\n字符串方式：可以使用由0和1组成的字符串来指定周末，串中的第一个数字字符代表周一，最后一个则代表周日。零表示这一天是工作日，1表示这一天为周末。例如，“0000011”表示将周六和周日作为周末。\n数字方式：这种方式不使用上述字符串形式，而是使用一个数字。1 =周六/周日为周末，2 =周日/周一为周末，依此类推则7 =周五/周六。11 =周日为唯一周末，12 =周一为唯一周末，依此类推则17 =周六为唯一周末。",example:"16)",require:"o",repeat:"n",type:"rangeall"},{name:"holidays",detail:"[ 可选 ] - 这是一个范围或数组常量，其中包含作为节假日的日期。\n在节假日数组内提供的值必须为日期序数值（例如N的返回值）或日期值（例如DATE、DATEVALUE或TO_DATE的返回值）。由范围指定的值应该是标准的日期值或日期序数值。",example:"DATE(1969",require:"o",repeat:"n",type:"rangeall"}]},{n:"YEAR",t:6,d:"返回对应于某个日期的年份。 Year 作为 1900 - 9999 之间的整数返回。",a:"返回对应于某个日期的年份。 Year 作为 1900 - 9999 之间的整数返回。",m:[1,1],p:[{name:"serial_number",detail:"用于计算年份的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"YEARFRAC",t:6,d:"返回 start_date 和 end_date 之间的天数占全年天数的百分比。",a:"返回 start_date 和 end_date 之间的天数占全年天数的百分比。",m:[2,3],p:[{name:"start_date",detail:"计算中要使用的开始日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"end_date",detail:"计算中要使用的结束日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"7",require:"m",repeat:"n",type:"rangeall"},{name:"basis",detail:"[可选 - 默认为0] - 要使用的日计数基准类型。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"16)",require:"o",repeat:"n",type:"rangenumber"}]},{n:"TODAY",t:6,d:"以日期值格式返回当前日期。",a:"以日期值格式返回当前日期。",m:[0,0],p:[]},{n:"MONTH",t:6,d:"返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数。",a:"返回日期（以序列数表示）中的月份。 月份是介于 1（一月）到 12（十二月）之间的整数。",m:[1,1],p:[{name:"serial_number",detail:"要从中提取月份的日期。必须是以下一种：对包含日期的单元格的引用、返回日期类型的函数或者数字。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"}]},{n:"EFFECT",t:8,d:"根据名义利率及每年的复利计息期数来计算实际年利率。",a:"根据名义利率及每年的复利计息期数来计算实际年利率。",m:[2,2],p:[{name:"nominal_rate",detail:"每年的名义利率。",example:"0.99",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"每年的复利计算期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLAR",t:12,d:"将数字格式设置为与语言区域相对应的货币格式。",a:"将数字格式设置为与语言区域相对应的货币格式。",m:[1,2],p:[{name:"number",detail:"要设置格式的值。",example:"1.2351",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:"[可选 - 默认值为 2] - 要显示的小数位数。\n\n如果这是负数，则将数字四舍五入到小数点左侧。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARDE",t:8,d:"将以整数部分和分数部分转换为以小数部分表示的金额数字",a:"将以整数部分和分数部分转换为以小数部分表示的金额数字",m:[2,2],p:[{name:"fractional_dollar",detail:"以整数部份和分数部分表示的数字，用小数点隔开。",example:"100.10",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"用作分数中的分母的整数。",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DOLLARFR",t:8,d:"将小数转换为分数表示的金额数字。",a:"将小数转换为分数表示的金额数字。",m:[2,2],p:[{name:"decimal_dollar",detail:"小数。",example:"100.125",require:"m",repeat:"n",type:"rangenumber"},{name:"fraction",detail:"用作分数中的分母的整数。",example:"32",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DB",t:8,d:"使用固定余额递减法，返回指定期间内某项固定资产的折旧值。",a:"使用固定余额递减法，返回指定期间内某项固定资产的折旧值。",m:[4,5],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"month",detail:"[可选 - 默认值为12] - 折旧第一年中的月数。",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DDB",t:8,d:"用双倍余额递减法，返回指定期间内某项固定资产的折旧值。",a:"用双倍余额递减法，返回指定期间内某项固定资产的折旧值。",m:[4,5],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"factor",detail:"[可选 - 默认值为2] - 折旧的递减系数。",example:"2.25",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RATE",t:8,d:"返回年金每期的利率。",a:"返回年金每期的利率。",m:[3,6],p:[{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"每期的付款金额，在年金周期内不能更改。",example:"-100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值即一系列未来付款当前值的总和。",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"guess",detail:"[可选 - 默认值为0.1] - 预期利率。",example:"0.1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"CUMPRINC",t:8,d:"基于等额分期付款和固定利率，计算投资在多个付款期内的累计本金偿还额。",a:"基于等额分期付款和固定利率，计算投资在多个付款期内的累计本金偿还额。",m:[6,6],p:[{name:"rate",detail:"利率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"总付款期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"年金的现值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:"开始累计计算的付款期序号。\n\n首期必须大于等于1。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:"结束累计计算的付款期序号。\n\n末期必须大于首期。",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPNUM",t:8,d:"返回在结算日和到期日之间的付息次数，向上舍入到最近的整数。",a:"返回在结算日和到期日之间的付息次数，向上舍入到最近的整数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。到期日是有价证券有效期截止时的日期。",example:"02",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SYD",t:8,d:"返回在指定期间内资产按年限总和折旧法计算的折旧。",a:"返回在指定期间内资产按年限总和折旧法计算的折旧。",m:[4,4],p:[{name:"cost",detail:"资产原值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"50",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangenumber"},{name:"period",detail:"在使用期限内要计算折旧的折旧期。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLEQ",t:8,d:"基于贴现率计算美国政府短期债券的等效年化收益率。",a:"基于贴现率计算美国政府短期债券的等效年化收益率。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"1",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"债券购买时的贴现率。",example:"2)",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLYIELD",t:8,d:"基于价格计算美国政府短期债券的收益率。",a:"基于价格计算美国政府短期债券的收益率。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"债券的购买价格。",example:"95",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TBILLPRICE",t:8,d:"基于贴现率计算美国政府短期债券的价格。",a:"基于贴现率计算美国政府短期债券的价格。",m:[3,3],p:[{name:"settlement",detail:"债券的结算日期，此日期为债券发行后交付给买家的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"债券的到期或结束日期，届时可将其以面值或票面价值赎回。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"债券购买时的贴现率。",example:"0.09",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PV",t:8,d:"基于等额分期付款和固定利率，计算年金投资的现值。",a:"基于等额分期付款和固定利率，计算年金投资的现值。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"每期的付款金额，在年金周期内不能更改。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"D2",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ACCRINT",t:8,d:"返回定期付息证券的应计利息。",a:"返回定期付息证券的应计利息。",m:[6,8],p:[{name:"issue",detail:"有价证券的发行日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"first_interest",detail:"有价证券的首次计息日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"证券的票面值。",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示““欧洲30/360”方法” - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"calc_method",detail:"[可选 - 默认为TRUE()] - 一个逻辑值，指定当结算日期晚于首次计息日期时用于计算总应计利息的方法。\n\n如果值为 TRUE，则返回从发行日到结算日的总应计利息。\n\n如果值为 FALSE，则返回从首次计息日到结算日的应计利息。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"ACCRINTM",t:8,d:"返回在到期日支付利息的有价证券的应计利息。",a:"返回在到期日支付利息的有价证券的应计利息。",m:[4,5],p:[{name:"issue",detail:"有价证券的发行日。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"settlement",detail:"有价证券的到期日。",example:"DATE(1969",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"par",detail:"证券的票面值。",example:"1000",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYBS",t:8,d:"返回从付息期开始到结算日的天数。",a:"返回从付息期开始到结算日的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYS",t:8,d:"返回结算日所在的付息期的天数。",a:"返回结算日所在的付息期的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPDAYSNC",t:8,d:"返回从结算日到下一票息支付日之间的天数。",a:"返回从结算日到下一票息支付日之间的天数。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPNCD",t:8,d:"计算结算日之后的下一票息或利息派发日期。",a:"计算结算日之后的下一票息或利息派发日期。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COUPPCD",t:8,d:"计算结算日之前的最后一个票息或利息支付日。",a:"计算结算日之前的最后一个票息或利息支付日。",m:[3,4],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"01)",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"DATE(2019",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FV",t:8,d:"基于等额分期付款和固定利率，计算年金投资的未来价值。",a:"基于等额分期付款和固定利率，计算年金投资的未来价值。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"各期所应支付的金额，在整个年金期间保持不变。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"[可选 - 默认值为 0 ] - 现值，或一系列未来付款的当前值的累积和。",example:"400",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为 0 ] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"FVSCHEDULE",t:8,d:"返回应用一系列复利率计算的初始本金的未来值。",a:"返回应用一系列复利率计算的初始本金的未来值。",m:[2,2],p:[{name:"principal",detail:"现值。",example:"10000",require:"m",repeat:"n",type:"rangenumber"},{name:"schedule",detail:"用于计算本金复利的一组利率。\n\n利率表必须是范围或数组，其中包含要用于计算复利的一组利率。这些利率值应该以十进制小数形式表示，或者使用UNARY_PERCENT以百分比形式表示，即表示为0.09或UNARY_PERCENT(9)，而不要表示为9。",example:"A2:A100",require:"m",repeat:"n",type:"range"}]},{n:"YIELD",t:8,d:"返回定期支付利息的债券的收益率。",a:"返回定期支付利息的债券的收益率。",m:[6,7],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"pr",detail:"有价证券的价格。",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"YIELDDISC",t:8,d:"基于价格计算折价发行的（不带息）债券的年收益率。",a:"基于价格计算折价发行的（不带息）债券的年收益率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"有价证券的价格。",example:"95",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"NOMINAL",t:8,d:"基于给定的实际利率和年复利期数，返回名义年利率。",a:"基于给定的实际利率和年复利期数，返回名义年利率。",m:[2,2],p:[{name:"effect_rate",detail:"每年的实际利率。",example:"0.85",require:"m",repeat:"n",type:"rangenumber"},{name:"npery",detail:"每年的复利期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"XIRR",t:8,d:"返回一组不一定定期发生的现金流的内部收益率。",a:"返回一组不一定定期发生的现金流的内部收益率。",m:[2,3],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"与现金流数额参数中的现金流对应的日期数组或范围。",example:"C2:C25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[可选 - 默认值为0.1] - 对内部回报率的估算值。",example:"250",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MIRR",t:8,d:"返回一系列定期现金流的修改后内部收益率。",a:"返回一系列定期现金流的修改后内部收益率。",m:[3,3],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"finance_rate",detail:"现金流中使用的资金支付的利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"reinvest_rate",detail:"将现金流再投资的收益率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IRR",t:8,d:"返回由值中的数字表示的一系列现金流的内部收益率。 ",a:"返回由值中的数字表示的一系列现金流的内部收益率。 ",m:[1,2],p:[{name:"values",detail:"其中含有投资相关收益或支出的数组或范围。\n\n现金流数额中必须至少包含一项负的和一项正的现金流金额才能计算回报率。",example:"A2:A25",require:"m",repeat:"n",type:"range"},{name:"guess",detail:"[可选 - 默认为 0.1] - 内部收益率的估值。",example:"200",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPV",t:8,d:"使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值。",a:"使用贴现率和一系列未来支出（负值）和收益（正值）来计算一项投资的净现值。",m:[2,255],p:[{name:"rate",detail:"某一期间的贴现率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"value1",detail:"第一笔支出（负值）和收益（正值）。",example:"200",require:"m",repeat:"n",type:"rangeall"},{name:"value2, ...",detail:"[可选] - 其他支出（负值）和收益（正值）。",example:"250",require:"o",repeat:"y",type:"rangeall"}]},{n:"XNPV",t:8,d:"返回一组现金流的净现值，这些现金流不一定定期发生。",a:"返回一组现金流的净现值，这些现金流不一定定期发生。",m:[3,3],p:[{name:"rate",detail:"应用于现金流的贴现率。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"values",detail:"与 dates 中的支付时间相对应的一系列现金流。",example:"B2:B25",require:"m",repeat:"n",type:"range"},{name:"dates",detail:"与现金流支付相对应的支付日期表。",example:"C2:C25",require:"m",repeat:"n",type:"range"}]},{n:"CUMIPMT",t:8,d:"基于等额分期付款和固定利率，计算投资在一系列付款期内的累计利息。",a:"基于等额分期付款和固定利率，计算投资在一系列付款期内的累计利息。",m:[6,6],p:[{name:"rate",detail:"利息率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"总付款期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"start_period",detail:"开始累计计算的付款期序号。\n\n首期必须大于等于1。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"end_period",detail:"结束累计计算的付款期序号。\n\n末期必须大于首期。",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PMT",t:8,d:"用于根据固定付款额和固定利率计算贷款的付款额。",a:"用于根据固定付款额和固定利率计算贷款的付款额。",m:[3,5],p:[{name:"rate",detail:"贷款利率。",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"该项贷款的付款总数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值，或一系列未来付款额现在所值的总额，也叫本金。",example:" 100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"D2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"IPMT",t:8,d:"基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额。",a:"基于固定利率及等额分期付款方式，返回给定期数内对投资的利息偿还额。",m:[4,6],p:[{name:"rate",detail:"各期利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:"用于计算其利息数额的期数，必须在 1 到 nper 之间。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"年金的付款总期数。",example:"12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值，或一系列未来付款的当前值的累积和。",example:"80000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"E2",require:"m",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"1",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PPMT",t:8,d:"返回根据定期固定付款和固定利率而定的投资在已知期间内的本金偿付额。",a:"返回根据定期固定付款和固定利率而定的投资在已知期间内的本金偿付额。",m:[4,6],p:[{name:"rate",detail:"各期利率。",example:"0.1",require:"m",repeat:"n",type:"rangenumber"},{name:"per",detail:"指定期数，该值必须在 1 到 nper 范围内。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"nper",detail:"年金的付款总期数。",example:"3*12",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值即一系列未来付款当前值的总和。",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为 0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为 0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"INTRATE",t:8,d:"返回完全投资型证券的利率。",a:"返回完全投资型证券的利率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"有价证券的投资额。",example:"100000",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"有价证券到期时的兑换值。",example:"101200",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"m",repeat:"n",type:"rangenumber"}]},{n:"PRICE",t:8,d:"返回定期付息的面值 ￥100 的有价证券的价格。",a:"返回定期付息的面值 ￥100 的有价证券的价格。",m:[6,7],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券的年息票利率。",example:"0.057",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.065",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEDISC",t:8,d:"返回折价发行的面值 ￥100 的有价证券的价格。",a:"返回折价发行的面值 ￥100 的有价证券的价格。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"discount",detail:"有价证券的贴现率。",example:"0.0525",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"PRICEMAT",t:8,d:"返回到期付息的面值 ￥100 的有价证券的价格。",a:"返回到期付息的面值 ￥100 的有价证券的价格。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"issue",detail:"有价证券的发行日。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"rate",detail:"有价证券在发行日的利率。",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.061",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"RECEIVED",t:8,d:"返回一次性付息的有价证券到期收回的金额。",a:"返回一次性付息的有价证券到期收回的金额。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"investment",detail:"有价证券的投资额。",example:"10000000",require:"m",repeat:"n",type:"rangenumber"},{name:"discount",detail:"有价证券的贴现率。",example:"0.0575",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DISC",t:8,d:"返回有价证券的贴现率。",a:"返回有价证券的贴现率。",m:[4,5],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"pr",detail:"有价证券的价格（按面值为 ￥100 计算）。",example:"97.975",require:"m",repeat:"n",type:"rangenumber"},{name:"redemption",detail:"面值 ￥100 的有价证券的清偿价值。",example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"12",require:"o",repeat:"n",type:"rangenumber"}]},{n:"NPER",t:8,d:"基于固定利率及等额分期付款方式，返回某项投资的总期数。",a:"基于固定利率及等额分期付款方式，返回某项投资的总期数。",m:[3,5],p:[{name:"rate",detail:"各期利率。",example:"0.12",require:"m",repeat:"n",type:"rangenumber"},{name:"pmt",detail:"各期所应支付的金额，在整个年金期间保持不变。",example:"500",require:"m",repeat:"n",type:"rangenumber"},{name:"pv",detail:"现值，或一系列未来付款的当前值的累积和。",example:"40000",require:"m",repeat:"n",type:"rangenumber"},{name:"fv",detail:"[可选 - 默认值为0] - 未来值，或在最后一次付款后希望得到的现金余额。",example:"0",require:"o",repeat:"n",type:"rangenumber"},{name:"type",detail:"[可选 - 默认值为0] - 指定各期的付款时间是在期初还是期末。\n\n0 表示期末；\n\n1 表示期初。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SLN",t:8,d:"返回一个期间内的资产的直线折旧。",a:"返回一个期间内的资产的直线折旧。",m:[3,3],p:[{name:"cost",detail:"资产原值。",example:"300000",require:"m",repeat:"n",type:"rangenumber"},{name:"salvage",detail:"折旧末尾时的值（有时也称为资产残值）。",example:"75000",require:"m",repeat:"n",type:"rangenumber"},{name:"life",detail:"资产的折旧期数（有时也称作资产的使用寿命）。",example:"10",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DURATION",t:8,d:"返回假设面值 ￥100 的定期付息有价证券的修正期限。",a:"返回假设面值 ￥100 的定期付息有价证券的修正期限。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"有价证券的年息票利率。",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"MDURATION",t:8,d:"返回假设面值 ￥100 的有价证券的 Macauley 修正期限。",a:"返回假设面值 ￥100 的有价证券的 Macauley 修正期限。",m:[5,6],p:[{name:"settlement",detail:"有价证券的结算日。 有价证券结算日是在发行日之后，有价证券卖给购买者的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"maturity",detail:"有价证券的到期日。 到期日是有价证券有效期截止时的日期。",example:"DATE(2010",require:"m",repeat:"n",type:"rangeall"},{name:"coupon",detail:"有价证券的年息票利率。",example:"0.08",require:"m",repeat:"n",type:"rangenumber"},{name:"yld",detail:"有价证券的年收益率。",example:"0.09",require:"m",repeat:"n",type:"rangenumber"},{name:"frequency",detail:"年付息次数。\n\n如果按年支付，frequency = 1；\n\n按半年期支付，frequency = 2；\n\n按季支付，frequency = 4。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"basis",detail:"[可选 - 默认为0] - 指示要使用哪种天数计算方法。\n\n0表示“美国(NASD) 30/360”方法 - 此方法按照美国全国证券交易商协会标准，假设每月30天、每年360天，并对所输入的月末日期进行具体调整。\n\n1表示“实际/实际”方法 - 此方法计算基于指定日期之间的实际天数和所涉及的年份中的实际天数进行计算。此方法用于美国长期债券，也是在非财经用途方面使用最多的方法。\n\n2表示“实际/360”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为360天。\n\n3表示“实际/365”方法 - 此方法基于指定日期之间的实际天数进行计算，但假定每年为365天。\n\n4表示“欧洲30/360”方法 - 类似于0，此方法基于每月30天、每年360天进行计算，但按照欧洲金融惯例对月末日期进行调整。",example:"0",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2DEC",t:9,d:"将二进制数转换为十进制数。",a:"将二进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2DEC(100)和BIN2DEC("100")得出的结果相同，均为4。',example:"101",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIN2HEX",t:9,d:"将二进制数转换为十六进制数。",a:"将二进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2HEX(11111)和BIN2HEX("11111")得出 的结果相同，均为1F。',example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:'[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。例如，BIN2HEX("11111",8)所得的结果值为0000001F。\n\n如果带符号的二进制数的最高位为1，则忽略此值；即当提供的带符号的二进制数大于等于1000000000时忽略此值。',example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"BIN2OCT",t:9,d:"将二进制数转换为八进制数。",a:"将二进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的带符号的10位二进制数值（以字符串形式提供）。\n\n带符号的二进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n对于此函数，最大的正数输入值为0111111111，最小的负数输入值为1000000000。\n\n如果所提供的带符号的二进制数是有效的二进制数，会自动将其转换为相应的字符串输入。例如，BIN2OCT(11111)和BIN2OCT("11111")得出的结果相同，均为37。',example:"101",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:'[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。例如，BIN2OCT("11111")得到的结果值为00000037。\n\n如果带符号的二进制数的最高位为1，则忽略此值；即当提供的带符号的二进制数大于等于1000000000时忽略此值。',example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2BIN",t:9,d:"将十进制数转换为二进制数。",a:"将十进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的十进制数值（以字符串形式提供）。\n\n对于此函数，最大的正数输入值为511，最小的负数输入值为-512。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2BIN(199)和DEC2BIN("199")得出的结果相同，均为11000111。',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2HEX",t:9,d:"将十进制数转换为十六进制数。",a:"将十进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的十进制数值（以字符串形式提供）。\n\n此函数可接受的最大正数值为549755813887，最小负数值为-549755814888。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2HEX(100)和DEC2HEX("100")得出的结果相同，均为64。',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DEC2OCT",t:9,d:"将十进制数转换为八进制数。",a:"将十进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的十进制数值（以字符串形式提供）。\n\n此函数可接受的最大正数值为536870911，最小负数值为-53687092。\n\n如果所提供的十进制数是有效的十进制数，会自动将其转换为相应的字符串输入。例如，DEC2OCT(199)和DEC2OCT("199")得出的结果相同，均为307。',example:"100",require:"m",repeat:"n",type:"rangenumber"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果十进制数为负数，则忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2BIN",t:9,d:"将十六进制数转换为二进制数。",a:"将十六进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为1FF，最小负数值为FFFFFFFE00。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2BIN(199)和HEX2BIN("199")得出的结果相同，均为110011001。',example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的十六进制数的最高位为1，则忽略此值；即当提供的带符号的十六进制数大于等于8000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"HEX2DEC",t:9,d:"将十六进制数转换为十进制数。",a:"将十六进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为7fffffffff，最小负数值为8000000000。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2DEC(199)和HEX2DEC("199")得出的结果相同，均为409。',example:'"f3"',require:"m",repeat:"n",type:"rangeall"}]},{n:"HEX2OCT",t:9,d:"将十六进制数转换为八进制数。",a:"将十六进制数转换为八进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的八进制数的带符号的40位十六进制数值（以字符串形式提供）。\n\n带符号的十六进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为1FFFFFFF，最小负数值为FFE0000000。\n\n如果所提供的带符号的十六进制数是有效的十六进制数，函数会自动将其转换为相应的字符串输入。例如，HEX2OCT(199)和HEX2OCT("199")得出的结果相同，均为631。',example:'"f3"',require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的十六进制数的最高位为1，则忽略此值；即当给定的带符号的十六进制数大于等于8000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2BIN",t:9,d:"将八进制数转换为二进制数。",a:"将八进制数转换为二进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的二进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的八进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为777，最小负数值为7777777000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2BIN(177)和OCT2BIN("177")得出的结果相同，均为1111111。',example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的八进制数的最高位为1，则忽略此值；即当给定的带符号的八进制数大于等于4000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"OCT2DEC",t:9,d:"将八进制数转换为十进制数。",a:"将八进制数转换为十进制数。",m:[1,1],p:[{name:"number",detail:'要转换为十进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的ba进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为3777777777，最小负数值为4000000000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2DEC(177)和OCT2DEC("177")得出的结果相同，均为127。',example:"37",require:"m",repeat:"n",type:"rangeall"}]},{n:"OCT2HEX",t:9,d:"将八进制数转换为十六进制数。",a:"将八进制数转换为十六进制数。",m:[1,2],p:[{name:"number",detail:'要转换为带符号的十六进制数的带符号的30位八进制数值（以字符串形式提供）。\n\n带符号的ba进制数的最高位是符号位；也就是说，负数是以二的补码形式表示的。\n\n此函数可接受的最大正数值为3777777777，最小负数值为4000000000。\n\n如果所提供的带符号的八进制数是有效的八进制数，函数会自动将其转换为相应的字符串输入。例如，OCT2HEX(177)和OCT2HEX("177")得出的结果相同，均为7F。',example:"37",require:"m",repeat:"n",type:"rangeall"},{name:"places",detail:"[ 可选 ] - 结果中要确保的有效位数。\n\n如果设置的有效位数大于结果中的有效位数，则在结果的左侧填充0，使总有效位数达到有效位数。\n\n如果带符号的八进制数的最高位为1，则忽略此值；即当给定的带符号的八进制数大于等于4000000000时忽略此值。",example:"8",require:"o",repeat:"n",type:"rangenumber"}]},{n:"COMPLEX",t:9,d:"将实系数及虚系数转换为 x+yi 或 x+yj 形式的复数。",a:"将实系数及虚系数转换为 x+yi 或 x+yj 形式的复数。",m:[2,3],p:[{name:"real_num",detail:"复数的实系数。",example:"3",require:"m",repeat:"n",type:"rangenumber"},{name:"i_num",detail:"复数的虚系数。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"suffix",detail:'[可选 - 默认为 "i"] - 复数中虚系数的后缀。',example:'"j"',require:"o",repeat:"n",type:"rangestring"}]},{n:"IMREAL",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的实系数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的实系数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其实系数的复数。",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMAGINARY",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的虚系数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的虚系数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其虚系数的复数。",example:'"4+5i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMCONJUGATE",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的共轭复数。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的共轭复数。",m:[1,1],p:[{name:"inumber",detail:"需要计算其共轭数的复数。",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMABS",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的复数的绝对值（模）。",a:"返回以 x+yi 或 x+yj 文本格式表示的复数的绝对值（模）。",m:[1,1],p:[{name:"inumber",detail:"要计算其绝对值的复数。",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"DELTA",t:9,d:"检验两个值是否相等。 如果 number1=number2，则返回 1；否则返回 0。",a:"检验两个值是否相等。 如果 number1=number2，则返回 1；否则返回 0。",m:[1,2],p:[{name:"number1",detail:"第一个数字。",example:"2",require:"m",repeat:"n",type:"rangenumber"},{name:"number2",detail:"[可选 - 默认为 0] - 第二个数字。",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"IMSUM",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的和。",a:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的和。",m:[1,255],p:[{name:"inumber1",detail:"要相加的第一个复数",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, …",detail:"[可选] - 要与值1 相加的其他复数",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMSUB",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的差。",a:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的差。",m:[2,2],p:[{name:"inumber1",detail:"从（复）数中减去 inumber2。",example:'"6+5i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:"从 inumber1 中减（复）数。",example:'"2+3i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IMPRODUCT",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的乘积。",a:"返回以 x+yi 或 x+yj 文本格式表示的 1 至 255 个复数的乘积。",m:[1,255],p:[{name:"inumber1",detail:"用于计算乘积的第一个复数",example:'"3+4i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2, …",detail:"[可选] - 要相乘的其他复数。",example:'"5-3i"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IMDIV",t:9,d:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的商。",a:"返回以 x+yi 或 x+yj 文本格式表示的两个复数的商。",m:[2,2],p:[{name:"inumber1",detail:"复数分子或被除数。",example:'"11+16i"',require:"m",repeat:"n",type:"rangeall"},{name:"inumber2",detail:"复数分母或除数。",example:'"3+2i"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NOT",t:10,d:"返回某个逻辑值的相反值 - “NOT(TRUE())”将返回 FALSE；“NOT(FALSE())”将返回 TRUE。",a:"返回某个逻辑值的相反值 - “NOT(TRUE())”将返回 FALSE；“NOT(FALSE())”将返回 TRUE。",m:[1,1],p:[{name:"logical",detail:"计算结果为 TRUE 或 FALSE 的任何值或表达式。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TRUE",t:10,d:"返回逻辑值 TRUE。",a:"返回逻辑值 TRUE。",m:[0,0],p:[]},{n:"FALSE",t:10,d:"返回逻辑值 FALSE。",a:"返回逻辑值 FALSE。",m:[0,0],p:[]},{n:"AND",t:10,d:"所有参数的计算结果为 TRUE 时，返回 TRUE；只要有一个参数的计算结果为 FALSE，即返回 FALSE。",a:"所有参数的计算结果为 TRUE 时，返回 TRUE；只要有一个参数的计算结果为 FALSE，即返回 FALSE。",m:[1,255],p:[{name:"logical1",detail:"要测试的第一个条件，其计算结果可以为 TRUE 或 FALSE。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"logical2,...",detail:"[可选] - 要测试的其他条件，其计算结果可以为 TRUE 或 FALSE，最多可包含 255 个条件。",example:'A3 = "bar"',require:"o",repeat:"y",type:"rangeall"}]},{n:"IFERROR",t:10,d:"如果第一个参数不是错误值，就返回第一个参数；否则，返回第二个参数。",a:"如果第一个参数不是错误值",m:[2,2],p:[{name:"value",detail:"检查是否存在错误的参数。",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"value_if_error",detail:"公式的计算结果错误时返回的值。 计算以下错误类型：#N/A、#VALUE!、#REF!、#DIV/0!、#NUM!、#NAME? 或 #NULL!。",example:'"Error in cell A1"',require:"m",repeat:"n",type:"rangeall"}]},{n:"IF",t:10,d:"当逻辑表达式的值为 TRUE 时返回一个值，而当其为 FALSE 时返回另一个值。",a:"当逻辑表达式的值为 TRUE 时返回一个值，而当其为 FALSE 时返回另一个值。",m:[2,3],p:[{name:"logical_test",detail:"一个表达式或对包含表达式的单元格的引用，该表达式代表某种逻辑值（即TRUE或FALSE）。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_true",detail:"当逻辑表达式为TRUE时的返回值。",example:'"A2 is foo"',require:"m",repeat:"n",type:"rangeall"},{name:"value_if_false",detail:"[可选 - 默认为空白] - 当逻辑表达式等于FALSE时的函数返回值。",example:'"A2 was false"',require:"o",repeat:"n",type:"rangeall"}]},{n:"OR",t:10,d:"只要有一个参数的计算结果为 TRUE 时，返回 TRUE；所有参数的计算结果为 FALSE，即返回 FALSE。",a:"只要有一个参数的计算结果为 TRUE 时，返回 TRUE；所有参数的计算结果为 FALSE，即返回 FALSE。",m:[1,255],p:[{name:"logical1",detail:"要测试的第一个条件，其计算结果可以为 TRUE 或 FALSE。",example:'A2 = "foo"',require:"m",repeat:"n",type:"rangeall"},{name:"逻辑表达式2",detail:"[可选] - 其他表达式或对包含表达式的单元格的引用，这些表达式代表某种逻辑值（即TRUE或FALSE）或者可以强制转换为逻辑值。",example:' A3 = "bar"',require:"m",repeat:"n",type:"rangeall"}]},{n:"NE",t:11,d:"如果指定的值不相等，则返回“TRUE”；否则返回“FALSE”。相当于“<>”运算符。",a:"如果指定的值不相等，则返回“TRUE”；否则返回“FALSE”。相当于“<>”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"要检查是否与 value1 不相等的值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"EQ",t:11,d:"如果指定的值相等，则返回“TRUE”；否则返回“FALSE”。相当于“=”运算符。",a:"如果指定的值相等，则返回“TRUE”；否则返回“FALSE”。相当于“=”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"要检查是否与 value1 相等的值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GT",t:11,d:"如果第一个参数严格大于第二个，则返回 TRUE；否则返回 FALSE。相当于“>”运算符。",a:"如果第一个参数严格大于第二个，则返回 TRUE；否则返回 FALSE。相当于“>”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否大于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"GTE",t:11,d:"如果第一个参数大于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“>=”运算符。",a:"如果第一个参数大于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“>=”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否大于等于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LT",t:11,d:"如果第一个参数严格小于第二个，则返回 TRUE；否则返回 FALSE。相当于“<”运算符。",a:"如果第一个参数严格小于第二个，则返回 TRUE；否则返回 FALSE。相当于“<”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否小于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"LTE",t:11,d:"如果第一个参数小于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“<=”运算符。",a:"如果第一个参数小于或等于第二个，则返回 TRUE；否则返回 FALSE。相当于“<=”运算符。",m:[2,2],p:[{name:"value1",detail:"要测试其是否小于等于 value2 的值。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"第二个值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ADD",t:11,d:"返回两个数值之和。相当于 `+` 运算符。",a:"返回两个数值之和。相当于 `+` 运算符。",m:[2,2],p:[{name:"value1",detail:"第一个加数。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"第二个加数。",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINUS",t:11,d:"返回两个数值之差。相当于“-”运算符。",a:"返回两个数值之差。相当于“-”运算符。",m:[2,2],p:[{name:"value1",detail:"被减数，即要对其计减的数值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"减数，即要从 value1 中减除的数值。",example:"A3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MULTIPLY",t:11,d:"返回两个数的乘积。相当于“*”运算符。",a:"返回两个数的乘积。相当于“*”运算符。",m:[2,2],p:[{name:"value1",detail:"第一个乘数。",example:"A2",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"第二个乘数。",example:"B2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DIVIDE",t:11,d:"返回两个参数相除所得的结果。相当于 `/` 运算符。",a:"返回两个参数相除所得的结果。相当于 `/` 运算符。",m:[2,2],p:[{name:"value1",detail:"要被除的数值。",example:"4",require:"m",repeat:"n",type:"rangenumber"},{name:"value2",detail:"用于除其他数的数值。\n\n除数不得为0。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCAT",t:11,d:"返回两个值的串联。相当于 `&` 运算符。",a:"返回两个值的串联。相当于 `&` 运算符。",m:[2,2],p:[{name:"value1",detail:"value2 将附于其后的值。",example:'"de"',require:"m",repeat:"n",type:"rangeall"},{name:"value2",detail:"要附于 value1 之后的值。",example:'"mystify"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UNARY_PERCENT",t:11,d:"返回按百分比解释的数值。例如，“UNARY_PERCENT(100)”等于1。",a:"返回按百分比解释的数值。例如，“UNARY_PERCENT(100)”等于1。",m:[1,1],p:[{name:"number",detail:"要作为百分比解释的数值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CONCATENATE",t:12,d:"将两个或多个文本字符串联接为一个字符串。",a:"将两个或多个文本字符串联接为一个字符串。",m:[1,255],p:[{name:"text1",detail:"初始字符串。",example:'"Super"',require:"m",repeat:"n",type:"rangeall"},{name:"text2 ...",detail:"[可选] - 要按顺序连接在一起的其他字符串。",example:'"calla"',require:"o",repeat:"y",type:"rangeall"}]},{n:"CODE",t:12,d:"返回所提供的字符串中首字符的 Unicode 映射值。",a:"返回所提供的字符串中首字符的 Unicode 映射值。",m:[1,1],p:[{name:"text",detail:"要返回其首字符的Unicode映射值的字符串。",example:'"a"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CHAR",t:12,d:"按照当前 Unicode 编码表，将数字转换为对应的字符。",a:"按照当前 Unicode 编码表，将数字转换为对应的字符。",m:[1,1],p:[{name:"number",detail:"介于 1 到 255 之间的数字。",example:"97",require:"m",repeat:"n",type:"rangenumber"}]},{n:"ARABIC",t:12,d:"将罗马数字转换为阿拉伯数字。",a:"将罗马数字转换为阿拉伯数字。",m:[1,1],p:[{name:"text",detail:"要转换格式的罗马数字",example:'"XIV"',require:"m",repeat:"n",type:"rangeall"}]},{n:"ROMAN",t:12,d:"将数字格式设置为罗马数字形式。",a:"将数字格式设置为罗马数字形式。",m:[1,1],p:[{name:"number",detail:"要设置格式的数字，介于1到3999之间（包括这两个数字）。",example:"499",require:"m",repeat:"n",type:"rangenumber"}]},{n:"REGEXEXTRACT",t:12,d:"按照正则表达式提取匹配的子串。",a:"按照正则表达式提取匹配的子串。",m:[2,2],p:[{name:"text",detail:"输入文本。",example:'"Needle in a haystack"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"此函数将返回文本中符合此表达式的第一个子串。",example:'".e{2}dle"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXMATCH",t:12,d:"判断一段文本是否与正则表达式相匹配。",a:"判断一段文本是否与正则表达式相匹配。",m:[2,2],p:[{name:"text",detail:"要用正则表达式测试的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"用来测试文本的正则表达式。",example:'"S.r"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REGEXREPLACE",t:12,d:"使用正则表达式将文本字符串中的一部分替换为其他文本字符串。",a:"使用正则表达式将文本字符串中的一部分替换为其他文本字符串。",m:[3,3],p:[{name:"text",detail:"要对其局部进行替换操作的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"regular_expression",detail:"正则表达式。 text 中所有匹配的实例都将被替换。",example:'"S.*d"',require:"m",repeat:"n",type:"rangeall"},{name:"replacement",detail:"要插入到原有文本中的文本。",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"T",t:12,d:"返回文本格式的字符串参数。",a:"返回文本格式的字符串参数。",m:[1,1],p:[{name:"value",detail:"要转换为文本的参数。\n\n如果值为文本，T将返回值本身。\n\n如果值为指向包含文本的单元格的引用，T将返回值中的内容。\n\n如果值为错误值或包含错误值的单元格，T将返回该错误值。\n\n对于所有其他情况，T将返回空串。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"FIXED",t:12,d:"以固定的小数位数设置数字的格式。",a:"以固定的小数位数设置数字的格式。",m:[1,3],p:[{name:"number",detail:"要进行舍入并转换为文本的数字。",example:"3.141592653",require:"m",repeat:"n",type:"rangenumber"},{name:"decimals",detail:"[可选 - 默认值为2] - 结果中要显示的小数位数。\n\n如果数值的有效位数小于小数位数，将以零填充。如果数值的有效位数大于小数位数，则将其舍入到所需的小数位数而不是将其截断。",example:"2",require:"o",repeat:"n",type:"rangenumber"},{name:"no_commas",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，如果为 TRUE()，则会禁止 FIXED 在返回的文本中包含逗号。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FIND",t:12,d:"返回字符串在文本中首次出现的位置（区分大小写）。",a:"返回字符串在文本中首次出现的位置（区分大小写）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[可选 - 默认值为1] - 要在要搜索的文本中开始搜索的字符位置。",example:"14",require:"o",repeat:"n",type:"rangenumber"}]},{n:"FINDB",t:12,d:"返回某个字符串在文本中首次出现的位置（每个双字节字符占两个位置）。",a:"返回某个字符串在文本中首次出现的位置（每个双字节字符占两个位置）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"新"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:'"农历新年"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[可选 - 默认值为 1] - 要在要搜索的文本中开始搜索的字符位置。",example:"2",require:"o",repeat:"n",type:"rangenumber"}]},{n:"JOIN",t:12,d:"将一个或多个使用指定定界符的一维数组的元素连接到一起。",a:"将一个或多个使用指定定界符的一维数组的元素连接到一起。",m:[2,255],p:[{name:"separator",detail:"置于相互连接的值之间的字符或字符串。\n\n定界符可以为空，例如JOIN(,{1,2,3})。",example:'" and-a "',require:"m",repeat:"n",type:"rangeall"},{name:"array1",detail:"要使用定界符连接的一个或多个值。",example:"{1",require:"m",repeat:"n",type:"rangeall"},{name:"array2, ...",detail:"[可选] - 要使用定界符连接的其他值或数组。",example:"2",require:"o",repeat:"y",type:"rangeall"}]},{n:"LEFT",t:12,d:"从文本字符串的第一个字符开始返回指定个数的字符。",a:"从文本字符串的第一个字符开始返回指定个数的字符。",m:[1,2],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[可选 - 默认值为1] - 指定要由 LEFT 提取的字符的数量。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"RIGHT",t:12,d:"根据所指定的字符数返回文本字符串中最后一个或多个字符。",a:"根据所指定的字符数返回文本字符串中最后一个或多个字符。",m:[1,2],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"num_chars",detail:"[可选 - 默认值为1] - 指定要由 RIGHT 提取的字符的数量。",example:"2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MID",t:12,d:"返回文本字符串中从指定位置开始的特定数目的字符。",a:"返回文本字符串中从指定位置开始的特定数目的字符。",m:[3,3],p:[{name:"text",detail:"包含要提取的字符的文本字符串。",example:'"get this"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"要从字符串中开始提取的位置。字符串中第一个字符的索引为1。",example:"5",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"指定要由 MID 提取的字符的数量。\n\n如果提取的字符数尚不足提取长度个字符时就到达了字符串尾部，则MID返回从开始位置到字符串尾部的字符。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"LEN",t:12,d:"返回给定字符串的长度。",a:"返回给定字符串的长度。",m:[1,1],p:[{name:"text",detail:"要返回其长度的字符串。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LENB",t:12,d:"返回文本中所包含的字符数。与双字节字符集(DBCS)一起使用。",a:"返回文本中所包含的字符数。与双字节字符集(DBCS)一起使用。",m:[1,1],p:[{name:"text",detail:"要返回其字节数的字符串。（一个汉字为两个字节数）",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"LOWER",t:12,d:"将指定字符串中的字母转换为小写。",a:"将指定字符串中的字母转换为小写。",m:[1,1],p:[{name:"text",detail:"要转换为小写的字符串。",example:'"LOREM IPSUM"',require:"m",repeat:"n",type:"rangeall"}]},{n:"UPPER",t:12,d:"将指定字符串中的字母转换为大写。",a:"将指定字符串中的字母转换为大写。",m:[1,1],p:[{name:"text",detail:"要转换为大写的字符串。",example:'"lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"EXACT",t:12,d:"比较两个字符串是否相同。",a:"比较两个字符串是否相同。",m:[2,2],p:[{name:"text1",detail:"要比较的第一个字符串。",example:"A1",require:"m",repeat:"n",type:"rangeall"},{name:"text2",detail:"要比较的第二个字符串。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"REPLACE",t:12,d:"将文本字符串的一部分替换为其他文本字符串。",a:"将文本字符串的一部分替换为其他文本字符串。",m:[4,4],p:[{name:"old_text",detail:"要对其局部进行替换操作的文本。",example:'"Spreadsheets"',require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"开始进行替换操作的位置（文本开头位置为 1）。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"num_chars",detail:"要在文本中替换的字符个数。",example:"6",require:"m",repeat:"n",type:"rangenumber"},{name:"new_text",detail:"要插入到原有文本中的文本。",example:'"Bed"',require:"m",repeat:"n",type:"rangeall"}]},{n:"REPT",t:12,d:"返回指定文本的多次重复。",a:"返回指定文本的多次重复。",m:[2,2],p:[{name:"text",detail:"要重复的字符或字符串。",example:'"ha"',require:"m",repeat:"n",type:"rangeall"},{name:"number_times",detail:"要重复的文本要在返回值中出现的次数。\n\n最大重复次数为100。即使重复次数大于100，REPT也仅将相应文本重复100次。",example:"4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SEARCH",t:12,d:"返回字符串在文本中首次出现的位置（不区分大小写）。",a:"返回字符串在文本中首次出现的位置（不区分大小写）。",m:[2,3],p:[{name:"find_text",detail:"要在要搜索的文本中查找的字符串。",example:'"n"',require:"m",repeat:"n",type:"rangeall"},{name:"within_text",detail:"要在其中搜索搜索字符串的首次出现位置的文本。",example:"A2",require:"m",repeat:"n",type:"rangeall"},{name:"start_num",detail:"[ 可选 - 默认值为1 ] - 要在要搜索的文本中开始搜索的字符位置。",example:"14",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUBSTITUTE",t:12,d:"在文本字符串中用 new_text 替换 old_text。",a:"在文本字符串中用 new_text 替换 old_text。",m:[3,4],p:[{name:"text",detail:"需要替换其中字符的文本，或对含有文本（需要替换其中字符）的单元格的引用。",example:'"search for it"',require:"m",repeat:"n",type:"rangeall"},{name:"old_text",detail:"需要替换的文本。",example:'"search for"',require:"m",repeat:"n",type:"rangeall"},{name:"new_text",detail:"用于替换 old_text 的文本。",example:'"Google"',require:"m",repeat:"n",type:"rangeall"},{name:"instance_num",detail:"[ 可选 ] - 指定要用 new_text 替换 old_text 的事件。 如果指定了 instance_num，则只有满足要求的 old_text 被替换。 否则，文本中出现的所有 old_text 都会更改为 new_text。",example:"3",require:"m",repeat:"n",type:"rangenumber"}]},{n:"CLEAN",t:12,d:"移除文本中的不可打印 ASCII 字符后将其返回。",a:"移除文本中的不可打印 ASCII 字符后将其返回。",m:[1,1],p:[{name:"text",detail:"要移除其中不可打印字符的文本。",example:'"AF"&CHAR(31)',require:"m",repeat:"n",type:"rangeall"}]},{n:"TEXT",t:12,d:"按照指定格式将数字转换为文本。",a:"按照指定格式将数字转换为文本。",m:[2,2],p:[{name:"value",detail:"要设置格式的数字、日期或时间。",example:"1.23",require:"m",repeat:"n",type:"rangenumber"},{name:"format_text",detail:'以括号括起来的模式串，将按该模式设置数字的格式。\n\n0表示在数值位数少于格式指定的位数时必定以零填充。例如，TEXT(12.3,"000.00")将返回012.30。当数值的小数位数超过模式指定的小数位数时，四舍五入为指定的小数位数。例如，TEXT(12.305,"00.00")将返回12.31。\n\n#类似于0，但并不是在小数点的两侧都以零填充。例如，TEXT(12.3,"###.##")将返回12.3。',example:'"$0.00"',require:"m",repeat:"n",type:"rangeall"}]},{n:"TRIM",t:12,d:"删除指定字符串前后的空格。",a:"删除指定字符串前后的空格。",m:[1,1],p:[{name:"text",detail:"要修剪的字符串或指向包含该字符串的单元格的引用。",example:'" lorem ipsum"',require:"m",repeat:"n",type:"rangeall"}]},{n:"VALUE",t:12,d:"将可识别的任何日期、时间或数字格式的字符串转换为数字。",a:"将可识别的任何日期、时间或数字格式的字符串转换为数字。",m:[1,1],p:[{name:"text",detail:"包含要转换的值的字符串。",example:'"123"',require:"m",repeat:"n",type:"rangeall"}]},{n:"PROPER",t:12,d:"将指定字符串中每个单词的首字母转为大写。",a:"将指定字符串中每个单词的首字母转为大写。",m:[1,1],p:[{name:"text",detail:"要转换的文本，其中每个单词的首字母都将转为大写，所有其他字母则转为小写。",example:'"united states"',require:"m",repeat:"n",type:"rangeall"}]},{n:"CONVERT",t:13,d:"将数字从一种度量系统转换为另一种度量系统。",a:"将数字从一种度量系统转换为另一种度量系统。",m:[3,3],p:[{name:"number",detail:"是以 from_unit 为单位的需要进行转换的数值。",example:"5.1",require:"m",repeat:"n",type:"rangenumber"},{name:"from_unit",detail:"是数值的单位。",example:'"g"',require:"m",repeat:"n",type:"rangeall"},{name:"to_unit",detail:"是结果的单位。",example:'"kg"',require:"m",repeat:"n",type:"rangeall"}]},{n:"SUMX2MY2",t:14,d:"返回两数组中对应数值的平方差之和。",a:"返回两数组中对应数值的平方差之和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMX2PY2",t:14,d:"返回两数组中对应数值的平方和之和。",a:"返回两数组中对应数值的平方和之和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMXMY2",t:14,d:"返回两数组中对应数值之差的平方和。",a:"返回两数组中对应数值之差的平方和。",m:[2,2],p:[{name:"array_x",detail:"第一个数组或数值区域。",example:"A2:A100",require:"m",repeat:"n",type:"rangenumber"},{name:"array_y",detail:"第二个数组或数值区域。",example:"B2:B100",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TRANSPOSE",t:14,d:"将数组或单元格范围的行列转置。",a:"将数组或单元格范围的行列转置。",m:[1,1],p:[{name:"array",detail:"要将其行列互换的数组或范围。",example:"{1,2}",require:"m",repeat:"n",type:"range"}]},{n:"TREND",t:14,d:"返回线性趋势值。",a:"返回线性趋势值。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[可选 - 默认与 known_x 相同] -  需要函数 TREND 返回对应 y 值的新 x 值。",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FREQUENCY",t:14,d:"计算数值在某个区域内的出现频率，然后返回一个垂直数组。",a:"计算数值在某个区域内的出现频率，然后返回一个垂直数组。",m:[2,2],p:[{name:"data_array",detail:"要对其频率进行计数的一组数值或对这组数值的引用。",example:"A2:A40",require:"m",repeat:"n",type:"rangenumber"},{name:"bins_array",detail:"要将 data_array 中的值插入到的间隔数组或对间隔的引用。\n\n为清晰起见，应将类别排序，但如果未排序，FREQUENCY会在内部对这些指定的值进行排序并返回正确结果。",example:"B2:B5",require:"m",repeat:"n",type:"rangenumber"}]},{n:"GROWTH",t:14,d:"使用现有数据计算预测的指数等比。",a:"使用现有数据计算预测的指数等比。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = b*m^x 中已知的 y 值集合。\n\n如果已知数据_y为二维数组或范围，则已知数据_x的维数必须与之相同，或者省略此参数。\n\n如果已知数据_y为一维数组或范围，已知数据_x则可代表二维数组或范围中的多个自变量。也就是说，如果已知数据_y为单行，则将已知数据_x中的每行解释为各自独立的值，类似情况也适用于已知数据_y为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = b*m^x 中已知的可选 x 值集合。\n\n如果已知数据_y为一维数组或范围，已知数据_x则可代表二维数组或范围中的多个自变量。也就是说，如果已知数据_y为单行，则将已知数据_x中的每行解释为各自独立的值，类似情况也适用于已知数据_y为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"new_x",detail:"[可选 - 默认与 known_x 相同] - 需要函数 GROWTH 返回对应 y 值的新 x 值。",example:"A11:A13",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] -一个逻辑值，用于指定是否将常量 b 强制设为 1。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 1，m 将被调整以使 y = m^x。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LINEST",t:14,d:"可通过使用最小二乘法计算与现有数据最佳拟合的直线，来计算某直线的统计值，然后返回描述此直线的数组。",a:"可通过使用最小二乘法计算与现有数据最佳拟合的直线，来计算某直线的统计值，然后返回描述此直线的数组。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，用于指定是否返回附加回归统计值。\n\n如果详细为TRUE，除了对应于每个自变量的一组线性系数和y截距之外，LINEST还返回以下信息：\n\n每项系数和截距的标准误差、\n\n限定系数（介于0和1之间，1表示完全相关）、\n\n因变量值的标准误差、\n\nF统计或F观测值，指示所观测到的因变量和自变量变量之间的关系是随机的还是线性的、\n\n自由度，用于在参照表中查找F统计值以估算可信度、\n\n回归平方和，以及\n\n残差平方和。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"LOGEST",t:14,d:"在回归分析中，计算最符合数据的指数回归拟合曲线，并返回描述该曲线的数值数组。",a:"在回归分析中，计算最符合数据的指数回归拟合曲线，并返回描述该曲线的数值数组。",m:[1,4],p:[{name:"known_y",detail:"关系表达式 y = mx + b 中已知的 y 值集合。\n\n如果 known_y 为二维数组或范围，则 known_x 的维数必须与之相同，或者省略此参数。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"B2:B10",require:"m",repeat:"n",type:"rangenumber"},{name:"known_x",detail:"[可选 - 默认该数组为{1,2,3,...},其大小与 known_y 相同] - 关系表达式 y = mx + b 中已知的可选 x 值集合。\n\n如果 known_y 为一维数组或范围，known_x 则可代表二维数组或范围中的多个自变量。也就是说，如果 known_y 为单行，则将 known_x 中的每行解释为各自独立的值，类似情况也适用于 known_y 为单列的情况。",example:"A2:A10",require:"o",repeat:"n",type:"rangenumber"},{name:"const",detail:"[可选 - 默认值为TRUE()] - 一个逻辑值，用于指定是否将常量 b 强制设为 0。\n\nTRUE() 表示 b 将按正常计算；\n\nFALSE() 表示 b 将被设为 0（零），m 将被调整以使 y = mx。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"stats",detail:"[可选 - 默认值为FALSE()] - 一个逻辑值，用于指定是否返回附加回归统计值。\n\n如果详细为TRUE，则除了为每个自变量和系数 b 返回一组指数值之外，LOGEST 还将返回以下数据：\n\n每项指数和系数的标准误差、\n\n限定系数（介于 0 和 1 之间，1 表示完全相关）、\n\n因变量值的标准误差、\n\nF 统计或 F 观测值，指示所观测到的因变量和自变量之间的关系是随机的还是指数的、\n\n自由度 - 用于在参照表中查找 F 统计值以估算可信度、\n\n回归平方和，以及\n\n残差平方和。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"MDETERM",t:14,d:"返回一个数组的矩阵行列式的值。",a:"返回一个数组的矩阵行列式的值。",m:[1,1],p:[{name:"array",detail:"行数和列数相等的数值数组。",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MINVERSE",t:14,d:"返回数组中存储的矩阵的逆矩阵。",a:"返回数组中存储的矩阵的逆矩阵。",m:[1,1],p:[{name:"array",detail:"行数和列数相等的数值数组。",example:"A1:D4",require:"m",repeat:"n",type:"rangenumber"}]},{n:"MMULT",t:14,d:"返回两个数组的矩阵乘积。结果矩阵的行数与 array1 的行数相同，矩阵的列数与 array2 的列数相同。",a:"返回两个数组的矩阵乘积。结果矩阵的行数与 array1 的行数相同，矩阵的列数与 array2 的列数相同。",m:[2,2],p:[{name:"array1",detail:"要进行矩阵乘法运算的第一个矩阵数组。\n\narray1 列数必须与 array2 的行数相同",example:"A1:B3",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"要进行矩阵乘法运算的第二个矩阵数组。\n\narray2 的行数必须与 array1 列数相同",example:"C1:F2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"SUMPRODUCT",t:14,d:"在给定的几组数组中，将数组间对应的元素相乘，并返回乘积之和。",a:"在给定的几组数组中，将数组间对应的元素相乘，并返回乘积之和。",m:[1,255],p:[{name:"array1",detail:"其相应元素需要进行相乘并求和的第一个数组参数。",example:"A2:C5",require:"m",repeat:"n",type:"rangenumber"},{name:"array2",detail:"[可选] - 其相应元素需要进行相乘并求和的其它数组参数。",example:"D2:F5",require:"o",repeat:"y",type:"rangenumber"}]},{n:"ISFORMULA",t:15,d:"检查公式是否位于引用的单元格中。",a:"检查公式是否位于引用的单元格中。",m:[1,1],p:[{name:"cell",detail:"要检查是否存在公式的单元格。\n\n如果 cell 为包含公式的单元格，则 ISFORMULA 将返回 TRUE。如果 cell 为相应单元格范围，则当该范围内的首个单元格包含公式时，系统会返回 TRUE。如果是任何其他值，系统都将返回 FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"CELL",t:15,d:"返回有关单元格的格式、位置或内容的信息。",a:"返回有关单元格的格式、位置或内容的信息。",m:[2,2],p:[{name:"info_type",detail:"一个文本值，指定要返回的单元格信息的类型。",example:'"type"',require:"m",repeat:"n",type:"rangeall"},{name:"reference",detail:"需要其相关信息的单元格。",example:"C2",require:"m",repeat:"n",type:"range"}]},{n:"NA",t:15,d:"返回错误值 #N/A。",a:"返回错误值 #N/A。",m:[0,0],p:[]},{n:"ERROR_TYPE",t:15,d:"返回与其他单元格中的错误值相对应的数字。",a:"返回与其他单元格中的错误值相对应的数字。",m:[1,1],p:[{name:"error_val",detail:"用于查找错误号的单元格，虽然您也可以直接提供错误值。",example:"A3",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISBLANK",t:15,d:"检查所引用的单元格是否为空。",a:"检查所引用的单元格是否为空。",m:[1,1],p:[{name:"value",detail:"对要检查其是否为空的单元格的引用。\n\n如果是空单元格，则 TRUE；否则返回 FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISERR",t:15,d:"检查某个值是否为 #N/A 以外的错误值。",a:"检查某个值是否为 #N/A 以外的错误值。",m:[1,1],p:[{name:"value",detail:"要验证其是否为#N/A以外的错误类型的值。\n\n如果值是除#N/A之外的任何错误（包括#DIV/0!、#NAME?、#NULL!、#NUM!、#VALUE!和#REF!），ISERR将返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISERROR",t:15,d:"检查某个值是否为错误值。",a:"检查某个值是否为错误值。",m:[1,1],p:[{name:"value",detail:"要验证其是否为错误类型的值。\n\n只要值是某种错误值（包括#DIV/0!、#N/A、#NAME?、#NULL!、#NUM!、#VALUE!和#REF!），ISERROR就会返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISLOGICAL",t:15,d:"检查某个值是 TRUE 还是 FALSE。",a:"检查某个值是 TRUE 还是 FALSE。",m:[1,1],p:[{name:"value",detail:"要验证其为逻辑TRUE还是逻辑FALSE的值。\n\n*如果值为TRUE或FALSE，或为指向值为TRUE或FALSE的单元格的引用，ISLOGICAL将返回TRUE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNA",t:15,d:"检查某个值是否为错误值 #N/A。",a:"检查某个值是否为错误值 #N/A。",m:[1,1],p:[{name:"value",detail:"要与错误值#N/A进行比较的值。\n\n*如果值为#N/A或指向包含#N/A的单元格的引用，则ISNA将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNONTEXT",t:15,d:"检查某个值是否为非文本。",a:"检查某个值是否为非文本。",m:[1,1],p:[{name:"value",detail:"要检查的文本。\n\n*如果参数为文本值或指向包含文本的单元格的引用，ISNONTEXT将返回FALSE，否则返回TRUE。\n\n当值为指向空单元格的引用时，ISNONTEXT会返回TRUE。\n\n当值为空字符串时，ISNONTEXT将返回FALSE，因为空串被视作文本。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISNUMBER",t:15,d:"检查某个值是否为数字。",a:"检查某个值是否为数字。",m:[1,1],p:[{name:"value",detail:"要验证其是否为数字的值。\n\n*如果参数为数字或指向内容为数字值的单元格的引用，ISNUMBER将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISREF",t:15,d:"检查某个值是否为有效的单元格引用。",a:"检查某个值是否为有效的单元格引用。",m:[1,1],p:[{name:"value",detail:"要验证其是否为单元格引用的值。\n\n*如果参数是有效的单元格引用，ISREF将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"range"}]},{n:"ISTEXT",t:15,d:"检查某个值是否为文本。",a:"检查某个值是否为文本。",m:[1,1],p:[{name:"value",detail:"要验证其是否为文本的值。\n\n如果参数为文本值或指向包含文本值的单元格的引用，ISTEXT将返回TRUE，否则返回FALSE。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TYPE",t:15,d:"返回数值的类型。",a:"返回数值的类型。",m:[1,1],p:[{name:"value",detail:"要确定其类型的数据。\n\n数字 返回 1;\n\n文本 返回 2;\n\n逻辑值 返回 4;\n\n错误值 返回 16;\n\n数组 返回 64;",example:"C4",require:"m",repeat:"n",type:"rangeall"}]},{n:"N",t:15,d:"返回转化为数值后的值。",a:"返回转化为数值后的值。",m:[1,1],p:[{name:"value",detail:"要转换为数字的参数。\n\n如果值为数字，则返回该数字。\n\n如果值为日期，则返回该日期的序列号。\n\n如果值为TRUE，则返回1。\n\n如果值为FALSE，则返回0。\n\n如果值为错误值，则返回错误值。\n\n如果值为其他值，则返回0。",example:"A2",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DATE",t:16,d:"将指定的数字转换为日期。",a:"将指定的数字转换为日期。",m:[1,1],p:[{name:"value",detail:"要转换为日期的参数或其单元格引用。\n\n如果值为数字或指向内容为数值的单元格的引用，TO_DATE会将值转换为相应的日期并返回，值代表从十二月30日到对应的日期之间的天数，\n\n负值表示对应的日期在十二月30日之前，而小数值则代表一天中从午夜算起的时间。\n如果值不是数字或指向内容为数值的单元格的引用，则TO_DATE将在不做任何修改的情况下返回值。",example:"25405",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PURE_NUMBER",t:16,d:"将给定的日期/时间、百分比、货币金额或其他格式的数值转换为不带格式的纯数字。",a:"将给定的日期/时间、百分比、货币金额或其他格式的数值转换为不带格式的纯数字。",m:[1,1],p:[{name:"value",detail:"要转换为纯数字的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_PURE_NUMBER将以不带任何格式与解释的形式返回值。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_PERCENT将在不做任何修改的情况下返回值。",example:"50%",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_TEXT",t:16,d:"将给定的数字值转换为文本格式。",a:"将给定的数字值转换为文本格式。",m:[1,1],p:[{name:"value",detail:"要转换为文本的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_TEXT将返回字符串形式的值，并保持现有格式。即原为货币的仍为货币，原为十进制数的仍为十进制数，原为百分比的仍为百分比，原为日期的仍为日期。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_TEXT将在不做任何修改的情况下返回值。",example:"24",require:"m",repeat:"n",type:"rangeall"}]},{n:"TO_DOLLARS",t:16,d:"将指定的数字转换为美元金额。",a:"将指定的数字转换为美元金额。",m:[1,1],p:[{name:"value",detail:"要转换为美元金额的参数或其单元格引用。\n\n如果值不是数字或指向内容为数值的单元格的引用，则 TO_DOLLARS 将在不做任何修改的情况下返回值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"TO_PERCENT",t:16,d:"将指定的数字转换为百分比。",a:"将指定的数字转换为百分比。",m:[1,1],p:[{name:"value",detail:"要转换为百分比的参数或其单元格引用。\n\n如果值为数字或指向包含数值的单元格的引用，TO_PERCENT会以1 = 100%为标准，将值转换为百分比。\n\n如果值不是数字或指向内容为数值的单元格的引用，则TO_PERCENT将在不做任何修改的情况下返回值。",example:"A2",require:"m",repeat:"n",type:"rangenumber"}]},{n:"DGET",t:17,d:"使用 SQL 式查询，从列表或数据库的列中提取符合指定条件的单个值。",a:"使用 SQL 式查询，从列表或数据库的列中提取符合指定条件的单个值。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMAX",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最大数字。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最大数字。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DMIN",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最小数字。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的最小数字。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DAVERAGE",t:17,d:"使用 SQL 式查询，对列表或数据库中满足指定条件的记录字段（列）中的数值求平均值。",a:"使用 SQL 式查询，对列表或数据库中满足指定条件的记录字段（列）中的数值求平均值。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNT",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中包含数字的单元格的个数。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中包含数字的单元格的个数。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DCOUNTA",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的非空单元格的个数。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的非空单元格的个数。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DPRODUCT",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数值的乘积。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数值的乘积。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEV",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体标准偏差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体标准偏差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSTDEVP",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的总体标准偏差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为样本总体计算出的总体标准偏差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DSUM",t:17,d:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数字之和。",a:"使用 SQL 式查询，返回列表或数据库中满足指定条件的记录字段（列）中的数字之和。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVAR",t:17,d:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体方差。",a:"使用 SQL 式查询，返回利用列表或数据库中满足指定条件的记录字段（列）中的数字作为一个样本估算出的总体方差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"DVARP",t:17,d:"使用 SQL 式查询，通过使用列表或数据库中满足指定条件的记录字段（列）中的数字计算样本总体的样本总体方差。",a:"使用 SQL 式查询，通过使用列表或数据库中满足指定条件的记录字段（列）中的数字计算样本总体的样本总体方差。",m:[3,3],p:[{name:"database",detail:"构成列表或数据库的单元格区域，列表的第一行包含每一列的标签。",example:"A2:F20",require:"m",repeat:"n",type:"range"},{name:"field",detail:"指定 database 中的哪一列包含要提取和用于计算的值。\n\nfield 可以是与 database 第一行中某个列标题对应的文本标签，也可以是指定相关列的数字索引，第一列的索引值为 1。",example:"G2",require:"m",repeat:"n",type:"rangeall"},{name:"criteria",detail:"包含所指定条件的单元格区域。计算之前将使用这些条件来过滤 database 中的值。",example:"A22:D23",require:"m",repeat:"n",type:"range"}]},{n:"AGE_BY_IDCARD",t:"3",d:"根据中国身份证号计算出年龄。支持15为或18位身份证",a:"根据身份证号得到年龄。",m:[1,2],p:[{name:"身份证号",example:"A1",detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"},{name:"截止日期",example:'"2017-10-01"',detail:"年龄计算的截止日期或范围，默认为当日。",require:"o",repeat:"n",type:"rangedatetime"}]},{n:"SEX_BY_IDCARD",t:"3",d:"根据中国身份证号计算出性别。支持15为或18位身份证",a:"根据身份证号得到性别。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"BIRTHDAY_BY_IDCARD",t:"3",d:"根据中国身份证号计算出生日。支持15为或18位身份证",a:"根据身份证号得到生日。",m:[1,2],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"},{name:"生日格式",example:"0",detail:"日期类型,默认0:[1900/01/01], 1:[1900-01-01], 2:[1900年1月1日]",require:"o",repeat:"n",type:"rangeall"}]},{n:"PROVINCE_BY_IDCARD",t:"3",d:"根据中国身份证号计算出籍贯的省份。支持15为或18位身份证",a:"根据身份证号得到籍贯的省份。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"CITY_BY_IDCARD",t:"3",d:"根据中国身份证号计算出籍贯的城市。支持15为或18位身份证",a:"根据身份证号得到籍贯的城市。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"STAR_BY_IDCARD",t:"3",d:"根据中国身份证号计算出星座。支持15为或18位身份证",a:"根据身份证号得到星座。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"ANIMAL_BY_IDCARD",t:"3",d:"根据中国身份证号计算出生肖（鼠、牛、虎、兔...）。支持15为或18位身份证",a:"根据身份证号得到生肖。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"ISIDCARD",t:"3",d:"验证身份证的格式是否正确。支持15为或18位身份证",a:"验证身份证格式正确性。",m:[1,1],p:[{name:"身份证号",example:'"31033519900101XXXX"',detail:"15位或者18位的身份证号或范围。",require:"m",repeat:"n",type:"rangeall"}]},{n:"DM_TEXT_CUTWORD",t:"4",d:"文本分词。把一连串文字拆分为一系列单独词语",a:"中文文本分词。",m:[1,2],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeall"},{name:"分词模式",example:"0",detail:"默认为0[精确模式], 1[全模式], 2[搜索引擎模式]。",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TFIDF",t:"4",d:"采用tf-idf算法进行关键词提取。从一连串文字中识别关键词",a:"tf-idf关键词识别。",m:[1,3],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeall"},{name:"关键词个数",example:"20",detail:"算法返回的关键词个数，默认20",require:"o",repeat:"n",type:"rangenumber"},{name:"语料库",example:"1",detail:"选择特定领域的语料库，默认0[通用], 1[金融], 2[医疗]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DM_TEXT_TEXTRANK",t:"4",d:"采用TextRank算法进行关键词提取。从一连串文字中识别关键词",a:"TextRank关键词识别。",m:[1,3],p:[{name:"文本",example:'"我来到北京清华大学"',detail:"任意需要分词的文本。",require:"m",repeat:"n",type:"rangeall"},{name:"关键词个数",example:"20",detail:"算法返回的关键词个数，默认20",require:"o",repeat:"n",type:"rangenumber"},{name:"语料库",example:"1",detail:"选择特定领域的语料库，默认0[通用], 1[金融], 2[医疗]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_CLOSE",t:"5",d:"根据股票代码和日期，返回A股对应股票收盘价。",a:"返回A股对应股票收盘价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_OPEN",t:"5",d:"根据股票代码和日期，返回A股对应股票开盘价。",a:"返回A股对应股票开盘价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MAX",t:"5",d:"根据股票代码和日期，返回A股对应股票最高价。",a:"返回A股对应股票最高价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_MIN",t:"5",d:"根据股票代码和日期，返回A股对应股票最低价。",a:"返回A股对应股票最低价。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_VOLUMN",t:"5",d:"根据股票代码和日期，返回A股对应股票成交量。",a:"返回A股对应股票成交量。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"DATA_CN_STOCK_AMOUNT",t:"5",d:"根据股票代码和日期，返回A股对应股票成交额。",a:"返回A股对应股票成交额。",m:[1,3],p:[{name:"股票代码",example:'"000001"',detail:"6位股票代码，必填项。",require:"m",repeat:"n",type:"rangeall"},{name:"日期",example:"2015-01-08",detail:"股票的交易日，默认为最新交易日",require:"o",repeat:"n",type:"rangedate"},{name:"复权除权",example:"0",detail:"选择股票的除权复权类型，默认0[前复权], 1[原始价格], 2[后复权]",require:"o",repeat:"n",type:"rangenumber"}]},{n:"ISDATE",t:"6",d:"验证日期的格式是否正确。支持多种日期格式",a:"验证日期格式正确性。",m:[1,1],p:[{name:"日期",example:'"1990-01-01"',detail:"日期值，例如1990/01/01, 1990年1月1日等。",require:"m",repeat:"n",type:"rangeall"}]},{n:"LINESPLINES",t:"3",d:"生成嵌入在单元格内的折线图sparklines，用于描述数据的连续走势",a:"生成单元格折线图",m:[1,8],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"线条颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"线条粗细",example:"1",detail:"折线图线段粗细，默认为1px",require:"o",repeat:"n",type:"rangeall"},{name:"辅助线",example:"avg",detail:"一条横线，可以是min、max、avg、median、范围或自定义数值，默认0无",require:"o",repeat:"n",type:"rangeall"},{name:"辅助线颜色",example:"#000",detail:"辅助线的颜色设置，同线条颜色配置，默认#000",require:"o",repeat:"n",type:"rangeall"},{name:"最大值标识",example:"#fc5c5c",detail:"标识线图最大值，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeall"},{name:"最小值标识",example:"#fc5c5c",detail:"标识线图最大值，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeall"},{name:"标识大小",example:"1.5",detail:"最大值和最小值的标识大小设置，默认为1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"AREASPLINES",t:"3",d:"生成嵌入在单元格内的面积图sparklines，一般用于描述数据的连续累积值走势",a:"生成单元格面积图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"线条颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"填充颜色",example:"#CCF3F4",detail:"形成面积图，同线条颜色配置，默认0不显示",require:"o",repeat:"n",type:"rangeall"},{name:"线条粗细",example:"1",detail:"折线图线段粗细，默认为1px",require:"o",repeat:"n",type:"rangeall"},{name:"辅助线",example:"avg",detail:"一条横线，可以是min、max、avg、median、范围或自定义数值，默认0无",require:"o",repeat:"n",type:"rangeall"},{name:"辅助线颜色",example:"#000",detail:"辅助线的颜色设置，同线条颜色配置，默认#000",require:"o",repeat:"n",type:"rangeall"}]},{n:"COLUMNSPLINES",t:"3",d:"生成嵌入在单元格内的垂直柱状图sparklines，一般用于描述离散数据之间的大小情况",a:"生成单元格垂直柱状图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"最大值",example:"100",detail:"柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeall"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0:5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKCOLUMNSPLINES",t:"3",d:"生成嵌入在单元格内的累积垂直柱状图sparklines，一般用于描述离散数据多个维度的数值大小",a:"生成单元格累积垂直柱状图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"按列堆积",example:"1",detail:"如果需要按行堆积则本项设为false或0，默认为是1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"最大值",example:"100",detail:"累积柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeall"},{name:"累积色板",example:"#97b552",detail:"调色板可以单独设置每个维度的柱条颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BARSPLINES",t:"3",d:"生成嵌入在单元格内的横向条形图sparklines，一般用于描述离散数据之间的大小情况",a:"生成单元格横向条形图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"最大值",example:"100",detail:"柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeall"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0:5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeall"}]},{n:"STACKBARSPLINES",t:"3",d:"生成嵌入在单元格内的累积横向条形图sparklines，一般用于描述离散数据多个维度的数值大小",a:"生成单元格累积横向条形图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"按列堆积",example:"1",detail:"如果需要按行堆积则本项设为false或0，默认为是1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"最大值",example:"100",detail:"累积柱图最大值，用于规范柱图长度，默认为自动计算false、auto、null",require:"o",repeat:"n",type:"rangeall"},{name:"累积色板",example:"#97b552",detail:"调色板可以单独设置每个维度的柱条颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"DISCRETESPLINES",t:"3",d:"生成嵌入在单元格内的离散图sparklines，一般用于描述离散数据走势",a:"生成单元格离散图",m:[1,4],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"分割阈值",example:"1",detail:"离散图柱形颜色的区分，例如：该值为0，则大于0为蓝色，小于0为红色，默认为0",require:"o",repeat:"n",type:"rangeall"},{name:"阈值以上颜色",example:"#2ec7c9",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#2ec7c9",require:"o",repeat:"n",type:"rangeall"},{name:"阈值以下颜色",example:"#fc5c5c",detail:"阈值以下柱条颜色设置，同阈值以上颜色，默认#fc5c5c",require:"o",repeat:"n",type:"rangeall"}]},{n:"TRISTATESPLINES",t:"3",d:"生成嵌入在单元格内的三态图sparklines，一般用于描述三种态势的走势例如胜负平",a:"生成单元格离散图",m:[1,6],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"柱条间隔",example:"1",detail:"柱条之间的间隔距离，默认为1",require:"o",repeat:"n",type:"rangeall"},{name:"柱条颜色",example:"#fc5c5c",detail:"线图的线条颜色，可以是否个范围A1、色表索引数值或者具体颜色值，设置为0或false则不显示，支持regx、rgb、rgba等。默认#fc5c5c",require:"o",repeat:"n",type:"rangeall"},{name:"负向柱条颜色",example:"#97b552",detail:"负向柱条颜色设置，代表负值的颜色，同柱条颜色配置，默认#97b552",require:"o",repeat:"n",type:"rangeall"},{name:"零值柱条颜色",example:"#999",detail:"零值柱条颜色设置，代表0值颜色，同柱条颜色配置，默认#999",require:"o",repeat:"n",type:"rangeall"},{name:"色板",example:"#97b552",detail:"调色板可以单独设置每个柱条的颜色，可设置多个，支持两种格式：1颜色例如#000，代表第一个柱的颜色是黑色；2数值范围:颜色，例如-2:#000表示数值为-2的柱为黑色，0-5:#000表示数值0-5的柱为黑色，默认为空",require:"o",repeat:"y",type:"rangeall"}]},{n:"PIESPLINES",t:"3",d:"生成嵌入在单元格内的饼图sparklines，一般用于描述数据占比",a:"生成单元格饼图",m:[1,5],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"旋转角度",example:"0",detail:"饼图的旋转角度，默认为0",require:"o",repeat:"n",type:"rangeall"},{name:"饼图边框",example:"0",detail:"饼图边框大小，默认为无0",require:"o",repeat:"n",type:"rangeall"},{name:"边框颜色",example:"#000",detail:"饼图边框颜色，默认为#000",require:"o",repeat:"n",type:"rangeall"},{name:"饼图色板",example:"#97b552",detail:"调色板可以设置切片的颜色，可设置为A1:A10等范围，默认为#2ec7c9, #fc5c5c, #5ab1ef, #ffb980...",require:"o",repeat:"y",type:"rangeall"}]},{n:"BOXSPLINES",t:"3",d:"生成嵌入在单元格内的箱线图sparklines，一般用于描述数据集的统计分布",a:"生成单元格箱线图",m:[1,4],p:[{name:"数据范围",example:"A1:A20",detail:"数据范围，数值才能被有效计算，例如A1:A20， {1,2,3,4,5}等。",require:"m",repeat:"n",type:"rangeall"},{name:"离群点比例",example:"1.5",detail:"离群点的阈值范围，如果为0或false则不显示，默认为1.5倍",require:"o",repeat:"n",type:"rangeall"},{name:"目标点值",example:"10",detail:"箱线图上的目标值设置，默认为false不显示",require:"o",repeat:"n",type:"rangeall"},{name:"数据点大小",example:"1.5",detail:"目标点和利群点的半径大小设置，默认为1.5",require:"o",repeat:"n",type:"rangeall"}]},{n:"BULLETSPLINES",t:"3",d:"生成嵌入在单元格内的子弹图sparklines，一般用于描述任务达成率",a:"生成单元格子弹图",m:[2,3],p:[{name:"目标",example:"10",detail:"达成的目标值，数值才能被有效计算，例如A1， 100等。",require:"m",repeat:"n",type:"rangeall"},{name:"实际完成",example:"8",detail:"目前完成值，数值才能被有效计算，例如A1， 100等。",require:"m",repeat:"n",type:"rangeall"},{name:"对比值",example:"12",detail:"对比值，例如超额、最低、获奖底线等，数值才能被有效计算，例如A1， 100等。可以设置最多9个对比值",require:"o",repeat:"y",type:"rangeall"}]},{n:"COMPOSESPLINES",t:"3",d:"支持多个类型的图画在同一个单元格,每个参数代表一个sparklines图",a:"组合sparklines图到一个单元格",m:[1,1],p:[{name:"图设置",example:"PIESPLINES(A1:A20)",detail:"sparklines图设置，例如A1:A20， 一个完成的饼图、线图设置等。",require:"m",repeat:"y",type:"rangeall"}]},{n:"SORT",t:"14",d:"返回数组中元素的排序数组。返回的数组与提供的数组参数形状相同。",a:"返回数组中元素的排序数组。返回的数组与提供的数组参数形状相同。",m:[1,4],p:[{name:"array",detail:"要排序的范围或数组。",example:"A2:A17",require:"m",repeat:"n",type:"rangenumber"},{name:"sort_index",detail:"[可选] - 表示要排序的行或列的数字。（默认row1/col1）",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"sort_order",detail:"[可选] - 表示所需排序顺序的数字；1表示升序（默认），-1表示降序。",example:"-1",require:"o",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[可选] - 表示所需排序方向的逻辑值；按行排序为FALSE()（默认），按列排序为TRUE()。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"FILTER",t:"14",d:"基于一个布尔（真/假）数组过滤一个数组。",a:"基于一个布尔（真/假）数组过滤一个数组。",m:[2,3],p:[{name:"array",detail:"要筛选的数组或范围。",example:"A5:D20",require:"m",repeat:"n",type:"range"},{name:"include",detail:"布尔数组，其高度或宽度与数组相同",example:"1",require:"m",repeat:"n",type:"range"},{name:"if_empty",detail:"[可选] - 如果包含数组中的所有值都为空(filter不返回任何值)，则返回的值。",example:'""',require:"o",repeat:"n",type:"rangeall"}]},{n:"UNIQUE",t:"14",d:"返回列表或区域中的唯一值的列表。",a:"返回列表或区域中的唯一值的列表。",m:[1,3],p:[{name:"array",detail:"从其返回唯一值的数组或区域。",example:"A2:B26",require:"m",repeat:"n",type:"rangenumber"},{name:"by_col",detail:"[可选] - 逻辑值，指示如何比较；按行 = FALSE() 或省略；按列 = TRUE()。",example:"TRUE()",require:"o",repeat:"n",type:"rangeall"},{name:"occurs_once",detail:"[可选] - 逻辑值，仅返回唯一值中出现一次 = TRUE()；包括所有唯一值 = FALSE() 或省略。",example:"FALSE()",require:"o",repeat:"n",type:"rangeall"}]},{n:"RANDARRAY",t:"14",d:"返回 0 到 1 之间的随机数字数组。",a:"返回 0 到 1 之间的随机数字数组。",m:[0,2],p:[{name:"rows",detail:"[可选] - 要返回的行数。",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[可选] - 要返回的列数。",example:"1",require:"o",repeat:"n",type:"rangenumber"}]},{n:"SEQUENCE",t:"14",d:"生成数字序列的列表。",a:"生成数字序列的列表。",m:[1,4],p:[{name:"rows",detail:"要返回的行数。",example:"1",require:"m",repeat:"n",type:"rangenumber"},{name:"cols",detail:"[可选] - 要返回的列数。",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"start",detail:"[可选] - 序列中的第一个数字。",example:"1",require:"o",repeat:"n",type:"rangenumber"},{name:"step",detail:"[可选] - 序列中每个序列值的增量。",example:"1",require:"o",repeat:"n",type:"rangenumber"}]}],jfgrid.functionImplementation={SUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else if(jfgrid.func_methods.isRealNum(t))r.push(t);else{if("boolean"!=jfgrid.getObjType(t))return jfgrid.formula.error.v;"true"==t.toString().toLowerCase()?r.push(1):"false"==t.toString().toLowerCase()&&r.push(0)}}var i=0;if(0<r.length)for(e=0;e<r.length;e++){if(jfgrid.func_methods.valueIsError(r[e]))return r[e];jfgrid.func_methods.isRealNum(r[e])&&(i+=parseFloat(r[e]))}return i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},AVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else r=r.concat(t);else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"text",!0)):r.push(t)}for(var i=0,a=0,e=0;e<r.length;e++){if(jfgrid.func_methods.valueIsError(r[e]))return r[e];if(!jfgrid.func_methods.isRealNum(r[e]))return jfgrid.formula.error.v;i+=parseFloat(r[e]),a++}return 0==a?jfgrid.formula.error.d:i/a}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},COUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else r=r.concat(t);else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"text",!0)):"boolean"==jfgrid.getObjType(t)?"true"==t.toString().toLowerCase()?r.push(1):"false"==t.toString().toLowerCase()&&r.push(0):r.push(t)}for(var i=0,e=0;e<r.length;e++)jfgrid.func_methods.isRealNum(r[e])&&i++;return i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},COUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t))}else r=r.concat(t);else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"text",!0)):r.push(t)}return r.length}catch(e){return e=jfgrid.formula.errorInfo(e),[jfgrid.formula.error.v,e]}},MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else r=r.concat(t);else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):r.push(t)}for(var i=null,e=0;e<r.length;e++){if(jfgrid.func_methods.valueIsError(r[e]))return r[e];jfgrid.func_methods.isRealNum(r[e])&&(null==i||parseFloat(r[e])>i)&&(i=parseFloat(r[e]))}return null==i?0:i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else r=r.concat(t);else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):r.push(t)}for(var i=null,e=0;e<r.length;e++){if(jfgrid.func_methods.valueIsError(r[e]))return r[e];jfgrid.func_methods.isRealNum(r[e])&&(null==i||parseFloat(r[e])<i)&&(i=parseFloat(r[e]))}return null==i?0:i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},AGE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!window.jfgrid_function.ISIDCARD.f(r))return jfgrid.formula.error.v;var t=window.jfgrid_function.BIRTHDAY_BY_IDCARD.f(r);if(jfgrid.func_methods.valueIsError(t))return t;t=moment(t);var i=moment();if(2==arguments.length){if(i=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(i))return i;i=moment(i)}var a=i.diff(t,"years");return a<0||"NaN"==a.toString()?jfgrid.formula.error.v:a}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},SEX_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:window.jfgrid_function.ISIDCARD.f(r)?parseInt(r.substr(16,1))%2==1?"男":"女":jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},BIRTHDAY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!window.jfgrid_function.ISIDCARD.f(r))return jfgrid.formula.error.v;var t="";15==r.length?t="19"+r.substring(6,8)+"/"+r.substring(8,10)+"/"+r.substring(10,12):18==r.length&&(t=r.substring(6,10)+"/"+r.substring(10,12)+"/"+r.substring(12,14));var i=0;if(null!=arguments[1]&&(i=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(i)))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;if((i=parseInt(i))<0||2<i)return jfgrid.formula.error.v;if(0==parseInt(i))return t;if(1==parseInt(i))return moment(t).format("YYYY-MM-DD");if(2==parseInt(i))return moment(t).format("YYYY年M月D日")}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},PROVINCE_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!window.jfgrid_function.ISIDCARD.f(r))return jfgrid.formula.error.v;var t="未知",i=jfgrid.formula.classlist.province;return r.substring(0,2)in i&&(t=i[r.substring(0,2)]),t}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},CITY_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!window.jfgrid_function.ISIDCARD.f(r))return jfgrid.formula.error.v;for(var t=cityData.length,i="未知",e=0;e<t;e++)if(r.substring(0,6)==cityData[e].code){i=cityData[e].title;break}return i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},STAR_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!window.jfgrid_function.ISIDCARD.f(r))return jfgrid.formula.error.v;var t=window.jfgrid_function.BIRTHDAY_BY_IDCARD.f(r);if(jfgrid.func_methods.valueIsError(t))return t;var i=(t=new Date(t)).getMonth(),a=t.getDate(),n=new Date(1999,i,a,0,0,0),o=[];o.push(["魔羯座",new Date(1999,0,1,0,0,0)]),o.push(["水瓶座",new Date(1999,0,20,0,0,0)]),o.push(["双鱼座",new Date(1999,1,19,0,0,0)]),o.push(["白羊座",new Date(1999,2,21,0,0,0)]),o.push(["金牛座",new Date(1999,3,21,0,0,0)]),o.push(["双子座",new Date(1999,4,21,0,0,0)]),o.push(["巨蟹座",new Date(1999,5,22,0,0,0)]),o.push(["狮子座",new Date(1999,6,23,0,0,0)]),o.push(["处女座",new Date(1999,7,23,0,0,0)]),o.push(["天秤座",new Date(1999,8,23,0,0,0)]),o.push(["天蝎座",new Date(1999,9,23,0,0,0)]),o.push(["射手座",new Date(1999,10,22,0,0,0)]),o.push(["魔羯座",new Date(1999,11,22,0,0,0)]);for(e=o.length-1;0<=e;e--)if(n>=o[e][1])return o[e][0];return"未找到匹配星座信息"}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},ANIMAL_BY_IDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!window.jfgrid_function.ISIDCARD.f(r))return jfgrid.formula.error.v;var t=window.jfgrid_function.BIRTHDAY_BY_IDCARD.f(r);if(jfgrid.func_methods.valueIsError(t))return t;t=new Date(t);var i=new Array("猪","鼠","牛","虎","兔","龙","蛇","马","羊","猴","鸡","狗"),a=(parseInt(t.getFullYear())+9)%12;return null==a||isNaN(a)?"未找到匹配生肖信息":i[a]}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},ISIDCARD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;return!!/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(r)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},DM_TEXT_CUTWORD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var t=window.jfgridCurrentRow,i=window.jfgridCurrentColumn,a=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;var n=0;return null!=arguments[1]&&(n=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(n))?n:!jfgrid.func_methods.isRealNum(n)||0!=(n=parseInt(n))&&1!=n&&2!=n?jfgrid.formula.error.v:($.post("/dataqk/tu/api/cutword",{text:r,type:n},function(e){var r=[].concat(jfgrid.flowdata);jfgrid.formula.execFunctionGroup(t,i,e),r[t][i]={v:e,f:a},jfgrid.jfrefreshgrid(r,[{row:[t,t],column:[i,i]}])}),"loading...")}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},DM_TEXT_TFIDF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var t=window.jfgridCurrentRow,i=window.jfgridCurrentColumn,a=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;var n=20;if(null!=arguments[1]&&(n=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(n)))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n);var o=0;return null!=arguments[2]&&(o=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(o))?o:jfgrid.func_methods.isRealNum(o)?(o=parseInt(o),n<0||0!=o&&1!=o&&2!=o?jfgrid.formula.error.v:($.post("/dataqk/tu/api/tfidf",{text:r,count:n,set:o},function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);jfgrid.formula.execFunctionGroup(t,i,e),r[t][i]={v:e,f:a},jfgrid.jfrefreshgrid(r,[{row:[t,t],column:[i,i]}])}),"loading...")):jfgrid.formula.error.v}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},DM_TEXT_TEXTRANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var t=window.jfgridCurrentRow,i=window.jfgridCurrentColumn,a=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;var n=20;if(null!=arguments[1]&&(n=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(n)))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n);var o=0;return null!=arguments[2]&&(o=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(o))?o:jfgrid.func_methods.isRealNum(o)?(o=parseInt(o),n<0||0!=o&&1!=o&&2!=o?jfgrid.formula.error.v:($.post("/dataqk/tu/api/tfidf",{text:r,count:n,set:o},function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);jfgrid.formula.execFunctionGroup(t,i,e),r[t][i]={v:e,f:a},jfgrid.jfrefreshgrid(r,[{row:[t,t],column:[i,i]}])}),"loading...")):jfgrid.formula.error.v}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},DATA_CN_STOCK_CLOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var i=window.jfgridCurrentRow,a=window.jfgridCurrentColumn,n=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=null;if(null!=arguments[1]){var o=arguments[1];if("array"==jfgrid.getObjType(o))return jfgrid.formula.error.v;if("object"==jfgrid.getObjType(o)&&null!=o.startCell){if(null==o.data||"array"==jfgrid.getObjType(o.data)||null==o.data.ct||"d"!=o.data.ct.t)return jfgrid.formula.error.v;t=jfgrid.mask.update("yyyy-mm-dd",o.data.v)}else t=o;if(!jfgrid.datecontroll.isdatetime(t))return[jfgrid.formula.error.v,"日期错误"];t=moment(t).format("YYYY-MM-DD")}var l=0;return null!=arguments[2]&&(l=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(l))?l:!jfgrid.func_methods.isRealNum(l)||0!=(l=parseInt(l))&&1!=l&&2!=l?jfgrid.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:r,date:t,price:l,type:"0"},function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata),t=jfgrid.numFormat(e);null==t&&(t=e),jfgrid.formula.execFunctionGroup(i,a,t),r[i][a]={v:t,f:n},jfgrid.jfrefreshgrid(r,[{row:[i,i],column:[a,a]}])}),"loading...")}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},DATA_CN_STOCK_OPEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var t=window.jfgridCurrentRow,i=window.jfgridCurrentColumn,a=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var n=null;if(null!=arguments[1]){var o=arguments[1];if("array"==jfgrid.getObjType(o))return jfgrid.formula.error.v;if("object"==jfgrid.getObjType(o)&&null!=o.startCell){if(null==o.data||"array"==jfgrid.getObjType(o.data)||null==o.data.ct||"d"!=o.data.ct.t)return jfgrid.formula.error.v;n=jfgrid.mask.update("yyyy-mm-dd",o.data.v)}else n=o;if(!jfgrid.datecontroll.isdatetime(n))return[jfgrid.formula.error.v,"日期错误"];n=moment(n).format("YYYY-MM-DD")}var l=0;return null!=arguments[2]&&(l=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(l))?l:!jfgrid.func_methods.isRealNum(l)||0!=(l=parseInt(l))&&1!=l&&2!=l?jfgrid.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:r,date:n,price:l,type:"1"},function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);jfgrid.formula.execFunctionGroup(t,i,e),r[t][i]={v:e,f:a},jfgrid.jfrefreshgrid(r,[{row:[t,t],column:[i,i]}])}),"loading...")}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},DATA_CN_STOCK_MAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var t=window.jfgridCurrentRow,i=window.jfgridCurrentColumn,a=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var n=null;if(null!=arguments[1]){var o=arguments[1];if("array"==jfgrid.getObjType(o))return jfgrid.formula.error.v;if("object"==jfgrid.getObjType(o)&&null!=o.startCell){if(null==o.data||"array"==jfgrid.getObjType(o.data)||null==o.data.ct||"d"!=o.data.ct.t)return jfgrid.formula.error.v;n=jfgrid.mask.update("yyyy-mm-dd",o.data.v)}else n=o;if(!jfgrid.datecontroll.isdatetime(n))return[jfgrid.formula.error.v,"日期错误"];n=moment(n).format("YYYY-MM-DD")}var l=0;return null!=arguments[2]&&(l=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(l))?l:!jfgrid.func_methods.isRealNum(l)||0!=(l=parseInt(l))&&1!=l&&2!=l?jfgrid.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:r,date:n,price:l,type:"2"},function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);jfgrid.formula.execFunctionGroup(t,i,e),r[t][i]={v:e,f:a},jfgrid.jfrefreshgrid(r,[{row:[t,t],column:[i,i]}])}),"loading...")}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},DATA_CN_STOCK_MIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var t=window.jfgridCurrentRow,i=window.jfgridCurrentColumn,a=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var n=null;if(null!=arguments[1]){var o=arguments[1];if("array"==jfgrid.getObjType(o))return jfgrid.formula.error.v;if("object"==jfgrid.getObjType(o)&&null!=o.startCell){if(null==o.data||"array"==jfgrid.getObjType(o.data)||null==o.data.ct||"d"!=o.data.ct.t)return jfgrid.formula.error.v;n=jfgrid.mask.update("yyyy-mm-dd",o.data.v)}else n=o;if(!jfgrid.datecontroll.isdatetime(n))return[jfgrid.formula.error.v,"日期错误"];n=moment(n).format("YYYY-MM-DD")}var l=0;return null!=arguments[2]&&(l=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(l))?l:!jfgrid.func_methods.isRealNum(l)||0!=(l=parseInt(l))&&1!=l&&2!=l?jfgrid.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:r,date:n,price:l,type:"3"},function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);jfgrid.formula.execFunctionGroup(t,i,e),r[t][i]={v:e,f:a},jfgrid.jfrefreshgrid(r,[{row:[t,t],column:[i,i]}])}),"loading...")}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},DATA_CN_STOCK_VOLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var t=window.jfgridCurrentRow,i=window.jfgridCurrentColumn,a=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var n=null;if(null!=arguments[1]){var o=arguments[1];if("array"==jfgrid.getObjType(o))return jfgrid.formula.error.v;if("object"==jfgrid.getObjType(o)&&null!=o.startCell){if(null==o.data||"array"==jfgrid.getObjType(o.data)||null==o.data.ct||"d"!=o.data.ct.t)return jfgrid.formula.error.v;n=jfgrid.mask.update("yyyy-mm-dd",o.data.v)}else n=o;if(!jfgrid.datecontroll.isdatetime(n))return[jfgrid.formula.error.v,"日期错误"];n=moment(n).format("YYYY-MM-DD")}var l=0;return null!=arguments[2]&&(l=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(l))?l:!jfgrid.func_methods.isRealNum(l)||0!=(l=parseInt(l))&&1!=l&&2!=l?jfgrid.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:r,date:n,price:l,type:"4"},function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);jfgrid.formula.execFunctionGroup(t,i,e),r[t][i]={v:e,f:a},jfgrid.jfrefreshgrid(r,[{row:[t,t],column:[i,i]}])}),"loading...")}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},DATA_CN_STOCK_AMOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var t=window.jfgridCurrentRow,i=window.jfgridCurrentColumn,a=window.jfgridCurrentFunction,r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var n=null;if(null!=arguments[1]){var o=arguments[1];if("array"==jfgrid.getObjType(o))return jfgrid.formula.error.v;if("object"==jfgrid.getObjType(o)&&null!=o.startCell){if(null==o.data||"array"==jfgrid.getObjType(o.data)||null==o.data.ct||"d"!=o.data.ct.t)return jfgrid.formula.error.v;n=jfgrid.mask.update("yyyy-mm-dd",o.data.v)}else n=o;if(!jfgrid.datecontroll.isdatetime(n))return[jfgrid.formula.error.v,"日期错误"];n=moment(n).format("YYYY-MM-DD")}var l=0;return null!=arguments[2]&&(l=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(l))?l:!jfgrid.func_methods.isRealNum(l)||0!=(l=parseInt(l))&&1!=l&&2!=l?jfgrid.formula.error.v:($.post("/dataqk/tu/api/getstockinfo",{stockCode:r,date:n,price:l,type:"5"},function(e){var r=jfgrid.editor.deepCopyFlowData(jfgrid.flowdata);jfgrid.formula.execFunctionGroup(t,i,e),r[t][i]={v:e,f:a},jfgrid.jfrefreshgrid(r,[{row:[t,t],column:[i,i]}])}),"loading...")}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},ISDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:jfgrid.datecontroll.isdatetime(r)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},SUMIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=0,t=arguments[0].data,i=arguments[0].rowl,a=arguments[0].coll,n=jfgrid_parseData(arguments[1]),t=jfgrid.formula.getRangeArray(t)[0];if(arguments[2]){var o,l,d,f,s=[],g=arguments[2].startCell,c=arguments[2].rowl,u=arguments[2].coll,m=arguments[2].sheetName;s=i==c&&a==u?arguments[2].data:(l=[],0,(o=[])[0]=parseInt(g.replace(/[^0-9]/g,""))-1,l[0]=jfgrid.jfgridABCatNum(g.replace(/[^A-Za-z]/g,"")),o[1]=o[0]+i-1,l[1]=l[0]+a-1,d=jfgrid.jfgridchatatABC(l[1]),f=o[1]+1,jfgrid_getcelldata(m+"!"+g+":"+(d+f)).data),s=jfgrid.formula.getRangeArray(s)[0];for(e=0;e<t.length;e++){if((h=t[e])&&jfgrid.formula.acompareb(h,n)){if(!jfgrid.func_methods.isRealNum(s[e]))continue;r+=parseFloat(s[e])}}}else for(var h,e=0;e<t.length;e++){if((h=t[e])&&jfgrid.formula.acompareb(h,n)){if(!jfgrid.func_methods.isRealNum(h))continue;r+=parseFloat(h)}}return r}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},TAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),Math.tan(r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},TANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=Math.exp(2*r);return(t-1)/(t+1)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},CEILING:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?0==(t=parseFloat(t))?0:0<r&&t<0?jfgrid.formula.error.nm:Math.ceil(r/t)*t:jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ATAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),Math.atan(r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ASINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),Math.log(r+Math.sqrt(r*r+1))):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),Math.abs(r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ACOS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<-1||1<r?jfgrid.formula.error.nm:Math.acos(r):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ACOSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<1?jfgrid.formula.error.nm:Math.log(r+Math.sqrt(r*r-1)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},MULTINOMIAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):r.push(t)}for(var i=0,a=1,e=0;e<r.length;e++){var n=r[e];if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;if((n=parseFloat(n))<0)return jfgrid.formula.error.nm;i+=n,a*=jfgrid.func_methods.factorial(n)}return jfgrid.func_methods.factorial(i)/a}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},ATANH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<=-1||1<=r?jfgrid.formula.error.nm:Math.log((1+r)/(1-r))/2:jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ATAN2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseFloat(t),0==r&&0==t?jfgrid.formula.error.d:Math.atan2(t,r)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},COUNTBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=0;if("object"==jfgrid.getObjType(r)&&null!=r.startCell){if(null==r.data)return 1;if("array"==jfgrid.getObjType(r.data))for(var i=0;i<r.data.length;i++)for(var a=0;a<r.data[i].length;a++)null!=r.data[i][a]&&!jfgrid.func_methods.isRealNull(r.data[i][a].v)||t++;else jfgrid.func_methods.isRealNull(r.data.v)&&t++}return t}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},COSH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),(Math.exp(r)+Math.exp(-r))/2):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},INT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0];if("array"==jfgrid.getObjType(r))return"array"==jfgrid.getObjType(r[0])?jfgrid.func_methods.isDyadicArr(r)&&jfgrid.func_methods.isRealNum(r[0][0])?Math.floor(parseFloat(r[0][0])):jfgrid.formula.error.v:jfgrid.func_methods.isRealNum(r[0])?Math.floor(parseFloat(r[0])):jfgrid.formula.error.v;if("object"==jfgrid.getObjType(r)&&null!=r.startCell){if(1<r.coll)return jfgrid.formula.error.v;if(1<r.rowl){var t=jfgrid.formula.getcellrange(r.startCell).row[0];if(window.jfgridCurrentRow<t||window.jfgridCurrentRow>t+r.rowl-1)return jfgrid.formula.error.v;var i=r.data[window.jfgridCurrentRow-t][0]}else i=r.data;return null==i||jfgrid.func_methods.isRealNull(i.v)?0:jfgrid.func_methods.isRealNum(i.v)?Math.floor(parseFloat(i.v)):jfgrid.formula.error.v}if("boolean"==jfgrid.getObjType(r)){if("true"==r.toString().toLowerCase())return 1;if("false"==r.toString().toLowerCase())return 0}return jfgrid.func_methods.isRealNum(r)?Math.floor(parseFloat(r)):jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},ISEVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseInt(r),!(1&Math.abs(r))):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ISODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseInt(r),!!(1&Math.abs(r))):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},LCM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t))}else r=r.concat(t);else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):r.push(t)}for(var i=0;i<r.length;i++){var a=r[i];if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;if((a=parseInt(a))<0)return jfgrid.formula.error.nm;r[i]=a}for(var n,o,l,d=1;void 0!==(o=r.pop());)for(0==o&&(d=0);1<o;){if(o%2){for(e=3,n=Math.floor(Math.sqrt(o));e<=n&&o%e;e+=2);l=e<=n?e:o}else l=2;for(o/=l,d*=l,e=r.length;e;r[--e]%l==0&&1==(r[e]/=l)&&r.splice(e,1));}return d>=Math.pow(2,53)?jfgrid.formula.error.nm:d}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},LN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<=0?jfgrid.formula.error.nm:Math.log(r):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},LOG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;if((r=parseFloat(r))<=0)return jfgrid.formula.error.nm;if(2==arguments.length){var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;if((t=parseFloat(t))<=0)return jfgrid.formula.error.nm}else t=10;return Math.log(r)/Math.log(t)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},LOG10:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<=0?jfgrid.formula.error.nm:Math.log(r)/Math.log(10):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},MOD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;if(0==(t=parseFloat(t)))return jfgrid.formula.error.d;var i=Math.abs(r%t);return 0<t?i:-i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},MROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?r*(t=parseFloat(t))<0?jfgrid.formula.error.nm:Math.round(r/t)*t:jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ODD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=1&(t=Math.ceil(Math.abs(r)))?t:t+1;return 0<=r?t:-t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},SUMSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):r.push(t)}var i=0;if(0<r.length)for(e=0;e<r.length;e++){var a=r[e];if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;i+=(a=parseFloat(a))*a}return i}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},COMBIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),r<0||t<0||r<t?jfgrid.formula.error.nm:jfgrid.func_methods.factorial(r)/(jfgrid.func_methods.factorial(t)*jfgrid.func_methods.factorial(r-t))):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},SUBTOTAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=[];for(e=0;e<t.length;e++){for(var i=[],a=0;a<t[e].length;a++)i.push(t[e][a]);r.push(i)}}else{r=[];for(e=0;e<t.length;e++)r.push(t[e])}else r="object"==jfgrid.getObjType(t)&&null!=t.startCell?jfgrid.func_methods.getFirstValue(t):t;var n=Array.prototype.slice.apply(arguments);if(n.shift(),"array"!=jfgrid.getObjType(r))return jfgrid.func_methods.valueIsError(r)?r:!jfgrid.func_methods.isRealNum(r)||(r=parseInt(r))<1||111<r||11<r&&r<101?jfgrid.formula.error.v:d(r);var o=[];if("array"==jfgrid.getObjType(r[0]))for(e=0;e<r.length;e++){for(i=[],a=0;a<r[e].length;a++){var l=r[e][a];jfgrid.func_methods.valueIsError(l)?i.push(l):!jfgrid.func_methods.isRealNum(l)||(l=parseInt(l))<1||111<l||11<l&&l<101?i.push(jfgrid.formula.error.v):i.push(d(l))}o.push(i)}else for(e=0;e<r.length;e++){l=r[e];jfgrid.func_methods.valueIsError(l)?o.push(l):!jfgrid.func_methods.isRealNum(l)||(l=parseInt(l))<1||111<l||11<l&&l<101?o.push(jfgrid.formula.error.v):o.push(d(l))}return o;function d(e){switch(e){case 1:case 101:return window.jfgrid_function.AVERAGE.f.apply(window.jfgrid_function.AVERAGE,n);case 2:case 102:return window.jfgrid_function.COUNT.f.apply(window.jfgrid_function.COUNT,n);case 3:case 103:return window.jfgrid_function.COUNTA.f.apply(window.jfgrid_function.COUNTA,n);case 4:case 104:return window.jfgrid_function.MAX.f.apply(window.jfgrid_function.MAX,n);case 5:case 105:return window.jfgrid_function.MIN.f.apply(window.jfgrid_function.MIN,n);case 6:case 106:return window.jfgrid_function.PRODUCT.f.apply(window.jfgrid_function.PRODUCT,n);case 7:case 107:return window.jfgrid_function.STDEVA.f.apply(window.jfgrid_function.STDEVA,n);case 8:case 108:return window.jfgrid_function.STDEVP.f.apply(window.jfgrid_function.STDEVP,n);case 9:case 109:return window.jfgrid_function.SUM.f.apply(window.jfgrid_function.SUM,n);case 10:case 110:return window.jfgrid_function.VAR_S.f.apply(window.jfgrid_function.VAR_S,n);case 11:case 111:return window.jfgrid_function.VAR_P.f.apply(window.jfgrid_function.VAR_P,n)}}}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},ASIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<-1||1<r?jfgrid.formula.error.nm:Math.asin(r):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},COUNTIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var i=0;i<arguments.length;i++){var p=jfgrid.formula.errorParamCheck(this.p,arguments[i],i);if(!p[0])return jfgrid.formula.error.v}try{var data_range=arguments[0],range;if("object"!=jfgrid.getObjType(data_range)||null==data_range.startCell)return jfgrid.formula.error.v;range=data_range.data;var data_criteria=arguments[1],criteria;if("array"==jfgrid.getObjType(data_criteria))if(criteria=[],"array"==jfgrid.getObjType(data_criteria[0])){if(!jfgrid.func_methods.isDyadicArr(data_criteria))return jfgrid.formula.error.v;for(var i=0;i<data_criteria.length;i++){for(var rowArr=[],j=0;j<data_criteria[i].length;j++)rowArr.push(data_criteria[i][j]);criteria.push(rowArr)}}else for(var i=0;i<data_criteria.length;i++)criteria.push(data_criteria[i]);else if("object"==jfgrid.getObjType(data_criteria)&&null!=data_criteria.startCell){if(1<data_criteria.rowl||1<data_criteria.coll)return 0;criteria=data_criteria.data}else criteria=data_criteria;if("array"!=jfgrid.getObjType(criteria))return getCriteriaResult(range,criteria);var result=[];if("array"==jfgrid.getObjType(criteria[0]))for(var i=0;i<criteria.length;i++){for(var rowArr=[],j=0;j<criteria[i].length;j++)rowArr.push(getCriteriaResult(range,criteria[i][j]));result.push(rowArr)}else for(var i=0;i<criteria.length;i++)result.push(getCriteriaResult(range,criteria[i]));return result;function getCriteriaResult(range,criter){/[<>=!*?]/.test(criter)||(criter='=="'+criter+'"'),criter=criter.replace("<>","!=");var matches=0,value;if("array"==jfgrid.getObjType(range))for(var i=0;i<range.length;i++)for(var j=0,value;j<range[i].length;j++){null==range[i][j]||jfgrid.func_methods.isRealNull(range[i][j].v)||(value=range[i][j].v,-1<criter.indexOf("*")||-1<criter.indexOf("?")?jfgrid.formula.isWildcard(value,criter)&&matches++:"string"!=typeof value?eval(value+criter)&&matches++:eval('"'+value+'"'+criter)&&matches++)}else null==range||jfgrid.func_methods.isRealNull(range.v)||(value=range.v,-1<criter.indexOf("*")||-1<criter.indexOf("?")?jfgrid.formula.isWildcard(value,criter)&&matches++:"string"!=typeof value?eval(value+criter)&&matches++:eval('"'+value+'"'+criter)&&matches++);return matches}}catch(e){var err=e;return err=jfgrid.formula.errorInfo(err),[jfgrid.formula.error.v,err]}},RADIANS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))*Math.PI/180:jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},RAND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;try{return Math.floor(1e9*Math.random())/1e9}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},COUNTUNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"text",!0)):r.push(t)}return window.jfgrid_function.UNIQUE.f(r)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},DEGREES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?180*(r=parseFloat(r))/Math.PI:jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ERFC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),jStat.erfc(r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},EVEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=1&(t=Math.ceil(Math.abs(r)))?t+1:t;return 0<r?t:-t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},EXP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),Math.exp(r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},FACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r)){if("boolean"!=jfgrid.getObjType(r))return jfgrid.formula.error.v;"true"==r.toString().toLowerCase()?r=1:"false"==r.toString().toLowerCase()&&(r=0)}return(r=parseInt(r))<0?jfgrid.formula.error.nm:jfgrid.func_methods.factorial(r)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},FACTDOUBLE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r)){if("boolean"!=jfgrid.getObjType(r))return jfgrid.formula.error.v;"true"==r.toString().toLowerCase()?r=1:"false"==r.toString().toLowerCase()&&(r=0)}return(r=parseInt(r))<0?jfgrid.formula.error.nm:jfgrid.func_methods.factorialDouble(r)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},PI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;try{return Math.PI}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},FLOOR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;if(0==(t=parseFloat(t)))return jfgrid.formula.error.d;if(0<r&&t<0)return jfgrid.formula.error.nm;var i=-Math.floor(Math.log(Math.abs(t))/Math.log(10));return 0<=r?Math.floor(r/t)*t*Math.pow(10,i)/Math.pow(10,i):-(Math.ceil(Math.abs(r)/t)*t*Math.pow(10,i))/Math.pow(10,i)}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},GCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!1))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!1)):r.push(t)}if(!jfgrid.func_methods.isRealNum(r[0]))return jfgrid.formula.error.v;var i=parseInt(r[0]);if(i<0||i>=Math.pow(2,53))return jfgrid.formula.error.nm;for(e=1;e<r.length;e++){var a=r[e];if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;if((a=parseInt(a))<0||a>=Math.pow(2,53))return jfgrid.formula.error.nm;for(;i&&a;)a<i?i%=a:a%=i;i+=a}return i}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},RANDBETWEEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t))<r?jfgrid.formula.error.nm:r+Math.ceil((t-r+1)*Math.random())-1:jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ROUND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),(0<r?1:-1)*Math.round(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ROUNDDOWN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),(0<r?1:-1)*Math.floor(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ROUNDUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),(0<r?1:-1)*Math.ceil(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},SERIESSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=arguments[3],n=[];if("array"==jfgrid.getObjType(a)){if("array"==jfgrid.getObjType(a[0])&&!jfgrid.func_methods.isDyadicArr(a))return jfgrid.formula.error.v;n=n.concat(jfgrid.func_methods.getDataArr(a,!1))}else"object"==jfgrid.getObjType(a)&&null!=a.startCell?n=n.concat(jfgrid.func_methods.getCellDataArr(a,"number",!1)):n.push(a);if(!jfgrid.func_methods.isRealNum(n[0]))return jfgrid.formula.error.v;for(var o=parseFloat(n[0])*Math.pow(r,t),e=1;e<n.length;e++){var l=n[e];if(!jfgrid.func_methods.isRealNum(l))return jfgrid.formula.error.v;o+=(l=parseFloat(l))*Math.pow(r,t+e*i)}return o}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},SIGN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;if(0<(r=parseFloat(r)))return 1;if(0==r)return 0;if(r<0)return-1}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},SIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),Math.sin(r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},SINH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),(Math.exp(r)-Math.exp(-r))/2):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},SQRT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<0?jfgrid.formula.error.nm:Math.sqrt(r):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},SQRTPI:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<0?jfgrid.formula.error.nm:Math.sqrt(r*Math.PI):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},GAMMALN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<=0?jfgrid.formula.error.nm:jStat.gammaln(r):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},COS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),Math.cos(r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},TRUNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;if(r=parseFloat(r),2==arguments.length){var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}else t=0;return(0<r?1:-1)*Math.floor(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},QUOTIENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?0==(t=parseFloat(t))?jfgrid.formula.error.d:parseInt(r/t,10):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},POWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseFloat(t),0==r&&0==t||r<0&&-1<t.toString().indexOf(".")?jfgrid.formula.error.nm:Math.pow(r,t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},SUMIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=0,t=arguments;jfgrid_getValue(t);for(var i=jfgrid.formula.getRangeArray(t[0])[0],a=new Array(i.length),e=0;e<a.length;e++)a[e]=!0;for(e=1;e<t.length;e+=2)for(var n=jfgrid.formula.getRangeArray(t[e])[0],o=t[e+1],l=0;l<n.length;l++){var d=n[l];a[l]=a[l]&&!!d&&jfgrid.formula.acompareb(d,o)}for(e=0;e<i.length;e++)a[e]&&(r+=parseFloat(i[e]));return r}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},COUNTIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments;jfgrid_getValue(r);for(var t=new Array(jfgrid.formula.getRangeArray(r[0])[0].length),e=0;e<t.length;e++)t[e]=!0;for(e=0;e<r.length;e+=2)for(var i=jfgrid.formula.getRangeArray(r[e])[0],a=r[e+1],n=0;n<i.length;n++){var o=i[n];t[n]=t[n]&&!!o&&jfgrid.formula.acompareb(o,a)}for(var l=0,e=0;e<t.length;e++)t[e]&&l++;return l}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},PRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):r.push(t)}for(var i=1,e=0;e<r.length;e++){var a=r[e];if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;i*=a=parseFloat(a)}return i}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},HARMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):r.push(t)}for(var i=0,a=0,e=0;e<r.length;e++){var n=r[e];if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;if((n=parseFloat(n))<=0)return jfgrid.formula.error.nm;i+=1/n,a++}return a/i}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},HYPGEOMDIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a);var n=jfgrid.func_methods.getCellBoolen(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(r<0||r>Math.min(t,i)||r<Math.max(0,t-a+i))return jfgrid.formula.error.nm;if(t<=0||a<t)return jfgrid.formula.error.nm;if(i<=0||a<i)return jfgrid.formula.error.nm;if(a<=0)return jfgrid.formula.error.nm;function o(e,r,t,i){return jfgrid.func_methods.factorial(t)/(jfgrid.func_methods.factorial(e)*jfgrid.func_methods.factorial(t-e))*(jfgrid.func_methods.factorial(i-t)/(jfgrid.func_methods.factorial(r-e)*jfgrid.func_methods.factorial(i-t-r+e)))/(jfgrid.func_methods.factorial(i)/(jfgrid.func_methods.factorial(r)*jfgrid.func_methods.factorial(i-r)))}return(n?function(e,r,t,i){for(var a=0,n=0;n<=e;n++)a+=o(n,r,t,i);return a}:o)(r,t,i,a)}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},INTERCEPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1)):t.push(r);var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):a.push(i);if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}if(0==jfgrid.func_methods.variance_s(o))return jfgrid.formula.error.d;for(var f=jStat.mean(o),s=jStat.mean(n),g=o.length,c=0,u=0,e=0;e<g;e++)c+=(o[e]-f)*(n[e]-s),u+=Math.pow(o[e]-f,2);var m=c/u;return s-m*f+0*m}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},KURT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"text",!0)):r.push(t)}for(var i=[],a=0;a<r.length;a++){var n=r[a];if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n),i.push(n)}if(i.length<4||0==jfgrid.func_methods.standardDeviation_s(i))return jfgrid.formula.error.d;for(var o=jStat.mean(i),l=i.length,d=0,e=0;e<l;e++)d+=Math.pow(i[e]-o,4);return l*(l+1)/((l-1)*(l-2)*(l-3))*(d/=Math.pow(jStat.stdev(i,!0),4))-3*(l-1)*(l-1)/((l-2)*(l-3))}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},LARGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!0))}else"object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"text",!0)):r.push(arguments[0]);for(var t=[],i=0;i<r.length;i++){var a=r[i];if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a),t.push(a)}if("array"==jfgrid.getObjType(arguments[1])){if("array"==jfgrid.getObjType(arguments[1][0])&&!jfgrid.func_methods.isDyadicArr(arguments[1]))return jfgrid.formula.error.v;n=jfgrid.func_methods.getDataArr(arguments[1])}else if("object"==jfgrid.getObjType(arguments[1])&&null!=arguments[1].startCell){if(1<arguments[1].rowl||1<arguments[1].coll)return jfgrid.formula.error.v;var n,o=arguments[1].data;n=null==o||jfgrid.func_methods.isRealNull(o.v)?0:o.v}else n=arguments[1];if("array"!=jfgrid.getObjType(n))return jfgrid.func_methods.isRealNum(n)?(n=Math.ceil(parseFloat(n)),0==t.length||n<=0||n>t.length?jfgrid.formula.error.nm:r.sort(function(e,r){return r-e})[n-1]):jfgrid.formula.error.v;if(0==t.length)return jfgrid.formula.error.nm;for(var l=[],e=0;e<n.length;e++)jfgrid.func_methods.isRealNum(n[e])?(n[e]=Math.ceil(parseFloat(n[e])),n[e]<=0||n[e]>t.length?l.push(jfgrid.formula.error.nm):l.push(r.sort(function(e,r){return r-e})[n[e]-1])):l.push(jfgrid.formula.error.v);return l}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},STDEVA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!1))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"text",!1)):r.push(t)}for(var i=[],a=0;a<r.length;a++){var n=r[a],n=jfgrid.func_methods.isRealNum(n)?parseFloat(n):"true"==n.toString().toLowerCase()?1:0;i.push(n)}return 0==i.length?0:1==i.length?jfgrid.formula.error.d:jfgrid.func_methods.standardDeviation_s(i)}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},STDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(t,"text",!0)):r.push(t)}for(var i=[],a=0;a<r.length;a++){var n=r[a];if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n),i.push(n)}return 0==i.length?0:1==i.length?jfgrid.formula.error.d:jfgrid.func_methods.standardDeviation(i)}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},GEOMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"text",!0));else if("boolean"==jfgrid.getObjType(t))"true"==t.toString().toLowerCase()?r.push(1):"false"==t.toString().toLowerCase()&&r.push(0);else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],a=0;a<r.length;a++){var n=r[a];if(jfgrid.func_methods.isRealNum(n)){if((n=parseFloat(n))<=0)return jfgrid.formula.error.nm;i.push(n)}}return 0==i.length?jfgrid.formula.error.nm:jStat.geomean(i)}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},RANK_EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=arguments[1],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;i=i.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?i=i.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):i.push(t);for(var a=[],n=0;n<i.length;n++){var o=i[n];if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o),a.push(o)}if(3==arguments.length){var l=jfgrid.func_methods.getCellBoolen(arguments[2]);if(jfgrid.func_methods.valueIsError(l))return l}else l=!1;var d=l?function(e,r){return e-r}:function(e,r){return r-e},f=(a=a.sort(d)).indexOf(r);return-1==f?jfgrid.formula.error.na:f+1}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},RANK_AVG:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=arguments[1],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;i=i.concat(jfgrid.func_methods.getDataArr(t,!0))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?i=i.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0)):i.push(t);for(var a=[],n=0;n<i.length;n++){var o=i[n];if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o),a.push(o)}if(3==arguments.length){var l=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(l))return l;if("boolean"!=jfgrid.getObjType(l))if("string"!=jfgrid.getObjType(l)||"true"!=l.toLowerCase()&&"false"!=l.toLowerCase()){if(!jfgrid.func_methods.isRealNum(l))return jfgrid.formula.error.v;l=0!=(l=parseFloat(l))}else"true"==l.toLowerCase()&&(l=!0),"false"==l.toLowerCase()&&(l=!1)}else l=!1;for(var d=l?function(e,r){return e-r}:function(e,r){return r-e},a=a.sort(d),f=0,e=0;e<a.length;e++)a[e]==r&&f++;return 1<f?(2*a.indexOf(r)+f+1)/2:a.indexOf(r)+1}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},PERCENTRANK_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!0))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"number",!0)):t.push(r);for(var i=[],a=0;a<t.length;a++){var n=t[a];if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n),i.push(n)}var o=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;if(o=parseFloat(o),3==arguments.length){var l=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(l))return l;if(!jfgrid.func_methods.isRealNum(l))return jfgrid.formula.error.v;l=parseInt(l)}else l=3;if(0==i.length)return jfgrid.formula.error.nm;if(l<1)return jfgrid.formula.error.nm;if(1==i.length&&i[0]==o)return 1;i=i.sort(function(e,r){return e-r});for(var d=window.jfgrid_function.UNIQUE.f(i)[0],f=i.length,s=d.length,g=Math.pow(10,l),c=0,u=!1,e=0;!u&&e<s;)o===d[e]?(c=(i.indexOf(d[e])+1)/(f+1),u=!0):o>=d[e]&&(o<d[e+1]||e===s-1)&&(c=(i.lastIndexOf(d[e])+1+(o-d[e])/(d[e+1]-d[e]))/(f+1),u=!0),e++;return isNaN(c)?jfgrid.formula.error.na:Math.floor(c*g)/g}catch(e){var m=e;return m=jfgrid.formula.errorInfo(m),[jfgrid.formula.error.v,m]}},PERCENTRANK_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!0))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"number",!0)):t.push(r);for(var i=[],a=0;a<t.length;a++){var n=t[a];if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n),i.push(n)}var o=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;if(o=parseFloat(o),3==arguments.length){var l=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(l))return l;if(!jfgrid.func_methods.isRealNum(l))return jfgrid.formula.error.v;l=parseInt(l)}else l=3;if(0==i.length)return jfgrid.formula.error.nm;if(l<1)return jfgrid.formula.error.nm;if(1==i.length&&i[0]==o)return 1;i=i.sort(function(e,r){return e-r});for(var d=window.jfgrid_function.UNIQUE.f(i)[0],f=i.length,s=d.length,g=Math.pow(10,l),c=0,u=!1,e=0;!u&&e<s;)o===d[e]?(c=i.indexOf(d[e])/(f-1),u=!0):o>=d[e]&&(o<d[e+1]||e===s-1)&&(c=(i.lastIndexOf(d[e])+(o-d[e])/(d[e+1]-d[e]))/(f-1),u=!0),e++;return isNaN(c)?jfgrid.formula.error.na:Math.floor(c*g)/g}catch(e){var m=e;return m=jfgrid.formula.errorInfo(m),[jfgrid.formula.error.v,m]}},FORECAST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=arguments[1],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;i=i.concat(jfgrid.func_methods.getDataArr(t,!1))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?i=i.concat(jfgrid.func_methods.getCellDataArr(t,"text",!1)):i.push(t);var a=arguments[2],n=[];if("array"==jfgrid.getObjType(a)){if("array"==jfgrid.getObjType(a[0])&&!jfgrid.func_methods.isDyadicArr(a))return jfgrid.formula.error.v;n=n.concat(jfgrid.func_methods.getDataArr(a,!1))}else"object"==jfgrid.getObjType(a)&&null!=a.startCell?n=n.concat(jfgrid.func_methods.getCellDataArr(a,"text",!1)):n.push(a);if(i.length!=n.length)return jfgrid.formula.error.na;for(var o=[],l=[],e=0;e<i.length;e++){var d=i[e],f=n[e];jfgrid.func_methods.isRealNum(d)&&jfgrid.func_methods.isRealNum(f)&&(o.push(parseFloat(d)),l.push(parseFloat(f)))}if(0==jfgrid.func_methods.variance_s(l))return jfgrid.formula.error.d;for(var s=jStat.mean(l),g=jStat.mean(o),c=l.length,u=0,m=0,e=0;e<c;e++)u+=(l[e]-s)*(o[e]-g),m+=Math.pow(l[e]-s,2);var h=u/m;return g-h*s+h*r}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},FISHERINV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=Math.exp(2*r);return(t-1)/(t+1)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},FISHER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<=-1||1<=r?jfgrid.formula.error.nm:Math.log((1+r)/(1-r))/2:jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},MODE_SNGL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}for(var n,o={},l=[],d=0,e=0;e<i.length;e++)o[n=i[e]]=o[n]?o[n]+1:1,o[n]>d&&(d=o[n],l=[]),o[n]==d&&(l[l.length]=n);if(d<=1)return jfgrid.formula.error.na;for(var f=i.indexOf(l[0]),s=0;s<l.length;s++){var g=i.indexOf(l[s]);g<f&&(f=g)}return i[f]}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},WEIBULL_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getCellBoolen(arguments[3]);return jfgrid.func_methods.valueIsError(a)?a:r<0||t<=0||i<=0?jfgrid.formula.error.nm:a?1-Math.exp(-Math.pow(r/i,t)):Math.pow(r,t-1)*Math.exp(-Math.pow(r/i,t))*t/Math.pow(i,t)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},AVEDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}return 0==i.length?jfgrid.formula.error.nm:jStat.sum(jStat(i).subtract(jStat.mean(i)).abs()[0])/i.length}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},AVERAGEA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!1))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else if("true"==n.toString.toLowerCase())r.push(1);else if("false"==n.toString.toLowerCase())r.push(0);else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=0,a=0,e=0;e<r.length;e++){var n=r[e];jfgrid.func_methods.isRealNum(n)?i+=parseFloat(n):"true"==n.toString().toLowerCase()?i+=1:i+=0,a++}return 0==a?jfgrid.formula.error.d:i/a}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},BINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getCellBoolen(arguments[3]);return jfgrid.func_methods.valueIsError(a)?a:r<0||t<r||i<0||1<i?jfgrid.formula.error.nm:a?jStat.binomial.cdf(r,t,i):jStat.binomial.pdf(r,t,i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},BINOM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;if(i=parseFloat(i),r<0)return jfgrid.formula.error.nm;if(t<0||1<t)return jfgrid.formula.error.nm;if(i<0||1<i)return jfgrid.formula.error.nm;for(var a=0;a<=r;){if(jStat.binomial.cdf(a,r,t)>=i)return a;a++}}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},CONFIDENCE_NORM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?(i=parseInt(i),r<=0||1<=r||t<=0||i<1?jfgrid.formula.error.nm:jStat.normalci(1,r,t,i)[1]-1):jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},CORREL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1)):t.push(r);var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):a.push(i);if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}return 0==n.length||0==o.length||0==jfgrid.func_methods.standardDeviation(n)||0==jfgrid.func_methods.standardDeviation(o)?jfgrid.formula.error.d:jStat.corrcoeff(n,o)}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},COVARIANCE_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1)):t.push(r);var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):a.push(i);if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}if(0==n.length||0==o.length)return jfgrid.formula.error.d;for(var f=jStat.mean(n),s=jStat.mean(o),g=0,e=0;e<n.length;e++)g+=(n[e]-f)*(o[e]-s);return g/=n.length}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},COVARIANCE_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1)):t.push(r);var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):a.push(i);if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}return 0==n.length||0==o.length?jfgrid.formula.error.d:jStat.covariance(n,o)}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},DEVSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else if(jfgrid.func_methods.isRealNum(t))r.push(t);else{if("boolean"!=jfgrid.getObjType(t))return jfgrid.formula.error.v;"true"==t.toString().toLowerCase()?r.push(1):"false"==t.toString().toLowerCase()&&r.push(0)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}for(var n=jStat.mean(i),o=0,e=0;e<i.length;e++)o+=Math.pow(i[e]-n,2);return o}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},EXPON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getCellBoolen(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:r<0||t<0?jfgrid.formula.error.nm:i?jStat.exponential.cdf(r,t):jStat.exponential.pdf(r,t)}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},AVERAGEIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t,i,a,n,o,l,d,f=0,s=0,g=arguments[0].data,c=arguments[0].rowl,u=arguments[0].coll,m=jfgrid_parseData(arguments[1]),h=[];arguments[2]&&(r=arguments[2].startCell,t=arguments[2].rowl,i=arguments[2].coll,a=arguments[2].sheetName,h=c==t&&u==i?arguments[2].data:(o=[],0,(n=[])[0]=parseInt(r.replace(/[^0-9]/g,""))-1,o[0]=jfgrid.jfgridABCatNum(r.replace(/[^A-Za-z]/g,"")),n[1]=n[0]+c-1,o[1]=o[0]+u-1,l=jfgrid.jfgridchatatABC(o[1]),d=n[1]+1,jfgrid_getcelldata(a+"!"+r+":"+(l+d)).data),h=jfgrid.formula.getRangeArray(h)[0]),g=jfgrid.formula.getRangeArray(g)[0];for(e=0;e<g.length;e++){var j=g[e];if(j&&jfgrid.formula.acompareb(j,m)){var p=h[e]||j;if(!jfgrid.func_methods.isRealNum(p))continue;f+=parseFloat(p),s++}}return 0==f||0==s?jfgrid.formula.error.d:jfgrid.numFormat(f/s)}catch(e){var v=e;return v=jfgrid.formula.errorInfo(v),[jfgrid.formula.error.v,v]}},AVERAGEIFS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=0,t=0,i=arguments;jfgrid_getValue(i);for(var a=jfgrid.formula.getRangeArray(i[0])[0],n=new Array(a.length),e=0;e<n.length;e++)n[e]=!0;for(e=1;e<i.length;e+=2)for(var o=jfgrid.formula.getRangeArray(i[e])[0],l=i[e+1],d=0;d<o.length;d++){var f=o[d];n[d]=n[d]&&!!f&&jfgrid.formula.acompareb(f,l)}for(e=0;e<a.length;e++)n[e]&&jfgrid.func_methods.isRealNum(a[e])&&(r+=parseFloat(a[e]),t++);return 0==r||0==t?jfgrid.formula.error.d:jfgrid.numFormat(r/t)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},PERMUT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),r<=0||t<0||r<t?jfgrid.formula.error.nm:jfgrid.func_methods.factorial(r)/jfgrid.func_methods.factorial(r-t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},TRIMMEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e,r,t,i,a=0;a<arguments.length;a++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[a],a)[0])return jfgrid.formula.error.v}try{var n=arguments[0],o=[];if("array"==jfgrid.getObjType(n)){if("array"==jfgrid.getObjType(n[0])&&!jfgrid.func_methods.isDyadicArr(n))return jfgrid.formula.error.v;o=o.concat(jfgrid.func_methods.getDataArr(n,!1))}else"object"==jfgrid.getObjType(n)&&null!=n.startCell?o=o.concat(jfgrid.func_methods.getCellDataArr(n,"number",!1)):o.push(n);for(var l=[],a=0;a<o.length;a++){var d=o[a];jfgrid.func_methods.isRealNum(d)&&l.push(parseFloat(d))}var f=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(f))return f;if(!jfgrid.func_methods.isRealNum(f))return jfgrid.formula.error.v;if(f=parseFloat(f),0==l.length)return jfgrid.formula.error.nm;if(f<0||1<f)return jfgrid.formula.error.nm;l.sort(function(e,r){return e-r});var s=window.jfgrid_function.FLOOR.f(l.length*f,2)/2,g=(i=(i=s)||1,(t=l)&&"function"==typeof t.slice?t.slice(i):t);return r=(r=s)||1,g=(e=g)&&"function"==typeof e.slice?e.slice(0,e.length-r):e,g=jStat.mean(g)}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},PERCENTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"number",!1)):t.push(r);for(var i=[],e=0;e<t.length;e++){var a=t[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}var n=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;if(n=parseFloat(n),0==i.length)return jfgrid.formula.error.nm;if(n<=0||1<=n)return jfgrid.formula.error.nm;var o=(i=i.sort(function(e,r){return e-r})).length;if(n<1/(o+1)||1-1/(o+1)<n)return jfgrid.formula.error.nm;var l=n*(o+1)-1,d=Math.floor(l);return l===d?i[l]:i[d]+(l-d)*(i[d+1]-i[d])}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},PERCENTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"number",!1)):t.push(r);for(var i=[],e=0;e<t.length;e++){var a=t[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}var n=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;if(n=parseFloat(n),0==i.length)return jfgrid.formula.error.nm;if(n<0||1<n)return jfgrid.formula.error.nm;var o=n*((i=i.sort(function(e,r){return e-r})).length-1),l=Math.floor(o);return o===l?i[o]:i[l]+(o-l)*(i[l+1]-i[l])}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},PEARSON:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1)):t.push(r);var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):a.push(i);if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}if(0==o.length||0==n.length)return jfgrid.formula.error.d;for(var f=jStat.mean(n),s=jStat.mean(o),g=n.length,c=0,u=0,m=0,e=0;e<g;e++)c+=(n[e]-f)*(o[e]-s),u+=Math.pow(n[e]-f,2),m+=Math.pow(o[e]-s,2);return c/Math.sqrt(u*m)}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},NORM_S_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r))<=0||1<=r?jfgrid.formula.error.nm:jStat.normal.inv(r,0,1):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},NORM_S_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getCellBoolen(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:t?jStat.normal.cdf(r,0,1):jStat.normal.pdf(r,0,1)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},NORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r)){if("boolean"!=jfgrid.getObjType(r))return jfgrid.formula.error.v;"true"==r.toString().toLowerCase()?r=1:"false"==r.toString().toLowerCase()&&(r=0)}r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t)){if("boolean"!=jfgrid.getObjType(t))return jfgrid.formula.error.v;"true"==t.toString().toLowerCase()?t=1:"false"==t.toString().toLowerCase()&&(t=0)}t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i)){if("boolean"!=jfgrid.getObjType(i))return jfgrid.formula.error.v;"true"==i.toString().toLowerCase()?i=1:"false"==i.toString().toLowerCase()&&(i=0)}return i=parseFloat(i),r<=0||1<=r||i<=0?jfgrid.formula.error.nm:jStat.normal.inv(r,t,i)}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},NORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r)){if("boolean"!=jfgrid.getObjType(r))return jfgrid.formula.error.v;"true"==r.toString().toLowerCase()?r=1:"false"==r.toString().toLowerCase()&&(r=0)}r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getCellBoolen(arguments[3]);return jfgrid.func_methods.valueIsError(a)?a:i<=0?jfgrid.formula.error.nm:a?jStat.normal.cdf(r,t,i):jStat.normal.pdf(r,t,i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},NEGBINOM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getCellBoolen(arguments[3]);return jfgrid.func_methods.valueIsError(a)?a:i<0||1<i||r<0||t<1?jfgrid.formula.error.nm:a?jStat.negbin.cdf(r,t,i):jStat.negbin.pdf(r,t,i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},MINA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!1))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else if("true"==a.toString.toLowerCase())r.push(1);else if("false"==a.toString.toLowerCase())r.push(0);else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)?i.push(parseFloat(a)):"true"==a.toString().toLowerCase()?i.push(1):i.push(0)}return 0===i.length?0:Math.min.apply(Math,i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},MEDIAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}return jStat.median(i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},MAXA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!1))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else if("true"==a.toString.toLowerCase())r.push(1);else if("false"==a.toString.toLowerCase())r.push(0);else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)?i.push(parseFloat(a)):"true"==a.toString().toLowerCase()?i.push(1):i.push(0)}return 0===i.length?0:Math.max.apply(Math,i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},LOGNORM_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?(i=parseFloat(i),r<=0||1<=r||i<=0?jfgrid.formula.error.nm:jStat.lognormal.inv(r,t,i)):jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},LOGNORM_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getCellBoolen(arguments[3]);return jfgrid.func_methods.valueIsError(a)?a:r<=0||i<=0?jfgrid.formula.error.nm:a?jStat.lognormal.cdf(r,t,i):jStat.lognormal.pdf(r,t,i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},Z_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!0))}else"object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"text",!0)):r.push(arguments[0]);for(var t=[],i=0;i<r.length;i++){var a=r[i];jfgrid.func_methods.isRealNum(a)&&t.push(parseFloat(a))}var n=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;if(n=parseFloat(n),0==t.length)return jfgrid.formula.error.na;var o=jfgrid.func_methods.standardDeviation_s(t);if(3==arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o)}var l=t.length,d=window.jfgrid_function.AVERAGE.f.apply(window.jfgrid_function.AVERAGE,t);return 1-window.jfgrid_function.NORM_S_DIST.f((d-n)/(o/Math.sqrt(l)),"true")}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},PROB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!1))}else"object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell?r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"text",!1)):r.push(arguments[0]);var t=[];if("array"==jfgrid.getObjType(arguments[1])){if("array"==jfgrid.getObjType(arguments[1][0])&&!jfgrid.func_methods.isDyadicArr(arguments[1]))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(arguments[1],!1))}else"object"==jfgrid.getObjType(arguments[1])&&null!=arguments[1].startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(arguments[1],"text",!1)):t.push(arguments[1]);if(r.length!=t.length)return jfgrid.formula.error.na;for(var i=[],a=[],n=0,e=0;e<r.length;e++){var o=r[e],l=t[e];if(jfgrid.func_methods.isRealNum(o)&&jfgrid.func_methods.isRealNum(l)&&(i.push(parseFloat(o)),a.push(parseFloat(l)),n+=parseFloat(l),parseFloat(l)<=0||1<parseFloat(l)))return jfgrid.formula.error.nm}if(1!=n)return jfgrid.formula.error.nm;var d=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(d))return d;if(!jfgrid.func_methods.isRealNum(d))return jfgrid.formula.error.v;var f=d=parseFloat(d);if(4==arguments.length){if(f=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(f))return f;if(!jfgrid.func_methods.isRealNum(f))return jfgrid.formula.error.v;f=parseFloat(f)}for(var s=0,e=0;e<i.length;e++)i[e]>=d&&i[e]<=f&&(s+=a[e]);return s}catch(e){var g=e;return g=jfgrid.formula.errorInfo(g),[jfgrid.formula.error.v,g]}},QUARTILE_EXC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!0))}else if("object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"text",!0));else{if(!jfgrid.func_methods.isRealNum(arguments[0]))return jfgrid.formula.error.v;r.push(arguments[0])}for(var t=[],e=0;e<r.length;e++){var i=r[e];jfgrid.func_methods.isRealNum(i)&&t.push(parseFloat(i))}var a=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;if(a=parseInt(a),0==t.length)return jfgrid.formula.error.nm;if(a<=0||4<=a)return jfgrid.formula.error.nm;switch(a){case 1:return window.jfgrid_function.PERCENTILE_EXC.f(t,.25);case 2:return window.jfgrid_function.PERCENTILE_EXC.f(t,.5);case 3:return window.jfgrid_function.PERCENTILE_EXC.f(t,.75)}}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},QUARTILE_INC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!0))}else if("object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"text",!0));else{if(!jfgrid.func_methods.isRealNum(arguments[0]))return jfgrid.formula.error.v;r.push(arguments[0])}for(var t=[],e=0;e<r.length;e++){var i=r[e];jfgrid.func_methods.isRealNum(i)&&t.push(parseFloat(i))}var a=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;if(a=parseInt(a),0==t.length)return jfgrid.formula.error.nm;if(a<0||4<a)return jfgrid.formula.error.nm;switch(a){case 0:return Math.min.apply(Math,t);case 1:return window.jfgrid_function.PERCENTILE_INC.f(t,.25);case 2:return window.jfgrid_function.PERCENTILE_INC.f(t,.5);case 3:return window.jfgrid_function.PERCENTILE_INC.f(t,.75);case 4:return Math.max.apply(Math,t)}}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},POISSON_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getCellBoolen(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:r<0||t<0?jfgrid.formula.error.nm:i?jStat.poisson.cdf(r,t):jStat.poisson.pdf(r,t)}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},RSQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else if("object"==jfgrid.getObjType(r)&&null!=r.startCell)t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1));else{if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;t.push(r)}var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else if("object"==jfgrid.getObjType(i)&&null!=i.startCell)a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1));else{if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;a.push(i)}if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}return 0==n.length||0==o.length?jfgrid.formula.error.d:Math.pow(window.jfgrid_function.PEARSON.f(n,o),2)}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},T_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getCellBoolen(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:t<1?jfgrid.formula.error.nm:i?jStat.studentt.cdf(r,t):jStat.studentt.pdf(r,t)}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},T_DIST_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),r<0||t<1?jfgrid.formula.error.nm:2*(1-jStat.studentt.cdf(r,t))):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},T_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t))<1?jfgrid.formula.error.nm:1-jStat.studentt.cdf(r,t):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},T_INV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),r<=0||1<r||t<1?jfgrid.formula.error.nm:jStat.studentt.inv(r,t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},T_INV_2T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),r<=0||1<r||t<1?jfgrid.formula.error.nm:Math.abs(jStat.studentt.inv(r/2,t))):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},T_TEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!1))}else if("object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"text",!1));else{if(!jfgrid.func_methods.isRealNum(arguments[0]))return jfgrid.formula.error.v;r.push(arguments[0])}var t=r,i=[];if("array"==jfgrid.getObjType(arguments[1])){if("array"==jfgrid.getObjType(arguments[1][0])&&!jfgrid.func_methods.isDyadicArr(arguments[1]))return jfgrid.formula.error.v;i=i.concat(jfgrid.func_methods.getDataArr(arguments[1],!1))}else if("object"==jfgrid.getObjType(arguments[1])&&null!=arguments[1].startCell)i=i.concat(jfgrid.func_methods.getCellDataArr(arguments[1],"text",!1));else{if(!jfgrid.func_methods.isRealNum(arguments[1]))return jfgrid.formula.error.v;i.push(arguments[1])}var a=i,n=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n);var o=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;if(o=parseInt(o),-1==[1,2].indexOf(n))return jfgrid.formula.error.nm;if(-1==[1,2,3].indexOf(o))return jfgrid.formula.error.nm;var l,d=null,f=null;if(1==o){for(var s=[],e=0;e<t.length;e++)s.push(t[e]-a[e]);d=Math.abs(jStat.mean(s))/(jfgrid.func_methods.standardDeviation_s(s)/Math.sqrt(t.length)),f=t.length-1}else{var g=jStat.mean(t),c=jStat.mean(a),u=jfgrid.func_methods.variance_s(t),m=jfgrid.func_methods.variance_s(a);switch(d=Math.abs(g-c)/Math.sqrt(u/t.length+m/a.length),o){case 2:f=t.length+a.length-2;break;case 3:f=Math.pow(u/t.length+m/a.length,2)/(Math.pow(u/t.length,2)/(t.length-1)+Math.pow(m/a.length,2)/(a.length-1))}}return 1==n?l=window.jfgrid_function.T_DIST_RT.f(d,f):2==n&&(l=window.jfgrid_function.T_DIST_2T.f(d,f)),l}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},F_DIST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a=jfgrid.func_methods.getCellBoolen(arguments[3]);return jfgrid.func_methods.valueIsError(a)?a:r<0||t<1||i<1?jfgrid.formula.error.nm:a?jStat.centralF.cdf(r,t,i):jStat.centralF.pdf(r,t,i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},F_DIST_RT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?(i=parseInt(i),r<0||t<1||i<1?jfgrid.formula.error.nm:1-jStat.centralF.cdf(r,t,i)):jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},VAR_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}if(0==i.length)return jfgrid.formula.error.d;for(var n=i.length,o=0,l=window.jfgrid_function.AVERAGE.f.apply(window.jfgrid_function.AVERAGE,i),e=0;e<n;e++)o+=Math.pow(i[e]-l,2);return o/n}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},VAR_S:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}if(0==i.length)return jfgrid.formula.error.d;for(var n=i.length,o=0,l=window.jfgrid_function.AVERAGE.f.apply(window.jfgrid_function.AVERAGE,i),e=0;e<n;e++)o+=Math.pow(i[e]-l,2);return o/(n-1)}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},VARA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!1))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else if("true"==a.toString.toLowerCase())r.push(1);else if("false"==a.toString.toLowerCase())r.push(0);else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)?i.push(parseFloat(a)):"true"==a.toString().toLowerCase()?i.push(1):i.push(0)}for(var n=i.length,o=0,l=window.jfgrid_function.AVERAGE.f.apply(window.jfgrid_function.AVERAGE,i),e=0;e<n;e++)o+=Math.pow(i[e]-l,2);return o/(n-1)}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},VARPA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!1))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else if("true"==a.toString.toLowerCase())r.push(1);else if("false"==a.toString.toLowerCase())r.push(0);else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)?i.push(parseFloat(a)):"true"==a.toString().toLowerCase()?i.push(1):i.push(0)}for(var n=i.length,o=0,l=window.jfgrid_function.AVERAGE.f.apply(window.jfgrid_function.AVERAGE,i),e=0;e<n;e++)o+=Math.pow(i[e]-l,2);return o/n}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},STEYX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!1))}else if("object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"text",!1));else{if(!jfgrid.func_methods.isRealNum(arguments[0]))return jfgrid.formula.error.v;r.push(arguments[0])}var t=[];if("array"==jfgrid.getObjType(arguments[1])){if("array"==jfgrid.getObjType(arguments[1][0])&&!jfgrid.func_methods.isDyadicArr(arguments[1]))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(arguments[1],!1))}else if("object"==jfgrid.getObjType(arguments[1])&&null!=arguments[1].startCell)t=t.concat(jfgrid.func_methods.getCellDataArr(arguments[1],"text",!1));else{if(!jfgrid.func_methods.isRealNum(arguments[1]))return jfgrid.formula.error.v;t.push(arguments[1])}if(r.length!=t.length)return jfgrid.formula.error.na;for(var i=[],a=[],e=0;e<r.length;e++){var n=r[e],o=t[e];jfgrid.func_methods.isRealNum(n)&&jfgrid.func_methods.isRealNum(o)&&(i.push(parseFloat(n)),a.push(parseFloat(o)))}if(i.length<3||a.length<3)return jfgrid.formula.error.d;for(var l=jStat.mean(a),d=jStat.mean(i),f=a.length,s=0,g=0,c=0,e=0;e<f;e++)s+=Math.pow(i[e]-d,2),g+=(a[e]-l)*(i[e]-d),c+=Math.pow(a[e]-l,2);return Math.sqrt((s-g*g/c)/(f-2))}catch(e){var u=e;return u=jfgrid.formula.errorInfo(u),[jfgrid.formula.error.v,u]}},STANDARDIZE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?(i=parseFloat(i))<=0?jfgrid.formula.error.nm:(r-t)/i:jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},SMALL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!0))}else if("object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"number",!0));else{if(!jfgrid.func_methods.isRealNum(arguments[0]))return jfgrid.formula.error.v;r.push(arguments[0])}for(var t=[],e=0;e<r.length;e++){var i=r[e];jfgrid.func_methods.isRealNum(i)&&t.push(parseFloat(i))}var a=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(a)?a:jfgrid.func_methods.isRealNum(a)?(a=parseInt(a),0==t.length||a<=0||a>t.length?jfgrid.formula.error.nm:t.sort(function(e,r){return e-r})[a-1]):jfgrid.formula.error.v}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},SLOPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[];if("array"==jfgrid.getObjType(arguments[0])){if("array"==jfgrid.getObjType(arguments[0][0])&&!jfgrid.func_methods.isDyadicArr(arguments[0]))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(arguments[0],!1))}else if("object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(arguments[0],"text",!1));else{if(!jfgrid.func_methods.isRealNum(arguments[0]))return jfgrid.formula.error.v;r.push(arguments[0])}var t=[];if("array"==jfgrid.getObjType(arguments[1])){if("array"==jfgrid.getObjType(arguments[1][0])&&!jfgrid.func_methods.isDyadicArr(arguments[1]))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(arguments[1],!1))}else if("object"==jfgrid.getObjType(arguments[1])&&null!=arguments[1].startCell)t=t.concat(jfgrid.func_methods.getCellDataArr(arguments[1],"text",!1));else{if(!jfgrid.func_methods.isRealNum(arguments[1]))return jfgrid.formula.error.v;t.push(arguments[1])}if(r.length!=t.length)return jfgrid.formula.error.na;for(var i=[],a=[],e=0;e<r.length;e++){var n=r[e],o=t[e];jfgrid.func_methods.isRealNum(n)&&jfgrid.func_methods.isRealNum(o)&&(i.push(parseFloat(n)),a.push(parseFloat(o)))}if(i.length<3||a.length<3)return jfgrid.formula.error.d;for(var l=jStat.mean(a),d=jStat.mean(i),f=a.length,s=0,g=0,e=0;e<f;e++)s+=(a[e]-l)*(i[e]-d),g+=Math.pow(a[e]-l,2);return s/g}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},SKEW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}if(i.length<3||0==jfgrid.func_methods.standardDeviation_s(i))return jfgrid.formula.error.d;for(var n=jStat.mean(i),o=i.length,l=0,e=0;e<o;e++)l+=Math.pow(i[e]-n,3);return o*l/((o-1)*(o-2)*Math.pow(jStat.stdev(i,!0),3))}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},SKEW_P:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=[],e=0;e<arguments.length;e++){var t=arguments[e];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=r.concat(jfgrid.func_methods.getDataArr(t,!0))}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)r=r.concat(jfgrid.func_methods.getCellDataArr(t,"number",!0));else{if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;r.push(t)}}for(var i=[],e=0;e<r.length;e++){var a=r[e];jfgrid.func_methods.isRealNum(a)&&i.push(parseFloat(a))}if(i.length<3||0==jfgrid.func_methods.standardDeviation_s(i))return jfgrid.formula.error.d;for(var n=jStat.mean(i),o=i.length,l=0,d=0,e=0;e<o;e++)d+=Math.pow(i[e]-n,3),l+=Math.pow(i[e]-n,2);return l/=o,(d/=o)/Math.pow(l,1.5)}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},ADDRESS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=1;if(3<=arguments.length){if(i=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i)}var a,n=!0;if(4<=arguments.length&&(n=jfgrid.func_methods.getCellBoolen(arguments[3]),jfgrid.func_methods.valueIsError(n)))return n;if(r<=0||t<=0)return jfgrid.formula.error.v;if(-1==[1,2,3,4].indexOf(i))return jfgrid.formula.error.v;if(n)switch(t=jfgrid.jfgridchatatABC(t-1),i){case 1:a="$"+t+"$"+r;break;case 2:a=t+"$"+r;break;case 3:a="$"+t+r;break;case 4:a=t+r}else switch(i){case 1:a="R"+r+"C"+t;break;case 2:a="R"+r+"C["+t+"]";break;case 3:a="R["+r+"]C"+t;break;case 4:a="R["+r+"]C["+t+"]"}if(5!=arguments.length)return a;var o=jfgrid.func_methods.getFirstValue(arguments[4]);return jfgrid.func_methods.valueIsError(o)?o:o+"!"+a}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},INDIRECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;var t=!0;if(2==arguments.length&&(t=jfgrid.func_methods.getCellBoolen(arguments[1]),jfgrid.func_methods.valueIsError(t)))return t;if(t){if(/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g.test(r)){var i=parseInt(r.replace(/[^0-9]/g,""))-1,a=jfgrid.jfgridABCatNum(r.replace(/[^A-Za-z]/g,""));return i<0||i>=jfgrid.flowdata.length||a<0||a>=jfgrid.flowdata[0].length?jfgrid.formula.error.r:null==jfgrid.flowdata[i][a]||jfgrid.func_methods.isRealNull(jfgrid.flowdata[i][a].v)?0:jfgrid.flowdata[i][a].v}return jfgrid.formula.error.r}if(/^[R][0-9]+[C][0-9]+$/g.test(r)){i=parseInt(r.split("R")[1].split("C")[0]),a=parseInt(r.split("R")[1].split("C")[1]);return i<0||i>=jfgrid.flowdata.length||a<0||a>=jfgrid.flowdata[0].length?jfgrid.formula.error.r:null==jfgrid.flowdata[i][a]||jfgrid.func_methods.isRealNull(jfgrid.flowdata[i][a].v)?0:jfgrid.flowdata[i][a].v}return jfgrid.formula.error.r}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},ROW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e,r=0;r<arguments.length;r++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[r],r)[0])return jfgrid.formula.error.v}try{return 1!=arguments.length?window.jfgridCurrentRow+1:"array"==jfgrid.getObjType(arguments[0])?jfgrid.formula.error.v:(e="object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell?arguments[0].startCell:arguments[0],jfgrid.formula.iscelldata(e)?jfgrid.formula.getcellrange(e).row[0]+1:jfgrid.formula.error.v)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ROWS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return"array"==jfgrid.getObjType(arguments[0])?"array"==jfgrid.getObjType(arguments[0][0])?arguments[0].length:1:"object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell?arguments[0].rowl:1}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},COLUMN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e,r=0;r<arguments.length;r++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[r],r)[0])return jfgrid.formula.error.v}try{return 1!=arguments.length?window.jfgridCurrentColumn+1:"array"==jfgrid.getObjType(arguments[0])?jfgrid.formula.error.v:(e="object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell?arguments[0].startCell:arguments[0],jfgrid.formula.iscelldata(e)?jfgrid.formula.getcellrange(e).column[0]+1:jfgrid.formula.error.v)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},COLUMNS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return"array"==jfgrid.getObjType(arguments[0])?"array"==jfgrid.getObjType(arguments[0][0])?arguments[0][0].length:arguments[0].length:"object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell?arguments[0].coll:1}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},OFFSET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{if("object"!=jfgrid.getObjType(arguments[0])||null==arguments[0].startCell)return jfgrid.formula.error.v;var r=arguments[0].startCell,t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a=arguments[0].rowl;if(4<=arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a)}var n=arguments[0].coll;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(a<1||n<1)return jfgrid.formula.error.r;var o=jfgrid.formula.getcellrange(r),l=o.row[0],d=o.column[0],f=(l+=t)+a-1,s=(d+=i)+n-1;if(l<0||f>=jfgrid.flowdata.length||d<0||s>=jfgrid.flowdata[0].length)return jfgrid.formula.error.r;for(var g=[],c=l;c<=f;c++){for(var u=[],m=d;m<=s;m++)null==jfgrid.flowdata[c][m]||jfgrid.func_methods.isRealNull(jfgrid.flowdata[c][m].v)?u.push(0):u.push(jfgrid.flowdata[c][m].v);g.push(u)}return g}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},MATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=arguments[1],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0]))return jfgrid.func_methods.isDyadicArr(t)?jfgrid.formula.error.na:jfgrid.formula.error.v;for(e=0;e<t.length;e++)i.push(t[e])}else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if(1<t.rowl&&1<t.coll)return jfgrid.formula.error.na;if(null!=t.data)if("array"==jfgrid.getObjType(t.data))for(e=0;e<t.data.length;e++)for(var a=0;a<t.data[e].length;a++)null==t.data[e][a]||jfgrid.func_methods.isRealNull(t.data[e][a].v)||i.push(t.data[e][a].v);else i.push(t.data.v)}var n,o,l=1;if(3==arguments.length){if(l=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(l))return l;if(!jfgrid.func_methods.isRealNum(l))return jfgrid.formula.error.v;l=Math.ceil(parseFloat(l))}if(-1==[-1,0,1].indexOf(l))return jfgrid.formula.error.na;for(var d=0;d<i.length;d++)if(1===l){if(i[d]===r)return d+1;i[d]<r&&(!o||i[d]>o)&&(n=d+1,o=i[d])}else if(0===l){if("string"==typeof r){if(r=r.replace(/\?/g,"."),i[d].toLowerCase().match(r.toLowerCase()))return d+1}else if(i[d]===r)return d+1}else if(-1===l){if(i[d]===r)return d+1;i[d]>r&&(!o||i[d]<o)&&(n=d+1,o=i[d])}return n||jfgrid.formula.error.na}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},VLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;if(""==r.toString().replace(/\s/g,""))return jfgrid.formula.error.na;var t=arguments[1],i=[];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;for(e=0;e<t.length;e++){for(var a=[],n=0;n<t[e].length;n++)a.push(t[e][n]);i.push(a)}}else{for(a=[],e=0;e<t.length;e++)a.push(t[e]);i.push(a)}else{if("object"!=jfgrid.getObjType(t)||null==t.startCell)return jfgrid.formula.error.v;i=jfgrid.func_methods.getCellDataDyadicArr(t,"text")}var o=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseInt(o);var l=!0;if(4==arguments.length&&(l=jfgrid.func_methods.getCellBoolen(arguments[3]),jfgrid.func_methods.valueIsError(l)))return l;if(o<1)return jfgrid.formula.error.v;if(o>i[0].length)return jfgrid.formula.error.r;if(!l){for(var d=null,f=0;f<i.length;f++)if(r.toString()==i[f][0].toString()){d=f;break}return null==d?jfgrid.formula.error.na:i[d][o-1]}i=jfgrid.orderbydata(i,0,!0);for(var f=0;f<i.length;f++){var s,g=i[f][0];if(jfgrid.datecontroll.isdatetime(r)&&jfgrid.datecontroll.isdatetime(g)?s=jfgrid.datecontroll.diff(r,g):jfgrid.func_methods.isRealNum(r)&&jfgrid.func_methods.isRealNum(g)?s=numeral(r).value()-numeral(g).value():jfgrid.func_methods.isRealNum(r)||jfgrid.func_methods.isRealNum(g)?jfgrid.func_methods.isRealNum(r)?jfgrid.func_methods.isRealNum(g)||(s=-1):s=1:s=r.localeCompare(g,"zh"),s<0)return 0==f?jfgrid.formula.error.na:i[f-1][o-1];if(f==i.length-1)return i[f][o-1]}}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},HLOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{window.jfgridCurrentRow,window.jfgridCurrentColumn;var t=arguments[0];"object"==typeof t&&(t=arguments[0].data,"array"==jfgrid.getObjType(t)?(t=t[r],"array"==jfgrid.getObjType(t)&&(t=t[l])):t=t.v);var i=arguments[1].data,a=arguments[2],n=3<arguments.length?!!arguments[3]:!1;if(a>i.rowl)return[jfgrid.formula.error.v,"索引超过了范围的长度，"+i[0].length];if(a<1)return[jfgrid.formula.error.v,"索引必须大于1"];for(var o=jfgrid.formula.error.na,l=0;l<i[0].length;l++){var d=jfgrid.getcellvalue(0,l,i),f=jfgrid.getcellvalue(a-1,l,i);if(n)-1<d.indexOf(t)&&(o=f);else if(jfgrid.formula.acompareb(d,t))return o=f}return o}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},LOOKUP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{window.jfgridCurrentRow,window.jfgridCurrentColumn;var t=arguments[0];"object"==typeof t&&(t=arguments[0].data,"array"==jfgrid.getObjType(t)?(t=t[r],"array"==jfgrid.getObjType(t)&&(t=t[c])):t=t.v);var i,a=arguments[1].data,n=jfgrid.formula.error.na;if(a=jfgrid.formula.getRangeArray(a)[0],arguments[2]&&(i=arguments[2].data,i=jfgrid.formula.getRangeArray(i)[0]),"string"==typeof t)for(e=0;e<a.length;e++){var o=a[e];arguments[2]?(d=i[e],o==t&&(n=d)):jfgrid.formula.acompareb(o,t)&&(n=o)}else if("num"==jfgrid.isdatatype(t)){for(var l=[],e=0;e<a.length;e++){var d,o=a[e];if(arguments[2]){if(d=i[e],o==t)return n=d;o!=t&&"num"==jfgrid.isdatatype(o)&&l.push(o)}else{if(o==t)return n=o;o!=t&&"num"==jfgrid.isdatatype(o)&&l.push(o)}}if(0!=l.length){l.push(t),l.sort(function(e,r){return r-e});var f=l.indexOf(t);if(f==l.length-1)return[jfgrid.formula.error.na,"找不到对应参数"];var s=l[f+1];n=arguments[2]?i[e=a.indexOf(s)]:s}}return n}catch(e){var g=e;return g=jfgrid.formula.errorInfo(g),[jfgrid.formula.error.v,g]}},INDEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=jfgrid.func_methods.getDataDyadicArr(r)}else"object"==jfgrid.getObjType(r)&&null!=r.startCell&&(t=jfgrid.func_methods.getCellDataDyadicArr(r,"number"));var i=t.length,a=t[0].length,n=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n);var o=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(o)?o:jfgrid.func_methods.isRealNum(o)?(o=parseInt(o),n<=0||o<=0?jfgrid.formula.error.v:i<n||a<o?jfgrid.formula.error.r:t[n-1][o-1]):jfgrid.formula.error.v}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},GETPIVOTDATA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return jfgrid.formula.error.v}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},CHOOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;if((r=parseInt(r))<1||arguments.length-1<r)return jfgrid.formula.error.v;var t=arguments[r];return"array"==jfgrid.getObjType(t)?"array"!=jfgrid.getObjType(t[0])||jfgrid.func_methods.isDyadicArr(t)?t:jfgrid.formula.error.v:"object"!=jfgrid.getObjType(t)||null==t.startCell?t:null==t.data?0:"array"!=jfgrid.getObjType(t.data)?jfgrid.func_methods.isRealNull(t.data.v)?0:t.data.v:jfgrid.func_methods.getCellDataDyadicArr(t.data,"number")}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},HYPERLINK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return jfgrid.formula.error.v}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},TIME:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;if(i=parseInt(i),r<0||32767<r)return jfgrid.formula.error.nm;if(24<r&&(r%=24),t<0||32767<t)return jfgrid.formula.error.nm;if(i<0||32767<i)return jfgrid.formula.error.nm;var a=moment().set({hour:r,minute:t,second:i});return moment(a).format("h:mm:ss a")}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},TIMEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?(3600*moment(r).get("hour")+60*moment(r).get("minute")+moment(r).get("second"))/86400:jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},EOMONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;if(t=parseInt(t),!moment(r).isValid())return jfgrid.formula.error.v;var i=moment(r).add(t+1,"months").set("date",1).subtract(1,"days");return jfgrid.mask.genarate(moment(i).format("YYYY-MM-DD H:mm:ss"))[2]}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},EDATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;if(t=parseInt(t),!moment(r).isValid())return jfgrid.formula.error.v;var i=moment(r).add(t,"months");return jfgrid.mask.genarate(moment(i).format("YYYY-MM-DD h:mm:ss"))[2]}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},SECOND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?moment(r).seconds():jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},MINUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?moment(r).minutes():jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},HOUR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?moment(r).hours():jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},NOW:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return moment().format("YYYY-M-D HH:mm")}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},NETWORKDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return 3==arguments.length?window.jfgrid_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1,arguments[2]):window.jfgrid_function.NETWORKDAYS_INTL.f(arguments[0],arguments[1],1)}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},NETWORKDAYS_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],t=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(i))return i;if(!moment(i).isValid())return jfgrid.formula.error.v;var a=r[1];if(3<=arguments.length&&("string"!=typeof(a=arguments[2])||"7"!=a.length||!/^[0-1]{7}$/g.test(a))){if(a=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;if((a=parseInt(a))<1||7<a&&a<11||17<a)return jfgrid.formula.error.nm;a=r[a]}var n=[];if(4==arguments.length&&(n=jfgrid.func_methods.getCellrangeDate(arguments[3]),jfgrid.func_methods.valueIsError(n)))return n;for(e=0;e<n.length;e++)if(!moment(n[e]).isValid())return jfgrid.formula.error.v;var o=moment(i).diff(moment(t),"days")+1,l=o,d=moment(t);for(e=0;e<o;e++){var f=moment(d).weekday(),s=!1;"array"==jfgrid.getObjType(a)?f!==a[0]&&f!==a[1]||(s=!0):(0==f&&(f=7),"0"==a.charAt(f-1)&&(s=!0));for(var g=0;g<n.length;g++)if(0===moment(d).diff(moment(n[g]),"days")){s=!0;break}s&&l--,d=moment(d).add(1,"days")}return l}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},ISOWEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?moment(r).isoWeeks():jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},WEEKNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[void 0,7,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,7],t=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=1;if(2==arguments.length){if(i=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i)}if(21==i)return window.jfgrid_function.ISOWEEKNUM.f(arguments[0]);if(-1==[1,2,11,12,13,14,15,16,17].indexOf(i))return jfgrid.formula.error.nm;var a=r[i],n=moment(t).isoWeekday()>=a?1:0;return moment(t).isoWeeks()+n}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},WEEKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=1;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}return-1==[1,2,3,11,12,13,14,15,16,17].indexOf(t)?jfgrid.formula.error.nm:[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]][t][moment(r).day()]}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},DAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?moment(r).date():jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},DAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:moment(t).isValid()?moment(r).diff(moment(t),"days"):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},DAYS360:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=!1;if(3==arguments.length&&(i=jfgrid.func_methods.getCellBoolen(arguments[2]),jfgrid.func_methods.valueIsError(i)))return i;var a,n,o,l,d=moment(r).month(),f=moment(t).month();return l=i?(o=31===moment(r).date()?30:moment(r).date(),31===moment(t).date()?30:moment(t).date()):(a=moment().set({year:moment(r).year(),month:d+1,date:0}).date(),n=moment().set({year:moment(t).year(),month:f+1,date:0}).date(),o=moment(r).date()===a?30:moment(r).date(),moment(t).date()===n?o<30?(f++,1):30:moment(t).date()),360*moment(t).diff(moment(r),"years")+30*(f-d)+(l-o)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;if(i=parseInt(i),r<0||1e4<=r)return jfgrid.formula.error.nm;0<=r&&r<=1899&&(r+=1900);var a=moment().set({year:r,month:t-1,date:i});return moment(a).year()<1900?jfgrid.formula.error.nm:moment(a).format("YYYY-MM-DD")}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},DATEVALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?(r=moment(r).format("YYYY-MM-DD"),jfgrid.mask.genarate(r)[2]):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},DATEDIF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{jfgrid_getValue(arguments);for(e=0;e<arguments.length-1;e++)if(arguments[e]=moment.fromOADate(arguments[e]).format("l"),!jfgrid.datecontroll.isdatetime(arguments[e]))return jfgrid.formula.error.v;var r=moment(arguments[0]),t=moment(arguments[1]),i=arguments[2],a=jfgrid.formula.error.v;if(jfgrid_function.DAYS.f(t,r)<0)return jfgrid.formula.error.v;switch(i){case"Y":case"y":a=t.diff(r,"years",!1);break;case"M":case"m":a=t.diff(r,"months",!1);break;case"D":case"d":a=t.diff(r,"days",!1);break;case"MD":case"md":a=t.format("DD")-r.format("DD");break;case"YM":case"ym":var n,o,a=(n=parseInt(r.format("M")))<=(o=parseInt(t.format("M")))?o-n:o+12-n;break;case"YD":case"yd":a=(n=jfgrid.mask.genarate(r.format("MM-DD"))[2])<=(o=jfgrid.mask.genarate(t.format("MM-DD"))[2])?o-n:o+365-n;break;default:a=jfgrid.formula.error.v}return a}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},WORKDAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return 3==arguments.length?window.jfgrid_function.WORKDAY_INTL.f(arguments[0],arguments[1],1,arguments[2]):window.jfgrid_function.WORKDAY_INTL.f(arguments[0],arguments[1],1)}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},WORKDAY_INTL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]],t=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a=r[1];if(3<=arguments.length&&("string"!=typeof(a=arguments[2])||"7"!=a.length||!/^[0-1]{7}$/g.test(a))){if(a=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;if((a=parseInt(a))<1||7<a&&a<11||17<a)return jfgrid.formula.error.nm;a=r[a]}var n=[];if(4==arguments.length&&(n=jfgrid.func_methods.getCellrangeDate(arguments[3]),jfgrid.func_methods.valueIsError(n)))return n;for(e=0;e<n.length;e++)if(!moment(n[e]).isValid())return jfgrid.formula.error.v;for(var o=0;o<i;){t=moment(t).add(1,"days");var l=moment(t).weekday();if(jfgrid.getObjType(a)){if(l===a[0]||l===a[1])continue}else if(0==l&&(l=7),"0"==a.charAt(l-1))continue;for(var d=0;d<n.length;d++)if(0===moment(t).diff(moment(n[d]),"days")){o--;break}o++}return moment(t).format("YYYY-MM-DD")}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},YEAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?moment(r).year():jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},YEARFRAC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=0;if(3==arguments.length){if(i=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i)}if(i<0||4<i)return jfgrid.formula.error.nm;var a=moment(r).date(),n=moment(r).month()+1,o=moment(r).year(),l=moment(t).date(),d=moment(t).month()+1,f=moment(t).year();switch(i){case 0:31===a&&31===l?l=a=30:31===a?a=30:30===a&&31===l&&(l=30),u=(l+30*d+360*f-(a+30*n+360*o))/360;break;case 1:var s=365;if(o===f||o+1===f&&(d<n||n===d&&l<=a))return(o===f&&jfgrid.func_methods.isLeapYear(o)||jfgrid.func_methods.feb29Between(r,t)||1===d&&29===l)&&(s=366),moment(t).diff(moment(r),"days")/s;var g=f-o+1,c=(moment().set({year:f+1,month:0,date:1})-moment().set({year:o,month:0,date:1}))/1e3/60/60/24/g,u=moment(t).diff(moment(r),"days")/c;break;case 2:u=moment(t).diff(moment(r),"days")/360;break;case 3:u=moment(t).diff(moment(r),"days")/365;break;case 4:u=(l+30*d+360*f-(a+30*n+360*o))/360}return u}catch(e){var m=e;return m=jfgrid.formula.errorInfo(m),[jfgrid.formula.error.v,m]}},TODAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return moment().format("YYYY-MM-DD")}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},MONTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?moment(r).month()+1:jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},EFFECT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),r<=0||t<1?jfgrid.formula.error.nm:Math.pow(1+r/t,t)-1):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},DOLLAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=2;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}9<t&&(t=9);for(e=1;e<=t;e++)0;return(0<r?1:-1)*Math.floor(Math.abs(r)*Math.pow(10,t))/Math.pow(10,t)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},DOLLARDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;if((t=parseInt(t))<0)return jfgrid.formula.error.nm;if(0==t)return jfgrid.formula.error.d;var i=parseInt(r,10);i+=r%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var a=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return i=Math.round(i*a)/a}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},DOLLARFR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;if((t=parseInt(t))<0)return jfgrid.formula.error.nm;if(0==t)return jfgrid.formula.error.d;var i=parseInt(r,10);return i+=r%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},DB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a);var n=12;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(r<0||t<0||i<0||a<0)return jfgrid.formula.error.nm;if(n<1||12<n)return jfgrid.formula.error.nm;if(i<a)return jfgrid.formula.error.nm;if(r<=t)return 0;for(var o=(1-Math.pow(t/r,1/i)).toFixed(3),l=r*o*n/12,d=l,f=0,s=a===i?i-1:a,e=2;e<=s;e++)d+=f=(r-d)*o;return 1===a?l:a===i?(r-d)*o:f}catch(e){var g=e;return g=jfgrid.formula.errorInfo(g),[jfgrid.formula.error.v,g]}},DDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a);var n=2;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}if(r<0||t<0||i<0||a<0||n<=0)return jfgrid.formula.error.nm;if(i<a)return jfgrid.formula.error.nm;if(r<=t)return 0;for(var o=0,l=0,e=1;e<=a;e++)o+=l=Math.min(n/i*(r-o),r-t-o);return l}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},RATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=0;if(4<=arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a)}var n=0;if(5<=arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}var o=.1;if(6==arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[5]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o)}if(0!=n&&1!=n)return jfgrid.formula.error.nm;for(var l=0,d=!1,f=o;l<100&&!d;){var s=Math.pow(f+1,r),g=Math.pow(f+1,r-1),c=f-(a+s*i+t*(s-1)*(f*n+1)/f)/(r*g*i-t*(s-1)*(f*n+1)/Math.pow(f,2)+(r*t*g*(f*n+1)/f+t*(s-1)*n/f));Math.abs(c-f)<1e-6&&(d=!0),l++,f=c}return d?f:jfgrid.formula.error.nm}catch(e){var u=e;return u=jfgrid.formula.errorInfo(u),[jfgrid.formula.error.v,u]}},CUMPRINC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a);var n=jfgrid.func_methods.getFirstValue(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n);var o=jfgrid.func_methods.getFirstValue(arguments[5]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;if(o=parseFloat(o),r<=0||t<=0||i<=0)return jfgrid.formula.error.nm;if(a<1||n<1||n<a)return jfgrid.formula.error.nm;if(0!=o&&1!=o)return jfgrid.formula.error.nm;var l=window.jfgrid_function.PMT.f(r,t,i,0,o),d=0;1===a&&(d=0===o?l+i*r:l,a++);for(e=a;e<=n;e++)d+=0<o?l-(window.jfgrid_function.FV.f(r,e-2,l,i,1)-l)*r:l-window.jfgrid_function.FV.f(r,e-1,l,i,0)*r;return d}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},COUPNUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a=0;if(4==arguments.length){a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a)}if(1!=i&&2!=i&&4!=i)return jfgrid.formula.error.nm;if(a<0||4<a)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;var n=moment(r).date(),o=moment(r).month()+1,l=moment(r).year(),d=moment(t).date(),f=moment(t).month()+1,s=moment(t).year();switch(a){case 0:31===n&&31===d?d=n=30:31===n?n=30:30===n&&31===d&&(d=30),m=(d+30*f+360*s-(n+30*o+360*l))/(360/i);break;case 1:var g=365;if(l===s||l+1===s&&(f<o||o===f&&d<=n))return(l===s&&jfgrid.func_methods.isLeapYear(l)||jfgrid.func_methods.feb29Between(r,t)||1===f&&29===d)&&(g=366),moment(t).diff(moment(r),"days")/(g/i);var c=s-l+1,u=(moment().set({year:s+1,month:0,date:1})-moment().set({year:l,month:0,date:1}))/1e3/60/60/24/c,m=moment(t).diff(moment(r),"days")/(u/i);break;case 2:m=moment(t).diff(moment(r),"days")/(360/i);break;case 3:m=moment(t).diff(moment(r),"days")/(365/i);break;case 4:m=(d+30*f+360*s-(n+30*o+360*l))/(360/i)}return Math.round(m)}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},SYD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);return jfgrid.func_methods.valueIsError(a)?a:jfgrid.func_methods.isRealNum(a)?(a=parseInt(a),0==i||a<1||i<a?jfgrid.formula.error.nm:(r-t)*(i-a+1)*2/(i*(i+1))):jfgrid.formula.error.v}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},TBILLEQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?(i=parseFloat(i))<=0||0<moment(r)-moment(t)||31536e6<moment(t)-moment(r)?jfgrid.formula.error.nm:365*i/(360-i*moment(t).diff(moment(r),"days")):jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},TBILLYIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?(i=parseFloat(i))<=0||0<=moment(r)-moment(t)||31536e6<moment(t)-moment(r)?jfgrid.formula.error.nm:(100-i)/i*(360/moment(t).diff(moment(r),"days")):jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},TBILLPRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?(i=parseFloat(i))<=0||0<moment(r)-moment(t)||31536e6<moment(t)-moment(r)?jfgrid.formula.error.nm:100*(1-i*moment(t).diff(moment(r),"days")/360):jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},PV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=0;if(4<=arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a)}var n=0;if(5<=arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}return 0!=n&&1!=n?jfgrid.formula.error.nm:0===r?-i*t-a:((1-Math.pow(1+r,t))/r*i*(1+r*n)-a)/Math.pow(1+r,t)}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},ACCRINT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getCellDate(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!moment(i).isValid())return jfgrid.formula.error.v;var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=jfgrid.func_methods.getFirstValue(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n);var o=jfgrid.func_methods.getFirstValue(arguments[5]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseInt(o);var l=0;if(7<=arguments.length){if(l=jfgrid.func_methods.getFirstValue(arguments[6]),jfgrid.func_methods.valueIsError(l))return l;if(!jfgrid.func_methods.isRealNum(l))return jfgrid.formula.error.v;l=parseInt(l)}var d=!0;if(8==arguments.length&&(d=jfgrid.func_methods.getCellBoolen(arguments[7]),jfgrid.func_methods.valueIsError(d)))return d;if(a<=0||n<=0)return jfgrid.formula.error.nm;if(1!=o&&2!=o&&4!=o)return jfgrid.formula.error.nm;if(l<0||4<l)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(i))return jfgrid.formula.error.nm;if(0<=moment(i)-moment(t)&&!d){var f=moment(t).date(),s=moment(t).month()+1,g=moment(t).year(),c=moment(i).date(),u=moment(i).month()+1,m=moment(i).year();switch(l){case 0:31===f&&31===c?c=f=30:31===f?f=30:30===f&&31===c&&(c=30),v=(c+30*u+360*m-(f+30*s+360*g))/360;break;case 1:var h=365;if(g===m||g+1===m&&(u<s||s===u&&c<=f))return(g===m&&jfgrid.func_methods.isLeapYear(g)||jfgrid.func_methods.feb29Between(t,i)||1===u&&29===c)&&(h=366),moment(i).diff(moment(t),"days")/h;var j=m-g+1,p=(moment().set({year:m+1,month:0,date:1})-moment().set({year:g,month:0,date:1}))/1e3/60/60/24/j,v=moment(i).diff(moment(t),"days")/p;break;case 2:v=moment(i).diff(moment(t),"days")/360;break;case 3:v=moment(i).diff(moment(t),"days")/365;break;case 4:v=(c+30*u+360*m-(f+30*s+360*g))/360}}else{f=moment(r).date(),s=moment(r).month()+1,g=moment(r).year(),c=moment(i).date(),u=moment(i).month()+1,m=moment(i).year();switch(l){case 0:31===f&&31===c?c=f=30:31===f?f=30:30===f&&31===c&&(c=30),v=(c+30*u+360*m-(f+30*s+360*g))/360;break;case 1:h=365;if(g===m||g+1===m&&(u<s||s===u&&c<=f))return(g===m&&jfgrid.func_methods.isLeapYear(g)||jfgrid.func_methods.feb29Between(r,i)||1===u&&29===c)&&(h=366),moment(i).diff(moment(r),"days")/h;j=m-g+1,p=(moment().set({year:m+1,month:0,date:1})-moment().set({year:g,month:0,date:1}))/1e3/60/60/24/j;v=moment(i).diff(moment(r),"days")/p;break;case 2:v=moment(i).diff(moment(r),"days")/360;break;case 3:v=moment(i).diff(moment(r),"days")/365;break;case 4:v=(c+30*u+360*m-(f+30*s+360*g))/360}}return n*a*v}catch(e){var b=e;return b=jfgrid.formula.errorInfo(b),[jfgrid.formula.error.v,b]}},ACCRINTM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=0;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(i<=0||a<=0)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;var o=moment(r).date(),l=moment(r).month()+1,d=moment(r).year(),f=moment(t).date(),s=moment(t).month()+1,g=moment(t).year();switch(n){case 0:31===o&&31===f?f=o=30:31===o?o=30:30===o&&31===f&&(f=30),h=(f+30*s+360*g-(o+30*l+360*d))/360;break;case 1:var c=365;if(d===g||d+1===g&&(s<l||l===s&&f<=o))return(d===g&&jfgrid.func_methods.isLeapYear(d)||jfgrid.func_methods.feb29Between(r,t)||1===s&&29===f)&&(c=366),moment(t).diff(moment(r),"days")/c;var u=g-d+1,m=(moment().set({year:g+1,month:0,date:1})-moment().set({year:d,month:0,date:1}))/1e3/60/60/24/u,h=moment(t).diff(moment(r),"days")/m;break;case 2:h=moment(t).diff(moment(r),"days")/360;break;case 3:h=moment(t).diff(moment(r),"days")/365;break;case 4:h=(f+30*s+360*g-(o+30*l+360*d))/360}return a*i*h}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},COUPDAYBS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a,n=0;if(4==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(1!=i&&2!=i&&4!=i)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;for(var o=Math.ceil(moment(t).diff(moment(r),"months")/(12/i))+1,e=1;e<=o;e++){var l=moment(t).subtract(12/i*e,"months");if(l<=moment(r)){a=l;break}}switch(n){case 0:var d=moment(a).date(),f=moment(a).month()+1,s=moment(a).year(),g=moment(r).date(),c=moment(r).month()+1,u=moment(r).year();31===d&&31===g?g=d=30:31===d?d=30:30===d&&31===g&&(g=30),m=g+30*c+360*u-(d+30*f+360*s);break;case 1:case 2:case 3:m=moment(r).diff(moment(a),"days");break;case 4:var d=moment(a).date(),f=moment(a).month()+1,s=moment(a).year(),m=(g=moment(r).date())+30*(c=moment(r).month()+1)+360*(u=moment(r).year())-(d+30*f+360*s)}return m}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},COUPDAYS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a=0;if(4==arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a)}if(1!=i&&2!=i&&4!=i)return jfgrid.formula.error.nm;if(a<0||4<a)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;switch(a){case 0:d=360/i;break;case 1:for(var n=Math.ceil(moment(t).diff(moment(r),"months")/(12/i))+1,e=1;e<=n;e++){var o=moment(t).subtract(12/i*e,"months");if(o<=moment(r)){var l=moment(t).subtract(12/i*(e-1),"months"),d=moment(l).diff(moment(o),"days");break}}break;case 2:d=360/i;break;case 3:d=365/i;break;case 4:d=360/i}return d}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},COUPDAYSNC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a,n=0;if(4==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(1!=i&&2!=i&&4!=i)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;for(var o=Math.ceil(moment(t).diff(moment(r),"months")/(12/i))+1,e=1;e<=o;e++){if(moment(t).subtract(12/i*e,"months")<=moment(r)){a=moment(t).subtract(12/i*(e-1),"months");break}}switch(n){case 0:var l=moment(r).date(),d=moment(r).month()+1,f=moment(r).year(),s=moment(a).date(),g=moment(a).month()+1,c=moment(a).year();31===l&&31===s?s=l=30:31===l?l=30:30===l&&31===s&&(s=30),u=s+30*g+360*c-(l+30*d+360*f);break;case 1:case 2:case 3:u=moment(a).diff(moment(r),"days");break;case 4:var l=moment(r).date(),d=moment(r).month()+1,f=moment(r).year(),u=(s=moment(a).date())+30*(g=moment(a).month()+1)+360*(c=moment(a).year())-(l+30*d+360*f)}return u}catch(e){var m=e;return m=jfgrid.formula.errorInfo(m),[jfgrid.formula.error.v,m]}},COUPNCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a,n=0;if(4==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(1!=i&&2!=i&&4!=i)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;for(var o=Math.ceil(moment(t).diff(moment(r),"months")/(12/i))+1,e=1;e<=o;e++){if(moment(t).subtract(12/i*e,"months")<=moment(r)){a=moment(t).subtract(12/i*(e-1),"months");break}}return moment(a).format("YYYY-MM-DD")}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},COUPPCD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a,n=0;if(4==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(1!=i&&2!=i&&4!=i)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;for(var o=Math.ceil(moment(t).diff(moment(r),"months")/(12/i))+1,e=1;e<=o;e++){var l=moment(t).subtract(12/i*e,"months");if(l<=moment(r)){a=l;break}}return moment(a).format("YYYY-MM-DD")}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},FV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=0;if(4<=arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a)}var n,o=0;if(5<=arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o)}return 0!=o&&1!=o?jfgrid.formula.error.nm:-(0===r?a+i*t:(n=Math.pow(1+r,t),1===o?a*n+i*(1+r)*(n-1)/r:a*n+i*(n-1)/r))}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},FVSCHEDULE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=arguments[1],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;i=i.concat(jfgrid.func_methods.getDataArr(t,!1))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?i=i.concat(jfgrid.func_methods.getCellDataArr(t,"number",!1)):i.push(t);for(var a=[],e=0;e<i.length;e++){var n=i[e];if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;a.push(parseFloat(n))}for(var o=a.length,l=r,e=0;e<o;e++)l*=1+a[e];return l}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},YIELD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=jfgrid.func_methods.getFirstValue(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n);var o=jfgrid.func_methods.getFirstValue(arguments[5]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseInt(o);var l=0;if(7==arguments.length){if(l=jfgrid.func_methods.getFirstValue(arguments[6]),jfgrid.func_methods.valueIsError(l))return l;if(!jfgrid.func_methods.isRealNum(l))return jfgrid.formula.error.v;l=parseInt(l)}if(i<0)return jfgrid.formula.error.nm;if(a<=0||n<=0)return jfgrid.formula.error.nm;if(1!=o&&2!=o&&4!=o)return jfgrid.formula.error.nm;if(l<0||4<l)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;if(1<window.jfgrid_function.COUPNUM.f(r,t,o,l)){for(var d=1,f=0,s=d,e=1;e<=100;e++){var g=window.jfgrid_function.PRICE.f(r,t,i,s,n,o,l);if(Math.abs(g-a)<1e-6)break;a<g?f=s:d=s,s=(d+f)/2}var c=s}else var u=window.jfgrid_function.COUPDAYSNC.f(r,t,o,l),m=window.jfgrid_function.COUPDAYS.f(r,t,o,l),h=a/100+window.jfgrid_function.COUPDAYBS.f(r,t,o,l)/m*(i/o),c=(n/100+i/o-h)/h*(o*m/u);return c}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},YIELDDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=0;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}return i<=0||a<=0?jfgrid.formula.error.nm:n<0||4<n||0<=moment(r)-moment(t)?jfgrid.formula.error.nm:(a/i-1)/window.jfgrid_function.YEARFRAC.f(r,t,n)}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},NOMINAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseInt(t),r<=0||t<1?jfgrid.formula.error.nm:(Math.pow(r+1,1/t)-1)*t):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},XIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"number",!1)):t.push(r);for(var i=[],e=0;e<t.length;e++){var a=t[e];if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;i.push(parseFloat(a))}var n=jfgrid.func_methods.getCellrangeDate(arguments[1]);if(jfgrid.func_methods.valueIsError(n))return n;for(e=0;e<n.length;e++)if(!moment(n[e]).isValid())return jfgrid.formula.error.v;var o=.1;if(3==arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o)}for(var l=!1,d=!1,e=0;e<i.length&&(0<i[e]&&(l=!0),i[e]<0&&(d=!0),!l||!d);e++);if(!l||!d)return jfgrid.formula.error.nm;if(i.length!=n.length)return jfgrid.formula.error.nm;for(var f,s,g,c=o;f=c-(g=function(e,r,t){for(var i=t+1,a=e[0],n=1;n<e.length;n++)a+=e[n]/Math.pow(i,window.jfgrid_function.DAYS.f(r[n],r[0])/365);return a}(i,n,c))/function(e,r,t){for(var i=t+1,a=0,n=1;n<e.length;n++){var o=window.jfgrid_function.DAYS.f(r[n],r[0])/365;a-=o*e[n]/Math.pow(i,1+o)}return a}(i,n,c),s=Math.abs(f-c),c=f,1e-10<s&&1e-10<Math.abs(g););return c}catch(e){var u=e;return u=jfgrid.formula.errorInfo(u),[jfgrid.formula.error.v,u]}},MIRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"number",!1)):t.push(r);for(var i=[],e=0;e<t.length;e++){var a=t[e];if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;i.push(parseFloat(a))}var n=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n);var o=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o);for(var l=i.length,d=[],f=[],e=0;e<l;e++)i[e]<0?d.push(i[e]):f.push(i[e]);if(0==d.length||0==f.length)return jfgrid.formula.error.d;var s=-window.jfgrid_function.NPV.f(o,f)*Math.pow(1+o,l-1),g=window.jfgrid_function.NPV.f(n,d)*(1+n);return Math.pow(s/g,1/(l-1))-1}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},IRR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"number",!1)):t.push(r);for(var i=[],e=0;e<t.length;e++){var a=t[e];if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;i.push(parseFloat(a))}var n=.1;if(2==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}for(var o=[],l=!1,d=!1,e=0;e<t.length;e++)o[e]=0===e?0:o[e-1]+365,0<t[e]&&(l=!0),t[e]<0&&(d=!0);if(!l||!d)return jfgrid.formula.error.nm;for(var f,s,g,c=n;f=c-(g=function(e,r,t){for(var i=t+1,a=e[0],n=1;n<e.length;n++)a+=e[n]/Math.pow(i,(r[n]-r[0])/365);return a}(i,o,c))/function(e,r,t){for(var i=t+1,a=0,n=1;n<e.length;n++){var o=(r[n]-r[0])/365;a-=o*e[n]/Math.pow(i,1+o)}return a}(i,o,c),s=Math.abs(f-c),c=f,1e-10<s&&1e-10<Math.abs(g););return c}catch(e){var u=e;return u=jfgrid.formula.errorInfo(u),[jfgrid.formula.error.v,u]}},NPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);for(var t=[],e=1;e<arguments.length;e++){var i=arguments[e];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(i,!0))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(i,"number",!0)):t.push(i)}for(var a=[],e=0;e<t.length;e++){var n=t[e];jfgrid.func_methods.isRealNum(n)&&a.push(parseFloat(n))}var o=0;if(0<a.length)for(e=0;e<a.length;e++)o+=a[e]/Math.pow(1+r,e+1);return o}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},XNPV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=arguments[1],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;i=i.concat(jfgrid.func_methods.getDataArr(t,!1))}else"object"==jfgrid.getObjType(t)&&null!=t.startCell?i=i.concat(jfgrid.func_methods.getCellDataArr(t,"number",!1)):i.push(t);for(var a=[],e=0;e<i.length;e++){var n=i[e];if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;a.push(parseFloat(n))}var o=jfgrid.func_methods.getCellrangeDate(arguments[2]);if(jfgrid.func_methods.valueIsError(o))return o;for(e=0;e<o.length;e++)if(!moment(o[e]).isValid())return jfgrid.formula.error.v;if(a.length!=o.length)return jfgrid.formula.error.nm;for(var l=0,e=0;e<a.length;e++)l+=a[e]/Math.pow(1+r,window.jfgrid_function.DAYS.f(o[e],o[0])/365);return l}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},CUMIPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a);var n=jfgrid.func_methods.getFirstValue(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n);var o=jfgrid.func_methods.getFirstValue(arguments[5]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;if(o=parseFloat(o),r<=0||t<=0||i<=0)return jfgrid.formula.error.nm;if(a<1||n<1||n<a)return jfgrid.formula.error.nm;if(0!=o&&1!=o)return jfgrid.formula.error.nm;var l=window.jfgrid_function.PMT.f(r,t,i,0,o),d=0;1===a&&0===o&&(d=-i,a++);for(e=a;e<=n;e++)d+=1===o?window.jfgrid_function.FV.f(r,e-2,l,i,1)-l:window.jfgrid_function.FV.f(r,e-1,l,i,0);return d*=r}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},PMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=0;if(4<=arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a)}var n,o=0;if(5==arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o)}return 0!=o&&1!=o?jfgrid.formula.error.nm:-(0===r?(i+a)/t:(n=Math.pow(1+r,t),1===o?(a*r/(n-1)+i*r/(1-1/n))/(1+r):a*r/(n-1)+i*r/(1-1/n)))}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},IPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=0;if(5<=arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}var o=0;if(6<=arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[5]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o)}if(t<1||i<t)return jfgrid.formula.error.nm;if(0!=o&&1!=o)return jfgrid.formula.error.nm;var l=window.jfgrid_function.PMT.f(r,i,a,n,o),d=1===t?1===o?0:-a:1===o?window.jfgrid_function.FV.f(r,t-2,l,a,1)-l:window.jfgrid_function.FV.f(r,t-1,l,a,0);return d*r}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},PPMT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=0;if(5<=arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}var o=0;if(6<=arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[5]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseFloat(o)}return t<1||i<t?jfgrid.formula.error.nm:0!=o&&1!=o?jfgrid.formula.error.nm:window.jfgrid_function.PMT.f(r,i,a,n,o)-window.jfgrid_function.IPMT.f(r,t,i,a,n,o)}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},INTRATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=0;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(i<=0||a<=0)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;var o=moment(r).date(),l=moment(r).month()+1,d=moment(r).year(),f=moment(t).date(),s=moment(t).month()+1,g=moment(t).year();switch(n){case 0:31===o&&31===f?f=o=30:31===o?o=30:30===o&&31===f&&(f=30),m=360/(f+30*s+360*g-(o+30*l+360*d));break;case 1:var c=365;if(d===g||d+1===g&&(s<l||l===s&&f<=o))return(d===g&&jfgrid.func_methods.isLeapYear(d)||jfgrid.func_methods.feb29Between(r,t)||1===s&&29===f)&&(c=366),m=c/moment(t).diff(moment(r),"days"),m*=(a-i)/i;var u=g-d+1,m=(moment().set({year:g+1,month:0,date:1})-moment().set({year:d,month:0,date:1}))/1e3/60/60/24/u/moment(t).diff(moment(r),"days");break;case 2:m=360/moment(t).diff(moment(r),"days");break;case 3:m=365/moment(t).diff(moment(r),"days");break;case 4:m=360/(f+30*s+360*g-(o+30*l+360*d))}return m*=(a-i)/i}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},PRICE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=jfgrid.func_methods.getFirstValue(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n);var o=jfgrid.func_methods.getFirstValue(arguments[5]);if(jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseInt(o);var l=0;if(7==arguments.length){if(l=jfgrid.func_methods.getFirstValue(arguments[6]),jfgrid.func_methods.valueIsError(l))return l;if(!jfgrid.func_methods.isRealNum(l))return jfgrid.formula.error.v;l=parseInt(l)}if(i<0||a<0)return jfgrid.formula.error.nm;if(n<=0)return jfgrid.formula.error.nm;if(1!=o&&2!=o&&4!=o)return jfgrid.formula.error.nm;if(l<0||4<l)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;var d=window.jfgrid_function.COUPDAYSNC.f(r,t,o,l),f=window.jfgrid_function.COUPDAYS.f(r,t,o,l),s=window.jfgrid_function.COUPDAYBS.f(r,t,o,l),g=window.jfgrid_function.COUPNUM.f(r,t,o,l);if(1<g){for(var c=n/Math.pow(1+a/o,g-1+d/f),u=0,e=1;e<=g;e++)u+=100*i/o/Math.pow(1+a/o,e-1+d/f);var m=c+u-i/o*100*(s/f)}else m=(c=i/o*100+n)/(u=a/o*((f-s)/f)+1)-i/o*100*(s/f);return m}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},PRICEDISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=0;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n)}if(i<=0||a<=0)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;var o=moment(r).date(),l=moment(r).month()+1,d=moment(r).year(),f=moment(t).date(),s=moment(t).month()+1,g=moment(t).year();switch(n){case 0:31===o&&31===f?f=o=30:31===o?o=30:30===o&&31===f&&(f=30),h=(f+30*s+360*g-(o+30*l+360*d))/360;break;case 1:var c=365;if(d===g||d+1===g&&(s<l||l===s&&f<=o))return(d===g&&jfgrid.func_methods.isLeapYear(d)||jfgrid.func_methods.feb29Between(r,t)||1===s&&29===f)&&(c=366),h=a-i*a*(h=moment(t).diff(moment(r),"days")/c);var u=g-d+1,m=(moment().set({year:g+1,month:0,date:1})-moment().set({year:d,month:0,date:1}))/1e3/60/60/24/u,h=moment(t).diff(moment(r),"days")/m;break;case 2:h=moment(t).diff(moment(r),"days")/360;break;case 3:h=moment(t).diff(moment(r),"days")/365;break;case 4:h=(f+30*s+360*g-(o+30*l+360*d))/360}return h=a-i*a*h}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},PRICEMAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getCellDate(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!moment(i).isValid())return jfgrid.formula.error.v;var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=jfgrid.func_methods.getFirstValue(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n);var o=0;if(6==arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[5]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseInt(o)}if(a<0||n<0)return jfgrid.formula.error.nm;if(o<0||4<o)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;var l=moment(r).date(),d=moment(r).month()+1,f=moment(r).year(),s=moment(t).date(),g=moment(t).month()+1,c=moment(t).year(),u=moment(i).date(),m=moment(i).month()+1,h=moment(i).year();switch(o){case 0:31==l&&(l=30),31==s&&(s=30),31==u&&(u=30);var j=360,p=s+30*g+360*c-(l+30*d+360*f),v=s+30*g+360*c-(u+30*m+360*h),b=l+30*d+360*f-(u+30*m+360*h);break;case 1:var _=365;if(f===c||f+1===c&&(g<d||d===g&&s<=l)){(f===c&&jfgrid.func_methods.isLeapYear(f)||jfgrid.func_methods.feb29Between(r,t)||1===g&&29===s)&&(_=366);j=_,p=moment(t).diff(moment(r),"days");return(100+(v=moment(r).diff(moment(i),"days"))/j*a*100)/(1+p/j*n)-(b=moment(t).diff(moment(i),"days"))/j*a*100}var w=c-f+1,j=(moment().set({year:c+1,month:0,date:1})-moment().set({year:f,month:0,date:1}))/1e3/60/60/24/w,p=moment(t).diff(moment(r),"days"),v=moment(r).diff(moment(i),"days"),b=moment(t).diff(moment(i),"days");break;case 2:j=360,p=moment(t).diff(moment(r),"days"),v=moment(r).diff(moment(i),"days"),b=moment(t).diff(moment(i),"days");break;case 3:j=365,p=moment(t).diff(moment(r),"days"),v=moment(r).diff(moment(i),"days"),b=moment(t).diff(moment(i),"days");break;case 4:j=360,p=s+30*g+360*c-(l+30*d+360*f),v=s+30*g+360*c-(u+30*m+360*h),b=l+30*d+360*f-(u+30*m+360*h)}return(100+v/j*a*100)/(1+p/j*n)-b/j*a*100}catch(e){var y=e;return y=jfgrid.formula.errorInfo(y),[jfgrid.formula.error.v,y]}},RECEIVED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=0;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}if(i<=0||a<=0)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;var o=moment(r).date(),l=moment(r).month()+1,d=moment(r).year(),f=moment(t).date(),s=moment(t).month()+1,g=moment(t).year();switch(n){case 0:31==o&&(o=30),31==f&&(f=30);var c=360,u=f+30*s+360*g-(o+30*l+360*d);break;case 1:var m=365;if(d===g||d+1===g&&(s<l||l===s&&f<=o)){(d===g&&jfgrid.func_methods.isLeapYear(d)||jfgrid.func_methods.feb29Between(r,t)||1===s&&29===f)&&(m=366);c=m;return i/(1-a*(u=moment(t).diff(moment(r),"days"))/c)}var h=g-d+1,c=(moment().set({year:g+1,month:0,date:1})-moment().set({year:d,month:0,date:1}))/1e3/60/60/24/h,u=moment(t).diff(moment(r),"days");break;case 2:c=360,u=moment(t).diff(moment(r),"days");break;case 3:c=365,u=moment(t).diff(moment(r),"days");break;case 4:c=360,u=f+30*s+360*g-(o+30*l+360*d)}return i/(1-a*u/c)}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},DISC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=0;if(5==arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}if(i<=0||a<=0)return jfgrid.formula.error.nm;if(n<0||4<n)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;var o=moment(r).date(),l=moment(r).month()+1,d=moment(r).year(),f=moment(t).date(),s=moment(t).month()+1,g=moment(t).year();switch(n){case 0:31==o&&(o=30),31==f&&(f=30);var c=360,u=f+30*s+360*g-(o+30*l+360*d);break;case 1:var m=365;if(d===g||d+1===g&&(s<l||l===s&&f<=o))return(d===g&&jfgrid.func_methods.isLeapYear(d)||jfgrid.func_methods.feb29Between(r,t)||1===s&&29===f)&&(m=366),(a-i)/a*((c=m)/(u=moment(t).diff(moment(r),"days")));var h=g-d+1,c=(moment().set({year:g+1,month:0,date:1})-moment().set({year:d,month:0,date:1}))/1e3/60/60/24/h,u=moment(t).diff(moment(r),"days");break;case 2:c=360,u=moment(t).diff(moment(r),"days");break;case 3:c=365,u=moment(t).diff(moment(r),"days");break;case 4:c=360,u=f+30*s+360*g-(o+30*l+360*d)}return(a-i)/a*(c/u)}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},NPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=0;if(4<=arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a)}var n=0;if(5<=arguments.length){if(n=jfgrid.func_methods.getFirstValue(arguments[4]),jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseFloat(n)}if(0!=n&&1!=n)return jfgrid.formula.error.nm;var o=t*(1+r*n)-a*r,l=i*r+t*(1+r*n);return Math.log(o/l)/Math.log(1+r)}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},SLN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?0==(i=parseFloat(i))?jfgrid.formula.error.d:(r-t)/i:jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},DURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=jfgrid.func_methods.getFirstValue(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n);var o=0;if(6==arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[5]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseInt(o)}if(i<0||a<0)return jfgrid.formula.error.nm;if(1!=n&&2!=n&&4!=n)return jfgrid.formula.error.nm;if(o<0||4<o)return jfgrid.formula.error.nm;if(0<=moment(r)-moment(t))return jfgrid.formula.error.nm;for(var l=window.jfgrid_function.COUPNUM.f(r,t,n,o),d=0,f=0,e=1;e<=l;e++)d+=i/n*100*e/Math.pow(1+a/n,e),f+=i/n*100/Math.pow(1+a/n,e);var s=(d+100*l/Math.pow(1+a/n,l))/(f+100/Math.pow(1+a/n,l));return s/=n}catch(e){var g=e;return g=jfgrid.formula.errorInfo(g),[jfgrid.formula.error.v,g]}},MDURATION:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellDate(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!moment(r).isValid())return jfgrid.formula.error.v;var t=jfgrid.func_methods.getCellDate(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!moment(t).isValid())return jfgrid.formula.error.v;var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i);var a=jfgrid.func_methods.getFirstValue(arguments[3]);if(jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a);var n=jfgrid.func_methods.getFirstValue(arguments[4]);if(jfgrid.func_methods.valueIsError(n))return n;if(!jfgrid.func_methods.isRealNum(n))return jfgrid.formula.error.v;n=parseInt(n);var o=0;if(6==arguments.length){if(o=jfgrid.func_methods.getFirstValue(arguments[5]),jfgrid.func_methods.valueIsError(o))return o;if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=parseInt(o)}return i<0||a<0?jfgrid.formula.error.nm:1!=n&&2!=n&&4!=n||o<0||4<o||0<=moment(r)-moment(t)?jfgrid.formula.error.nm:window.jfgrid_function.DURATION.f(r,t,i,a,n,o)/(1+a/n)}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},BIN2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!/^[01]{1,10}$/g.test(r))return jfgrid.formula.error.nm;var t=parseInt(r,2),i=r.toString();return 10===i.length&&"1"===i.substring(0,1)?parseInt(i.substring(1),2)-512:t}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},BIN2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^[01]{1,10}$/g.test(r))return jfgrid.formula.error.nm;var i=parseInt(r,2).toString(16).toUpperCase();return null==t?i:t<0||t<i.length?jfgrid.formula.error.nm:new Array(t-i.length+1).join("0")+i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},BIN2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^[01]{1,10}$/g.test(r))return jfgrid.formula.error.nm;var i=r.toString();if(10===i.length&&"1"===i.substring(0,1))return(1073741312+parseInt(i.substring(1),2)).toString(8);var a=parseInt(r,2).toString(8);return null==t?a:t<0||t<a.length?jfgrid.formula.error.nm:new Array(t-a.length+1).join("0")+a}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},DEC2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^-?[0-9]{1,3}$/.test(r)||r<-512||511<r)return jfgrid.formula.error.nm;if(r<0)return"1"+new Array(9-(512+r).toString(2).length).join("0")+(512+r).toString(2);var i=parseInt(r,10).toString(2);return null==t?i:t<0||t<i.length?jfgrid.formula.error.nm:new Array(t-i.length+1).join("0")+i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},DEC2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^-?[0-9]{1,12}$/.test(r)||r<-549755813888||549755813887<r)return jfgrid.formula.error.nm;if(r<0)return(1099511627776+r).toString(16).toUpperCase();var i=parseInt(r,10).toString(16).toUpperCase();return null==t?i:t<0||t<i.length?jfgrid.formula.error.nm:new Array(t-i.length+1).join("0")+i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},DEC2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^-?[0-9]{1,9}$/.test(r)||r<-536870912||536870911<r)return jfgrid.formula.error.nm;if(r<0)return(1073741824+r).toString(8);var i=parseInt(r,10).toString(8);return null==t?i:t<0||t<i.length?jfgrid.formula.error.nm:new Array(t-i.length+1).join("0")+i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},HEX2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return jfgrid.formula.error.nm;var i=10===r.length&&"f"===r.substring(0,1).toLowerCase(),a=i?parseInt(r,16)-1099511627776:parseInt(r,16);if(a<-512||511<a)return jfgrid.formula.error.nm;if(i)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var n=a.toString(2);return null==t?n:t<0||t<n.length?jfgrid.formula.error.nm:new Array(t-n.length+1).join("0")+n}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},HEX2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return jfgrid.formula.error.nm;var t=parseInt(r,16);return 549755813888<=t?t-1099511627776:t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},HEX2OCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^[0-9A-Fa-f]{1,10}$/.test(r))return jfgrid.formula.error.nm;var i=parseInt(r,16);if(536870911<i&&i<0xffe0000000)return jfgrid.formula.error.nm;if(0xffe0000000<=i)return(i-0xffc0000000).toString(8);var a=i.toString(8);return null==t?a:t<0||t<a.length?jfgrid.formula.error.nm:new Array(t-a.length+1).join("0")+a}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},OCT2BIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^[0-7]{1,10}$/.test(r))return jfgrid.formula.error.nm;var i=10===(r=r.toString()).length&&"7"===r.substring(0,1),a=i?parseInt(r,8)-1073741824:parseInt(r,8);if(a<-512||511<a)return error.num;if(i)return"1"+new Array(9-(512+a).toString(2).length).join("0")+(512+a).toString(2);var n=a.toString(2);return null==t?n:t<0||t<n.length?jfgrid.formula.error.nm:new Array(t-n.length+1).join("0")+n}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},OCT2DEC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!/^[0-7]{1,10}$/.test(r))return jfgrid.formula.error.nm;var t=parseInt(r,8);return 536870912<=t?t-1073741824:t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},OCT2HEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=null;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(!/^[0-7]{1,10}$/.test(r))return jfgrid.formula.error.nm;var i=parseInt(r,8);if(536870912<=i)return"FF"+(i+3221225472).toString(16).toUpperCase();var a=i.toString(16).toUpperCase();return null==t?a:t<0||t<a.length?jfgrid.formula.error.nm:new Array(t-a.length+1).join("0")+a}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},COMPLEX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t);var i="i";if(3==arguments.length&&(i=arguments[2].toString()),"i"!=i&&"j"!=i)return jfgrid.formula.error.v;if(0===r&&0===t)return 0;if(0===r)return 1===t?i:t.toString()+i;if(0===t)return r.toString();var a=0<t?"+":"";return r.toString()+a+(1===t?i:t.toString()+i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},IMREAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if("true"==(r=r.toString()).toLowerCase()||"false"==r.toLowerCase())return jfgrid.formula.error.v;if("0"==r)return 0;if(0<=["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(r))return 0;var t=r.indexOf("+"),i=r.indexOf("-");0===t&&(t=r.indexOf("+",1)),0===i&&(i=r.indexOf("-",1));var a=r.substring(r.length-1,r.length),n="i"===a||"j"===a;return 0<=t||0<=i?n?0<=t?isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?jfgrid.formula.error.nm:Number(r.substring(0,t)):isNaN(r.substring(0,i))||isNaN(r.substring(i+1,r.length-1))?jfgrid.formula.error.nm:Number(r.substring(0,i)):jfgrid.formula.error.nm:n?isNaN(r.substring(0,r.length-1))?jfgrid.formula.error.nm:0:isNaN(r)?jfgrid.formula.error.nm:r}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},IMAGINARY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if("true"==(r=r.toString()).toLowerCase()||"false"==r.toLowerCase())return jfgrid.formula.error.v;if("0"==r)return 0;if(0<=["i","j"].indexOf(r))return 1;var t=(r=r.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),i=r.indexOf("-");0===t&&(t=r.indexOf("+",1)),0===i&&(i=r.indexOf("-",1));var a=r.substring(r.length-1,r.length),n="i"===a||"j"===a;return 0<=t||0<=i?n?0<=t?isNaN(r.substring(0,t))||isNaN(r.substring(t+1,r.length-1))?jfgrid.formula.error.nm:Number(r.substring(t+1,r.length-1)):isNaN(r.substring(0,i))||isNaN(r.substring(i+1,r.length-1))?jfgrid.formula.error.nm:-Number(r.substring(i+1,r.length-1)):jfgrid.formula.error.nm:n?isNaN(r.substring(0,r.length-1))?jfgrid.formula.error.nm:r.substring(0,r.length-1):isNaN(r)?jfgrid.formula.error.nm:0}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},IMCONJUGATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=window.jfgrid_function.IMREAL.f(r);if(jfgrid.func_methods.valueIsError(t))return t;var i=window.jfgrid_function.IMAGINARY.f(r);if(jfgrid.func_methods.valueIsError(i))return i;var a="i"===(a=r.substring(r.length-1))||"j"===a?a:"i";return 0!==i?window.jfgrid_function.COMPLEX.f(t,-i,a):r}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},IMABS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgrid_function.IMREAL.f(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=window.jfgrid_function.IMAGINARY.f(arguments[0]);return jfgrid.func_methods.valueIsError(t)?t:Math.sqrt(Math.pow(r,2)+Math.pow(t,2))}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},DELTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=0;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseFloat(t)}return r===t?1:0}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},IMSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgrid_function.IMREAL.f(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=window.jfgrid_function.IMAGINARY.f(arguments[0]);if(jfgrid.func_methods.valueIsError(t))return t;for(var i=arguments[0],e=1;e<arguments.length;e++){var a=window.jfgrid_function.IMREAL.f(i);if(jfgrid.func_methods.valueIsError(a))return a;var n=window.jfgrid_function.IMAGINARY.f(i);if(jfgrid.func_methods.valueIsError(n))return n;var o=window.jfgrid_function.IMREAL.f(arguments[e]);if(jfgrid.func_methods.valueIsError(o))return o;var l=window.jfgrid_function.IMAGINARY.f(arguments[e]);if(jfgrid.func_methods.valueIsError(l))return l;i=window.jfgrid_function.COMPLEX.f(a+o,n+l)}return i}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},IMSUB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if("true"==(r=r.toString()).toLowerCase()||"false"==r.toLowerCase())return jfgrid.formula.error.v;var t=window.jfgrid_function.IMREAL.f(r);if(jfgrid.func_methods.valueIsError(t))return t;var i=window.jfgrid_function.IMAGINARY.f(r);if(jfgrid.func_methods.valueIsError(i))return i;var a=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(a))return a;if("true"==(a=a.toString()).toLowerCase()||"false"==a.toLowerCase())return jfgrid.formula.error.v;var n=window.jfgrid_function.IMREAL.f(a);if(jfgrid.func_methods.valueIsError(n))return n;var o=window.jfgrid_function.IMAGINARY.f(a);if(jfgrid.func_methods.valueIsError(o))return o;var l=r.substring(r.length-1),d=a.substring(a.length-1),f="j"!==l&&"j"!==d?"i":"j";return window.jfgrid_function.COMPLEX.f(t-n,i-o,f)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},IMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgrid_function.IMREAL.f(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=window.jfgrid_function.IMAGINARY.f(arguments[0]);if(jfgrid.func_methods.valueIsError(t))return t;for(var i=arguments[0],e=1;e<arguments.length;e++){var a=window.jfgrid_function.IMREAL.f(i);if(jfgrid.func_methods.valueIsError(a))return a;var n=window.jfgrid_function.IMAGINARY.f(i);if(jfgrid.func_methods.valueIsError(n))return n;var o=window.jfgrid_function.IMREAL.f(arguments[e]);if(jfgrid.func_methods.valueIsError(o))return o;var l=window.jfgrid_function.IMAGINARY.f(arguments[e]);if(jfgrid.func_methods.valueIsError(l))return l;i=window.jfgrid_function.COMPLEX.f(a*o-n*l,a*l+n*o)}return i}catch(e){var d=e;return d=jfgrid.formula.errorInfo(d),[jfgrid.formula.error.v,d]}},IMDIV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if("true"==(r=r.toString()).toLowerCase()||"false"==r.toLowerCase())return jfgrid.formula.error.v;var t=window.jfgrid_function.IMREAL.f(r);if(jfgrid.func_methods.valueIsError(t))return t;var i=window.jfgrid_function.IMAGINARY.f(r);if(jfgrid.func_methods.valueIsError(i))return i;var a=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(a))return a;if("true"==(a=a.toString()).toLowerCase()||"false"==a.toLowerCase())return jfgrid.formula.error.v;var n=window.jfgrid_function.IMREAL.f(a);if(jfgrid.func_methods.valueIsError(n))return n;var o=window.jfgrid_function.IMAGINARY.f(a);if(jfgrid.func_methods.valueIsError(o))return o;var l=r.substring(r.length-1),d=a.substring(a.length-1),f="j"===l||"j"===d?"j":"i";if(0===n&&0===o)return jfgrid.formula.error.nm;var s=n*n+o*o;return window.jfgrid_function.COMPLEX.f((t*n+i*o)/s,(i*n-t*o)/s,f)}catch(e){var g=e;return g=jfgrid.formula.errorInfo(g),[jfgrid.formula.error.v,g]}},NOT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellBoolen(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:!r}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},TRUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return!0}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},FALSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return!1}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},AND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=!0,e=0;e<arguments.length;e++){var t=jfgrid.func_methods.getCellBoolen(arguments[e]);if(jfgrid.func_methods.valueIsError(t))return t;if(!t){r=!1;break}}return r}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},IFERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[1],"text"),t=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(t)?r:t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},IF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getCellBoolen(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(t))return t;var i="";return 3==arguments.length&&(i=jfgrid.func_methods.getFirstValue(arguments[2],"text"),jfgrid.func_methods.valueIsError(i))?i:r?t:i}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},OR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r=!1,e=0;e<arguments.length;e++){var t=jfgrid.func_methods.getCellBoolen(arguments[e]);if(jfgrid.func_methods.valueIsError(t))return t;if(t){r=!0;break}}return r}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},NE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:r!=t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},EQ:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:r==t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},GT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseFloat(t))<r:jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},GTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?(t=parseFloat(t))<=r:jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},LT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?r<(t=parseFloat(t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},LTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?r<=(t=parseFloat(t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ADD:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?r+(t=parseFloat(t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},MINUS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?r-(t=parseFloat(t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},MULTIPLY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?r*(t=parseFloat(t)):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},DIVIDE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:jfgrid.func_methods.isRealNum(t)?0==(t=parseFloat(t))?jfgrid.formula.error.d:r/t:jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},CONCAT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");return jfgrid.func_methods.valueIsError(t)?t:r+""+t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},UNARY_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;var t=(r=parseFloat(r))/100;return Math.round(100*t)/100}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},CONCATENATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{for(var r="",e=0;e<arguments.length;e++){var t=jfgrid.func_methods.getFirstValue(arguments[e],"text");if(jfgrid.func_methods.valueIsError(t))return t;r=r+""+t}return r}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},CODE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:""==r?jfgrid.formula.error.v:r.charCodeAt(0)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},CHAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:!jfgrid.func_methods.isRealNum(r)||(r=parseInt(r))<1||255<r?jfgrid.formula.error.v:String.fromCharCode(r)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ARABIC:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;if(r=r.toString().toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(r))return jfgrid.formula.error.v;var t=0;return r.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ROMAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e,r,t=0;t<arguments.length;t++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[t],t)[0])return jfgrid.formula.error.v}try{var i=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;if(0==(i=parseInt(i)))return"";if(i<1||3999<i)return jfgrid.formula.error.v;return e=i,(r=[["","I","II","III","IV","V","VI","VII","VIII","IX"],["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"],["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"],["","M","MM","MMM"]])[3][Math.floor(e/1e3)]+r[2][Math.floor(e%1e3/100)]+r[1][Math.floor(e%100/10)]+r[0][e%10]}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},REGEXEXTRACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(t))return t;var i=r.match(new RegExp(t));return i?i[1<i.length?i.length-1:0]:null}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},REGEXMATCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");return jfgrid.func_methods.valueIsError(t)?t:!!r.match(new RegExp(t))}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},REGEXREPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(t))return t;var i=jfgrid.func_methods.getFirstValue(arguments[2],"text");return jfgrid.func_methods.valueIsError(i)?i:r.replace(new RegExp(t),i)}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},T:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:"string"==jfgrid.getObjType(r)?r:""}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},FIXED:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=2;if(2<=arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}var i=!1;if(3==arguments.length&&(i=jfgrid.func_methods.getCellBoolen(arguments[2]),jfgrid.func_methods.valueIsError(i)))return i;if(127<t)return jfgrid.formula.error.v;var a=i?"0":"#,##0";return t<=0?r=Math.round(r*Math.pow(10,t))/Math.pow(10,t):0<t&&(a+="."+new Array(t+1).join("0")),jfgrid.mask.update(a,r)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},FIND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(t))return t;t=t.toString();var i=1;if(3==arguments.length){if(i=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i)}return i<0||i>t.length?jfgrid.formula.error.v:""==r?i:-1==t.indexOf(r)?jfgrid.formula.error.v:t.indexOf(r,i-1)+1}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},FINDB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(t))return t;t=t.toString();var i=1;if(3==arguments.length){if(i=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i)}if(i<0||i>t.length)return jfgrid.formula.error.v;if(""==r)return i;if(-1==t.indexOf(r))return jfgrid.formula.error.v;for(var a=t.split(""),n=t.indexOf(r,i-1),o=0,e=0;e<n;e++)/[^\x00-\xff]/g.test(a[e])?o+=2:o+=1;return o}catch(e){var l=e;return l=jfgrid.formula.errorInfo(l),[jfgrid.formula.error.v,l]}},JOIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;for(var t=[],e=1;e<arguments.length;e++){var i=arguments[e];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):t.push(i)}return t.join(r)}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},LEFT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=1;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}return t<0?jfgrid.formula.error.v:t>=r.length?r:0==t?"":r.substr(0,t)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},RIGHT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=1;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}return t<0?jfgrid.formula.error.v:t>=r.length?r:0==t?"":r.substr(-t,t)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},MID:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);return jfgrid.func_methods.valueIsError(i)?i:jfgrid.func_methods.isRealNum(i)?(i=parseInt(i),t<1||i<0?jfgrid.formula.error.v:t>r.length?"":t+i>r.length?r.substr(t-1,r.length-t+1):r.substr(t-1,i)):jfgrid.formula.error.v}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},LEN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:(r=r.toString()).length}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},LENB:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:(r=r.toString()).replace(/[^\x00-\xff]/g,"aa").length}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},LOWER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:(r=r.toString())?r.toLowerCase():r}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},UPPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:(r=r.toString())?r.toUpperCase():r}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},EXACT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");return jfgrid.func_methods.valueIsError(t)?t:r===(t=t.toString())}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},REPLACE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=jfgrid.func_methods.getFirstValue(arguments[1]);if(jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t);var i=jfgrid.func_methods.getFirstValue(arguments[2]);if(jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i);var a=jfgrid.func_methods.getFirstValue(arguments[3],"text");return jfgrid.func_methods.valueIsError(a)?a:(a=a.toString(),r.substr(0,t-1)+a+r.substr(t-1+i))}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},REPT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=jfgrid.func_methods.getFirstValue(arguments[1]);return jfgrid.func_methods.valueIsError(t)?t:!jfgrid.func_methods.isRealNum(t)||(t=parseInt(t))<0?jfgrid.formula.error.v:(100<t&&(t=100),new Array(t+1).join(r))}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},SEARCH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(t))return t;t=t.toString();var i=1;if(3==arguments.length){if(i=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseInt(i)}if(i<=0||i>t.length)return jfgrid.formula.error.v;var a=t.toLowerCase().indexOf(r.toLowerCase(),i-1)+1;return 0===a?jfgrid.formula.error.v:a}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},SUBSTITUTE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(t))return t;t=t.toString();var i=jfgrid.func_methods.getFirstValue(arguments[2],"text");if(jfgrid.func_methods.valueIsError(i))return i;i=i.toString();var a=null;if(4==arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseInt(a)}var n,o=new RegExp(t,"g");if(null==a)n=r.replace(o,i);else{if(a<=0)return jfgrid.formula.error.v;var l=r.match(o);if(null==l||a>l.length)return r;for(var d=t.length,f=0,e=1;e<=a;e++)f=r.indexOf(t,f)+1;n=r.substring(0,f-1)+i+r.substring(f-1+d)}return n}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},CLEAN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");if(jfgrid.func_methods.valueIsError(r))return r;r=r.toString();for(var t=[],e=0;e<r.length;e++){var i=r.charCodeAt(e);(/[\u4e00-\u9fa5]/g.test(r.charAt(e))||31<i&&i<127)&&t.push(r.charAt(e))}return t.join("")}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");return jfgrid.func_methods.valueIsError(t)?t:(t=t.toString(),jfgrid.mask.update(t,r))}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},TRIM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:(r=r.toString()).replace(/ +/g," ").trim()}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},VALUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:(r=r.toString(),jfgrid.mask.genarate(r)[2])}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},PROPER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:(r=r.toString().toLowerCase()).replace(/[a-zA-Z]+/g,function(e){return e.substring(0,1).toUpperCase()+e.substring(1)})}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},CONVERT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseFloat(r);var t=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(t))return t;t=t.toString();var i=jfgrid.func_methods.getFirstValue(arguments[2],"text");if(jfgrid.func_methods.valueIsError(i))return i;i=i.toString();for(var a,n=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],o={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},d=null,f=null,s=t,g=i,c=1,u=1,e=0;e<n.length;e++)a=null===n[e][2]?[]:n[e][2],(n[e][1]===s||0<=a.indexOf(s))&&(d=n[e]),(n[e][1]===g||0<=a.indexOf(g))&&(f=n[e]);if(null===d){var m=o[t.substring(0,2)],h=l[t.substring(0,1)];"da"===t.substring(0,2)&&(h=["dekao",10,"da"]),m?(c=m[2],s=t.substring(2)):h&&(c=h[1],s=t.substring(h[2].length));for(var j=0;j<n.length;j++)a=null===n[j][2]?[]:n[j][2],(n[j][1]===s||0<=a.indexOf(s))&&(d=n[j])}if(null===f){var p=o[i.substring(0,2)],v=l[i.substring(0,1)];"da"===i.substring(0,2)&&(v=["dekao",10,"da"]),p?(u=p[2],g=i.substring(2)):v&&(u=v[1],g=i.substring(v[2].length));for(var b=0;b<n.length;b++)a=null===n[b][2]?[]:n[b][2],(n[b][1]===g||0<=a.indexOf(g))&&(f=n[b])}return null===d||null===f?jfgrid.formula.error.na:d[3]!==f[3]?jfgrid.formula.error.na:r*d[6]*c/(f[6]*u)}catch(e){var _=e;return _=jfgrid.formula.errorInfo(_),[jfgrid.formula.error.v,_]}},SUMX2MY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1)):t.push(r);var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):a.push(i);if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}for(var f=0,e=0;e<n.length;e++)f+=Math.pow(n[e],2)-Math.pow(o[e],2);return f}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},SUMX2PY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1)):t.push(r);var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):a.push(i);if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}for(var f=0,e=0;e<n.length;e++)f+=Math.pow(n[e],2)+Math.pow(o[e],2);return f}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},SUMXMY2:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!1))}else"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=t.concat(jfgrid.func_methods.getCellDataArr(r,"text",!1)):t.push(r);var i=arguments[1],a=[];if("array"==jfgrid.getObjType(i)){if("array"==jfgrid.getObjType(i[0])&&!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;a=a.concat(jfgrid.func_methods.getDataArr(i,!1))}else"object"==jfgrid.getObjType(i)&&null!=i.startCell?a=a.concat(jfgrid.func_methods.getCellDataArr(i,"text",!1)):a.push(i);if(t.length!=a.length)return jfgrid.formula.error.na;for(var n=[],o=[],e=0;e<t.length;e++){var l=t[e],d=a[e];jfgrid.func_methods.isRealNum(l)&&jfgrid.func_methods.isRealNum(d)&&(n.push(parseFloat(l)),o.push(parseFloat(d)))}for(var f=0,e=0;e<n.length;e++)f+=Math.pow(n[e]-o[e],2);return f}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},TRANSPOSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=jfgrid.func_methods.getDataDyadicArr(r)}else"object"==jfgrid.getObjType(r)&&null!=r.startCell&&(t=jfgrid.func_methods.getCellDataDyadicArr(r,"number"));return t=t[0].map(function(e,r){return t.map(function(e){return e[r]})})}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},TREND:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=jfgrid.func_methods.getDataDyadicArr(r)}else if("object"==jfgrid.getObjType(r)&&null!=r.startCell)t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");else{if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;(c=[]).push(parseFloat(r)),t.push(c)}for(var i=t.length,a=t[0].length,e=0;e<i;e++)for(var n=0;n<a;n++){if(!jfgrid.func_methods.isRealNum(t[e][n]))return jfgrid.formula.error.v;t[e][n]=parseFloat(t[e][n])}for(var o=[],e=1;e<=i;e++)for(n=1;n<=a;n++){var l=(e-1)*a+n;o.push(l)}if(2<=arguments.length){var d=arguments[1],o=[];if("array"==jfgrid.getObjType(d)){if("array"==jfgrid.getObjType(d[0])&&!jfgrid.func_methods.isDyadicArr(d))return jfgrid.formula.error.v;o=jfgrid.func_methods.getDataDyadicArr(d)}else if("object"==jfgrid.getObjType(d)&&null!=d.startCell)o=jfgrid.func_methods.getCellDataDyadicArr(d,"text");else{if(!jfgrid.func_methods.isRealNum(d))return jfgrid.formula.error.v;(c=[]).push(parseFloat(d)),o.push(c)}for(e=0;e<o.length;e++)for(n=0;n<o[0].length;n++){if(!jfgrid.func_methods.isRealNum(o[e][n]))return jfgrid.formula.error.v;o[e][n]=parseFloat(o[e][n])}}var f=o.length,s=o[0].length,g=o;if(3<=arguments.length){var c,u=arguments[2],g=[];if("array"==jfgrid.getObjType(u)){if("array"==jfgrid.getObjType(u[0])&&!jfgrid.func_methods.isDyadicArr(u))return jfgrid.formula.error.v;g=jfgrid.func_methods.getDataDyadicArr(u)}else if("object"==jfgrid.getObjType(u)&&null!=u.startCell)g=jfgrid.func_methods.getCellDataDyadicArr(u,"text");else{if(!jfgrid.func_methods.isRealNum(u))return jfgrid.formula.error.v;(c=[]).push(parseFloat(u)),g.push(c)}for(e=0;e<g.length;e++)for(n=0;n<g[0].length;n++){if(!jfgrid.func_methods.isRealNum(g[e][n]))return jfgrid.formula.error.v;g[e][n]=parseFloat(g[e][n])}}var m=!0;if(4==arguments.length&&(m=jfgrid.func_methods.getCellBoolen(arguments[3]),jfgrid.func_methods.valueIsError(m)))return m;if(i!=f||a!=s)return jfgrid.formula.error.r;var h,j=function(e,r){for(var t=0,i=0,a=0,n=0,o=0;o<e.length;o++)for(var l=0;l<e[o].length;l++)t+=e[o][l],i+=r[o][l],a+=e[o][l]*r[o][l],n+=e[o][l]*e[o][l];var d=e.length*e[0].length,f=t/d,s=i/d,g=(a/d-f*s)/(n/d-f*f);return[g,s-g*f]}(o,t),p=j[0];h=m?j[1]:0;for(var v=[],e=0;e<g.length;e++)for(n=0;n<g[e].length;n++){var b=p*g[e][n]+h;v.push(Math.round(1e9*b)/1e9)}return v}catch(e){var _=e;return _=jfgrid.formula.errorInfo(_),[jfgrid.formula.error.v,_]}},FREQUENCY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=t.concat(jfgrid.func_methods.getDataArr(r,!0))}else if("object"==jfgrid.getObjType(r)&&null!=r.startCell)t=t.concat(jfgrid.func_methods.getCellDataArr(r,"number",!0));else{if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;t.push(r)}for(var i=[],e=0;e<t.length;e++)jfgrid.func_methods.isRealNum(t[e])&&i.push(parseFloat(t[e]));var a=arguments[1],n=[];if("array"==jfgrid.getObjType(a)){if("array"==jfgrid.getObjType(a[0])&&!jfgrid.func_methods.isDyadicArr(a))return jfgrid.formula.error.v;n=n.concat(jfgrid.func_methods.getDataArr(a,!0))}else if("object"==jfgrid.getObjType(a)&&null!=a.startCell)n=n.concat(jfgrid.func_methods.getCellDataArr(a,"number",!0));else{if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;n.push(a)}for(var o=[],e=0;e<n.length;e++)jfgrid.func_methods.isRealNum(n[e])&&o.push(parseFloat(n[e]));if(0==i.length&&0==o.length)return[[0],[0]];if(0==i.length){for(var l=[[0]],e=0;e<o.length;e++)l.push([0]);return l}if(0==o.length)return[[0],[i.length]];o.sort(function(e,r){return e-r});for(l=[],e=0;e<o.length;e++)if(0==e){for(var d=0,f=0;f<i.length;f++)i[f]<=o[0]&&d++;l.push([d])}else if(e==o.length-1){for(var s=0,g=0,f=0;f<i.length;f++)i[f]<=o[e]&&i[f]>o[e-1]&&s++,i[f]>o[e]&&g++;l.push([s]),l.push([g])}else{for(d=0,f=0;f<i.length;f++)i[f]<=o[e]&&i[f]>o[e-1]&&d++;l.push([d])}return l}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},GROWTH:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=jfgrid.func_methods.getDataDyadicArr(r)}else if("object"==jfgrid.getObjType(r)&&null!=r.startCell)t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");else{if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;(c=[]).push(parseFloat(r)),t.push(c)}for(var i=t.length,a=t[0].length,e=0;e<i;e++)for(var n=0;n<a;n++){if(!jfgrid.func_methods.isRealNum(t[e][n]))return jfgrid.formula.error.v;t[e][n]=parseFloat(t[e][n])}for(var o=[],e=1;e<=i;e++)for(n=1;n<=a;n++){var l=(e-1)*a+n;o.push(l)}if(2<=arguments.length){var d=arguments[1],o=[];if("array"==jfgrid.getObjType(d)){if("array"==jfgrid.getObjType(d[0])&&!jfgrid.func_methods.isDyadicArr(d))return jfgrid.formula.error.v;o=jfgrid.func_methods.getDataDyadicArr(d)}else if("object"==jfgrid.getObjType(d)&&null!=d.startCell)o=jfgrid.func_methods.getCellDataDyadicArr(d,"text");else{if(!jfgrid.func_methods.isRealNum(d))return jfgrid.formula.error.v;(c=[]).push(parseFloat(d)),o.push(c)}for(e=0;e<o.length;e++)for(n=0;n<o[0].length;n++){if(!jfgrid.func_methods.isRealNum(o[e][n]))return jfgrid.formula.error.v;o[e][n]=parseFloat(o[e][n])}}var f=o.length,s=o[0].length,g=o;if(3<=arguments.length){var c,u=arguments[2],g=[];if("array"==jfgrid.getObjType(u)){if("array"==jfgrid.getObjType(u[0])&&!jfgrid.func_methods.isDyadicArr(u))return jfgrid.formula.error.v;g=jfgrid.func_methods.getDataDyadicArr(u)}else if("object"==jfgrid.getObjType(u)&&null!=u.startCell)g=jfgrid.func_methods.getCellDataDyadicArr(u,"text");else{if(!jfgrid.func_methods.isRealNum(u))return jfgrid.formula.error.v;(c=[]).push(parseFloat(u)),g.push(c)}for(e=0;e<g.length;e++)for(n=0;n<g[0].length;n++){if(!jfgrid.func_methods.isRealNum(g[e][n]))return jfgrid.formula.error.v;g[e][n]=parseFloat(g[e][n])}}var m=!0;if(4==arguments.length&&(m=jfgrid.func_methods.getCellBoolen(arguments[3]),jfgrid.func_methods.valueIsError(m)))return m;if(i!=f||a!=s)return jfgrid.formula.error.r;var h,j=function(e,r){for(var t=0,i=0,a=0,n=0,o=0;o<e.length;o++)for(var l=0;l<e[o].length;l++)t+=e[o][l],i+=Math.log(r[o][l]),a+=e[o][l]*Math.log(r[o][l]),n+=e[o][l]*e[o][l];var d=e.length*e[0].length,f=t/d,s=i/d,g=(a/d-f*s)/(n/d-f*f),c=s-g*f;return[Math.exp(g),Math.exp(c)]}(o,t),p=j[0];h=m?j[1]:1;for(var v=[],e=0;e<g.length;e++)for(n=0;n<g[e].length;n++){var b=g[e][n],_=h*Math.pow(p,b);v.push(Math.round(1e9*_)/1e9)}return v}catch(e){var w=e;return w=jfgrid.formula.errorInfo(w),[jfgrid.formula.error.v,w]}},LINEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return jfgrid.formula.error.v}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},LOGEST:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return jfgrid.formula.error.v}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},MDETERM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;i=jfgrid.func_methods.getDataDyadicArr(t)}else{"object"==jfgrid.getObjType(t)&&null!=t.startCell?i=jfgrid.func_methods.getCellDataDyadicArr(t,"text"):((r=[]).push(t),i.push(r))}for(e=0;e<i.length;e++)for(var a=0;a<i[e].length;a++){if(!jfgrid.func_methods.isRealNum(i[e][a]))return jfgrid.formula.error.v;i[e][a]=parseFloat(i[e][a])}if(i.length!=i[0].length)return jfgrid.formula.error.v;return function(e,r){var t,i=new Array;if(1==r)return t=e[0][0];if(2==r)return t=e[0][0]*e[1][1]-e[0][1]*e[1][0];if(3==r)return t=e[0][0]*e[1][1]*e[2][2]+e[1][0]*e[2][1]*e[0][2]+e[2][0]*e[0][1]*e[1][2]-e[2][0]*e[1][1]*e[0][2]-e[0][0]*e[2][1]*e[1][2]-e[1][0]*e[0][1]*e[2][2];t=0;for(var a=new Array,n=new Array,o=0;o<r;o++)i[o]=e[o][0]*Math.pow(-1,o+1+1);for(o=0;o<r;o++){n[o]=new Array;for(var l=0;l<r-1;l++)n[o][l]=e[o][l+1]}for(o=0;o<r;o++){for(l=0;l<r;l++){a[l]=new Array;for(var d=0;d<r-1;d++)l<o?a[l][d]=n[l][d]:o<l&&(a[l-1][d]=n[l][d])}t+=i[o]*arguments.callee(a,r-1)}return t}(i,i.length)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},MINVERSE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;i=jfgrid.func_methods.getDataDyadicArr(t)}else{"object"==jfgrid.getObjType(t)&&null!=t.startCell?i=jfgrid.func_methods.getCellDataDyadicArr(t,"text"):((r=[]).push(t),i.push(r))}for(e=0;e<i.length;e++)for(var a=0;a<i[e].length;a++){if(!jfgrid.func_methods.isRealNum(i[e][a]))return jfgrid.formula.error.v;i[e][a]=parseFloat(i[e][a])}return i.length!=i[0].length?jfgrid.formula.error.v:jfgrid.matrix_methods.inverse(i)}catch(e){var n=e;return n=jfgrid.formula.errorInfo(n),[jfgrid.formula.error.v,n]}},MMULT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!(u=jfgrid.formula.errorParamCheck(this.p,arguments[e],e))[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=jfgrid.func_methods.getDataDyadicArr(r)}else{"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=jfgrid.func_methods.getCellDataDyadicArr(r,"text"):((s=[]).push(r),t.push(s))}for(e=0;e<t.length;e++)for(var i=0;i<t[e].length;i++){if(!jfgrid.func_methods.isRealNum(t[e][i]))return jfgrid.formula.error.v;t[e][i]=parseFloat(t[e][i])}var a=arguments[1],n=[];if("array"==jfgrid.getObjType(a)){if("array"==jfgrid.getObjType(a[0])&&!jfgrid.func_methods.isDyadicArr(a))return jfgrid.formula.error.v;n=jfgrid.func_methods.getDataDyadicArr(a)}else{"object"==jfgrid.getObjType(a)&&null!=a.startCell?n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"):((s=[]).push(a),n.push(s))}for(e=0;e<n.length;e++)for(i=0;i<n[e].length;i++){if(!jfgrid.func_methods.isRealNum(n[e][i]))return jfgrid.formula.error.v;n[e][i]=parseFloat(n[e][i])}if(t[0].length!=n.length)return jfgrid.formula.error.v;for(var o=t.length,l=n[0].length,d=[],f=0;f<o;f++){for(var s=[],g=0;g<l;g++){for(var c=0,u=0;u<t[0].length;u++)c+=t[f][u]*n[u][g];s.push(c)}d.push(s)}return d}catch(e){var m=e;return m=jfgrid.formula.errorInfo(m),[jfgrid.formula.error.v,m]}},SUMPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=jfgrid.func_methods.getDataDyadicArr(r)}else{"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=jfgrid.func_methods.getCellDataDyadicArr(r,"text"):((o=[]).push(r),t.push(o))}for(e=0;e<t.length;e++)for(var i=0;i<t[e].length;i++)jfgrid.func_methods.isRealNum(t[e][i])?t[e][i]=parseFloat(t[e][i]):t[e][i]=0;var a=t.length,n=t[0].length;if(2<=arguments.length)for(e=1;e<arguments.length;e++){var o,l=arguments[e],d=[];if("array"==jfgrid.getObjType(l)){if("array"==jfgrid.getObjType(l[0])&&!jfgrid.func_methods.isDyadicArr(l))return jfgrid.formula.error.v;d=jfgrid.func_methods.getDataDyadicArr(l)}else{"object"==jfgrid.getObjType(l)&&null!=l.startCell?d=jfgrid.func_methods.getCellDataDyadicArr(l,"text"):((o=[]).push(l),d.push(o))}if(d.length!=a||d[0].length!=n)return jfgrid.formula.error.v;for(var f=0;f<a;f++)for(var s=0;s<n;s++)jfgrid.func_methods.isRealNum(d[f][s])?t[f][s]=t[f][s]*parseFloat(d[f][s]):t[f][s]=0}for(var g=0,f=0;f<a;f++)for(s=0;s<n;s++)g+=t[f][s];return g}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},ISFORMULA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];return"object"==jfgrid.getObjType(t)&&null!=t.startCell?null!=t.data&&(null!=(r="array"==jfgrid.getObjType(t.data)?t.data[0][0]:t.data)&&null!=r.f):jfgrid.formula.error.v}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},CELL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if(null==t.data)return jfgrid.formula.error.v;if("array"==jfgrid.getObjType(t.data))return jfgrid.formula.error.v;if(r=t.data.v,jfgrid.func_methods.isRealNull(r))return jfgrid.formula.error.v}else r=t;var i,a=arguments[1];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(i=a.startCell,-1==["address","col","color","contents","filename","format","parentheses","prefix","protect","row","type","width"].indexOf(r))return jfgrid.formula.error.v;var n=jfgrid.getjfgridfile()[jfgrid.sheetmanage.getSheetIndex(jfgrid.currentSheetIndex)],o=jfgrid.formula.getcellrange(i),l=o.row[0],d=o.column[0];switch(r){case"address":return i;case"col":return d+1;case"color":return 0;case"contents":return null==jfgrid.flowdata[l][d]||null==jfgrid.flowdata[l][d].v||""==jfgrid.flowdata[l][d].v?0:jfgrid.flowdata[l][d].v;case"filename":return n.name;case"format":return null==jfgrid.flowdata[l][d]||null==jfgrid.flowdata[l][d].ct?"G":jfgrid.flowdata[l][d].ct.fa;case"parentheses":return null==jfgrid.flowdata[l][d]||null==jfgrid.flowdata[l][d].v||""==jfgrid.flowdata[l][d].v?0:0<jfgrid.flowdata[l][d].v?1:0;case"prefix":return null==jfgrid.flowdata[l][d]||null==jfgrid.flowdata[l][d].ht||null==jfgrid.flowdata[l][d].v||""==jfgrid.flowdata[l][d].v?"":0==jfgrid.flowdata[l][d].ht?"^":1==jfgrid.flowdata[l][d].ht?"'":2==jfgrid.flowdata[l][d].ht?'"':"";case"protect":return 0;case"row":return l+1;case"type":return null==jfgrid.flowdata[l][d]||null==jfgrid.flowdata[l][d].v||""==jfgrid.flowdata[l][d].v?"b":"l";case"width":var f=n.config;return null!=f.columlen&&d in f.columlen?f.columlen[d]:jfgrid.defaultcollen}}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},NA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return jfgrid.formula.error.na}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},ERROR_TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if(null==t.data)return jfgrid.formula.error.na;if("array"==jfgrid.getObjType(t.data)){if(null==(r=t.data[0][0])||jfgrid.func_methods.isRealNull(r.v))return jfgrid.formula.error.na;r=r.v}else{if(jfgrid.func_methods.isRealNull(t.data.v))return jfgrid.formula.error.na;r=t.data.v}}else r=t;var i={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7,"#GETTING_DATA":8};return r in i?i[r]:jfgrid.formula.error.na}catch(e){var a=e;return a=jfgrid.formula.errorInfo(a),[jfgrid.formula.error.v,a]}},ISBLANK:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0];return"object"==jfgrid.getObjType(r)&&null!=r.startCell&&null==r.data}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},ISERR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if("array"==jfgrid.getObjType(t.data))return!0;if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return!1;r=t.data.v}else r=t;return-1<["#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(r)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ISERROR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if("array"==jfgrid.getObjType(t.data))return!0;if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return!1;r=t.data.v}else r=t;return-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(r)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ISLOGICAL:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if("array"==jfgrid.getObjType(t.data))return!1;if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return!1;r=t.data.v}else r=t;return"true"==r.toString().toLowerCase()||"false"==r.toString().toLowerCase()}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ISNA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if("array"==jfgrid.getObjType(t.data))return!1;if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return!1;r=t.data.v}else r=t;return"#N/A"==r.toString()}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ISNONTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if("array"==jfgrid.getObjType(t.data))return!0;if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return!0;r=t.data.v}else r=t;return-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(r)||("true"==r.toString().toLowerCase()||"false"==r.toString().toLowerCase()||!!jfgrid.func_methods.isRealNum(r))}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ISNUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if("array"==jfgrid.getObjType(t.data))return!1;if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return!1;r=t.data.v}else r=t;return!!jfgrid.func_methods.isRealNum(r)}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},ISREF:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{return"object"==jfgrid.getObjType(arguments[0])&&null!=arguments[0].startCell}catch(e){var r=e;return r=jfgrid.formula.errorInfo(r),[jfgrid.formula.error.v,r]}},ISTEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if("array"==jfgrid.getObjType(t.data))return!1;if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return!1;r=t.data.v}else r=t;return!(-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(r))&&("true"!=r.toString().toLowerCase()&&"false"!=r.toString().toLowerCase()&&!jfgrid.func_methods.isRealNum(r))}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},TYPE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))return 64;if("object"==jfgrid.getObjType(t)&&null!=t.startCell){if("array"==jfgrid.getObjType(t.data))return 16;if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return 1;r=t.data.v}else r=t;return-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(r)?16:"true"==r.toString().toLowerCase()||"false"==r.toString().toLowerCase()?4:jfgrid.func_methods.isRealNum(r)?1:2}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},N:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0];if("array"==jfgrid.getObjType(t))if("array"==jfgrid.getObjType(t[0])){if(!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;r=t[0][0]}else r=t[0];else if("object"==jfgrid.getObjType(t)&&null!=t.startCell)if("array"==jfgrid.getObjType(t.data)){if(null==(r=t.data[0][0])||jfgrid.func_methods.isRealNull(r.v))return 0;r=r.v}else{if(null==t.data||jfgrid.func_methods.isRealNull(t.data.v))return 0;r=t.data.v}else r=t;return-1<["#N/A","#VALUE!","#REF!","#DIV/0!","#NUM!","#NAME?","#NULL!"].indexOf(r)?r:"true"==r.toString().toLowerCase()||"false"==r.toString().toLowerCase()?"true"==r.toString().toLowerCase()?1:0:jfgrid.func_methods.isRealNum(r)?parseFloat(r):0}catch(e){var i=e;return i=jfgrid.formula.errorInfo(i),[jfgrid.formula.error.v,i]}},TO_DATE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),jfgrid.mask.update("yyyy-mm-dd",r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},TO_PURE_NUMBER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:moment(r).isValid()?jfgrid.mask.genarate(r)[2]:null==numeral(r).value()?r:numeral(r).value()}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},TO_TEXT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0],"text");return jfgrid.func_methods.valueIsError(r)?r:jfgrid.mask.update("@",r)}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},TO_DOLLARS:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),jfgrid.mask.update("$ 0.00",r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},TO_PERCENT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);return jfgrid.func_methods.valueIsError(r)?r:jfgrid.func_methods.isRealNum(r)?(r=parseFloat(r),jfgrid.mask.update("0%",r)):jfgrid.formula.error.v}catch(e){var t=e;return t=jfgrid.formula.errorInfo(t),[jfgrid.formula.error.v,t]}},DGET:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];return d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]),0===l.length?jfgrid.formula.error.v:1<l.length?jfgrid.formula.error.nm:d[l[0]]}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}},DMAX:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;for(var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[],f=(d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]))[l[0]],e=1;e<l.length;e++)f<d[l[e]]&&(f=d[l[e]]);return f}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DMIN:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;for(var o,l=findResultIndex(t,n),d=[],f=(d="string"===jfgrid.getObjType(i)?(o=findField(t,i),rest(t[o])):rest(t[i]))[l[0]],e=1;e<l.length;e++)f>d[l[e]]&&(f=d[l[e]]);return f}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DAVERAGE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=0,e=0;e<l.length;e++)f+=d[l[e]];return 0===l.length?jfgrid.formula.error.d:f/l.length}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DCOUNT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=[],e=0;e<l.length;e++)f[e]=d[l[e]];return window.jfgrid_function.COUNT.f.apply(window.jfgrid_function.COUNT,f)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DCOUNTA:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=[],e=0;e<l.length;e++)f[e]=d[l[e]];return window.jfgrid_function.COUNTA.f.apply(window.jfgrid_function.COUNTA,f)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DPRODUCT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=[],e=0;e<l.length;e++)f[e]=d[l[e]];f=jfgrid.func_methods.compact(f);var s=1;for(e=0;e<f.length;e++)s*=f[e];return s}catch(e){var g=e;return g=jfgrid.formula.errorInfo(g),[jfgrid.formula.error.v,g]}},DSTDEV:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=[],e=0;e<l.length;e++)f[e]=d[l[e]];return f=jfgrid.func_methods.compact(f),window.jfgrid_function.STDEVA.f.apply(window.jfgrid_function.STDEVA,f)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DSTDEVP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=[],e=0;e<l.length;e++)f[e]=d[l[e]];return f=jfgrid.func_methods.compact(f),window.jfgrid_function.STDEVP.f.apply(window.jfgrid_function.STDEVP,f)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DSUM:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=[],e=0;e<l.length;e++)f[e]=d[l[e]];f=jfgrid.func_methods.compact(f);var s=0;for(e=0;e<f.length;e++)s+=f[e];return s}catch(e){var g=e;return g=jfgrid.formula.errorInfo(g),[jfgrid.formula.error.v,g]}},DVAR:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=[],e=0;e<l.length;e++)f[e]=d[l[e]];return f=jfgrid.func_methods.compact(f),window.jfgrid_function.VAR_S.f.apply(window.jfgrid_function.VAR_S,f)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},DVARP:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("object"!=jfgrid.getObjType(r)||null==r.startCell)return jfgrid.formula.error.v;if(null==r.data)return jfgrid.formula.error.v;t=jfgrid.func_methods.getCellDataDyadicArr(r,"text");var i=jfgrid.func_methods.getFirstValue(arguments[1],"text");if(jfgrid.func_methods.valueIsError(i))return i;if(jfgrid.func_methods.isRealNull(i))return jfgrid.formula.error.v;var a=arguments[2],n=[];if("object"!=jfgrid.getObjType(a)||null==a.startCell)return jfgrid.formula.error.v;if(null==a.data)return jfgrid.formula.error.v;if(n=jfgrid.func_methods.getCellDataDyadicArr(a,"text"),!jfgrid.func_methods.isRealNum(i)&&"string"!==jfgrid.getObjType(i))return jfgrid.formula.error.v;var o,l=jfgrid.func_methods.findResultIndex(t,n),d=[];d="string"===jfgrid.getObjType(i)?(o=jfgrid.func_methods.findField(t,i),jfgrid.func_methods.rest(t[o])):jfgrid.func_methods.rest(t[i]);for(var f=[],e=0;e<l.length;e++)f[e]=d[l[e]];return f=jfgrid.func_methods.compact(f),window.jfgrid_function.VAR_P.f.apply(window.jfgrid_function.VAR_P,f)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},LINESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList),a=arguments[0],n=arguments[1],o=arguments[2],l=arguments[3],d=arguments[4],f=arguments[5],s=arguments[6],g=arguments[7],c=jfgrid.formula.readCellDataToOneArray(a),u=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t),m=u[0],h=u[1],j={};null==o&&(o=1),j.lineWidth=o,j.offsetY=o+1,j.height=h-(o+1),j.width=m;function p(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=i[r]),j[e]=r)}var v;return null==n&&(n="#2ec7c9"),p("lineColor",n),j.fillColor=0,l&&("string"==typeof l?(l=l.toLowerCase(),v=null,"min"==l?v=window.jfgrid_function.MIN.f({data:c}):"max"==l?v=window.jfgrid_function.MAX.f({data:c}):"avg"==l||"mean"==l?v=window.jfgrid_function.AVERAGE.f({data:c}):"median"==l&&(v=window.jfgrid_function.MEDIAN.f({data:c})),v&&(j.normalRangeMin=v,j.normalRangeMax=v)):(j.normalRangeMin=l,j.normalRangeMax=l)),null==d&&(d="#000"),p("normalRangeColor",d),p("maxSpotColor",f),p("minSpotColor",s),null==g&&(g="1.5"),j.spotRadius=g,jfgrid.sparkline.init(c,j)}catch(e){var b=e;return b=jfgrid.formula.errorInfo(b),[jfgrid.formula.error.v,b]}},AREASPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList),a=arguments[0],n=arguments[1],o=arguments[2],l=arguments[3],d=arguments[4],f=arguments[5],s=jfgrid.formula.readCellDataToOneArray(a),g=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t),c=g[0],u=g[1],m={};null==l&&(l=1),m.lineWidth=l,m.offsetY=l+1,m.height=u-(l+1),m.width=c;function h(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=i[r]),m[e]=r)}var j;return null==n&&(n="#2ec7c9"),h("lineColor",n),h("fillColor",o),null==l&&(l="1"),m.lineWidth=l,d&&("string"==typeof d?(d=d.toLowerCase(),j=null,"min"==d?j=window.jfgrid_function.MIN.f({data:s}):"max"==d?j=window.jfgrid_function.MAX.f({data:s}):"avg"==d||"mean"==d?j=window.jfgrid_function.AVERAGE.f({data:s}):"median"==d&&(j=window.jfgrid_function.MEDIAN.f({data:s})),j&&(m.normalRangeMin=j,m.normalRangeMax=j)):(m.normalRangeMin=d,m.normalRangeMax=d)),null==f&&(f="#000"),h("normalRangeColor",f),jfgrid.sparkline.init(s,m)}catch(e){var p=e;return p=jfgrid.formula.errorInfo(p),[jfgrid.formula.error.v,p]}},COLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList),a=arguments[0],n=jfgrid.formula.readCellDataToOneArray(a),o=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t),l=o[0],d=o[1],f={};f.height=d,f.width=l;function s(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=i[r]),f[e]=r)}var g=arguments[1],c=arguments[2],u=arguments[3],m=arguments[4];f.type="column",null==g&&(g="1"),f.barSpacing=g,null==c&&(c="#fc5c5c"),s("barColor",c),null==u&&(u="#97b552"),s("negBarColor",u),f.chartRangeMax=null==m||!1===m||"number"!=typeof m?void 0:m;var h=jfgrid.formula.sparklinesColorMap(arguments);return h&&(f.colorMap=h),jfgrid.sparkline.init(n,f)}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},STACKCOLUMNSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var i=0;i<arguments.length;i++){var p=jfgrid.formula.errorParamCheck(this.p,arguments[i],i);if(!p[0])return jfgrid.formula.error.v}try{var cell_r=window.jfgridCurrentRow,cell_c=window.jfgridCurrentColumn,cell_fp=window.jfgridCurrentFunction,colorList=jfgrid.formula.colorList,rangeValue=arguments[0],dataformat=[],data=[];if(null!=rangeValue&&null!=rangeValue.data&&(data=rangeValue.data),"array"==jfgrid.getObjType(data))data=jfgrid.formula.getPureValueByData(data);else{if("object"==jfgrid.getObjType(data))return data=data.v,[data];/\{.*?\}/.test(data)&&(data=data.replace(/\{/g,"[").replace(/\}/g,"]")),data=eval("("+data+")")}var stackconfig=arguments[1],offsetY=data.length;if(null==stackconfig||stackconfig)for(var c=0;c<data[0].length;c++){for(var colstr="",r=0;r<data.length;r++)colstr+=data[r][c]+":";colstr=colstr.substr(0,colstr.length-1),dataformat.push(colstr)}else{for(var r=0;r<data.length;r++){for(var rowstr="",c=0;c<data[0].length;c++)rowstr+=data[r][c]+":";rowstr=rowstr.substr(0,rowstr.length-1),dataformat.push(rowstr)}var offsetY=data[0].length}var cellSize=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,cell_r,cell_c),width=cellSize[0],height=cellSize[1],sparksetting={};sparksetting.height=height,sparksetting.width=width;var sparkColorSetting=function(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=colorList[r]),sparksetting[e]=r)},barSpacing=arguments[2],chartRangeMax=arguments[3];sparksetting.type="column",null==barSpacing&&(barSpacing="1"),sparksetting.barSpacing=barSpacing,sparksetting.chartRangeMax=null==chartRangeMax||!1===chartRangeMax||"number"!=typeof chartRangeMax?void 0:chartRangeMax;var colorLists=jfgrid.formula.sparklinesColorMap(arguments,4);colorLists&&(sparksetting.colorMap=colorLists);var temp1=jfgrid.sparkline.init(dataformat,sparksetting);return temp1}catch(e){var err=e;return err=jfgrid.formula.errorInfo(err),[jfgrid.formula.error.v,err]}},BARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList),a=arguments[0],n=jfgrid.formula.readCellDataToOneArray(a),o=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t),l=o[0],d=o[1],f={};f.height=d,f.width=l;function s(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=i[r]),f[e]=r)}var g=arguments[1],c=arguments[2],u=arguments[3],m=arguments[4];f.type="bar",null==g&&(g="1"),f.barSpacing=g,null==c&&(c="#fc5c5c"),s("barColor",c),null==u&&(u="#97b552"),s("negBarColor",u),f.chartRangeMax=null==m||!1===m||"number"!=typeof m?void 0:m;var h=jfgrid.formula.sparklinesColorMap(arguments);return h&&(f.colorMap=h),jfgrid.sparkline.init(n,f)}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},STACKBARSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var i=0;i<arguments.length;i++){var p=jfgrid.formula.errorParamCheck(this.p,arguments[i],i);if(!p[0])return jfgrid.formula.error.v}try{var cell_r=window.jfgridCurrentRow,cell_c=window.jfgridCurrentColumn,cell_fp=window.jfgridCurrentFunction,colorList=jfgrid.formula.colorList,rangeValue=arguments[0],dataformat=[],data=[];if(null!=rangeValue&&null!=rangeValue.data&&(data=rangeValue.data),"array"==jfgrid.getObjType(data))data=jfgrid.formula.getPureValueByData(data);else{if("object"==jfgrid.getObjType(data))return data=data.v,[data];/\{.*?\}/.test(data)&&(data=data.replace(/\{/g,"[").replace(/\}/g,"]")),data=eval("("+data+")")}var stackconfig=arguments[1],offsetY=data.length;if(null==stackconfig||stackconfig)for(var c=0;c<data[0].length;c++){for(var colstr="",r=0;r<data.length;r++)colstr+=data[r][c]+":";colstr=colstr.substr(0,colstr.length-1),dataformat.push(colstr)}else{for(var r=0;r<data.length;r++){for(var rowstr="",c=0;c<data[0].length;c++)rowstr+=data[r][c]+":";rowstr=rowstr.substr(0,rowstr.length-1),dataformat.push(rowstr)}var offsetY=data[0].length}var cellSize=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,cell_r,cell_c),width=cellSize[0],height=cellSize[1],sparksetting={};sparksetting.height=height,sparksetting.width=width;var sparkColorSetting=function(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=colorList[r]),sparksetting[e]=r)},barSpacing=arguments[2],chartRangeMax=arguments[3];sparksetting.type="bar",null==barSpacing&&(barSpacing="1"),sparksetting.barSpacing=barSpacing,sparksetting.chartRangeMax=null==chartRangeMax||!1===chartRangeMax||"number"!=typeof chartRangeMax?void 0:chartRangeMax;var colorLists=jfgrid.formula.sparklinesColorMap(arguments,4);colorLists&&(sparksetting.colorMap=colorLists);var temp1=jfgrid.sparkline.init(dataformat,sparksetting);return temp1}catch(e){var err=e;return err=jfgrid.formula.errorInfo(err),[jfgrid.formula.error.v,err]}},DISCRETESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList),a=arguments[0],n=jfgrid.formula.readCellDataToOneArray(a),o=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t),l=o[0],d=o[1],f={};f.height=d,f.width=l;function s(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=i[r]),f[e]=r)}var g=arguments[1],c=arguments[2],u=arguments[3];return f.type="discrete",null==g&&(g=0),f.thresholdValue=g,null==c&&(c="#2ec7c9"),s("lineColor",c),null==u&&(u="#fc5c5c"),s("thresholdColor",u),jfgrid.sparkline.init(n,f)}catch(e){var m=e;return m=jfgrid.formula.errorInfo(m),[jfgrid.formula.error.v,m]}},TRISTATESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList),a=arguments[0],n=jfgrid.formula.readCellDataToOneArray(a),o=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t),l=o[0],d=o[1],f={};f.height=d,f.width=l;function s(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=i[r]),f[e]=r)}var g=arguments[1],c=arguments[2],u=arguments[3],m=arguments[4];f.type="tristate",null==g&&(g="1"),f.barSpacing=g,null==c&&(c="#fc5c5c"),s("barColor",c),null==u&&(u="#97b552"),s("negBarColor",u),null==m&&(m="#999"),s("zeroBarColor",m);var h=jfgrid.formula.sparklinesColorMap(arguments);return h&&(f.colorMap=h),jfgrid.sparkline.init(n,f)}catch(e){var j=e;return j=jfgrid.formula.errorInfo(j),[jfgrid.formula.error.v,j]}},PIESPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList),a=arguments[0],n=jfgrid.formula.readCellDataToOneArray(a),o=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t),l=o[0],d=o[1],f={};f.height=d,f.width=l;function s(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=i[r]),f[e]=r)}var g=arguments[1],c=arguments[2],u=arguments[3];f.type="pie",null==g&&(g=0),f.offset=g,null==c&&(c=0),s("borderWidth",c),null==u&&(u="#97b552"),s("borderColor",u);var m=jfgrid.formula.sparklinesColorMap(arguments,4);return m&&(f.colorMap=m),jfgrid.sparkline.init(n,f)}catch(e){var h=e;return h=jfgrid.formula.errorInfo(h),[jfgrid.formula.error.v,h]}},BOXSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList),a=arguments[0],n=jfgrid.formula.readCellDataToOneArray(a),o=jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t),l=o[0],d=o[1],f={};f.height=d,f.width=l;function s(e,r){r&&("number"==typeof r&&(19<r&&(r%=20),r=i[r]),f[e]=r)}var g=arguments[1],c=arguments[2],u=arguments[3];return f.type="box",null==g&&(g=1.5),f.outlierIQR=g,null==c?c=0:s("target",c),null==u&&(u=1.5),s("spotRadius",u),jfgrid.sparkline.init(n,f)}catch(e){var m=e;return m=jfgrid.formula.errorInfo(m),[jfgrid.formula.error.v,m]}},BULLETSPLINES:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=window.jfgridCurrentRow,t=window.jfgridCurrentColumn,i=(window.jfgridCurrentFunction,jfgrid.formula.colorList,jfgrid.menuButton.getCellRealSize(jfgrid.flowdata,r,t)),a=i[0],n=i[1],o={};o.height=n,o.width=a;var l=[];jfgrid_getValue(arguments);var d=jfgrid.formula.getValueByFuncData(arguments[0]),f=jfgrid.formula.getValueByFuncData(arguments[1]);l.push(d),l.push(f);for(e=2;e<arguments.length;e++)l.push(jfgrid.formula.getValueByFuncData(arguments[e]));return o.type="bullet",jfgrid.sparkline.init(l,o)}catch(e){var s=e;return s=jfgrid.formula.errorInfo(s),[jfgrid.formula.error.v,s]}},SORT:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[],i=1,a=1;if("array"==jfgrid.getObjType(r))if("array"==jfgrid.getObjType(r[0])){if(!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;for(e=0;e<r.length;e++){for(var n=[],o=0;o<r[e].length;o++){var l=r[e][o];n.push(l)}t.push(n)}i=t.length,a=t[0].length}else{for(e=0;e<r.length;e++){l=r[e];t.push(l)}i=t.length}else if("object"==jfgrid.getObjType(r)&&null!=r.startCell)if(null!=r.data)if("array"==jfgrid.getObjType(r.data)){for(e=0;e<r.data.length;e++){for(n=[],o=0;o<r.data[e].length;o++){null!=r.data[e][o]?(l=r.data[e][o].v,jfgrid.func_methods.isRealNull(l)&&(l=0),n.push(l)):n.push(0)}t.push(n)}i=t.length,a=t[0].length}else{l=r.data.v;jfgrid.func_methods.isRealNull(l)&&(l=0),t.push(l)}else t.push(0);else{l=r;t.push(l)}var d=1;if(2<=arguments.length){if(d=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(d))return d;if(!jfgrid.func_methods.isRealNum(d))return jfgrid.formula.error.v;d=parseInt(d)}var f=1;if(3<=arguments.length){if(f=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(f))return f;if(!jfgrid.func_methods.isRealNum(f))return jfgrid.formula.error.v;f=Math.floor(parseFloat(f))}var s=!1;if(4==arguments.length&&(s=jfgrid.func_methods.getCellBoolen(arguments[3]),jfgrid.func_methods.valueIsError(s)))return s;if(s){if(d<1||i<d)return jfgrid.formula.error.v}else if(d<1||a<d)return jfgrid.formula.error.v;if(1!=f&&-1!=f)return jfgrid.formula.error.v;function g(e,r){return"array"==jfgrid.getObjType(e)&&(e=e[d-1]),"array"==jfgrid.getObjType(r)&&(r=r[d-1]),isNaN(e)||isNaN(r)?isNaN(e)?!isNaN(r)||r<e?1:e<r?-1:void 0:-1:e-r}function c(e,r){return"array"==jfgrid.getObjType(e)&&(e=e[d-1]),"array"==jfgrid.getObjType(r)&&(r=r[d-1]),isNaN(e)||isNaN(r)?isNaN(e)?!isNaN(r)||r<e?-1:e<r?1:void 0:1:r-e}return s?(t=t[0].map(function(e,r){return t.map(function(e){return e[r]})}),1==f&&t.sort(g),-1==f&&t.sort(c),t=t[0].map(function(e,r){return t.map(function(e){return e[r]})})):(1==f&&t.sort(g),-1==f&&t.sort(c)),t}catch(e){var u=e;return u=jfgrid.formula.errorInfo(u),[jfgrid.formula.error.v,u]}},FILTER:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=arguments[0],t=[];if("array"==jfgrid.getObjType(r)){if("array"==jfgrid.getObjType(r[0])&&!jfgrid.func_methods.isDyadicArr(r))return jfgrid.formula.error.v;t=jfgrid.func_methods.getDataDyadicArr(r)}else{"object"==jfgrid.getObjType(r)&&null!=r.startCell?t=jfgrid.func_methods.getCellDataDyadicArr(r,"number"):((f=[]).push(parseFloat(r)),t.push(f))}t.length,t[0].length;var i=arguments[1],a=[],n="row";if("array"==jfgrid.getObjType(i))if("array"==jfgrid.getObjType(i[0])){if(!jfgrid.func_methods.isDyadicArr(i))return jfgrid.formula.error.v;if(1<i.length&&1<i[0].length)return jfgrid.formula.error.v;if(1<i.length){if(i.length!=t.length)return jfgrid.formula.error.v;n="row";for(e=0;e<i.length;e++){var o=i[e][0];if("boolean"!=jfgrid.getObjType(o))if("string"!=jfgrid.getObjType(o)||"true"!=o.toLowerCase()&&"false"!=o.toLowerCase()){if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=0!=(o=parseFloat(o))}else"true"==o.toLowerCase()?o=!0:"false"==o.toLowerCase()&&(o=!1);a.push(o)}}if(1<i[0].length){if(i[0].length!=t[0].length)return jfgrid.formula.error.v;n="col";for(e=0;e<i[0].length;e++){o=i[0][e];if("boolean"!=jfgrid.getObjType(o))if("string"!=jfgrid.getObjType(o)||"true"!=o.toLowerCase()&&"false"!=o.toLowerCase()){if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=0!=(o=parseFloat(o))}else"true"==o.toLowerCase()?o=!0:"false"==o.toLowerCase()&&(o=!1);a.push(o)}}}else{if(i.length!=t[0].length)return jfgrid.formula.error.v;n="col";for(e=0;e<i.length;e++){o=i[e];if("boolean"!=jfgrid.getObjType(o))if("string"!=jfgrid.getObjType(o)||"true"!=o.toLowerCase()&&"false"!=o.toLowerCase()){if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=0!=(o=parseFloat(o))}else"true"==o.toLowerCase()?o=!0:"false"==o.toLowerCase()&&(o=!1);a.push(o)}}else{if("object"!=jfgrid.getObjType(i)||null==i.data||"array"!=jfgrid.getObjType(i.data))return jfgrid.formula.error.v;if(1<i.data.length&&1<i.data[0].length)return jfgrid.formula.error.v;if(1<i.data.length){if(i.data.length!=t.length)return jfgrid.formula.error.v;n="row";for(e=0;e<i.data.length;e++){o=i.data[e][0].v;if(jfgrid.func_methods.isRealNull(o)&&(o=0),"boolean"!=jfgrid.getObjType(o))if("string"!=jfgrid.getObjType(o)||"true"!=o.toLowerCase()&&"false"!=o.toLowerCase()){if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=0!=(o=parseFloat(o))}else"true"==o.toLowerCase()?o=!0:"false"==o.toLowerCase()&&(o=!1);a.push(o)}}if(1<i.data[0].length){if(i.data[0].length!=t[0].length)return jfgrid.formula.error.v;n="col";for(e=0;e<i.data[0].length;e++){o=i.data[0][e].v;if(jfgrid.func_methods.isRealNull(o)&&(o=0),"boolean"!=jfgrid.getObjType(o))if("string"!=jfgrid.getObjType(o)||"true"!=o.toLowerCase()&&"false"!=o.toLowerCase()){if(!jfgrid.func_methods.isRealNum(o))return jfgrid.formula.error.v;o=0!=(o=parseFloat(o))}else"true"==o.toLowerCase()?o=!0:"false"==o.toLowerCase()&&(o=!1);a.push(o)}}}var l="";if(3==arguments.length&&(l=jfgrid.func_methods.getFirstValue(arguments[2],"text"),jfgrid.func_methods.valueIsError(l)))return l;var d=[];if("row"==n)for(e=0;e<t.length;e++)a[e]&&d.push(t[e]);else for(e=0;e<t.length;e++){for(var f=[],s=0;s<t[0].length;s++)a[s]&&f.push(t[e][s]);0<f.length&&d.push(f)}return 0==d.length?l:d}catch(e){var g=e;return g=jfgrid.formula.errorInfo(g),[jfgrid.formula.error.v,g]}},UNIQUE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r,t=arguments[0],i=[];if("array"==jfgrid.getObjType(t)){if("array"==jfgrid.getObjType(t[0])&&!jfgrid.func_methods.isDyadicArr(t))return jfgrid.formula.error.v;i=jfgrid.func_methods.getDataDyadicArr(t)}else{"object"==jfgrid.getObjType(t)&&null!=t.startCell?i=jfgrid.func_methods.getCellDataDyadicArr(t,"number"):((r=[]).push(parseFloat(t)),i.push(r))}var a=!1;if(2<=arguments.length&&(a=jfgrid.func_methods.getCellBoolen(arguments[1]),jfgrid.func_methods.valueIsError(a)))return a;var n=!1;if(3==arguments.length&&(n=jfgrid.func_methods.getCellBoolen(arguments[2]),jfgrid.func_methods.valueIsError(n)))return n;if(a){i=i[0].map(function(e,r){return i.map(function(e){return e[r]})});for(var o={},l=[],d=[],e=0;e<i.length;e++){for(var f="",s=0;s<i[e].length;s++)f+=i[e][s].toString()+"|||";l.push(f),f in o||(o[f]=0,d.push(i[e]))}if(n){for(var g=[],e=0;e<l.length;e++)l.indexOf(l[e])==l.lastIndexOf(l[e])&&g.push(i[e]);return g=g[0].map(function(e,r){return g.map(function(e){return e[r]})})}return d=d[0].map(function(e,r){return d.map(function(e){return e[r]})})}for(o={},l=[],d=[],e=0;e<i.length;e++){for(f="",s=0;s<i[e].length;s++)f+=i[e][s].toString()+"|||";l.push(f),f in o||(o[f]=0,d.push(i[e]))}if(n){for(g=[],e=0;e<l.length;e++)l.indexOf(l[e])==l.lastIndexOf(l[e])&&g.push(i[e]);return g}return d}catch(e){var c=e;return c=jfgrid.formula.errorInfo(c),[jfgrid.formula.error.v,c]}},RANDARRAY:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=1;if(1<=arguments.length){if(r=jfgrid.func_methods.getFirstValue(arguments[0]),jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r)}var t=1;if(2==arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}if(r<=0||t<=0)return jfgrid.formula.error.v;for(var i=[],e=0;e<r;e++){for(var a=[],n=0;n<t;n++)a.push(Math.random().toFixed(9));i.push(a)}return i}catch(e){var o=e;return o=jfgrid.formula.errorInfo(o),[jfgrid.formula.error.v,o]}},SEQUENCE:function(){if(arguments.length<this.m[0]||arguments.length>this.m[1])return jfgrid.formula.error.na;for(var e=0;e<arguments.length;e++){if(!jfgrid.formula.errorParamCheck(this.p,arguments[e],e)[0])return jfgrid.formula.error.v}try{var r=jfgrid.func_methods.getFirstValue(arguments[0]);if(jfgrid.func_methods.valueIsError(r))return r;if(!jfgrid.func_methods.isRealNum(r))return jfgrid.formula.error.v;r=parseInt(r);var t=1;if(2<=arguments.length){if(t=jfgrid.func_methods.getFirstValue(arguments[1]),jfgrid.func_methods.valueIsError(t))return t;if(!jfgrid.func_methods.isRealNum(t))return jfgrid.formula.error.v;t=parseInt(t)}var i=1;if(3<=arguments.length){if(i=jfgrid.func_methods.getFirstValue(arguments[2]),jfgrid.func_methods.valueIsError(i))return i;if(!jfgrid.func_methods.isRealNum(i))return jfgrid.formula.error.v;i=parseFloat(i)}var a=1;if(4==arguments.length){if(a=jfgrid.func_methods.getFirstValue(arguments[3]),jfgrid.func_methods.valueIsError(a))return a;if(!jfgrid.func_methods.isRealNum(a))return jfgrid.formula.error.v;a=parseFloat(a)}if(r<=0||t<=0)return jfgrid.formula.error.v;for(var n=[],e=0;e<r;e++){for(var o=[],l=0;l<t;l++){var d=i+a*(l+t*e);o.push(d)}n.push(o)}return n}catch(e){var f=e;return f=jfgrid.formula.errorInfo(f),[jfgrid.formula.error.v,f]}}};for(var i=0,Yuc;i<jfgrid.functionlist.length;i++){var func=jfgrid.functionlist[i];func.f=jfgrid.functionImplementation[func.n]}jfgrid.matrix_methods=(Yuc={},function(e){function g(){}g.precision=1e-6,g.create=function(e){return(new g).setElements(e)},g.I=function(e){for(var r,t=[],i=e;i--;)for(r=e,t[i]=[];r--;)t[i][r]=i===r?1:0;return g.create(t)},g.prototype={e:function(e,r){return e<1||e>this.elements.length||r<1||r>this.elements[0].length?null:this.elements[e-1][r-1]},dimensions:function(){var e=0===this.elements.length?0:this.elements[0].length;return{rows:this.elements.length,cols:e}},rows:function(){return this.elements.length},cols:function(){return 0===this.elements.length?0:this.elements[0].length},eql:function(e){var r=e.elements||e;if(r[0]&&void 0!==r[0][0]||(r=g.create(r).elements),0===this.elements.length||0===r.length)return this.elements.length===r.length;if(this.elements.length!==r.length)return!1;if(this.elements[0].length!==r[0].length)return!1;for(var t,i=this.elements.length,a=this.elements[0].length;i--;)for(t=a;t--;)if(Math.abs(this.elements[i][t]-r[i][t])>g.precision)return!1;return!0},dup:function(){return g.create(this.elements)},map:function(e,r){if(0===this.elements.length)return g.create([]);for(var t,i=[],a=this.elements.length,n=this.elements[0].length;a--;)for(t=n,i[a]=[];t--;)i[a][t]=e.call(r,this.elements[a][t],a+1,t+1);return g.create(i)},isSameSizeAs:function(e){var r=e.elements||e;return void 0===r[0][0]&&(r=g.create(r).elements),0===this.elements.length?0===r.length:this.elements.length===r.length&&this.elements[0].length===r[0].length},add:function(e){if(0===this.elements.length)return this.map(function(e){return e});var i=e.elements||e;return void 0===i[0][0]&&(i=g.create(i).elements),this.isSameSizeAs(i)?this.map(function(e,r,t){return e+i[r-1][t-1]}):null},subtract:function(e){if(0===this.elements.length)return this.map(function(e){return e});var i=e.elements||e;return void 0===i[0][0]&&(i=g.create(i).elements),this.isSameSizeAs(i)?this.map(function(e,r,t){return e-i[r-1][t-1]}):null},canMultiplyFromLeft:function(e){if(0===this.elements.length)return!1;var r=e.elements||e;return void 0===r[0][0]&&(r=g.create(r).elements),this.elements[0].length===r.length},multiply:function(r){if(0===this.elements.length)return null;if(!r.elements)return this.map(function(e){return e*r});var e=!!r.modulus;if(void 0===(f=r.elements||r)[0][0]&&(f=g.create(f).elements),!this.canMultiplyFromLeft(f))return null;for(var t,i,a,n=this.elements.length,o=f[0].length,l=this.elements[0].length,d=[];n--;)for(t=o,d[n]=[];t--;){for(i=l,a=0;i--;)a+=this.elements[n][i]*f[i][t];d[n][t]=a}var f=g.create(d);return e?f.col(1):f},minor:function(e,r,t,i){if(0===this.elements.length)return null;for(var a,n,o,l=[],d=t,f=this.elements.length,s=this.elements[0].length;d--;)for(l[a=t-d-1]=[],n=i;n--;)o=i-n-1,l[a][o]=this.elements[(e+a-1)%f][(r+o-1)%s];return g.create(l)},transpose:function(){if(0===this.elements.length)return g.create([]);for(var e,r=this.elements.length,t=[],i=this.elements[0].length;i--;)for(e=r,t[i]=[];e--;)t[i][e]=this.elements[e][i];return g.create(t)},isSquare:function(){var e=0===this.elements.length?0:this.elements[0].length;return this.elements.length===e},max:function(){if(0===this.elements.length)return null;for(var e,r=0,t=this.elements.length,i=this.elements[0].length;t--;)for(e=i;e--;)Math.abs(this.elements[t][e])>Math.abs(r)&&(r=this.elements[t][e]);return r},indexOf:function(e){if(0===this.elements.length)return null;for(var r,t=this.elements.length,i=this.elements[0].length,a=0;a<t;a++)for(r=0;r<i;r++)if(this.elements[a][r]===e)return{i:a+1,j:r+1};return null},diagonal:function(){if(!this.isSquare)return null;for(var e=[],r=this.elements.length,t=0;t<r;t++)e.push(this.elements[t][t]);return g.create(e)},toRightTriangular:function(){if(0===this.elements.length)return g.create([]);for(var e,r=this.dup(),t=this.elements.length,i=this.elements[0].length,a=0;a<t;a++){if(0===r.elements[a][a])for(e=a+1;e<t;e++)if(0!==r.elements[e][a]){for(o=[],l=0;l<i;l++)o.push(r.elements[a][l]+r.elements[e][l]);r.elements[a]=o;break}if(0!==r.elements[a][a])for(e=a+1;e<t;e++){for(var n=r.elements[e][a]/r.elements[a][a],o=[],l=0;l<i;l++)o.push(l<=a?0:r.elements[e][l]-r.elements[a][l]*n);r.elements[e]=o}}return r},determinant:function(){if(0===this.elements.length)return 1;if(!this.isSquare())return null;for(var e=this.toRightTriangular(),r=e.elements[0][0],t=e.elements.length,i=1;i<t;i++)r*=e.elements[i][i];return r},isSingular:function(){return this.isSquare()&&0===this.determinant()},trace:function(){if(0===this.elements.length)return 0;if(!this.isSquare())return null;for(var e=this.elements[0][0],r=this.elements.length,t=1;t<r;t++)e+=this.elements[t][t];return e},rank:function(){if(0===this.elements.length)return 0;for(var e,r=this.toRightTriangular(),t=0,i=this.elements.length,a=this.elements[0].length;i--;)for(e=a;e--;)if(Math.abs(r.elements[i][e])>g.precision){t++;break}return t},augment:function(e){if(0===this.elements.length)return this.dup();var r=e.elements||e;void 0===r[0][0]&&(r=g.create(r).elements);var t,i=this.dup(),a=i.elements[0].length,n=i.elements.length,o=r[0].length;if(n!==r.length)return null;for(;n--;)for(t=o;t--;)i.elements[n][a+t]=r[n][t];return i},inverse:function(){if(0===this.elements.length)return null;if(!this.isSquare()||this.isSingular())return null;for(var e,r,t,i,a,n=this.elements.length,o=n,l=this.augment(g.I(n)).toRightTriangular(),d=l.elements[0].length,f=[];o--;){for(t=[],f[o]=[],i=l.elements[o][o],r=0;r<d;r++)a=l.elements[o][r]/i,t.push(a),n<=r&&f[o].push(a);for(l.elements[o]=t,e=o;e--;){for(t=[],r=0;r<d;r++)t.push(l.elements[e][r]-l.elements[o][r]*l.elements[e][o]);l.elements[e]=t}}return g.create(f)},round:function(){return this.map(function(e){return Math.round(e)})},snapTo:function(r){return this.map(function(e){return Math.abs(e-r)<=g.precision?r:e})},setElements:function(e){var r,t,i=e.elements||e;if(i[0]&&void 0!==i[0][0]){for(r=i.length,this.elements=[];r--;)for(t=i[r].length,this.elements[r]=[];t--;)this.elements[r][t]=i[r][t];return this}var a=i.length;for(this.elements=[],r=0;r<a;r++)this.elements.push([i[r]]);return this}},e.sylvester_matrix=g}(Yuc),{inverse:function(e){return Yuc.sylvester_matrix.create(e).inverse().elements}})}(jfgrid),jfgrid.chartparam={jfgrid_chart_point_config:null,jfgridCurrentChartMove:!1,jfgridCurrentChartMoveTimeout:null,jfgridCurrentChartResize:null,jfgrid_chart_rangefocus_timeout:null,jfgrid_chart_rangefocus:!1,jfgrid_chart_data_select_state:!1,jfgridCurrentChartMoveObj:null,jfgridCurrentChartMoveXy:[],jfgridCurrentChartMoveWinH:null,jfgridCurrentChartMoveWinW:null,jfgridInsertChartTosheetChange:!0,jgridCurrentChartSelection:null,jfgridCurrentChartResizeObj:null,jfgridCurrentChartResizeXy:null,jfgridCurrentChartResizeWinH:null,jfgridCurrentChartResizeWinW:null,jfgrid_chartIns_index:-1,jfgridCurrentChartActive:!1,jgridCurrentChartData:null,jfgridcurrentChart:null,jfgrid_chart_redo_click:!1,jgridCurrentChartType:null,jfgridCurrentChartStyle:null,jfgridCurrentChartCurrentType:null,jfgridPreviousChart:""},jfgrid.chartInitial=function(){$("#jfgriddatavisual").click(function(){if(window.generateChart){generator.ini(chartMixConfig),setTimeout(function(){generator.showChartSettingComponent("notRefresh")},0),store.state.chartSetting.isqk&&setTimeout(function(){jfgrid.jfgridsizeauto()},0);var e=jfgrid.getjfgird_select_save();1==e.length&&e[0].row[0]==e[0].row[1]&&e[0].column[0]==e[0].column[1]&&(jfgrid.jfgridMoveHighlightRange2("right","rangeOfSelect"),jfgrid.jfgridMoveHighlightRange2("down","rangeOfSelect"),e=jfgrid.getjfgird_select_save());for(var r=-1,t=e[0].row[1]-e[0].row[0],i=e[0].row[0];i<=e[0].row[1];i++){for(var a=e[0].column[0];a<=e[0].column[1];a++){if(null!=(l=jfgrid.getcellvalue(i,a,jfgrid.flowdata))&&0<l.toString().length){r=i;break}}if(-1!==r)break}-1==r&&(r=0),e[0].row=[r,r],jfgrid.setjfgird_select_save(e),jfgrid.jfgrid_shiftpositon=$.extend(!0,{},e[0]),jfgrid.jfgridMoveEndCell("down","range",!1,t);for(var n=-1,o=(e=jfgrid.getjfgird_select_save())[0].column[1]-e[0].column[0],a=e[0].column[0];a<=e[0].column[1];a++){for(var l,i=e[0].row[0];i<=e[0].row[1];i++){if(null!=(l=jfgrid.getcellvalue(i,a,jfgrid.flowdata))&&0<l.toString().length){n=a;break}}if(-1!==n)break}-1==n&&(n=0),e[0].column=[n,n],jfgrid.setjfgird_select_save(e),jfgrid.jfgrid_shiftpositon=$.extend(!0,{},e[0]),jfgrid.jfgridMoveEndCell("right","range",!1,o),e=jfgrid.getjfgird_select_save();var d=jfgrid.currentSheetIndex,f=$.extend(!0,[],e),s=jfgrid.getdatabyselection(e[0],d);generator.chartData=s;var g=jfgrid.sheetmanage.getRangetxt(d,f[0],d),c=$(window).width(),u=$(window).height(),m=$("#jfgrid-cell-main"),h=m.scrollLeft(),j=m.scrollTop(),p=.3*c,v=.3*c*.618,b=(c-p)/3+h+Math.round(10*Math.random()),_=(u-v)/4+j+Math.round(10*Math.random());generator.insertNewChart("echarts|line|default",s,d,f,g,"default",jfgrid.currentSheetIndex,v,p,b,_)}else jfgrid.tooltip.info('<i class="fa fa-exclamation-triangle"></i>提示',"图表插件暂未加入")})},jfgrid.chart_selection={create:function(e){var r,t,i,a,n,o,l=store.state.chartSetting.chartList[e];function d(e,r,t,i,a){var n,o=jfgrid.getvisibledatarow(),l=jfgrid.getvisibledatacolumn(),d=o[t],f=r-1==-1?0:o[r-1],s=l[a],g=i-1==-1?0:l[i-1];return"rowtitle"==e&&(n="#C65151"),"coltitle"==e&&(n="#9667C0"),"content"==e&&(n="#4970D1"),'<div id="jfgrid-chart-rangeShow-'+e+'" style="left: '+g+"px;width: "+(s-g-1)+"px;top: "+f+"px;height: "+(d-f-1)+'px;border: none;margin: 0;position: absolute;z-index: 14;"><div class="jfgrid-chart-rangeShow-move" data-type="top" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+n+';position: absolute;left: 0;right: 0;top: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="jfgrid-chart-rangeShow-move" data-type="right" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+n+';position: absolute;top: 0;bottom: 0;right: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="jfgrid-chart-rangeShow-move" data-type="bottom" style="height: 2px;border-top: 2px solid #fff;border-bottom: 2px solid #fff;background: '+n+';position: absolute;left: 0;right: 0;bottom: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div class="jfgrid-chart-rangeShow-move" data-type="left" style="width: 2px;border-left: 2px solid #fff;border-right: 2px solid #fff;background: '+n+';position: absolute;top: 0;bottom: 0;left: -2px;z-index: 18;opacity: 0.9;cursor: move;"></div><div style="border: 2px solid #FC6666;background: '+n+';position: absolute;top: 0;right: 0;bottom: 0;left: 0;z-index: 15;opacity: 0.1;"></div><div class="jfgrid-chart-rangeShow-resize" data-type="lt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+n+';position: absolute;left: -3px;top: -3px;z-index: 19;cursor: se-resize;"></div><div class="jfgrid-chart-rangeShow-resize" data-type="rt" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+n+';position: absolute;right: -3px;top: -3px;z-index: 19;cursor: ne-resize;"></div><div class="jfgrid-chart-rangeShow-resize" data-type="lb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+n+';position: absolute;left: -3px;bottom: -3px;z-index: 19;cursor: ne-resize;"></div><div class="jfgrid-chart-rangeShow-resize" data-type="rb" style="width: 6px;height: 6px;border: 1px solid #fff;background: '+n+';position: absolute;right: -3px;bottom: -3px;z-index: 19;cursor: se-resize;"></div></div>'}1<l.rangeArray.length||($("#jfgrid-chart-rangeShow").empty(),$("#jfgrid-cell-selected-boxs").hide(),$("#jfgrid-cell-selected-focus").hide(),$("#jfgrid-rows-h-selected").hide(),$("#jfgrid-cols-h-selected").hide(),$("#jfgrid-row-count-show").hide(),$("#jfgrid-column-count-show").hide(),r=l.rangeArray[0].row[0],t=l.rangeArray[0].column[0],i=l.rangeSplitArray,a=l.rangeRowCheck.exits?d("rowtitle",i.rowtitle.row[0]+r,i.rowtitle.row[1]+r,i.rowtitle.column[0]+t,i.rowtitle.column[1]+t):"",n=l.rangeColCheck.exits?d("coltitle",i.coltitle.row[0]+r,i.coltitle.row[1]+r,i.coltitle.column[0]+t,i.coltitle.column[1]+t):"",o=d("content",i.content.row[0]+r,i.content.row[1]+r,i.content.column[0]+t,i.content.column[1]+t),$("#jfgrid-chart-rangeShow").append(a+n+o))},rangeMove:!1,rangeMovexy:null,rangeMoveIndex:null,rangeMoveObj:null,rangeMoveDraging:function(e,r,t){var i,a,n,o,l=$.extend(!0,{},store.state.chartSetting.chartList[store.state.chartSetting.chartCurrent]),d=l.rangeArray[0].row[0],f=l.rangeArray[0].column[0],s=l.rangeRowCheck,g=l.rangeColCheck,c=l.rangeSplitArray,u=jfgrid.mouseposition(e.pageX,e.pageY),m=$("#jfgrid-cell-main").scrollLeft(),h=$("#jfgrid-cell-main").scrollTop(),j=u[0]+m,p=u[1]+h,v=$(window).height()+h-r-t,b=$(window).width()+m,_=jfgrid.rowLocation(p)[2],w=jfgrid.colLocation(j)[2],y=jfgrid.getvisibledatarow(),x=jfgrid.getvisibledatacolumn(),C=jfgrid.chart_selection.rangeMoveObj.attr("id");"jfgrid-chart-rangeShow-content"==C?(n=jfgrid.chart_selection.rangeMoveIndex[0]-jfgrid.chart_selection.rangeMovexy[0]+_,s.exits?(n<d+s.range[1]+1||p<0)&&(n=d+s.range[1]+1):(n<0||p<0)&&(n=0),((o=c.content.row[1]-c.content.row[0]+n)>=y.length-1||v<p)&&(n=y.length-1-c.content.row[1]+c.content.row[0],o=y.length-1),i=jfgrid.chart_selection.rangeMoveIndex[1]-jfgrid.chart_selection.rangeMovexy[1]+w,g.exits?(i<f+g.range[1]+1||j<0)&&(i=f+g.range[1]+1):(i<0||j<0)&&(i=0),((a=c.content.column[1]-c.content.column[0]+i)>=x.length-1||b<j)&&(i=x.length-1-c.content.column[1]+c.content.column[0],a=x.length-1),s.exits&&g.exits?(l.rangeArray=[{row:[d,o],column:[f,a]}],l.rangeSplitArray.range={row:[d,o],column:[f,a]},l.rangeSplitArray.content={row:[n-d,o-d],column:[i-f,a-f]},l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[i-f,a-f]},l.rangeSplitArray.coltitle={row:[n-d,o-d],column:l.rangeSplitArray.coltitle.column}):s.exits?(l.rangeArray=[{row:[d,o],column:[i,a]}],l.rangeSplitArray.range={row:[d,o],column:[i,a]},l.rangeSplitArray.content={row:[n-d,o-d],column:l.rangeSplitArray.content.column}):g.exits?(l.rangeArray=[{row:[n,o],column:[f,a]}],l.rangeSplitArray.range={row:[n,o],column:[f,a]},l.rangeSplitArray.content={row:l.rangeSplitArray.content.row,column:[i-f,a-f]}):(l.rangeArray=[{row:[n,o],column:[i,a]}],l.rangeSplitArray.range={row:[n,o],column:[i,a]})):"jfgrid-chart-rangeShow-rowtitle"==C?(i=jfgrid.chart_selection.rangeMoveIndex[1]-jfgrid.chart_selection.rangeMovexy[1]+w,g.exits?(i<f+g.range[1]+1||j<0)&&(i=f+g.range[1]+1):(i<0||j<0)&&(i=0),((a=c.rowtitle.column[1]-c.rowtitle.column[0]+i)>=x.length-1||b<j)&&(i=x.length-1-c.rowtitle.column[1]+c.rowtitle.column[0],a=x.length-1),g.exits?(l.rangeArray=[{row:l.rangeArray[0].row,column:[f,a]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[f,a]},l.rangeSplitArray.rowtitle={row:l.rangeSplitArray.rowtitle.row,column:[i-f,a-f]},l.rangeSplitArray.content={row:l.rangeSplitArray.content.row,column:[i-f,a-f]}):(l.rangeArray=[{row:l.rangeArray[0].row,column:[i,a]}],l.rangeSplitArray.range={row:l.rangeArray[0].row,column:[i,a]})):"jfgrid-chart-rangeShow-coltitle"==C&&(n=jfgrid.chart_selection.rangeMoveIndex[0]-jfgrid.chart_selection.rangeMovexy[0]+_,s.exits?(n<d+s.range[1]+1||p<0)&&(n=d+s.range[1]+1):(n<0||p<0)&&(n=0),((o=c.coltitle.row[1]-c.coltitle.row[0]+n)>=y.length-1||v<p)&&(n=y.length-1-c.coltitle.row[1]+c.coltitle.row[0],o=y.length-1),s.exits?(l.rangeArray=[{row:[d,o],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[d,o],column:l.rangeArray[0].column},l.rangeSplitArray.coltitle={row:[n-d,o-d],column:l.rangeSplitArray.coltitle.column},l.rangeSplitArray.content={row:[n-d,o-d],column:l.rangeSplitArray.content.column}):(l.rangeArray=[{row:[n,o],column:l.rangeArray[0].column}],l.rangeSplitArray.range={row:[n,o],column:l.rangeArray[0].column})),store.commit({type:"updateChartItem",key:"rangeArray",value:l.rangeArray,chartId:l.chart_id}),store.commit({type:"updateChartItem",key:"rangeSplitArray",value:l.rangeSplitArray,chartId:l.chart_id}),jfgrid.chart_selection.create(store.state.chartSetting.chartCurrent)},rangeMoveDragged:function(){jfgrid.chart_selection.rangeMove=!1;var e=$.extend(!0,{},store.state.chartSetting.chartList[store.state.chartSetting.chartCurrent]),r={};r.chart_id=store.state.chartSetting.chartCurrent,r.rangeTxt=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,e.rangeArray[0],jfgrid.currentSheetIndex),r.chartData=jfgrid.getdatabyselection(e.rangeArray[0],jfgrid.currentSheetIndex),"jfgrid-chart-rangeShow-content"!=jfgrid.chart_selection.rangeMoveObj.attr("id")||e.rangeRowCheck.exits||e.rangeColCheck.exits?r.rangeSplitArray=e.rangeSplitArray:r.rangeSplitArray=generator.getRangeSplitArray(r.chartData,e.rangeArray,e.rangeColCheck,e.rangeRowCheck);var t=e.chartAllType.split("|"),i=t[0],a=t[1],n=t[2];r.chartDataCache=generator.getChartDataCache(r.chartData,r.rangeSplitArray,i,a,n),r.chartDataSeriesOrder=generator.getChartDataSeriesOrder(r.chartDataCache.series[0].length),generator.drag=!0,generator.addPoint=!1,generator.addLine=!1,generator.addArea=!1,r.defaultOption="funnel"==a||"gauge"==a?generator.addDataToOption1(e.defaultOption,r.chartDataCache,r.chartDataSeriesOrder,i,a,n):generator.addDataToOption(e.defaultOption,r.chartDataCache,r.chartDataSeriesOrder,i,a,n),generator.patchVueSet(r),generator.generateChart(r.defaultOption,e.chartTheme,e.chartAllType,$("#"+r.chart_id).get(0))},rangeResize:!1,rangeResizexy:null,rangeResizeIndex:null,rangeResizeObj:null,rangeResizeDraging:function(e,r,t){var i,a,n,o,l,d,f,s,g,c,u=$.extend(!0,{},store.state.chartSetting.chartList[store.state.chartSetting.chartCurrent]),m=u.rangeArray[0].row[0],h=u.rangeArray[0].column[0],j=u.rangeRowCheck,p=u.rangeColCheck,v=(u.rangeSplitArray,jfgrid.mouseposition(e.pageX,e.pageY)),b=$("#jfgrid-cell-main").scrollLeft(),_=$("#jfgrid-cell-main").scrollTop(),w=v[0]+b,y=v[1]+_,x=$(window).height()+_-r-t,C=$(window).width()+b,T=jfgrid.rowLocation(y)[2],I=jfgrid.colLocation(w)[2],R=jfgrid.getvisibledatarow(),k=jfgrid.getvisibledatacolumn(),S=jfgrid.chart_selection.rangeResizeObj.attr("id");"jfgrid-chart-rangeShow-content"==S?("lt"==jfgrid.chart_selection.rangeResize?(d=jfgrid.chart_selection.rangeResizeIndex.row[0],i=jfgrid.chart_selection.rangeResizeIndex.column[0],f=jfgrid.chart_selection.rangeResizeIndex.row[1],a=jfgrid.chart_selection.rangeResizeIndex.column[1]):"lb"==jfgrid.chart_selection.rangeResize?(d=jfgrid.chart_selection.rangeResizeIndex.row[1],i=jfgrid.chart_selection.rangeResizeIndex.column[0],f=jfgrid.chart_selection.rangeResizeIndex.row[0],a=jfgrid.chart_selection.rangeResizeIndex.column[1]):"rt"==jfgrid.chart_selection.rangeResize?(d=jfgrid.chart_selection.rangeResizeIndex.row[0],i=jfgrid.chart_selection.rangeResizeIndex.column[1],f=jfgrid.chart_selection.rangeResizeIndex.row[1],a=jfgrid.chart_selection.rangeResizeIndex.column[0]):"rb"==jfgrid.chart_selection.rangeResize&&(d=jfgrid.chart_selection.rangeResizeIndex.row[1],i=jfgrid.chart_selection.rangeResizeIndex.column[1],f=jfgrid.chart_selection.rangeResizeIndex.row[0],a=jfgrid.chart_selection.rangeResizeIndex.column[0]),j.exits?(s=d-jfgrid.chart_selection.rangeResizexy[0]+T)<m+j.range[1]+1||y<0?s=m+j.range[1]+1:(s>=R.length-1||x<y)&&(s=R.length-1):(s=m-jfgrid.chart_selection.rangeResizexy[0]+T)<0||y<0?s=0:(s>=R.length-1||x<y)&&(s=R.length-1),p.exits?(n=i-jfgrid.chart_selection.rangeResizexy[1]+I)<h+p.range[1]+1||w<0?n=h+p.range[1]+1:(n>=k.length-1||C<w)&&(n=k.length-1):(n=h-jfgrid.chart_selection.rangeResizexy[1]+I)<0||w<0?n=0:(n>=k.length-1||C<w)&&(n=k.length-1),c=f<s?(g=f,s):(g=s,f),l=a<n?(o=a,n):(o=n,a),j.exits||p.exits?(u.rangeArray=[{row:[m,c],column:[h,l]}],u.rangeSplitArray.range={row:[m,c],column:[h,l]},u.rangeSplitArray.content={row:[g-m,c-m],column:[o-h,l-h]},j.exits&&(u.rangeSplitArray.rowtitle={row:u.rangeSplitArray.rowtitle.row,column:[o-h,l-h]}),p.exits&&(u.rangeSplitArray.coltitle={row:[g-m,c-m],column:u.rangeSplitArray.coltitle.column})):(u.rangeArray=[{row:[g,c],column:[o,l]}],u.rangeSplitArray.range={row:[g,c],column:[o,l]})):"jfgrid-chart-rangeShow-rowtitle"==S?("lt"==jfgrid.chart_selection.rangeResize||"lb"==jfgrid.chart_selection.rangeResize?(i=jfgrid.chart_selection.rangeResizeIndex.column[0],a=jfgrid.chart_selection.rangeResizeIndex.column[1]):"rt"!=jfgrid.chart_selection.rangeResize&&"rb"!=jfgrid.chart_selection.rangeResize||(i=jfgrid.chart_selection.rangeResizeIndex.column[1],a=jfgrid.chart_selection.rangeResizeIndex.column[0]),p.exits?(n=i-jfgrid.chart_selection.rangeResizexy[1]+I)<h+p.range[1]+1||w<0?n=h+p.range[1]+1:(n>=k.length-1||C<w)&&(n=k.length-1):(n=h-jfgrid.chart_selection.rangeResizexy[1]+I)<0||w<0?n=0:(n>=k.length-1||C<w)&&(n=k.length-1),l=a<n?(o=a,n):(o=n,a),p.exits?(u.rangeArray=[{row:u.rangeArray[0].row,column:[h,l]}],u.rangeSplitArray.range={row:u.rangeArray[0].row,column:[h,l]},u.rangeSplitArray.rowtitle={row:u.rangeSplitArray.rowtitle.row,column:[o-h,l-h]},u.rangeSplitArray.content={row:u.rangeSplitArray.content.row,column:[o-h,l-h]}):(u.rangeArray=[{row:u.rangeArray[0].row,column:[o,l]}],u.rangeSplitArray.range={row:u.rangeArray[0].row,column:[o,l]})):"jfgrid-chart-rangeShow-coltitle"==S&&("lt"==jfgrid.chart_selection.rangeResize||"rt"==jfgrid.chart_selection.rangeResize?(d=jfgrid.chart_selection.rangeResizeIndex.row[0],f=jfgrid.chart_selection.rangeResizeIndex.row[1]):"lb"!=jfgrid.chart_selection.rangeResize&&"rb"!=jfgrid.chart_selection.rangeResize||(d=jfgrid.chart_selection.rangeResizeIndex.row[1],f=jfgrid.chart_selection.rangeResizeIndex.row[0]),j.exits?(s=d-jfgrid.chart_selection.rangeResizexy[0]+T)<m+j.range[1]+1||y<0?s=m+j.range[1]+1:(s>=R.length-1||x<y)&&(s=R.length-1):(s=m-jfgrid.chart_selection.rangeResizexy[0]+T)<0||y<0?s=0:(s>=R.length-1||x<y)&&(s=R.length-1),c=f<s?(g=f,s):(g=s,f),j.exits?(u.rangeArray=[{row:[m,c],column:u.rangeArray[0].column}],u.rangeSplitArray.range={row:[m,c],column:u.rangeArray[0].column},u.rangeSplitArray.coltitle={row:[g-m,c-m],column:u.rangeSplitArray.coltitle.column},u.rangeSplitArray.content={row:[g-m,c-m],column:u.rangeSplitArray.content.column}):(u.rangeArray=[{row:[g,c],column:u.rangeArray[0].column}],u.rangeSplitArray.range={row:[g,c],column:u.rangeArray[0].column})),store.commit({type:"updateChartItem",key:"rangeArray",value:u.rangeArray,chartId:u.chart_id}),store.commit({type:"updateChartItem",key:"rangeSplitArray",value:u.rangeSplitArray,chartId:u.chart_id}),jfgrid.chart_selection.create(store.state.chartSetting.chartCurrent)},rangeResizeDragged:function(){jfgrid.chart_selection.rangeResize=null;var e=$.extend(!0,{},store.state.chartSetting.chartList[store.state.chartSetting.chartCurrent]),r={};r.chart_id=store.state.chartSetting.chartCurrent,r.rangeTxt=jfgrid.sheetmanage.getRangetxt(jfgrid.currentSheetIndex,e.rangeArray[0],jfgrid.currentSheetIndex),r.chartData=jfgrid.getdatabyselection(e.rangeArray[0],jfgrid.currentSheetIndex),"jfgrid-chart-rangeShow-content"!=jfgrid.chart_selection.rangeResizeObj.attr("id")||e.rangeRowCheck.exits||e.rangeColCheck.exits?r.rangeSplitArray=e.rangeSplitArray:r.rangeSplitArray=generator.getRangeSplitArray(r.chartData,e.rangeArray,e.rangeColCheck,e.rangeRowCheck);var t=e.chartAllType.split("|"),i=t[0],a=t[1],n=t[2];r.chartDataCache=generator.getChartDataCache(r.chartData,r.rangeSplitArray,i,a,n),r.chartDataSeriesOrder=generator.getChartDataSeriesOrder(r.chartDataCache.series[0].length),r.defaultOption="funnel"==a||"gauge"==a?generator.addDataToOption1(e.defaultOption,r.chartDataCache,r.chartDataSeriesOrder,i,a,n):generator.addDataToOption(e.defaultOption,r.chartDataCache,r.chartDataSeriesOrder,i,a,n),generator.patchVueSet(r),generator.generateChart(r.defaultOption,e.chartTheme,e.chartAllType,$("#"+r.chart_id).get(0))}};